<html>
<head>
<title>MayaChemTools:Code:PyMOLVisualizeMacromolecules.py</title>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<link rel="stylesheet" type="text/css" href="../../../css/MayaChemToolsPythonCode.css">
</head>
<body leftmargin="20" rightmargin="20" topmargin="10" bottommargin="10">
<br/>
<center>
<a href="http://www.mayachemtools.org" title="MayaChemTools Home"><img src="../../../images/MayaChemToolsLogo.gif" border="0" alt="MayaChemTools"></a>
</center>
<br/>
<pre>
    1 <span class="ch">#!/bin/env python</span>
    2 <span class="c1">#</span>
    3 <span class="c1"># File: PyMOLVisualizeMacromolecules.py</span>
    4 <span class="c1"># Author: Manish Sud &lt;msud@san.rr.com&gt;</span>
    5 <span class="c1">#</span>
    6 <span class="c1"># Copyright (C) 2020 Manish Sud. All rights reserved.</span>
    7 <span class="c1">#</span>
    8 <span class="c1"># The functionality available in this script is implemented using PyMOL, a</span>
    9 <span class="c1"># molecular visualization system on an open source foundation originally</span>
   10 <span class="c1"># developed by Warren DeLano.</span>
   11 <span class="c1">#</span>
   12 <span class="c1"># This file is part of MayaChemTools.</span>
   13 <span class="c1">#</span>
   14 <span class="c1"># MayaChemTools is free software; you can redistribute it and/or modify it under</span>
   15 <span class="c1"># the terms of the GNU Lesser General Public License as published by the Free</span>
   16 <span class="c1"># Software Foundation; either version 3 of the License, or (at your option) any</span>
   17 <span class="c1"># later version.</span>
   18 <span class="c1">#</span>
   19 <span class="c1"># MayaChemTools is distributed in the hope that it will be useful, but without</span>
   20 <span class="c1"># any warranty; without even the implied warranty of merchantability of fitness</span>
   21 <span class="c1"># for a particular purpose.  See the GNU Lesser General Public License for more</span>
   22 <span class="c1"># details.</span>
   23 <span class="c1">#</span>
   24 <span class="c1"># You should have received a copy of the GNU Lesser General Public License</span>
   25 <span class="c1"># along with MayaChemTools; if not, see &lt;http://www.gnu.org/licenses/&gt; or</span>
   26 <span class="c1"># write to the Free Software Foundation Inc., 59 Temple Place, Suite 330,</span>
   27 <span class="c1"># Boston, MA, 02111-1307, USA.</span>
   28 <span class="c1">#</span>
   29 
   30 <span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
   31 
   32 <span class="c1"># Add local python path to the global path and import standard library modules...</span>
   33 <span class="kn">import</span> <span class="nn">os</span>
   34 <span class="kn">import</span> <span class="nn">sys</span><span class="p">;</span>  <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="s2">&quot;..&quot;</span><span class="p">,</span> <span class="s2">&quot;lib&quot;</span><span class="p">,</span> <span class="s2">&quot;Python&quot;</span><span class="p">))</span>
   35 <span class="kn">import</span> <span class="nn">time</span>
   36 <span class="kn">import</span> <span class="nn">re</span>
   37 
   38 <span class="c1"># PyMOL imports...</span>
   39 <span class="k">try</span><span class="p">:</span>
   40     <span class="kn">import</span> <span class="nn">pymol</span>
   41     <span class="c1"># Finish launching PyMOL in  a command line mode for batch processing (-c)</span>
   42     <span class="c1"># along with the following options:  disable loading of pymolrc and plugins (-k);</span>
   43     <span class="c1"># suppress start up messages (-q)</span>
   44     <span class="n">pymol</span><span class="o">.</span><span class="n">finish_launching</span><span class="p">([</span><span class="s1">&#39;pymol&#39;</span><span class="p">,</span> <span class="s1">&#39;-ckq&#39;</span><span class="p">])</span>
   45 <span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">ErrMsg</span><span class="p">:</span>
   46     <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Failed to import PyMOL module/package: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ErrMsg</span><span class="p">)</span>
   47     <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Check/update your PyMOL environment and try again.</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
   48     <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
   49 
   50 <span class="c1"># MayaChemTools imports...</span>
   51 <span class="k">try</span><span class="p">:</span>
   52     <span class="kn">from</span> <span class="nn">docopt</span> <span class="kn">import</span> <span class="n">docopt</span>
   53     <span class="kn">import</span> <span class="nn">MiscUtil</span>
   54     <span class="kn">import</span> <span class="nn">PyMOLUtil</span>
   55 <span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">ErrMsg</span><span class="p">:</span>
   56     <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Failed to import MayaChemTools module/package: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ErrMsg</span><span class="p">)</span>
   57     <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Check/update your MayaChemTools environment and try again.</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
   58     <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
   59 
   60 <span class="n">ScriptName</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
   61 <span class="n">Options</span> <span class="o">=</span> <span class="p">{}</span>
   62 <span class="n">OptionsInfo</span> <span class="o">=</span> <span class="p">{}</span>
   63 
   64 <span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
   65     <span class="sd">&quot;&quot;&quot;Start execution of the script&quot;&quot;&quot;</span>
   66     
   67     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="s2"> (PyMOL v</span><span class="si">%s</span><span class="s2">; </span><span class="si">%s</span><span class="s2">) Starting...</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ScriptName</span><span class="p">,</span> <span class="n">pymol</span><span class="o">.</span><span class="n">cmd</span><span class="o">.</span><span class="n">get_version</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="n">time</span><span class="o">.</span><span class="n">asctime</span><span class="p">()))</span>
   68     
   69     <span class="p">(</span><span class="n">WallClockTime</span><span class="p">,</span> <span class="n">ProcessorTime</span><span class="p">)</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">GetWallClockAndProcessorTime</span><span class="p">()</span>
   70     
   71     <span class="c1"># Retrieve command line arguments and options...</span>
   72     <span class="n">RetrieveOptions</span><span class="p">()</span>
   73     
   74     <span class="c1"># Process and validate command line arguments and options...</span>
   75     <span class="n">ProcessOptions</span><span class="p">()</span>
   76 
   77     <span class="c1"># Perform actions required by the script...</span>
   78     <span class="n">GenerateMacromolecularVisualization</span><span class="p">()</span>
   79     
   80     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="s2">: Done...</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ScriptName</span><span class="p">)</span>
   81     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Total time: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">GetFormattedElapsedTime</span><span class="p">(</span><span class="n">WallClockTime</span><span class="p">,</span> <span class="n">ProcessorTime</span><span class="p">))</span>
   82 
   83 <span class="k">def</span> <span class="nf">GenerateMacromolecularVisualization</span><span class="p">():</span>
   84     <span class="sd">&quot;&quot;&quot;Generate macromolecular visualization.&quot;&quot;&quot;</span>
   85 
   86     <span class="n">Outfile</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMLOutfile&quot;</span><span class="p">]</span>
   87     <span class="n">OutFH</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">Outfile</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
   88     <span class="k">if</span> <span class="n">OutFH</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
   89         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;Failed to open output fie </span><span class="si">%s</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">Outfile</span><span class="p">)</span>
   90     
   91     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Generating file </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">Outfile</span><span class="p">)</span>
   92 
   93     <span class="c1"># Setup header...</span>
   94     <span class="n">WritePMLHeader</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">ScriptName</span><span class="p">)</span>
   95     <span class="n">WritePyMOLParameters</span><span class="p">(</span><span class="n">OutFH</span><span class="p">)</span>
   96     
   97     <span class="c1"># Load reffile for alignment..</span>
   98     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Align&quot;</span><span class="p">]:</span>
   99         <span class="n">WriteAlignReference</span><span class="p">(</span><span class="n">OutFH</span><span class="p">)</span>
  100 
  101     <span class="c1"># Setup view for each input file...</span>
  102     <span class="n">FirstComplex</span> <span class="o">=</span> <span class="bp">True</span>
  103     <span class="n">FirstComplexFirstChainName</span> <span class="o">=</span> <span class="bp">None</span>
  104     <span class="k">for</span> <span class="n">FileIndex</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">])):</span>
  105         <span class="c1"># Setup PyMOL object names...</span>
  106         <span class="n">PyMOLObjectNames</span> <span class="o">=</span> <span class="n">SetupPyMOLObjectNames</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">)</span>
  107 
  108         <span class="c1"># Setup complex view...</span>
  109         <span class="n">WriteComplexView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">FirstComplex</span><span class="p">)</span>
  110         
  111         <span class="n">SpecifiedChainsAndLigandsInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
  112         <span class="n">FirstChain</span> <span class="o">=</span> <span class="bp">True</span>
  113         <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]:</span>
  114             <span class="k">if</span> <span class="n">FirstComplex</span> <span class="ow">and</span> <span class="n">FirstChain</span><span class="p">:</span>
  115                 <span class="n">FirstComplexFirstChainName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAlone&quot;</span><span class="p">]</span>
  116                 
  117             <span class="n">WriteChainView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
  118             
  119             <span class="c1"># Setup ligand views...</span>
  120             <span class="n">FirstLigand</span> <span class="o">=</span> <span class="bp">True</span>
  121             <span class="k">for</span> <span class="n">LigandID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]:</span>
  122                 <span class="n">WriteChainLigandView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">)</span>
  123                 
  124                 <span class="c1"># Set up ligand level group...</span>
  125                 <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span> <span class="o">=</span> <span class="p">[</span><span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">]</span>
  126                 <span class="k">if</span> <span class="n">FirstLigand</span><span class="p">:</span>
  127                     <span class="n">FirstLigand</span> <span class="o">=</span> <span class="bp">False</span>
  128                     <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span> <span class="o">=</span> <span class="p">[</span><span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;open&quot;</span><span class="p">]</span>
  129                 <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="s2">&quot;ChainLigandGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="s2">&quot;ChainLigandGroupMembers&quot;</span><span class="p">],</span> <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span><span class="p">)</span>
  130             
  131             <span class="c1"># Setup Chain level group...</span>
  132             <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span> <span class="o">=</span> <span class="p">[</span><span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">]</span>
  133             <span class="k">if</span> <span class="n">FirstChain</span><span class="p">:</span>
  134                 <span class="n">FirstChain</span> <span class="o">=</span> <span class="bp">False</span>
  135                 <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span> <span class="o">=</span> <span class="p">[</span><span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;open&quot;</span><span class="p">]</span>
  136             <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroupMembers&quot;</span><span class="p">],</span> <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span><span class="p">)</span>
  137     
  138         <span class="c1"># Set up complex level group...</span>
  139         <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span> <span class="o">=</span> <span class="p">[</span><span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">]</span>
  140         <span class="k">if</span> <span class="n">FirstComplex</span><span class="p">:</span>
  141             <span class="n">FirstComplex</span> <span class="o">=</span> <span class="bp">False</span>
  142             <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span> <span class="o">=</span> <span class="p">[</span><span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;open&quot;</span><span class="p">]</span>
  143         <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;PDBGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;PDBGroupMembers&quot;</span><span class="p">],</span> <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span><span class="p">)</span>
  144         
  145         <span class="c1"># Delete empty PyMOL objects...</span>
  146         <span class="n">DeleteEmptyPyMOLObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">)</span>
  147         
  148     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Align&quot;</span><span class="p">]:</span>
  149         <span class="n">DeleteAlignReference</span><span class="p">(</span><span class="n">OutFH</span><span class="p">)</span>
  150 
  151     <span class="k">if</span> <span class="n">FirstComplexFirstChainName</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
  152         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">cmd.orient(&quot;</span><span class="si">%s</span><span class="s2">&quot;, animate = -1)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">FirstComplexFirstChainName</span><span class="p">)</span>
  153     <span class="k">else</span><span class="p">:</span>
  154         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">cmd.orient(&quot;visible&quot;, animate = -1)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  155     
  156     <span class="n">OutFH</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
  157 
  158     <span class="c1"># Generate PSE file as needed...</span>
  159     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PSEOut&quot;</span><span class="p">]:</span>
  160         <span class="n">GeneratePyMOLSessionFile</span><span class="p">()</span>
  161 
  162 <span class="k">def</span> <span class="nf">WritePMLHeader</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">ScriptName</span><span class="p">):</span>
  163     <span class="sd">&quot;&quot;&quot;Write out PML setting up complex view&quot;&quot;&quot;</span>
  164 
  165     <span class="n">HeaderInfo</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLHeaderInfo</span><span class="p">(</span><span class="n">ScriptName</span><span class="p">)</span>
  166     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">HeaderInfo</span><span class="p">)</span>
  167 
  168 <span class="k">def</span> <span class="nf">WritePyMOLParameters</span><span class="p">(</span><span class="n">OutFH</span><span class="p">):</span>
  169     <span class="sd">&quot;&quot;&quot;Write out PyMOL global parameters. &quot;&quot;&quot;</span>
  170 
  171     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
  172     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;transparency&quot;, </span><span class="si">%.2f</span><span class="s2">, &quot;&quot;, 0)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceTransparency&quot;</span><span class="p">]))</span>
  173     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;label_font_id&quot;, </span><span class="si">%s</span><span class="s2">)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;LabelFontID&quot;</span><span class="p">]))</span>
  174     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
  175     
  176     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Setting up PyMOL gobal parameters...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  177     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  178     
  179 <span class="k">def</span> <span class="nf">WriteAlignReference</span><span class="p">(</span><span class="n">OutFH</span><span class="p">):</span>
  180     <span class="sd">&quot;&quot;&quot;Setup object for alignment reference &quot;&quot;&quot;</span>
  181 
  182     <span class="n">RefFileInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;RefFileInfo&quot;</span><span class="p">]</span>
  183     <span class="n">RefFile</span> <span class="o">=</span> <span class="n">RefFileInfo</span><span class="p">[</span><span class="s2">&quot;RefFileName&quot;</span><span class="p">]</span>
  184     <span class="n">RefName</span> <span class="o">=</span> <span class="n">RefFileInfo</span><span class="p">[</span><span class="s2">&quot;PyMOLObjectName&quot;</span><span class="p">]</span>
  185     
  186     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
  187     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.load(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">RefFile</span><span class="p">,</span> <span class="n">RefName</span><span class="p">))</span>
  188     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.hide(&quot;everything&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">RefName</span><span class="p">))</span>
  189     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.disable(&quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">RefName</span><span class="p">))</span>
  190     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
  191     
  192     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Loading </span><span class="si">%s</span><span class="s2"> and setting up view for align reference...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">RefFile</span><span class="p">)</span>
  193     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  194     
  195 <span class="k">def</span> <span class="nf">WriteAlignComplex</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">):</span>
  196     <span class="sd">&quot;&quot;&quot;Setup alignment of complex to reference&quot;&quot;&quot;</span>
  197 
  198     <span class="n">RefFileInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;RefFileInfo&quot;</span><span class="p">]</span>
  199     <span class="n">RefName</span> <span class="o">=</span> <span class="n">RefFileInfo</span><span class="p">[</span><span class="s2">&quot;PyMOLObjectName&quot;</span><span class="p">]</span>
  200     
  201     <span class="n">ComplexName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Complex&quot;</span><span class="p">]</span>
  202     
  203     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^FirstChain$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AlignMode&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  204         <span class="n">RefFirstChainID</span> <span class="o">=</span> <span class="n">RefFileInfo</span><span class="p">[</span><span class="s2">&quot;ChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
  205         <span class="n">RefAlignSelection</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">RefName</span><span class="p">,</span> <span class="n">RefFirstChainID</span><span class="p">)</span>
  206         
  207         <span class="n">ComplexFirstChainID</span> <span class="o">=</span> <span class="n">RetrieveFirstChainID</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">)</span>
  208         <span class="n">ComplexAlignSelection</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ComplexName</span><span class="p">,</span> <span class="n">ComplexFirstChainID</span><span class="p">)</span>
  209     <span class="k">else</span><span class="p">:</span>
  210         <span class="n">RefAlignSelection</span> <span class="o">=</span> <span class="n">RefName</span>
  211         <span class="n">ComplexAlignSelection</span> <span class="o">=</span> <span class="n">ComplexName</span>
  212 
  213     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForAlignment</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AlignMethod&quot;</span><span class="p">],</span> <span class="n">RefAlignSelection</span><span class="p">,</span> <span class="n">ComplexAlignSelection</span><span class="p">)</span>
  214     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Aligning </span><span class="si">%s</span><span class="s2"> against reference </span><span class="si">%s</span><span class="s2"> ...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ComplexAlignSelection</span><span class="p">,</span> <span class="n">RefAlignSelection</span><span class="p">))</span>
  215     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  216     
  217 <span class="k">def</span> <span class="nf">DeleteAlignReference</span><span class="p">(</span><span class="n">OutFH</span><span class="p">):</span>
  218     <span class="sd">&quot;&quot;&quot;Delete alignment reference object.&quot;&quot;&quot;</span>
  219     
  220     <span class="n">RefName</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;RefFileInfo&quot;</span><span class="p">][</span><span class="s2">&quot;PyMOLObjectName&quot;</span><span class="p">]</span>
  221     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Deleting alignment reference object </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">RefName</span><span class="p">)</span>
  222     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.delete(&quot;</span><span class="si">%s</span><span class="s2">&quot;)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">RefName</span><span class="p">)</span>
  223 
  224 <span class="k">def</span> <span class="nf">WriteComplexView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">FirstComplex</span><span class="p">):</span>
  225     <span class="sd">&quot;&quot;&quot;Write out PML for viewing polymer complex.&quot;&quot;&quot;</span>
  226 
  227     <span class="c1"># Setup complex...</span>
  228     <span class="n">Infile</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
  229     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForPolymerComplexView</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Complex&quot;</span><span class="p">],</span> <span class="n">Infile</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
  230     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Loading </span><span class="si">%s</span><span class="s2"> and setting up view for complex...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">Infile</span><span class="p">)</span>
  231     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  232 
  233     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Align&quot;</span><span class="p">]:</span>
  234         <span class="c1"># No need to align complex on to itself...</span>
  235         <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^FirstInputFile$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AlignRefFile&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="ow">and</span> <span class="n">FirstComplex</span><span class="p">):</span>
  236             <span class="n">WriteAlignComplex</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">)</span>
  237     
  238     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceComplex&quot;</span><span class="p">]:</span>
  239         <span class="c1"># Setup hydrophobic surface...</span>
  240         <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForHydrophobicSurfaceView</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexHydrophobicSurface&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Complex&quot;</span><span class="p">],</span> <span class="n">ColorPalette</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceColorPalette&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
  241         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  242     
  243     <span class="c1"># Setup complex group...</span>
  244     <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexGroupMembers&quot;</span><span class="p">],</span> <span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  245 
  246 <span class="k">def</span> <span class="nf">WriteChainView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  247     <span class="sd">&quot;&quot;&quot;Write out PML for viewing chain.&quot;&quot;&quot;</span>
  248     
  249     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Setting up views for chain </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">ChainID</span><span class="p">)</span>
  250     
  251     <span class="n">ChainComplexName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplex&quot;</span><span class="p">]</span>
  252     
  253     <span class="c1"># Setup chain complex group view...</span>
  254     <span class="n">WriteChainComplexViews</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
  255 
  256     <span class="c1"># Setup chain view...</span>
  257     <span class="n">WriteChainAloneViews</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
  258     
  259     <span class="c1"># Setup chain solvent view...</span>
  260     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForSolventView</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;Solvent&quot;</span><span class="p">],</span> <span class="n">ChainComplexName</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
  261     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  262 
  263     <span class="c1"># Setup chain inorganic view...</span>
  264     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForInorganicView</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;Inorganic&quot;</span><span class="p">],</span> <span class="n">ChainComplexName</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
  265     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  266 
  267 <span class="k">def</span> <span class="nf">WriteChainComplexViews</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  268     <span class="sd">&quot;&quot;&quot;Write chain complex views. &quot;&quot;&quot;</span>
  269     
  270     <span class="c1"># Setup chain complex...</span>
  271     <span class="n">ChainComplexName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplex&quot;</span><span class="p">]</span>
  272     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForPolymerChainComplexView</span><span class="p">(</span><span class="n">ChainComplexName</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Complex&quot;</span><span class="p">],</span> <span class="n">ChainID</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
  273     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  274 
  275     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChainComplex&quot;</span><span class="p">]:</span>
  276         <span class="c1"># Setup hydrophobic surface...</span>
  277         <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForHydrophobicSurfaceView</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexHydrophobicSurface&quot;</span><span class="p">],</span> <span class="n">ChainComplexName</span><span class="p">,</span> <span class="n">ColorPalette</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceColorPalette&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
  278         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  279     
  280     <span class="c1"># Setup chain complex group...</span>
  281     <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexGroupMembers&quot;</span><span class="p">],</span> <span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  282     
  283 <span class="k">def</span> <span class="nf">WriteChainAloneViews</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  284     <span class="sd">&quot;&quot;&quot;Write individual chain views. &quot;&quot;&quot;</span>
  285 
  286     <span class="n">ChainComplexName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplex&quot;</span><span class="p">]</span>
  287     
  288     <span class="c1"># Setup chain view...</span>
  289     <span class="n">ChainName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAlone&quot;</span><span class="p">]</span>
  290     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForPolymerChainView</span><span class="p">(</span><span class="n">ChainName</span><span class="p">,</span> <span class="n">ChainComplexName</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
  291     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  292 
  293     <span class="n">WriteChainAloneChainSelectionsView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span>  <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
  294     <span class="n">WriteChainAloneResidueTypesView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span>  <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
  295         
  296     <span class="k">if</span> <span class="n">GetChainAloneContainsSurfacesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  297         <span class="c1"># Setup a generic color surface...</span>
  298         <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForSurfaceView</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSurface&quot;</span><span class="p">],</span> <span class="n">ChainName</span><span class="p">,</span>  <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">Color</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceColor&quot;</span><span class="p">])</span>
  299         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  300         
  301         <span class="k">if</span> <span class="n">GetChainAloneSurfaceChainStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  302             <span class="c1"># Setup surface colored by hydrophobicity...</span>
  303             <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForHydrophobicSurfaceView</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneHydrophobicSurface&quot;</span><span class="p">],</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">ColorPalette</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceColorPalette&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
  304             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  305             
  306             <span class="c1"># Setup surface colored by hyrdophobicity and charge...</span>
  307             <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForHydrophobicAndChargeSurfaceView</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneHydrophobicChargeSurface&quot;</span><span class="p">],</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AtomTypesColorNames&quot;</span><span class="p">][</span><span class="s2">&quot;HydrophobicAtomsColor&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AtomTypesColorNames&quot;</span><span class="p">][</span><span class="s2">&quot;NegativelyChargedAtomsColor&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AtomTypesColorNames&quot;</span><span class="p">][</span><span class="s2">&quot;PositivelyChargedAtomsColor&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AtomTypesColorNames&quot;</span><span class="p">][</span><span class="s2">&quot;OtherAtomsColor&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">DisplayAs</span> <span class="o">=</span> <span class="bp">None</span><span class="p">)</span>
  308             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  309         
  310         <span class="k">if</span> <span class="n">GetChainAloneSurfaceChainElectrostaticsStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  311             <span class="c1"># Setup electrostatics surface...</span>
  312             <span class="n">SelectionObjectName</span> <span class="o">=</span> <span class="n">ChainName</span>
  313             <span class="n">ElectrostaticsGroupName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneElectrostaticsGroup&quot;</span><span class="p">]</span>
  314             <span class="n">ElectrostaticsGroupMembers</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneElectrostaticsGroupMembers&quot;</span><span class="p">]</span>
  315             <span class="n">WriteSurfaceElectrostaticsView</span><span class="p">(</span><span class="s2">&quot;Surface&quot;</span><span class="p">,</span> <span class="n">OutFH</span><span class="p">,</span> <span class="n">SelectionObjectName</span><span class="p">,</span> <span class="n">ElectrostaticsGroupName</span><span class="p">,</span> <span class="n">ElectrostaticsGroupMembers</span><span class="p">,</span> <span class="n">DisplayAs</span> <span class="o">=</span> <span class="s2">&quot;cartoon&quot;</span><span class="p">)</span>
  316 
  317         <span class="c1"># Setup surface group...</span>
  318         <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSurfaceGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSurfaceGroupMembers&quot;</span><span class="p">],</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;open&quot;</span><span class="p">)</span>
  319 
  320     <span class="c1"># Setup chain group...</span>
  321     <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneGroupMembers&quot;</span><span class="p">],</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  322     
  323 <span class="k">def</span> <span class="nf">WriteChainLigandView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">):</span>
  324     <span class="sd">&quot;&quot;&quot;Write out PML for viewing ligand in a chain.&quot;&quot;&quot;</span>
  325     
  326     <span class="k">for</span> <span class="n">GroupID</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Ligand&quot;</span><span class="p">,</span> <span class="s2">&quot;Pocket&quot;</span><span class="p">,</span> <span class="s2">&quot;PocketSolvent&quot;</span><span class="p">,</span> <span class="s2">&quot;PocketInorganic&quot;</span><span class="p">]:</span>
  327         <span class="n">ComplexName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplex&quot;</span><span class="p">]</span>
  328         <span class="n">LigandName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="s2">&quot;Ligand&quot;</span><span class="p">]</span>
  329         
  330         <span class="c1"># Setup main object...</span>
  331         <span class="n">GroupTypeObjectID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  332         <span class="n">GroupTypeObjectName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupTypeObjectID</span><span class="p">]</span>
  333         
  334         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Ligand$&quot;</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  335             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Setting up views for ligand </span><span class="si">%s</span><span class="s2"> in chain </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">LigandID</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">))</span>
  336             <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForLigandView</span><span class="p">(</span><span class="n">GroupTypeObjectName</span><span class="p">,</span> <span class="n">ComplexName</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
  337             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  338         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Pocket$&quot;</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  339             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Setting up views for pocket around ligand </span><span class="si">%s</span><span class="s2"> in chain </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">LigandID</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">))</span>
  340             <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForLigandPocketView</span><span class="p">(</span><span class="n">GroupTypeObjectName</span><span class="p">,</span> <span class="n">ComplexName</span><span class="p">,</span> <span class="n">LigandName</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketDistanceCutoff&quot;</span><span class="p">],</span> <span class="bp">True</span><span class="p">)</span>
  341             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  342             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;label_color&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketLabelColor&quot;</span><span class="p">],</span> <span class="n">GroupTypeObjectName</span><span class="p">))</span>
  343         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^PocketSolvent$&quot;</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  344             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Setting up views for solvent in pockect around ligand </span><span class="si">%s</span><span class="s2"> in chain </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">LigandID</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">))</span>
  345             <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForLigandPocketSolventView</span><span class="p">(</span><span class="n">GroupTypeObjectName</span><span class="p">,</span> <span class="n">ComplexName</span><span class="p">,</span> <span class="n">LigandName</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketDistanceCutoff&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
  346             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  347         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^PocketInorganic$&quot;</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  348             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Setting up views for inorganic in pockect around ligand </span><span class="si">%s</span><span class="s2"> in chain </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">LigandID</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">))</span>
  349             <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForLigandPocketInorganicView</span><span class="p">(</span><span class="n">GroupTypeObjectName</span><span class="p">,</span> <span class="n">ComplexName</span><span class="p">,</span> <span class="n">LigandName</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketDistanceCutoff&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
  350             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  351         
  352         <span class="c1"># Set up polar contacts...</span>
  353         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(Pocket|PocketSolvent|PocketInorganic)$&quot;</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  354             <span class="n">PolarContactsID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">PolarContacts&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  355             <span class="n">PolarContactsName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">PolarContactsID</span><span class="p">]</span>
  356             
  357             <span class="n">PolarContactsColor</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketContactsLigandColor&quot;</span><span class="p">]</span>
  358             <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^PocketSolvent$&quot;</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  359                 <span class="n">PolarContactsColor</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketContactsSolventColor&quot;</span><span class="p">]</span>
  360             <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^PocketInorganic$&quot;</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  361                 <span class="n">PolarContactsColor</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketContactsInorganicColor&quot;</span><span class="p">]</span>
  362 
  363             <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForPolarContactsView</span><span class="p">(</span><span class="n">PolarContactsName</span><span class="p">,</span> <span class="n">LigandName</span><span class="p">,</span> <span class="n">GroupTypeObjectName</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">Color</span> <span class="o">=</span> <span class="n">PolarContactsColor</span><span class="p">,</span> <span class="n">Cutoff</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketContactsCutoff&quot;</span><span class="p">])</span>
  364             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  365             
  366             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;label_color&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">PolarContactsColor</span><span class="p">,</span> <span class="n">PolarContactsName</span><span class="p">))</span>
  367             
  368         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Pocket$&quot;</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  369             <span class="c1"># Setup hydrophobic contacts...</span>
  370             <span class="n">HydrophobicContactsID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">HydrophobicContacts&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  371             <span class="n">HydrophobicContactsName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">HydrophobicContactsID</span><span class="p">]</span>
  372             <span class="n">HydrophobicContactsColor</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketContactsLigandHydrophobicColor&quot;</span><span class="p">]</span>
  373             
  374             <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForHydrophobicContactsView</span><span class="p">(</span><span class="n">HydrophobicContactsName</span><span class="p">,</span> <span class="n">LigandName</span><span class="p">,</span> <span class="n">GroupTypeObjectName</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">Color</span> <span class="o">=</span> <span class="n">HydrophobicContactsColor</span><span class="p">,</span> <span class="n">Cutoff</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketContactsCutoff&quot;</span><span class="p">])</span>
  375             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  376             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;label_color&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">HydrophobicContactsColor</span><span class="p">,</span> <span class="n">HydrophobicContactsName</span><span class="p">))</span>
  377 
  378             <span class="c1"># Setup pocket residues...</span>
  379             <span class="n">WritePocketResidueTypesView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span>  <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">,</span> <span class="n">GroupTypeObjectID</span><span class="p">)</span>
  380             <span class="n">WritePocketSurfacesTypesView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span>  <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">,</span> <span class="n">GroupTypeObjectID</span><span class="p">)</span>
  381         
  382         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Ligand$&quot;</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  383             <span class="c1"># Setup ball and stick view...</span>
  384             <span class="n">BallAndStickNameID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">BallAndStick&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  385             <span class="n">BallAndStickName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">BallAndStickNameID</span><span class="p">]</span>
  386             <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForBallAndStickView</span><span class="p">(</span><span class="n">BallAndStickName</span><span class="p">,</span> <span class="n">GroupTypeObjectName</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
  387             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  388             
  389         <span class="c1"># Setup group...</span>
  390         <span class="n">GroupNameID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  391         <span class="n">GroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">GroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  392         <span class="n">GroupName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupNameID</span><span class="p">]</span>
  393         <span class="n">GroupMembers</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupMembersID</span><span class="p">]</span>
  394 
  395         <span class="n">Action</span> <span class="o">=</span> <span class="s2">&quot;close&quot;</span>
  396         <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span>
  397         <span class="k">if</span>  <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(Ligand|Pocket)$&quot;</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  398             <span class="n">Action</span> <span class="o">=</span> <span class="s2">&quot;open&quot;</span>
  399             <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span>
  400         <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">GroupName</span><span class="p">,</span> <span class="n">GroupMembers</span><span class="p">,</span> <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span><span class="p">)</span>
  401 
  402 <span class="k">def</span> <span class="nf">WritePocketSurfacesTypesView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span>  <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">,</span> <span class="n">PocketObjectID</span><span class="p">):</span>
  403     <span class="sd">&quot;&quot;&quot;Write out PML for viewing surfaces for a ligand pocket.&quot;&quot;&quot;</span>
  404 
  405     <span class="k">if</span> <span class="ow">not</span> <span class="n">GetPocketContainsSurfaceStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">):</span>
  406         <span class="k">return</span>
  407     
  408     <span class="n">PocketObjectName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">PocketObjectID</span><span class="p">]</span>
  409     
  410     <span class="n">SurfacesGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">SurfacesGroup&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">PocketObjectID</span><span class="p">)</span>
  411     <span class="n">SurfacesGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">SurfacesGroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">PocketObjectID</span><span class="p">)</span>
  412 
  413     <span class="c1"># Cavity modes: 1 or 2.  1: Cavity surfaces; 2: Culled cavity surfaces...</span>
  414     <span class="n">CavityMode</span> <span class="o">=</span> <span class="mi">2</span>
  415     
  416     <span class="c1"># Setup surfaces subgroup and its members...</span>
  417     <span class="k">for</span> <span class="n">SubGroupType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Surface&quot;</span><span class="p">,</span> <span class="s2">&quot;Cavity&quot;</span><span class="p">]:</span>
  418         <span class="n">ProcessingCavity</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Cavity$&quot;</span><span class="p">,</span> <span class="n">SubGroupType</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
  419         
  420         <span class="n">SubGroupID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">SubGroupType</span><span class="p">)</span>
  421         <span class="n">SurfacesSubGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfacesGroupID</span><span class="p">,</span> <span class="n">SubGroupID</span><span class="p">)</span>
  422         <span class="n">SurfacesSubGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Members&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfacesSubGroupID</span><span class="p">)</span>
  423 
  424         <span class="c1"># Turn off lines display for cavity surfaces...</span>
  425         <span class="n">DisplayStyle</span> <span class="o">=</span> <span class="bp">None</span> <span class="k">if</span> <span class="n">ProcessingCavity</span> <span class="k">else</span> <span class="s2">&quot;lines&quot;</span>
  426 
  427         <span class="c1"># Setup a generic color surface...</span>
  428         <span class="n">SurfaceID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Surface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfacesSubGroupID</span><span class="p">)</span>
  429         <span class="n">SurfaceName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">SurfaceID</span><span class="p">]</span>
  430         <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForSurfaceView</span><span class="p">(</span><span class="n">SurfaceName</span><span class="p">,</span> <span class="n">PocketObjectName</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">Color</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceColor&quot;</span><span class="p">],</span> <span class="n">DisplayAs</span> <span class="o">=</span> <span class="n">DisplayStyle</span><span class="p">)</span>
  431         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  432         
  433         <span class="k">if</span> <span class="n">ProcessingCavity</span><span class="p">:</span>
  434             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;surface_cavity_mode&quot;, </span><span class="si">%d</span><span class="s2">, &quot;</span><span class="si">%s</span><span class="s2">&quot;)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">CavityMode</span><span class="p">,</span> <span class="n">SurfaceName</span><span class="p">))</span>
  435         
  436         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;label_color&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketLabelColor&quot;</span><span class="p">],</span> <span class="n">SurfaceName</span><span class="p">))</span>
  437         
  438         <span class="k">if</span> <span class="n">GetPocketSurfaceChainStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">):</span>
  439             <span class="c1"># Setup a surface colored by hydrphobicity...</span>
  440             <span class="n">HydrophobicSurfaceID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">HydrophobicSurface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfacesSubGroupID</span><span class="p">)</span>
  441             <span class="n">HydrophobicSurfaceName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">HydrophobicSurfaceID</span><span class="p">]</span>
  442             <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForHydrophobicSurfaceView</span><span class="p">(</span><span class="n">HydrophobicSurfaceName</span><span class="p">,</span> <span class="n">PocketObjectName</span><span class="p">,</span> <span class="n">ColorPalette</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceColorPalette&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">DisplayAs</span> <span class="o">=</span> <span class="n">DisplayStyle</span><span class="p">)</span>
  443             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  444             
  445             <span class="k">if</span> <span class="n">ProcessingCavity</span><span class="p">:</span>
  446                 <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;surface_cavity_mode&quot;, </span><span class="si">%d</span><span class="s2">, &quot;</span><span class="si">%s</span><span class="s2">&quot;)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">CavityMode</span><span class="p">,</span> <span class="n">HydrophobicSurfaceName</span><span class="p">))</span>
  447             
  448             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;label_color&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketLabelColor&quot;</span><span class="p">],</span> <span class="n">HydrophobicSurfaceName</span><span class="p">))</span>
  449             
  450             <span class="c1"># Setup a surface colored by hydrphobicity and charge...</span>
  451             <span class="n">HydrophobicChargeSurfaceID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">HydrophobicChargeSurface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfacesSubGroupID</span><span class="p">)</span>
  452             <span class="n">HydrophobicChargeSurfaceName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">HydrophobicChargeSurfaceID</span><span class="p">]</span>
  453             <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForHydrophobicAndChargeSurfaceView</span><span class="p">(</span><span class="n">HydrophobicChargeSurfaceName</span><span class="p">,</span> <span class="n">PocketObjectName</span><span class="p">,</span>  <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AtomTypesColorNames&quot;</span><span class="p">][</span><span class="s2">&quot;HydrophobicAtomsColor&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AtomTypesColorNames&quot;</span><span class="p">][</span><span class="s2">&quot;NegativelyChargedAtomsColor&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AtomTypesColorNames&quot;</span><span class="p">][</span><span class="s2">&quot;PositivelyChargedAtomsColor&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AtomTypesColorNames&quot;</span><span class="p">][</span><span class="s2">&quot;OtherAtomsColor&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">DisplayAs</span> <span class="o">=</span> <span class="n">DisplayStyle</span><span class="p">)</span>
  454             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  455             
  456             <span class="k">if</span> <span class="n">ProcessingCavity</span><span class="p">:</span>
  457                 <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;surface_cavity_mode&quot;, </span><span class="si">%d</span><span class="s2">, &quot;</span><span class="si">%s</span><span class="s2">&quot;)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">CavityMode</span><span class="p">,</span> <span class="n">HydrophobicChargeSurfaceName</span><span class="p">))</span>
  458             
  459             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;label_color&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketLabelColor&quot;</span><span class="p">],</span> <span class="n">HydrophobicChargeSurfaceName</span><span class="p">))</span>
  460             
  461             <span class="k">if</span> <span class="n">GetPocketSurfaceChainElectrostaticsStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">):</span>
  462                 <span class="c1"># Set up a electrostatics surface...</span>
  463                 <span class="n">ElectrostaticsGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">ElectrostaticsGroup&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfacesSubGroupID</span><span class="p">)</span>
  464                 <span class="n">ElectrostaticsGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">ElectrostaticsGroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfacesSubGroupID</span><span class="p">)</span>
  465                 <span class="n">ElectrostaticsGroupName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">ElectrostaticsGroupID</span><span class="p">]</span>
  466                 <span class="n">ElectrostaticsGroupMembers</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">ElectrostaticsGroupMembersID</span><span class="p">]</span>
  467                 <span class="n">WriteSurfaceElectrostaticsView</span><span class="p">(</span><span class="n">SubGroupType</span><span class="p">,</span> <span class="n">OutFH</span><span class="p">,</span> <span class="n">PocketObjectName</span><span class="p">,</span> <span class="n">ElectrostaticsGroupName</span><span class="p">,</span> <span class="n">ElectrostaticsGroupMembers</span><span class="p">,</span> <span class="n">DisplayAs</span> <span class="o">=</span> <span class="n">DisplayStyle</span><span class="p">,</span> <span class="n">SurfaceCavityMode</span> <span class="o">=</span> <span class="n">CavityMode</span><span class="p">)</span>
  468                 
  469             <span class="c1"># Setup surfaces sub group...</span>
  470             <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">SurfacesSubGroupID</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">SurfacesSubGroupMembersID</span><span class="p">],</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;open&quot;</span><span class="p">)</span>
  471         
  472     <span class="c1"># Setup surface group...</span>
  473     <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">SurfacesGroupID</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">SurfacesGroupMembersID</span><span class="p">],</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;open&quot;</span><span class="p">)</span>
  474     
  475     
  476 <span class="k">def</span> <span class="nf">WritePocketResidueTypesView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span>  <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">,</span> <span class="n">PocketObjectID</span><span class="p">):</span>
  477     <span class="sd">&quot;&quot;&quot;Write out PML for viewing residue types for a ligand pocket.&quot;&quot;&quot;</span>
  478     
  479     <span class="k">if</span> <span class="ow">not</span> <span class="n">GetPocketResidueTypesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">):</span>
  480         <span class="k">return</span>
  481 
  482     <span class="n">PocketObjectName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">PocketObjectID</span><span class="p">]</span>
  483     
  484     <span class="n">ResiduesGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">ResiduesGroup&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">PocketObjectID</span><span class="p">)</span>
  485     <span class="n">ResiduesGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Members&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupID</span><span class="p">)</span>
  486     
  487     <span class="c1"># Setup residue types objects...</span>
  488     <span class="k">for</span> <span class="n">SubGroupType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Aromatic&quot;</span><span class="p">,</span> <span class="s2">&quot;Hydrophobic&quot;</span><span class="p">,</span> <span class="s2">&quot;Polar&quot;</span><span class="p">,</span> <span class="s2">&quot;Positively_Charged&quot;</span><span class="p">,</span> <span class="s2">&quot;Negatively_Charged&quot;</span><span class="p">,</span> <span class="s2">&quot;Other&quot;</span><span class="p">]:</span>
  489         <span class="n">SubGroupID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">SubGroupType</span><span class="p">)</span>
  490         
  491         <span class="n">ResiduesSubGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupID</span><span class="p">,</span> <span class="n">SubGroupID</span><span class="p">)</span>
  492         <span class="n">ResiduesSubMembersGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Members&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesSubGroupID</span><span class="p">)</span>
  493     
  494         <span class="n">SubGroupMemberID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Residues&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesSubGroupID</span><span class="p">)</span>
  495         <span class="n">ResiduesObjectName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">SubGroupMemberID</span><span class="p">]</span>
  496 
  497         <span class="n">SubGroupMemberID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Surface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesSubGroupID</span><span class="p">)</span>
  498         <span class="n">ResiduesSurfaceObjectName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">SubGroupMemberID</span><span class="p">]</span>
  499 
  500         <span class="n">ResiduesColor</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesParams&quot;</span><span class="p">][</span><span class="n">SubGroupType</span><span class="p">][</span><span class="s2">&quot;Color&quot;</span><span class="p">]</span> 
  501         <span class="n">ResiduesNames</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesParams&quot;</span><span class="p">][</span><span class="n">SubGroupType</span><span class="p">][</span><span class="s2">&quot;Residues&quot;</span><span class="p">]</span>
  502 
  503         <span class="n">NegateResidueNames</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Other$&quot;</span><span class="p">,</span> <span class="n">SubGroupType</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
  504         <span class="n">WriteResidueTypesResiduesAndSurfaceView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PocketObjectName</span><span class="p">,</span> <span class="n">ResiduesObjectName</span><span class="p">,</span> <span class="n">ResiduesSurfaceObjectName</span><span class="p">,</span> <span class="n">ResiduesColor</span><span class="p">,</span> <span class="n">ResiduesNames</span><span class="p">,</span> <span class="n">NegateResidueNames</span><span class="p">)</span>
  505         
  506         <span class="c1"># Setup residue type sub groups...</span>
  507         <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">ResiduesSubGroupID</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">ResiduesSubMembersGroupID</span><span class="p">],</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  508     
  509     <span class="c1"># Setup residue types group...</span>
  510     <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">ResiduesGroupID</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">ResiduesGroupMembersID</span><span class="p">],</span> <span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  511 
  512 <span class="k">def</span> <span class="nf">WriteChainAloneChainSelectionsView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span>  <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  513     <span class="sd">&quot;&quot;&quot;Write out PML for viewing selections for a chain. &quot;&quot;&quot;</span>
  514 
  515     <span class="k">if</span> <span class="ow">not</span> <span class="n">GetChainAloneContainsSelectionsStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  516         <span class="k">return</span>
  517     
  518     <span class="n">ChainName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAlone&quot;</span><span class="p">]</span>
  519     <span class="n">SelectionsGroupIDPrefix</span> <span class="o">=</span> <span class="s2">&quot;ChainAloneSelections&quot;</span>
  520     
  521     <span class="k">for</span> <span class="n">Index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ChainSelectionsInfo&quot;</span><span class="p">][</span><span class="s2">&quot;Names&quot;</span><span class="p">])):</span>
  522         <span class="n">SelectionName</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ChainSelectionsInfo&quot;</span><span class="p">][</span><span class="s2">&quot;Names&quot;</span><span class="p">][</span><span class="n">Index</span><span class="p">]</span>
  523         <span class="n">Selection</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ChainSelectionsInfo&quot;</span><span class="p">][</span><span class="s2">&quot;Selections&quot;</span><span class="p">][</span><span class="n">Index</span><span class="p">]</span>
  524         
  525         <span class="n">SelectionNameGroupID</span> <span class="o">=</span> <span class="n">SelectionName</span>
  526         
  527         <span class="c1"># Setup a selection object...</span>
  528         <span class="n">SelectionObjectID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Selection&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
  529         <span class="n">SelectionObjectName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SelectionObjectID</span><span class="p">]</span>
  530         <span class="n">SelectionCmd</span> <span class="o">=</span> <span class="s2">&quot;(</span><span class="si">%s</span><span class="s2"> and (</span><span class="si">%s</span><span class="s2">))&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainName</span><span class="p">,</span> <span class="n">Selection</span><span class="p">)</span>
  531         <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForSelectionDisplayView</span><span class="p">(</span><span class="n">SelectionObjectName</span><span class="p">,</span> <span class="n">SelectionCmd</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SelectionsChainStyle&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
  532         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  533         
  534         <span class="k">if</span> <span class="n">GetChainAloneContainsChainSelectionSurfacesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  535             <span class="c1"># Display style for selection objects in surfaces...</span>
  536             <span class="n">DisplayStyle</span> <span class="o">=</span> <span class="s2">&quot;lines&quot;</span>
  537             
  538             <span class="c1"># Setup a generic color surface...</span>
  539             <span class="n">SurfaceID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s%s</span><span class="s2">Surface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">,</span> <span class="s2">&quot;Surface&quot;</span><span class="p">)</span>
  540             <span class="n">SurfaceName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SurfaceID</span><span class="p">]</span>
  541             <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForSurfaceView</span><span class="p">(</span><span class="n">SurfaceName</span><span class="p">,</span> <span class="n">SelectionObjectName</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">Color</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceColor&quot;</span><span class="p">],</span> <span class="n">DisplayAs</span> <span class="o">=</span> <span class="n">DisplayStyle</span><span class="p">)</span>
  542             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  543             
  544             <span class="k">if</span> <span class="n">GetChainAloneSurfaceChainSelectionStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  545                 <span class="c1"># Setup a surface colored by hydrphobicity...</span>
  546                 <span class="n">HydrophobicSurfaceID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">SurfaceHydrophobicity&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
  547                 <span class="n">HydrophobicSurfaceName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">HydrophobicSurfaceID</span><span class="p">]</span>
  548                 <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForHydrophobicSurfaceView</span><span class="p">(</span><span class="n">HydrophobicSurfaceName</span><span class="p">,</span> <span class="n">SelectionObjectName</span><span class="p">,</span> <span class="n">ColorPalette</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceColorPalette&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">DisplayAs</span> <span class="o">=</span> <span class="n">DisplayStyle</span><span class="p">)</span>
  549                 <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  550                 
  551                 <span class="c1"># Setup a surface colored by hydrphobicity and charge...</span>
  552                 <span class="n">HydrophobicChargeSurfaceID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">SurfaceHydrophobicityCharge&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
  553                 <span class="n">HydrophobicChargeSurfaceName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">HydrophobicChargeSurfaceID</span><span class="p">]</span>
  554                 <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForHydrophobicAndChargeSurfaceView</span><span class="p">(</span><span class="n">HydrophobicChargeSurfaceName</span><span class="p">,</span> <span class="n">SelectionObjectName</span><span class="p">,</span>  <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AtomTypesColorNames&quot;</span><span class="p">][</span><span class="s2">&quot;HydrophobicAtomsColor&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AtomTypesColorNames&quot;</span><span class="p">][</span><span class="s2">&quot;NegativelyChargedAtomsColor&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AtomTypesColorNames&quot;</span><span class="p">][</span><span class="s2">&quot;PositivelyChargedAtomsColor&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AtomTypesColorNames&quot;</span><span class="p">][</span><span class="s2">&quot;OtherAtomsColor&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">DisplayAs</span> <span class="o">=</span> <span class="n">DisplayStyle</span><span class="p">)</span>
  555                 <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  556 
  557             <span class="c1"># Setup group for surfaces...</span>
  558             <span class="n">SurfaceGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">SurfaceGroup&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
  559             <span class="n">SurfaceGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">SurfaceGroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
  560             <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SurfaceGroupID</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SurfaceGroupMembersID</span><span class="p">],</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  561 
  562         <span class="c1"># Setup groups for named selections...</span>
  563         <span class="n">SelectionsNameGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
  564         <span class="n">SelectionsNameGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">GroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
  565         <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SelectionsNameGroupID</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SelectionsNameGroupMembersID</span><span class="p">],</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;open&quot;</span><span class="p">)</span>
  566 
  567     <span class="c1"># Setup a group for selections...</span>
  568     <span class="n">SelectionsGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">)</span>
  569     <span class="n">SelectionsGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">GroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">)</span>
  570     <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SelectionsGroupID</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SelectionsGroupMembersID</span><span class="p">],</span> <span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  571     
  572 <span class="k">def</span> <span class="nf">WriteChainAloneResidueTypesView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span>  <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  573     <span class="sd">&quot;&quot;&quot;Write out PML for viewing residue types for a chain. &quot;&quot;&quot;</span>
  574 
  575     <span class="k">if</span> <span class="ow">not</span> <span class="n">GetChainAloneResidueTypesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  576         <span class="k">return</span>
  577     
  578     <span class="n">ChainName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAlone&quot;</span><span class="p">]</span>
  579     
  580     <span class="c1"># Setup residue types objects...</span>
  581     <span class="n">ResiduesGroupIDPrefix</span> <span class="o">=</span> <span class="s2">&quot;ChainAloneResidues&quot;</span>
  582     <span class="k">for</span> <span class="n">SubGroupType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Aromatic&quot;</span><span class="p">,</span> <span class="s2">&quot;Hydrophobic&quot;</span><span class="p">,</span> <span class="s2">&quot;Polar&quot;</span><span class="p">,</span> <span class="s2">&quot;Positively_Charged&quot;</span><span class="p">,</span> <span class="s2">&quot;Negatively_Charged&quot;</span><span class="p">,</span> <span class="s2">&quot;Other&quot;</span><span class="p">]:</span>
  583         <span class="n">SubGroupID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">SubGroupType</span><span class="p">)</span>
  584 
  585         <span class="n">ResiduesObjectID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Residues&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupIDPrefix</span><span class="p">,</span> <span class="n">SubGroupID</span><span class="p">)</span>
  586         <span class="n">ResiduesObjectName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesObjectID</span><span class="p">]</span>
  587 
  588         <span class="n">ResiduesSurfaceObjectID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Surface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupIDPrefix</span><span class="p">,</span> <span class="n">SubGroupID</span><span class="p">)</span>
  589         <span class="n">ResiduesSurfaceObjectName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesSurfaceObjectID</span><span class="p">]</span>
  590 
  591         <span class="n">ResiduesColor</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesParams&quot;</span><span class="p">][</span><span class="n">SubGroupType</span><span class="p">][</span><span class="s2">&quot;Color&quot;</span><span class="p">]</span> 
  592         <span class="n">ResiduesNames</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesParams&quot;</span><span class="p">][</span><span class="n">SubGroupType</span><span class="p">][</span><span class="s2">&quot;Residues&quot;</span><span class="p">]</span>
  593 
  594         <span class="n">NegateResidueNames</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Other$&quot;</span><span class="p">,</span> <span class="n">SubGroupType</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
  595         <span class="n">WriteResidueTypesResiduesAndSurfaceView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">ResiduesObjectName</span><span class="p">,</span> <span class="n">ResiduesSurfaceObjectName</span><span class="p">,</span> <span class="n">ResiduesColor</span><span class="p">,</span> <span class="n">ResiduesNames</span><span class="p">,</span> <span class="n">NegateResidueNames</span><span class="p">)</span>
  596 
  597         <span class="c1"># Setup sub groups for residue types..</span>
  598         <span class="n">ResiduesSubGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupIDPrefix</span><span class="p">,</span> <span class="n">SubGroupID</span><span class="p">)</span>
  599         <span class="n">ResiduesSubGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">GroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupIDPrefix</span><span class="p">,</span> <span class="n">SubGroupID</span><span class="p">)</span>
  600 
  601         <span class="c1"># Setup residue type sub groups...</span>
  602         <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesSubGroupID</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesSubGroupMembersID</span><span class="p">],</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  603         
  604     <span class="c1"># Setup residue types group...</span>
  605     <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneResiduesGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneResiduesGroupMembers&quot;</span><span class="p">],</span> <span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  606 
  607 <span class="k">def</span> <span class="nf">WriteResidueTypesResiduesAndSurfaceView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">SelectionObjectName</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">SurfaceName</span><span class="p">,</span> <span class="n">ResiduesColor</span><span class="p">,</span> <span class="n">ResiduesNames</span><span class="p">,</span> <span class="n">NegateResidueNames</span><span class="p">):</span>
  608     <span class="sd">&quot;&quot;&quot;Write residue types residues and surface view. &quot;&quot;&quot;</span>
  609 
  610     <span class="n">ResidueNamesSelection</span> <span class="o">=</span> <span class="s2">&quot;+&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ResiduesNames</span><span class="p">)</span>
  611     <span class="k">if</span> <span class="n">NegateResidueNames</span><span class="p">:</span>
  612         <span class="n">Selection</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> and (not resn </span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionObjectName</span><span class="p">,</span> <span class="n">ResidueNamesSelection</span><span class="p">)</span>
  613     <span class="k">else</span><span class="p">:</span>
  614         <span class="n">Selection</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> and (resn </span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionObjectName</span><span class="p">,</span> <span class="n">ResidueNamesSelection</span><span class="p">)</span>
  615 
  616     <span class="c1"># Setup residues...</span>
  617     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForSelectionDisplayView</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="s2">&quot;lines&quot;</span><span class="p">,</span> <span class="n">ResiduesColor</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
  618     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  619 
  620     <span class="c1"># Setup surface...</span>
  621     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForSelectionDisplayView</span><span class="p">(</span><span class="n">SurfaceName</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="s2">&quot;surface&quot;</span><span class="p">,</span> <span class="n">ResiduesColor</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
  622     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  623     
  624 <span class="k">def</span> <span class="nf">WriteSurfaceElectrostaticsView</span><span class="p">(</span><span class="n">Mode</span><span class="p">,</span> <span class="n">OutFH</span><span class="p">,</span> <span class="n">SelectionObjectName</span><span class="p">,</span> <span class="n">ElectrostaticsGroupName</span><span class="p">,</span> <span class="n">ElectrostaticsGroupMembers</span><span class="p">,</span> <span class="n">DisplayAs</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">SurfaceCavityMode</span> <span class="o">=</span> <span class="mi">2</span><span class="p">):</span>
  625     <span class="sd">&quot;&quot;&quot;Write out PML for viewing surface electrostatics. &quot;&quot;&quot;</span>
  626 
  627     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ElectrostaticsGroupMembers</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
  628         <span class="n">Name</span><span class="p">,</span> <span class="n">ContactPotentialName</span><span class="p">,</span> <span class="n">MapName</span><span class="p">,</span> <span class="n">LegendName</span><span class="p">,</span> <span class="n">VolumeName</span> <span class="o">=</span> <span class="n">ElectrostaticsGroupMembers</span>
  629     <span class="k">else</span><span class="p">:</span>
  630         <span class="n">Name</span><span class="p">,</span> <span class="n">ContactPotentialName</span><span class="p">,</span> <span class="n">MapName</span><span class="p">,</span> <span class="n">LegendName</span> <span class="o">=</span> <span class="n">ElectrostaticsGroupMembers</span>
  631         <span class="n">VolumeName</span> <span class="o">=</span> <span class="bp">None</span>
  632 
  633     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
  634 
  635     <span class="c1"># Setup chain...</span>
  636     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.create(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;(</span><span class="si">%s</span><span class="s2">)&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">SelectionObjectName</span><span class="p">))</span>
  637 
  638     <span class="c1"># Setup vacuum electrostatics surface along with associated objects...</span>
  639     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;util.protein_vacuum_esp(&quot;</span><span class="si">%s</span><span class="s2">&quot;, mode=2, quiet=0, _self=cmd)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
  640     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set_name(&quot;</span><span class="si">%s</span><span class="s2">_e_chg&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">ContactPotentialName</span><span class="p">))</span>
  641     
  642     <span class="k">if</span> <span class="n">DisplayAs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
  643         <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.show(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;(</span><span class="si">%s</span><span class="s2">)&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">DisplayAs</span><span class="p">,</span> <span class="n">ContactPotentialName</span><span class="p">))</span>
  644 
  645     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Cavity$&quot;</span><span class="p">,</span> <span class="n">Mode</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  646         <span class="k">if</span> <span class="n">SurfaceCavityMode</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
  647             <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;surface_cavity_mode&quot;, </span><span class="si">%d</span><span class="s2">, &quot;</span><span class="si">%s</span><span class="s2">&quot;)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfaceCavityMode</span><span class="p">,</span> <span class="n">ContactPotentialName</span><span class="p">))</span>
  648         
  649     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">ContactPotentialName</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">))</span>
  650     
  651     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set_name(&quot;</span><span class="si">%s</span><span class="s2">_e_map&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">MapName</span><span class="p">))</span>
  652     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">MapName</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">))</span>
  653     
  654     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set_name(&quot;</span><span class="si">%s</span><span class="s2">_e_pot&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">LegendName</span><span class="p">))</span>
  655     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">LegendName</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">))</span>
  656 
  657     <span class="k">if</span> <span class="n">VolumeName</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
  658         <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.volume(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;(</span><span class="si">%s</span><span class="s2">)&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">VolumeName</span><span class="p">,</span> <span class="n">MapName</span><span class="p">,</span> <span class="s2">&quot;esp&quot;</span><span class="p">,</span> <span class="n">Name</span><span class="p">))</span>
  659         <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">VolumeName</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">))</span>
  660     
  661     <span class="c1"># Delete name and take it out from the group membership. It is</span>
  662     <span class="c1"># is already part of ContactPotential object.</span>
  663     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.delete(&quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
  664     <span class="n">ElectrostaticsGroupMembers</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
  665     
  666     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
  667     
  668     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  669     
  670     <span class="c1"># Setup group...</span>
  671     <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">ElectrostaticsGroupName</span><span class="p">,</span> <span class="n">ElectrostaticsGroupMembers</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  672 
  673 <span class="k">def</span> <span class="nf">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">GroupName</span><span class="p">,</span> <span class="n">GroupMembers</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">Action</span> <span class="o">=</span> <span class="s2">&quot;close&quot;</span><span class="p">):</span>
  674     <span class="sd">&quot;&quot;&quot;Generate and write PML for group. &quot;&quot;&quot;</span>
  675     
  676     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForGroup</span><span class="p">(</span><span class="n">GroupName</span><span class="p">,</span> <span class="n">GroupMembers</span><span class="p">,</span> <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span><span class="p">)</span>
  677     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Setting up group </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">GroupName</span><span class="p">)</span>
  678     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  679 
  680 <span class="k">def</span> <span class="nf">GeneratePyMOLSessionFile</span><span class="p">():</span>
  681     <span class="sd">&quot;&quot;&quot;Generate PME file from PML file. &quot;&quot;&quot;</span>
  682 
  683     <span class="n">PSEOutfile</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PSEOutfile&quot;</span><span class="p">]</span>
  684     <span class="n">PMLOutfile</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMLOutfile&quot;</span><span class="p">]</span>
  685     
  686     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Generating file </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">PSEOutfile</span><span class="p">)</span>
  687     
  688     <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">ConvertPMLFileToPSEFile</span><span class="p">(</span><span class="n">PMLOutfile</span><span class="p">,</span> <span class="n">PSEOutfile</span><span class="p">)</span>
  689     
  690     <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">PSEOutfile</span><span class="p">):</span>
  691         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;Failed to generate PSE file, </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">PSEOutfile</span><span class="p">))</span>
  692     
  693     <span class="k">if</span> <span class="ow">not</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMLOut&quot;</span><span class="p">]:</span>
  694         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Deleting file </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">PMLOutfile</span><span class="p">)</span>
  695         <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">PMLOutfile</span><span class="p">)</span>
  696 
  697 <span class="k">def</span> <span class="nf">DeleteEmptyPyMOLObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">):</span>
  698     <span class="sd">&quot;&quot;&quot;Delete empty PyMOL objects. &quot;&quot;&quot;</span>
  699     
  700     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AllowEmptyObjects&quot;</span><span class="p">]:</span>
  701         <span class="k">return</span>
  702     
  703     <span class="n">SpecifiedChainsAndLigandsInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
  704     <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]:</span>
  705         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Checking and deleting empty objects for chain </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainID</span><span class="p">))</span>
  706         
  707         <span class="c1"># Delete any chain level objects...</span>
  708         <span class="n">WritePMLToCheckAndDeleteEmptyObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;Solvent&quot;</span><span class="p">])</span>
  709         <span class="n">WritePMLToCheckAndDeleteEmptyObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;Inorganic&quot;</span><span class="p">])</span>
  710 
  711         <span class="c1"># Delete chain selection objects...</span>
  712         <span class="n">DeleteEmptyChainSelectionsObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
  713         
  714         <span class="c1"># Delete residue type objects...</span>
  715         <span class="n">DeleteEmptyChainResidueTypesObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
  716         
  717         <span class="k">for</span> <span class="n">LigandID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]:</span>
  718             <span class="c1"># Delete ligand level objects...</span>
  719             <span class="k">for</span> <span class="n">GroupID</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Pocket&quot;</span><span class="p">,</span> <span class="s2">&quot;PocketSolvent&quot;</span><span class="p">,</span> <span class="s2">&quot;PocketInorganic&quot;</span><span class="p">]:</span>
  720                 <span class="n">GroupNameID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  721                 <span class="n">GroupName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupNameID</span><span class="p">]</span>
  722 
  723                 <span class="n">GroupTypeObjectID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  724                 <span class="n">GroupTypeObjectName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupTypeObjectID</span><span class="p">]</span>
  725                 
  726                 <span class="n">WritePMLToCheckAndDeleteEmptyObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">GroupTypeObjectName</span><span class="p">,</span> <span class="n">GroupName</span><span class="p">)</span>
  727                 
  728                 <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Pocket$&quot;</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  729                     <span class="n">DeleteEmptyPocketResidueTypesObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">,</span> <span class="n">GroupTypeObjectID</span><span class="p">)</span>
  730 
  731 <span class="k">def</span> <span class="nf">DeleteEmptyChainSelectionsObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  732     <span class="sd">&quot;&quot;&quot;Delete empty chain selection objects. &quot;&quot;&quot;</span>
  733 
  734     <span class="k">if</span> <span class="ow">not</span> <span class="n">GetChainAloneContainsSelectionsStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  735         <span class="k">return</span>
  736     
  737     <span class="n">SelectionsGroupIDPrefix</span> <span class="o">=</span> <span class="s2">&quot;ChainAloneSelections&quot;</span>
  738 
  739     <span class="k">for</span> <span class="n">SelectionName</span> <span class="ow">in</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ChainSelectionsInfo&quot;</span><span class="p">][</span><span class="s2">&quot;Names&quot;</span><span class="p">]:</span>
  740         <span class="n">SelectionNameGroupID</span> <span class="o">=</span> <span class="n">SelectionName</span>
  741         
  742         <span class="c1"># Delete surface objects and surface group...</span>
  743         <span class="n">SurfaceGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">SurfaceGroup&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
  744         <span class="n">SurfaceGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">SurfaceGroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
  745         <span class="n">WritePMLToCheckAndDeleteEmptyObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SurfaceGroupMembersID</span><span class="p">]),</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SurfaceGroupID</span><span class="p">])</span>
  746         
  747         <span class="c1"># Delete Selection object and selection name group...</span>
  748         <span class="n">SelectionObjectID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Selection&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
  749         <span class="n">SelectionsGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
  750         <span class="n">WritePMLToCheckAndDeleteEmptyObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SelectionObjectID</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SelectionsGroupID</span><span class="p">])</span>
  751 
  752 <span class="k">def</span> <span class="nf">DeleteEmptyChainResidueTypesObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  753     <span class="sd">&quot;&quot;&quot;Delete empty chain residue objects. &quot;&quot;&quot;</span>
  754     
  755     <span class="k">if</span> <span class="ow">not</span> <span class="n">GetChainAloneResidueTypesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  756         <span class="k">return</span>
  757     
  758     <span class="n">ResiduesGroupIDPrefix</span> <span class="o">=</span> <span class="s2">&quot;ChainAloneResidues&quot;</span>
  759     <span class="k">for</span> <span class="n">GroupType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Aromatic&quot;</span><span class="p">,</span> <span class="s2">&quot;Hydrophobic&quot;</span><span class="p">,</span> <span class="s2">&quot;Polar&quot;</span><span class="p">,</span> <span class="s2">&quot;Positively_Charged&quot;</span><span class="p">,</span> <span class="s2">&quot;Negatively_Charged&quot;</span><span class="p">,</span> <span class="s2">&quot;Other&quot;</span><span class="p">]:</span>
  760         <span class="n">GroupID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">GroupType</span><span class="p">)</span>
  761         
  762         <span class="n">ResiduesGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupIDPrefix</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">)</span>
  763         <span class="n">GroupName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesGroupID</span><span class="p">]</span>
  764         
  765         <span class="n">GroupObjectNamesList</span> <span class="o">=</span> <span class="p">[]</span>
  766         
  767         <span class="n">ResiduesObjectID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Residues&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupIDPrefix</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">)</span>
  768         <span class="n">ResiduesObjectName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesObjectID</span><span class="p">]</span>
  769         <span class="n">GroupObjectNamesList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ResiduesObjectName</span><span class="p">)</span>
  770         
  771         <span class="n">ResiduesSurfaceObjectID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Surface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupIDPrefix</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">)</span>
  772         <span class="n">ResiduesSurfaceObjectName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesSurfaceObjectID</span><span class="p">]</span>
  773         <span class="n">GroupObjectNamesList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ResiduesSurfaceObjectName</span><span class="p">)</span>
  774         
  775         <span class="n">GroupObjectNames</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">GroupObjectNamesList</span><span class="p">)</span>
  776         <span class="n">WritePMLToCheckAndDeleteEmptyObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">GroupObjectNames</span><span class="p">,</span> <span class="n">GroupName</span><span class="p">)</span>
  777 
  778 <span class="k">def</span> <span class="nf">DeleteEmptyPocketResidueTypesObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">,</span> <span class="n">PocketObjectID</span><span class="p">):</span>
  779     <span class="sd">&quot;&quot;&quot;Delete empty chain residue objects. &quot;&quot;&quot;</span>
  780     
  781     <span class="k">if</span> <span class="ow">not</span> <span class="n">GetPocketResidueTypesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">):</span>
  782         <span class="k">return</span>
  783     
  784     <span class="n">ResiduesGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">ResiduesGroup&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">PocketObjectID</span><span class="p">)</span>
  785     <span class="n">ResiduesGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Members&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupID</span><span class="p">)</span>
  786     
  787     <span class="k">for</span> <span class="n">SubGroupType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Aromatic&quot;</span><span class="p">,</span> <span class="s2">&quot;Hydrophobic&quot;</span><span class="p">,</span> <span class="s2">&quot;Polar&quot;</span><span class="p">,</span> <span class="s2">&quot;Positively_Charged&quot;</span><span class="p">,</span> <span class="s2">&quot;Negatively_Charged&quot;</span><span class="p">,</span> <span class="s2">&quot;Other&quot;</span><span class="p">]:</span>
  788         <span class="n">SubGroupID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">SubGroupType</span><span class="p">)</span>
  789         
  790         <span class="n">ResiduesSubGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupID</span><span class="p">,</span> <span class="n">SubGroupID</span><span class="p">)</span>
  791         <span class="n">ResiduesSubMembersGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Members&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesSubGroupID</span><span class="p">)</span>
  792 
  793         <span class="n">SubGroupName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">ResiduesSubGroupID</span><span class="p">]</span>
  794         <span class="n">SubGroupObjectNames</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">ResiduesSubMembersGroupID</span><span class="p">])</span>
  795         
  796         <span class="n">WritePMLToCheckAndDeleteEmptyObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">SubGroupObjectNames</span><span class="p">,</span> <span class="n">SubGroupName</span><span class="p">)</span>
  797 
  798 <span class="k">def</span> <span class="nf">WritePMLToCheckAndDeleteEmptyObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">ObjectName</span><span class="p">,</span> <span class="n">ParentObjectName</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
  799     <span class="sd">&quot;&quot;&quot;Write PML to check and delete empty PyMOL objects. &quot;&quot;&quot;</span>
  800     
  801     <span class="k">if</span> <span class="n">ParentObjectName</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
  802         <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;CheckAndDeleteEmptyObjects(&quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ObjectName</span><span class="p">)</span>
  803     <span class="k">else</span><span class="p">:</span>
  804         <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;CheckAndDeleteEmptyObjects(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ObjectName</span><span class="p">,</span> <span class="n">ParentObjectName</span><span class="p">)</span>
  805     
  806     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  807     
  808 <span class="k">def</span> <span class="nf">SetupPyMOLObjectNames</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">):</span>
  809     <span class="sd">&quot;&quot;&quot;Setup hierarchy of PyMOL groups and objects for ligand centric views of</span>
  810 <span class="sd">    chains and ligands present in input file.</span>
  811 <span class="sd">    &quot;&quot;&quot;</span>
  812 
  813     <span class="n">PyMOLObjectNames</span> <span class="o">=</span> <span class="p">{}</span>
  814     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  815     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  816 
  817     <span class="c1"># Setup groups and objects for complex...</span>
  818     <span class="n">SetupPyMOLObjectNamesForComplex</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">)</span>
  819     
  820     <span class="c1"># Setup groups and objects for chain...</span>
  821     <span class="n">SpecifiedChainsAndLigandsInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
  822     <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]:</span>
  823         <span class="n">SetupPyMOLObjectNamesForChain</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
  824         
  825         <span class="c1"># Setup groups and objects for ligand...</span>
  826         <span class="k">for</span> <span class="n">LigandID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]:</span>
  827             <span class="n">SetupPyMOLObjectNamesForLigand</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">)</span>
  828 
  829     <span class="k">return</span> <span class="n">PyMOLObjectNames</span>
  830 
  831 <span class="k">def</span> <span class="nf">SetupPyMOLObjectNamesForComplex</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">):</span>
  832     <span class="sd">&quot;&quot;&quot;Setup groups and objects for complex. &quot;&quot;&quot;</span>
  833     
  834     <span class="n">PDBFileRoot</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InfilesRoots&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
  835     
  836     <span class="n">PDBGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PDBFileRoot</span>
  837     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;PDBGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PDBGroupName</span>
  838     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;PDBGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  839 
  840     <span class="n">ComplexGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Complex&quot;</span> <span class="o">%</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;PDBGroup&quot;</span><span class="p">]</span>
  841     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ComplexGroupName</span>
  842     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;PDBGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ComplexGroupName</span><span class="p">)</span>
  843     
  844     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Complex&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Complex&quot;</span> <span class="o">%</span> <span class="n">ComplexGroupName</span>
  845     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceComplex&quot;</span><span class="p">]:</span>
  846         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexHydrophobicSurface&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Surface&quot;</span> <span class="o">%</span> <span class="n">ComplexGroupName</span>
  847 
  848     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  849     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Complex&quot;</span><span class="p">])</span>
  850     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceComplex&quot;</span><span class="p">]:</span>
  851         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexHydrophobicSurface&quot;</span><span class="p">])</span>
  852     
  853 <span class="k">def</span> <span class="nf">SetupPyMOLObjectNamesForChain</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  854     <span class="sd">&quot;&quot;&quot;Setup groups and objects for chain.&quot;&quot;&quot;</span>
  855     
  856     <span class="n">PDBGroupName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;PDBGroup&quot;</span><span class="p">]</span>
  857     
  858     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  859     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  860     
  861     <span class="c1"># Set up chain group and chain objects...</span>
  862     <span class="n">ChainGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Chain</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">PDBGroupName</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
  863     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ChainGroupName</span>
  864     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;PDBGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ChainGroupName</span><span class="p">)</span>
  865     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  866     
  867     <span class="c1"># Setup chain complex group and objects...</span>
  868     <span class="n">ChainComplexGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Complex&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainGroupName</span><span class="p">)</span>
  869     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ChainComplexGroupName</span>
  870     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ChainComplexGroupName</span><span class="p">)</span>
  871 
  872     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  873     
  874     <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Complex&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainComplexGroupName</span><span class="p">)</span>
  875     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplex&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
  876     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
  877     
  878     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChainComplex&quot;</span><span class="p">]:</span>
  879         <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Surface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainComplexGroupName</span><span class="p">)</span>
  880         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexHydrophobicSurface&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
  881         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
  882 
  883     <span class="c1"># Setup up a group for individual chains...</span>
  884     <span class="n">ChainAloneGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Chain&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainGroupName</span><span class="p">)</span>
  885     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ChainAloneGroupName</span>
  886     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ChainAloneGroupName</span><span class="p">)</span>
  887         
  888     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  889         
  890     <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Chain&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainAloneGroupName</span><span class="p">)</span>
  891     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAlone&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
  892     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
  893 
  894     <span class="k">if</span> <span class="n">GetChainAloneContainsSelectionsStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  895         <span class="c1"># Setup selections group and its subgroups..</span>
  896         <span class="n">SelectionsGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Selections&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainAloneGroupName</span><span class="p">)</span>
  897         
  898         <span class="n">SelectionsGroupIDPrefix</span> <span class="o">=</span> <span class="s2">&quot;ChainAloneSelections&quot;</span>
  899         <span class="n">SelectionsGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="n">SelectionsGroupIDPrefix</span>
  900         
  901         <span class="c1"># Add selections group to chain alone group...</span>
  902         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SelectionsGroupID</span><span class="p">]</span> <span class="o">=</span> <span class="n">SelectionsGroupName</span>
  903         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SelectionsGroupName</span><span class="p">)</span>
  904         
  905         <span class="c1"># Initialize selections group members...</span>
  906         <span class="n">SelectionsGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">GroupMembers&quot;</span> <span class="o">%</span> <span class="n">SelectionsGroupIDPrefix</span>
  907         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SelectionsGroupMembersID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  908 
  909         <span class="c1"># Setup selections name sub group and its members...</span>
  910         <span class="k">for</span> <span class="n">SelectionName</span> <span class="ow">in</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ChainSelectionsInfo&quot;</span><span class="p">][</span><span class="s2">&quot;Names&quot;</span><span class="p">]:</span>
  911             <span class="n">SelectionNameGroupID</span> <span class="o">=</span> <span class="n">SelectionName</span>
  912             
  913             <span class="n">SelectionsNameGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupName</span><span class="p">,</span> <span class="n">SelectionName</span><span class="p">)</span>
  914             <span class="n">SelectionsNameGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
  915 
  916             <span class="c1"># Add selections name sub group to selections group...</span>
  917             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SelectionsNameGroupID</span><span class="p">]</span> <span class="o">=</span> <span class="n">SelectionsNameGroupName</span>
  918             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SelectionsGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SelectionsNameGroupName</span><span class="p">)</span>
  919             
  920             <span class="c1"># Initialize selections names sub group members...</span>
  921             <span class="n">SelectionsNameGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">GroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
  922             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SelectionsNameGroupMembersID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  923 
  924             <span class="c1"># Add selection member to selections name group...</span>
  925             <span class="n">SubGroupMemberName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Selection&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsNameGroupName</span><span class="p">)</span>
  926             <span class="n">SubGroupMemberID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Selection&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
  927             
  928             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SubGroupMemberID</span><span class="p">]</span> <span class="o">=</span> <span class="n">SubGroupMemberName</span>
  929             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SelectionsNameGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SubGroupMemberName</span><span class="p">)</span>
  930             
  931             <span class="k">if</span> <span class="n">GetChainAloneContainsChainSelectionSurfacesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  932                 <span class="c1"># Setup a surface sub group and add it to selections name group...</span>
  933                 
  934                 <span class="n">SelectionsNameSurfaceGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Surface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsNameGroupName</span><span class="p">)</span>
  935                 <span class="n">SelectionsNameSurfaceGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">SurfaceGroup&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
  936 
  937                 <span class="c1"># Add selection surface group to selectio name group...</span>
  938                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SelectionsNameSurfaceGroupID</span><span class="p">]</span> <span class="o">=</span> <span class="n">SelectionsNameSurfaceGroupName</span>
  939                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SelectionsNameGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SelectionsNameSurfaceGroupName</span><span class="p">)</span>
  940 
  941                 <span class="c1"># Initialize surface names sub group members...</span>
  942                 <span class="n">SelectionsNameSurfaceGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">SurfaceGroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
  943                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SelectionsNameSurfaceGroupMembersID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  944                 
  945                 <span class="c1"># Setup a generic color surface...</span>
  946                 <span class="n">SubGroupMemberName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Surface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsNameSurfaceGroupName</span><span class="p">)</span>
  947                 <span class="n">SubGroupMemberID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s%s</span><span class="s2">Surface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">,</span> <span class="s2">&quot;Surface&quot;</span><span class="p">)</span>
  948                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SubGroupMemberID</span><span class="p">]</span> <span class="o">=</span> <span class="n">SubGroupMemberName</span>
  949                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SelectionsNameSurfaceGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SubGroupMemberName</span><span class="p">)</span>
  950                 
  951                 <span class="k">if</span> <span class="n">GetChainAloneSurfaceChainSelectionStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  952                     <span class="c1"># Setup surfaces...</span>
  953                     <span class="k">for</span> <span class="n">MemberType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Hydrophobicity&quot;</span><span class="p">,</span> <span class="s2">&quot;Hydrophobicity_Charge&quot;</span><span class="p">]:</span>
  954                         <span class="n">MemberID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">MemberType</span><span class="p">)</span>
  955                         
  956                         <span class="n">SubGroupMemberName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsNameSurfaceGroupName</span><span class="p">,</span> <span class="n">MemberType</span><span class="p">)</span>
  957                         <span class="n">SubGroupMemberID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s%s%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">,</span> <span class="s2">&quot;Surface&quot;</span><span class="p">,</span> <span class="n">MemberID</span><span class="p">)</span>
  958                         
  959                         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SubGroupMemberID</span><span class="p">]</span> <span class="o">=</span> <span class="n">SubGroupMemberName</span>
  960                         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SelectionsNameSurfaceGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SubGroupMemberName</span><span class="p">)</span>
  961 
  962     <span class="k">if</span> <span class="n">GetChainAloneResidueTypesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  963         <span class="c1"># Setup residue type group and its subgroups...</span>
  964         <span class="n">ResiduesGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Residues&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainAloneGroupName</span><span class="p">)</span>
  965         
  966         <span class="n">ResiduesGroupIDPrefix</span> <span class="o">=</span> <span class="s2">&quot;ChainAloneResidues&quot;</span>
  967         <span class="n">ResiduesGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="n">ResiduesGroupIDPrefix</span>
  968 
  969         <span class="c1"># Add residue group to chain alone group...</span>
  970         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesGroupID</span><span class="p">]</span> <span class="o">=</span> <span class="n">ResiduesGroupName</span>
  971         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ResiduesGroupName</span><span class="p">)</span>
  972         
  973         <span class="c1"># Initialize residue group members...</span>
  974         <span class="n">ResiduesGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">GroupMembers&quot;</span> <span class="o">%</span> <span class="n">ResiduesGroupIDPrefix</span>
  975         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesGroupMembersID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  976 
  977         <span class="c1"># Setup residues sub groups and its members...</span>
  978         <span class="k">for</span> <span class="n">SubGroupType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Aromatic&quot;</span><span class="p">,</span> <span class="s2">&quot;Hydrophobic&quot;</span><span class="p">,</span> <span class="s2">&quot;Polar&quot;</span><span class="p">,</span> <span class="s2">&quot;Positively_Charged&quot;</span><span class="p">,</span> <span class="s2">&quot;Negatively_Charged&quot;</span><span class="p">,</span> <span class="s2">&quot;Other&quot;</span><span class="p">]:</span>
  979             <span class="n">SubGroupID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">SubGroupType</span><span class="p">)</span>
  980 
  981             <span class="n">ResiduesSubGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupName</span><span class="p">,</span> <span class="n">SubGroupType</span><span class="p">)</span>
  982             <span class="n">ResiduesSubGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupIDPrefix</span><span class="p">,</span> <span class="n">SubGroupID</span><span class="p">)</span>
  983 
  984             <span class="c1"># Add sub group to residues group...</span>
  985             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesSubGroupID</span><span class="p">]</span> <span class="o">=</span> <span class="n">ResiduesSubGroupName</span>
  986             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ResiduesSubGroupName</span><span class="p">)</span>
  987 
  988             <span class="c1"># Initialize sub group members...</span>
  989             <span class="n">ResiduesSubGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">GroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupIDPrefix</span><span class="p">,</span> <span class="n">SubGroupID</span><span class="p">)</span>
  990             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesSubGroupMembersID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  991             
  992             <span class="c1"># Add sub group members to subgroup...</span>
  993             <span class="k">for</span> <span class="n">MemberType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Residues&quot;</span><span class="p">,</span> <span class="s2">&quot;Surface&quot;</span><span class="p">]:</span>
  994                 <span class="n">MemberID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">MemberType</span><span class="p">)</span>
  995 
  996                 <span class="n">SubGroupMemberName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesSubGroupName</span><span class="p">,</span> <span class="n">MemberType</span><span class="p">)</span>
  997                 <span class="n">SubGroupMemberID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupIDPrefix</span><span class="p">,</span> <span class="n">SubGroupID</span><span class="p">,</span> <span class="n">MemberID</span><span class="p">)</span>
  998                 
  999                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SubGroupMemberID</span><span class="p">]</span> <span class="o">=</span> <span class="n">SubGroupMemberName</span>
 1000                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesSubGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SubGroupMemberName</span><span class="p">)</span>
 1001 
 1002     <span class="k">if</span> <span class="n">GetChainAloneContainsSurfacesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
 1003         <span class="c1"># Setup a surface group and add it to chain alone group...</span>
 1004         <span class="n">SurfaceGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Surface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainAloneGroupName</span><span class="p">)</span>
 1005         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSurfaceGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SurfaceGroupName</span>
 1006         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SurfaceGroupName</span><span class="p">)</span>
 1007         
 1008         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSurfaceGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1009 
 1010         <span class="c1"># Setup a generic color surface...</span>
 1011         <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Surface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfaceGroupName</span><span class="p">)</span>
 1012         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSurface&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
 1013         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSurfaceGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
 1014         
 1015         <span class="k">if</span> <span class="n">GetChainAloneSurfaceChainStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
 1016             <span class="c1"># Setup hydrophobicity surface...</span>
 1017             <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Hydrophobicity&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfaceGroupName</span><span class="p">)</span>
 1018             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneHydrophobicSurface&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
 1019             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSurfaceGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
 1020             
 1021             <span class="c1"># Setup hydrophobicity and charge surface...</span>
 1022             <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Hydrophobicity_Charge&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfaceGroupName</span><span class="p">)</span>
 1023             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneHydrophobicChargeSurface&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
 1024             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSurfaceGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
 1025     
 1026         <span class="k">if</span> <span class="n">GetChainAloneSurfaceChainElectrostaticsStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
 1027             <span class="c1"># Setup electrostatics group...</span>
 1028             <span class="n">GroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Vacuum_Electrostatics&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfaceGroupName</span><span class="p">)</span>
 1029             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneElectrostaticsGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">GroupName</span>
 1030             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSurfaceGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">GroupName</span><span class="p">)</span>
 1031             
 1032             <span class="c1"># Setup electrostatics group members...</span>
 1033             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneElectrostaticsGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1034             
 1035             <span class="k">for</span> <span class="n">MemberType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Chain&quot;</span><span class="p">,</span> <span class="s2">&quot;Contact_Potential&quot;</span><span class="p">,</span> <span class="s2">&quot;Map&quot;</span><span class="p">,</span> <span class="s2">&quot;Legend&quot;</span><span class="p">,</span> <span class="s2">&quot;Volume&quot;</span><span class="p">]:</span>
 1036                 <span class="n">MemberID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">MemberType</span><span class="p">)</span>
 1037                 
 1038                 <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupName</span><span class="p">,</span> <span class="n">MemberType</span><span class="p">)</span>
 1039                 <span class="n">NameID</span> <span class="o">=</span> <span class="s2">&quot;ChainAloneElectrostaticsSurface</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">MemberID</span>
 1040                 
 1041                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">NameID</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
 1042                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneElectrostaticsGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
 1043             
 1044     <span class="c1"># Setup solvent and inorganic objects for chain...</span>
 1045     <span class="k">for</span> <span class="n">NameID</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Solvent&quot;</span><span class="p">,</span> <span class="s2">&quot;Inorganic&quot;</span><span class="p">]:</span>
 1046         <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainGroupName</span><span class="p">,</span> <span class="n">NameID</span><span class="p">)</span>
 1047         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">NameID</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
 1048         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
 1049 
 1050 <span class="k">def</span> <span class="nf">SetupPyMOLObjectNamesForLigand</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">):</span>
 1051     <span class="sd">&quot;&quot;&quot;Stetup groups and objects for ligand.&quot;&quot;&quot;</span>
 1052 
 1053     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1054     
 1055     <span class="n">ChainGroupName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroup&quot;</span><span class="p">]</span>
 1056     
 1057     <span class="c1"># Setup a chain level ligand group...</span>
 1058     <span class="n">ChainLigandGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Ligand</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainGroupName</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">)</span>
 1059     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="s2">&quot;ChainLigandGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ChainLigandGroupName</span>
 1060     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ChainLigandGroupName</span><span class="p">)</span>
 1061     
 1062     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="s2">&quot;ChainLigandGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1063 
 1064     <span class="c1"># Set up groups and objects for a specific ligand group...</span>
 1065     <span class="k">for</span> <span class="n">GroupType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Ligand&quot;</span><span class="p">,</span> <span class="s2">&quot;Pocket&quot;</span><span class="p">,</span> <span class="s2">&quot;Pocket_Solvent&quot;</span><span class="p">,</span> <span class="s2">&quot;Pocket_Inorganic&quot;</span><span class="p">]:</span>
 1066         <span class="n">GroupID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">GroupType</span><span class="p">)</span>
 1067         <span class="n">GroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainLigandGroupName</span><span class="p">,</span> <span class="n">GroupType</span><span class="p">)</span>
 1068                 
 1069         <span class="n">GroupNameID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
 1070         <span class="n">GroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">GroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
 1071         
 1072         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupNameID</span><span class="p">]</span> <span class="o">=</span> <span class="n">GroupName</span>
 1073         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="s2">&quot;ChainLigandGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">GroupName</span><span class="p">)</span>
 1074         
 1075         <span class="n">GroupTypeObjectName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupName</span><span class="p">,</span> <span class="n">GroupType</span><span class="p">)</span>
 1076         <span class="n">GroupTypeObjectID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
 1077         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupTypeObjectID</span><span class="p">]</span> <span class="o">=</span> <span class="n">GroupTypeObjectName</span>
 1078         
 1079         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupMembersID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1080         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">GroupTypeObjectName</span><span class="p">)</span>
 1081         
 1082         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Ligand$&quot;</span><span class="p">,</span> <span class="n">GroupType</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1083             <span class="c1"># Only need to add ball and stick...</span>
 1084             <span class="n">BallAndStickName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.BallAndStick&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupName</span><span class="p">)</span>
 1085             <span class="n">BallAndStickID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">BallAndStick&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
 1086             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">BallAndStickID</span><span class="p">]</span> <span class="o">=</span> <span class="n">BallAndStickName</span>
 1087             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">BallAndStickName</span><span class="p">)</span>
 1088         
 1089         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(Pocket|Pocket_Solvent|Pocket_Inorganic)$&quot;</span><span class="p">,</span> <span class="n">GroupType</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1090             <span class="n">PolarContactsName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Polar_Contacts&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupName</span><span class="p">)</span>
 1091             <span class="n">PolarContactsID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">PolarContacts&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
 1092             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">PolarContactsID</span><span class="p">]</span> <span class="o">=</span> <span class="n">PolarContactsName</span>
 1093             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PolarContactsName</span><span class="p">)</span>
 1094                 
 1095         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Pocket$&quot;</span><span class="p">,</span> <span class="n">GroupType</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1096             <span class="n">HydrophobicContactsName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Hydrophobic_Contacts&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupName</span><span class="p">)</span>
 1097             <span class="n">HydrophobicContactsID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">HydrophobicContacts&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
 1098             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">HydrophobicContactsID</span><span class="p">]</span> <span class="o">=</span> <span class="n">HydrophobicContactsName</span>
 1099             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">HydrophobicContactsName</span><span class="p">)</span>
 1100             
 1101             <span class="k">if</span> <span class="n">GetPocketResidueTypesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">):</span>
 1102                 <span class="c1"># Setup residue type group and add to pocket group...</span>
 1103                 <span class="n">ResiduesGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Residues&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupName</span><span class="p">)</span>
 1104                 <span class="n">ResiduesGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">ResiduesGroup&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
 1105                 <span class="n">ResiduesGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Members&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupID</span><span class="p">)</span>
 1106 
 1107                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">ResiduesGroupID</span><span class="p">]</span> <span class="o">=</span> <span class="n">ResiduesGroupName</span>
 1108                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ResiduesGroupName</span><span class="p">)</span>
 1109                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">ResiduesGroupMembersID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1110                 
 1111                 <span class="c1"># Setup residue group subgroup and its members...</span>
 1112                 <span class="k">for</span> <span class="n">SubGroupType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Aromatic&quot;</span><span class="p">,</span> <span class="s2">&quot;Hydrophobic&quot;</span><span class="p">,</span> <span class="s2">&quot;Polar&quot;</span><span class="p">,</span> <span class="s2">&quot;Positively_Charged&quot;</span><span class="p">,</span> <span class="s2">&quot;Negatively_Charged&quot;</span><span class="p">,</span> <span class="s2">&quot;Other&quot;</span><span class="p">]:</span>
 1113                     <span class="n">SubGroupID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">SubGroupType</span><span class="p">)</span>
 1114                     <span class="n">ResiduesSubGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupName</span><span class="p">,</span> <span class="n">SubGroupType</span><span class="p">)</span>
 1115                     <span class="n">ResiduesSubGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupID</span><span class="p">,</span> <span class="n">SubGroupID</span><span class="p">)</span>
 1116                     <span class="n">ResiduesSubMembersGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Members&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesSubGroupID</span><span class="p">)</span>
 1117                     
 1118                     <span class="c1"># Add sub group to residues group...</span>
 1119                     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">ResiduesSubGroupID</span><span class="p">]</span> <span class="o">=</span> <span class="n">ResiduesSubGroupName</span>
 1120                     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">ResiduesGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ResiduesSubGroupName</span><span class="p">)</span>
 1121                     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">ResiduesSubMembersGroupID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1122                     
 1123                     <span class="c1"># Add sub group members to subgroup...</span>
 1124                     <span class="k">for</span> <span class="n">MemberType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Residues&quot;</span><span class="p">,</span> <span class="s2">&quot;Surface&quot;</span><span class="p">]:</span>
 1125                         <span class="n">MemberID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">MemberType</span><span class="p">)</span>
 1126                         <span class="n">SubGroupMemberName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesSubGroupName</span><span class="p">,</span> <span class="n">MemberType</span><span class="p">)</span>
 1127                         <span class="n">SubGroupMemberID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesSubGroupID</span><span class="p">,</span> <span class="n">MemberID</span><span class="p">)</span>
 1128                         
 1129                         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">SubGroupMemberID</span><span class="p">]</span> <span class="o">=</span> <span class="n">SubGroupMemberName</span>
 1130                         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">ResiduesSubMembersGroupID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SubGroupMemberName</span><span class="p">)</span>
 1131 
 1132             <span class="k">if</span> <span class="n">GetPocketContainsSurfaceStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">):</span>
 1133                 <span class="c1"># Setup a surfaces group and add it to pocket group...</span>
 1134                 <span class="n">SurfacesGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Surfaces&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupName</span><span class="p">)</span>
 1135                 <span class="n">SurfacesGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">SurfacesGroup&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
 1136                 <span class="n">SurfacesGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Members&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfacesGroupID</span><span class="p">)</span>
 1137 
 1138                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">SurfacesGroupID</span><span class="p">]</span> <span class="o">=</span> <span class="n">SurfacesGroupName</span>
 1139                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SurfacesGroupName</span><span class="p">)</span>
 1140                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">SurfacesGroupMembersID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1141 
 1142                 <span class="c1"># Setup surfaces subgroup and its members...</span>
 1143                 <span class="k">for</span> <span class="n">SubGroupType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Surface&quot;</span><span class="p">,</span> <span class="s2">&quot;Cavity&quot;</span><span class="p">]:</span>
 1144                     <span class="n">SubGroupID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">SubGroupType</span><span class="p">)</span>
 1145                     <span class="n">SurfacesSubGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfacesGroupName</span><span class="p">,</span> <span class="n">SubGroupType</span><span class="p">)</span>
 1146                     <span class="n">SurfacesSubGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfacesGroupID</span><span class="p">,</span> <span class="n">SubGroupID</span><span class="p">)</span>
 1147                     <span class="n">SurfacesSubGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Members&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfacesSubGroupID</span><span class="p">)</span>
 1148                     
 1149                     <span class="c1"># Add sub group to surfaces group...</span>
 1150                     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">SurfacesSubGroupID</span><span class="p">]</span> <span class="o">=</span> <span class="n">SurfacesSubGroupName</span>
 1151                     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">SurfacesGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SurfacesSubGroupName</span><span class="p">)</span>
 1152                     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">SurfacesSubGroupMembersID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1153                     
 1154                     <span class="c1"># Setup a generic color surface...</span>
 1155                     <span class="n">SurfaceName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Surface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfacesSubGroupName</span><span class="p">)</span>
 1156                     <span class="n">SurfaceID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Surface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfacesSubGroupID</span><span class="p">)</span>
 1157                     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">SurfaceID</span><span class="p">]</span> <span class="o">=</span> <span class="n">SurfaceName</span>
 1158                     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">SurfacesSubGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SurfaceName</span><span class="p">)</span>
 1159                     
 1160                     <span class="k">if</span> <span class="n">GetPocketSurfaceChainStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">):</span>
 1161                         <span class="c1"># Surface colored by hydrophobicity...</span>
 1162                         <span class="n">HydrophobicSurfaceName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Hydrophobicity&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfacesSubGroupName</span><span class="p">)</span>
 1163                         <span class="n">HydrophobicSurfaceID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">HydrophobicSurface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfacesSubGroupID</span><span class="p">)</span>
 1164                         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">HydrophobicSurfaceID</span><span class="p">]</span> <span class="o">=</span> <span class="n">HydrophobicSurfaceName</span>
 1165                         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">SurfacesSubGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">HydrophobicSurfaceName</span><span class="p">)</span>
 1166                         
 1167                         <span class="c1"># Surface colored by hydrophobicity and charge...</span>
 1168                         <span class="n">HydrophobicChargeSurfaceName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Hydrophobicity_Charge&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfacesSubGroupName</span><span class="p">)</span>
 1169                         <span class="n">HydrophobicChargeSurfaceID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">HydrophobicChargeSurface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfacesSubGroupID</span><span class="p">)</span>
 1170                         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">HydrophobicChargeSurfaceID</span><span class="p">]</span> <span class="o">=</span> <span class="n">HydrophobicChargeSurfaceName</span>
 1171                         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">SurfacesSubGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">HydrophobicChargeSurfaceName</span><span class="p">)</span>
 1172                 
 1173                     <span class="k">if</span> <span class="n">GetPocketSurfaceChainElectrostaticsStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">):</span>
 1174                         <span class="n">ElectrostaticsGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Vacuum_Electrostatics&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfacesSubGroupName</span><span class="p">)</span>
 1175                         <span class="n">ElectrostaticsGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">ElectrostaticsGroup&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfacesSubGroupID</span><span class="p">)</span>
 1176                         <span class="n">ElectrostaticsGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">ElectrostaticsGroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfacesSubGroupID</span><span class="p">)</span>
 1177                         
 1178                         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">ElectrostaticsGroupID</span><span class="p">]</span> <span class="o">=</span> <span class="n">ElectrostaticsGroupName</span>
 1179                         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">SurfacesSubGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ElectrostaticsGroupName</span><span class="p">)</span>
 1180                         
 1181                         <span class="c1"># Setup electrostatics group members without the volume object...</span>
 1182                         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">ElectrostaticsGroupMembersID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1183                         
 1184                         <span class="k">for</span> <span class="n">MemberType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Pocket&quot;</span><span class="p">,</span> <span class="s2">&quot;Contact_Potential&quot;</span><span class="p">,</span> <span class="s2">&quot;Map&quot;</span><span class="p">,</span> <span class="s2">&quot;Legend&quot;</span><span class="p">]:</span>
 1185                             <span class="n">MemberID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">MemberType</span><span class="p">)</span>
 1186                             
 1187                             <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ElectrostaticsGroupName</span><span class="p">,</span> <span class="n">MemberType</span><span class="p">)</span>
 1188                             <span class="n">NameID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ElectrostaticsGroupID</span><span class="p">,</span> <span class="n">MemberID</span><span class="p">)</span>
 1189                             
 1190                             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">NameID</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
 1191                             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">ElectrostaticsGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
 1192     
 1193 <span class="k">def</span> <span class="nf">RetrieveInfilesInfo</span><span class="p">():</span>
 1194     <span class="sd">&quot;&quot;&quot;Retrieve information for input files.&quot;&quot;&quot;</span>
 1195 
 1196     <span class="n">InfilesInfo</span> <span class="o">=</span> <span class="p">{}</span>
 1197     
 1198     <span class="n">InfilesInfo</span><span class="p">[</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1199     <span class="n">InfilesInfo</span><span class="p">[</span><span class="s2">&quot;InfilesRoots&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1200     <span class="n">InfilesInfo</span><span class="p">[</span><span class="s2">&quot;ChainsAndLigandsInfo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1201     
 1202     <span class="k">for</span> <span class="n">Infile</span> <span class="ow">in</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">]:</span>
 1203         <span class="n">FileDir</span><span class="p">,</span> <span class="n">FileName</span><span class="p">,</span> <span class="n">FileExt</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ParseFileName</span><span class="p">(</span><span class="n">Infile</span><span class="p">)</span>
 1204         <span class="n">InfileRoot</span> <span class="o">=</span> <span class="n">FileName</span>
 1205         
 1206         <span class="n">ChainsAndLigandInfo</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">GetChainsAndLigandsInfo</span><span class="p">(</span><span class="n">Infile</span><span class="p">,</span> <span class="n">InfileRoot</span><span class="p">)</span>
 1207         
 1208         <span class="n">InfilesInfo</span><span class="p">[</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Infile</span><span class="p">)</span>
 1209         <span class="n">InfilesInfo</span><span class="p">[</span><span class="s2">&quot;InfilesRoots&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">InfileRoot</span><span class="p">)</span>
 1210         <span class="n">InfilesInfo</span><span class="p">[</span><span class="s2">&quot;ChainsAndLigandsInfo&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ChainsAndLigandInfo</span><span class="p">)</span>
 1211     
 1212     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">InfilesInfo</span>
 1213 
 1214 <span class="k">def</span> <span class="nf">RetrieveRefFileInfo</span><span class="p">():</span>
 1215     <span class="sd">&quot;&quot;&quot;Retrieve information for ref file.&quot;&quot;&quot;</span>
 1216 
 1217     <span class="n">RefFileInfo</span> <span class="o">=</span> <span class="p">{}</span>
 1218     <span class="k">if</span> <span class="ow">not</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Align&quot;</span><span class="p">]:</span>
 1219         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;RefFileInfo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">RefFileInfo</span>
 1220         <span class="k">return</span>
 1221 
 1222     <span class="n">RefFile</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;RefFileName&quot;</span><span class="p">]</span>
 1223     
 1224     <span class="n">FileDir</span><span class="p">,</span> <span class="n">FileName</span><span class="p">,</span> <span class="n">FileExt</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ParseFileName</span><span class="p">(</span><span class="n">RefFile</span><span class="p">)</span>
 1225     <span class="n">RefFileRoot</span> <span class="o">=</span> <span class="n">FileName</span>
 1226     
 1227     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^FirstInputFile$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AlignRefFile&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1228         <span class="n">ChainsAndLigandInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;ChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
 1229     <span class="k">else</span><span class="p">:</span>
 1230         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Retrieving chain and ligand information for alignment reference file </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">RefFile</span><span class="p">)</span>
 1231         <span class="n">ChainsAndLigandInfo</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">GetChainsAndLigandsInfo</span><span class="p">(</span><span class="n">RefFile</span><span class="p">,</span> <span class="n">RefFileRoot</span><span class="p">)</span>
 1232 
 1233     <span class="n">RefFileInfo</span><span class="p">[</span><span class="s2">&quot;RefFileName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">RefFile</span>
 1234     <span class="n">RefFileInfo</span><span class="p">[</span><span class="s2">&quot;RefFileRoot&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">RefFileRoot</span>
 1235     <span class="n">RefFileInfo</span><span class="p">[</span><span class="s2">&quot;PyMOLObjectName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;AlignRef_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">RefFileRoot</span>
 1236     <span class="n">RefFileInfo</span><span class="p">[</span><span class="s2">&quot;ChainsAndLigandsInfo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ChainsAndLigandInfo</span>
 1237     
 1238     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;RefFileInfo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">RefFileInfo</span>
 1239 
 1240 <span class="k">def</span> <span class="nf">ProcessChainAndLigandIDs</span><span class="p">():</span>
 1241     <span class="sd">&quot;&quot;&quot;Process specified chain and ligand IDs for infiles.&quot;&quot;&quot;</span>
 1242     
 1243     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1244     
 1245     <span class="k">for</span> <span class="n">FileIndex</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">])):</span>
 1246         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Processing specified chain and ligand IDs for input file </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">])</span>
 1247         
 1248         <span class="n">ChainsAndLigandsInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;ChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
 1249         <span class="n">SpecifiedChainsAndLigandsInfo</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">ProcessChainsAndLigandsOptionsInfo</span><span class="p">(</span><span class="n">ChainsAndLigandsInfo</span><span class="p">,</span> <span class="s2">&quot;-c, --chainIDs&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">],</span> <span class="s2">&quot;-l, --ligandIDs&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">])</span>
 1250         <span class="n">ProcessResidueTypesAndSurfaceAndChainSelectionsOptions</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">)</span>
 1251         
 1252         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">)</span>
 1253         
 1254         <span class="n">CheckPresenceOfValidLigandIDs</span><span class="p">(</span><span class="n">ChainsAndLigandsInfo</span><span class="p">,</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">)</span>
 1255         
 1256 <span class="k">def</span> <span class="nf">ProcessResidueTypesAndSurfaceAndChainSelectionsOptions</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">):</span>
 1257     <span class="sd">&quot;&quot;&quot;Process residue types, surface, and chian selections options for chains and pockets.&quot;&quot;&quot;</span>
 1258 
 1259     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainSurfaces&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1260     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChain&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1261     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChainElectrostatics&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1262     
 1263     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;PocketSurfaces&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1264     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SurfacePocket&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1265     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SurfacePocketElectrostatics&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1266     
 1267     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesChain&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1268     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesPocket&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1269 
 1270     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainSelections&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1271     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainSelectionsSurfaces&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1272     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChainSelections&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1273     
 1274     <span class="c1"># Load infile...</span>
 1275     <span class="n">Infile</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
 1276     <span class="n">MolName</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InfilesRoots&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
 1277     <span class="n">pymol</span><span class="o">.</span><span class="n">cmd</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">Infile</span><span class="p">,</span> <span class="n">MolName</span><span class="p">)</span>
 1278     
 1279     <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]:</span>
 1280         <span class="n">AminoAcidsPresent</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">AreAminoAcidResiduesPresent</span><span class="p">(</span><span class="n">MolName</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
 1281 
 1282         <span class="c1"># Process surfaces for chains...</span>
 1283         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChain&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1284             <span class="n">SurfaceChain</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">AminoAcidsPresent</span> <span class="k">else</span> <span class="bp">False</span>
 1285         <span class="k">else</span><span class="p">:</span>
 1286             <span class="n">SurfaceChain</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^yes$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChain&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1287         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChain&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">SurfaceChain</span>
 1288 
 1289         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChainElectrostatics&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1290             <span class="n">SurfaceChainElectrostatics</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">AminoAcidsPresent</span> <span class="k">else</span> <span class="bp">False</span>
 1291         <span class="k">else</span><span class="p">:</span>
 1292             <span class="n">SurfaceChainElectrostatics</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^yes$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChainElectrostatics&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1293         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChainElectrostatics&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">SurfaceChainElectrostatics</span>
 1294 
 1295         <span class="c1"># A generic color surafce is always created...</span>
 1296         <span class="n">ChainSurfaces</span> <span class="o">=</span> <span class="bp">True</span>
 1297         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainSurfaces&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">ChainSurfaces</span>
 1298         
 1299         <span class="c1"># Process residue types for chains...</span>
 1300         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesChain&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1301             <span class="n">ResidueTypesChain</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">AminoAcidsPresent</span> <span class="k">else</span> <span class="bp">False</span>
 1302         <span class="k">else</span><span class="p">:</span>
 1303             <span class="n">ResidueTypesChain</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^yes$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesChain&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1304         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesChain&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">ResidueTypesChain</span>
 1305 
 1306         <span class="c1"># Process chain selections...</span>
 1307         <span class="n">ChainSelections</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ChainSelectionsInfo&quot;</span><span class="p">][</span><span class="s2">&quot;Names&quot;</span><span class="p">])</span> <span class="k">else</span> <span class="bp">False</span>
 1308         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainSelections&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">ChainSelections</span>
 1309         
 1310         <span class="c1"># Process surfaces for chain selections...</span>
 1311         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SelectionsChainSurface&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1312             <span class="n">SurfaceChainSelections</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">AminoAcidsPresent</span> <span class="k">else</span> <span class="bp">False</span>
 1313         <span class="k">else</span><span class="p">:</span>
 1314             <span class="n">SurfaceChainSelections</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^yes$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SelectionsChainSurface&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1315         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChainSelections&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">SurfaceChainSelections</span>
 1316         
 1317         <span class="c1"># A generic color surafce is always created...</span>
 1318         <span class="n">ChainSelectionsSurfaces</span> <span class="o">=</span> <span class="bp">True</span>
 1319         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainSelectionsSurfaces&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">ChainSelectionsSurfaces</span>
 1320         
 1321         <span class="c1"># Process residue types and surfaces for pockets...</span>
 1322         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;PocketSurfaces&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1323         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SurfacePocket&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1324         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SurfacePocketElectrostatics&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1325         
 1326         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesPocket&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1327         
 1328         <span class="k">for</span> <span class="n">LigandID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]:</span>
 1329             <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketSurface&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1330                 <span class="n">PocketSurface</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">AminoAcidsPresent</span> <span class="k">else</span> <span class="bp">False</span>
 1331             <span class="k">else</span><span class="p">:</span>
 1332                 <span class="n">PocketSurface</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^yes$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketSurface&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1333             <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SurfacePocket&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">]</span> <span class="o">=</span> <span class="n">PocketSurface</span>
 1334             
 1335             <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketSurfaceElectrostatics&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1336                 <span class="n">PocketSurfaceElectrostatics</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">AminoAcidsPresent</span> <span class="k">else</span> <span class="bp">False</span>
 1337             <span class="k">else</span><span class="p">:</span>
 1338                 <span class="n">PocketSurfaceElectrostatics</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^yes$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketSurfaceElectrostatics&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1339             <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SurfacePocketElectrostatics&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">]</span> <span class="o">=</span> <span class="n">PocketSurfaceElectrostatics</span>
 1340 
 1341             <span class="c1"># A generic color surafce is always displayed...</span>
 1342             <span class="n">PocketSurfaces</span> <span class="o">=</span> <span class="bp">True</span>
 1343             <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;PocketSurfaces&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">]</span> <span class="o">=</span> <span class="n">PocketSurfaces</span>
 1344         
 1345             <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketResidueTypes&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1346                 <span class="n">PocketResidueTypes</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">AminoAcidsPresent</span> <span class="k">else</span> <span class="bp">False</span>
 1347             <span class="k">else</span><span class="p">:</span>
 1348                 <span class="n">PocketResidueTypes</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^yes$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketResidueTypes&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1349             <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesPocket&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">]</span> <span class="o">=</span> <span class="n">PocketResidueTypes</span>
 1350     
 1351     <span class="c1"># Delete loaded object...</span>
 1352     <span class="n">pymol</span><span class="o">.</span><span class="n">cmd</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">MolName</span><span class="p">)</span>
 1353 
 1354 <span class="k">def</span> <span class="nf">GetChainAloneResidueTypesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
 1355     <span class="sd">&quot;&quot;&quot;Get status of residue types for chain alone object.&quot;&quot;&quot;</span>
 1356 
 1357     <span class="n">Status</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">][</span><span class="s2">&quot;ResidueTypesChain&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
 1358     
 1359     <span class="k">return</span> <span class="n">Status</span>
 1360 
 1361 <span class="k">def</span> <span class="nf">GetPocketResidueTypesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">):</span>
 1362     <span class="sd">&quot;&quot;&quot;Get status of residue types for a pocket.&quot;&quot;&quot;</span>
 1363 
 1364     <span class="k">return</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">][</span><span class="s2">&quot;ResidueTypesPocket&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">]</span>
 1365 
 1366 <span class="k">def</span> <span class="nf">GetChainAloneContainsSurfacesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
 1367     <span class="sd">&quot;&quot;&quot;Get status of surfaces present in chain alone object.&quot;&quot;&quot;</span>
 1368 
 1369     <span class="k">return</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">][</span><span class="s2">&quot;ChainSurfaces&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
 1370 
 1371 <span class="k">def</span> <span class="nf">GetPocketContainsSurfaceStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">):</span>
 1372     <span class="sd">&quot;&quot;&quot;Get status of surfaces present in a pocket.&quot;&quot;&quot;</span>
 1373 
 1374     <span class="k">return</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">][</span><span class="s2">&quot;PocketSurfaces&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">]</span>
 1375 
 1376 <span class="k">def</span> <span class="nf">GetChainAloneSurfaceChainStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
 1377     <span class="sd">&quot;&quot;&quot;Get status of hydrophobic surfaces for chain alone object.&quot;&quot;&quot;</span>
 1378 
 1379     <span class="k">return</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">][</span><span class="s2">&quot;SurfaceChain&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
 1380 
 1381 <span class="k">def</span> <span class="nf">GetChainAloneSurfaceChainElectrostaticsStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
 1382     <span class="sd">&quot;&quot;&quot;Get status of electrostatics surfaces for chain alone object.&quot;&quot;&quot;</span>
 1383 
 1384     <span class="k">return</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">][</span><span class="s2">&quot;SurfaceChainElectrostatics&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
 1385 
 1386 <span class="k">def</span> <span class="nf">GetPocketSurfaceChainStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">):</span>
 1387     <span class="sd">&quot;&quot;&quot;Get status of hydrophobic surfaces for a pocket.&quot;&quot;&quot;</span>
 1388 
 1389     <span class="k">return</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">][</span><span class="s2">&quot;SurfacePocket&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">]</span>
 1390 
 1391 <span class="k">def</span> <span class="nf">GetPocketSurfaceChainElectrostaticsStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">):</span>
 1392     <span class="sd">&quot;&quot;&quot;Get status of hydrophobic surfaces for a pocket.&quot;&quot;&quot;</span>
 1393 
 1394     <span class="k">return</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">][</span><span class="s2">&quot;SurfacePocketElectrostatics&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">]</span>
 1395 
 1396 <span class="k">def</span> <span class="nf">GetChainAloneContainsSelectionsStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
 1397     <span class="sd">&quot;&quot;&quot;Get status of selections present in chain alone object.&quot;&quot;&quot;</span>
 1398     <span class="k">return</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">][</span><span class="s2">&quot;ChainSelections&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
 1399 
 1400 <span class="k">def</span> <span class="nf">GetChainAloneContainsChainSelectionSurfacesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
 1401     <span class="sd">&quot;&quot;&quot;Get status of chain selections surfaces present in chain alone object.&quot;&quot;&quot;</span>
 1402     <span class="k">return</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">][</span><span class="s2">&quot;ChainSelectionsSurfaces&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
 1403 
 1404 <span class="k">def</span> <span class="nf">GetChainAloneSurfaceChainSelectionStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
 1405     <span class="sd">&quot;&quot;&quot;Get status of hydrophobic surfaces for chain alone object.&quot;&quot;&quot;</span>
 1406     <span class="k">return</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">][</span><span class="s2">&quot;SurfaceChainSelections&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
 1407 
 1408 <span class="k">def</span> <span class="nf">CheckPresenceOfValidLigandIDs</span><span class="p">(</span><span class="n">ChainsAndLigandsInfo</span><span class="p">,</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">):</span>
 1409     <span class="sd">&quot;&quot;&quot;Check presence of valid ligand IDs.&quot;&quot;&quot;</span>
 1410 
 1411     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Specified chain IDs: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">])))</span>
 1412     
 1413     <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]:</span>
 1414         <span class="k">if</span> <span class="nb">len</span> <span class="p">(</span><span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]):</span>
 1415             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Chain ID: </span><span class="si">%s</span><span class="s2">; Specified LigandIDs: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainID</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">])))</span>
 1416         <span class="k">else</span><span class="p">:</span>
 1417             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Chain IDs: </span><span class="si">%s</span><span class="s2">; Specified LigandIDs: None&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainID</span><span class="p">))</span>
 1418             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;No valid ligand IDs found for chain ID, </span><span class="si">%s</span><span class="s2">. PyMOL groups and objects related to ligand and binding pockect won&#39;t be created.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainID</span><span class="p">))</span>
 1419 
 1420 <span class="k">def</span> <span class="nf">RetrieveFirstChainID</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">):</span>
 1421     <span class="sd">&quot;&quot;&quot;Get first chain ID.&quot;&quot;&quot;</span>
 1422     
 1423     <span class="n">ChainsAndLigandsInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;ChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
 1424     
 1425     <span class="n">FirstChainID</span> <span class="o">=</span> <span class="bp">None</span>
 1426     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]):</span>
 1427         <span class="n">FirstChainID</span> <span class="o">=</span> <span class="n">ChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
 1428     
 1429     <span class="k">return</span> <span class="n">FirstChainID</span>
 1430 
 1431 <span class="k">def</span> <span class="nf">ProcessResidueTypes</span><span class="p">():</span>
 1432     <span class="sd">&quot;&quot;&quot;Process residue types. &quot;&quot;&quot;</span>
 1433 
 1434     <span class="n">ResidueTypesNamesInfo</span><span class="p">,</span> <span class="n">ResidueTypesParamsInfo</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">ProcessResidueTypesOptionsInfo</span><span class="p">(</span><span class="s2">&quot;-r, --residueTypes&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypes&quot;</span><span class="p">])</span>
 1435     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesNames&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ResidueTypesNamesInfo</span>
 1436     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesParams&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ResidueTypesParamsInfo</span>
 1437     
 1438 <span class="k">def</span> <span class="nf">ProcessSurfaceAtomTypesColors</span><span class="p">():</span>
 1439     <span class="sd">&quot;&quot;&quot;Process surface atom types colors. &quot;&quot;&quot;</span>
 1440 
 1441     <span class="n">AtomTypesColorNamesInfo</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">ProcessSurfaceAtomTypesColorsOptionsInfo</span><span class="p">(</span><span class="s2">&quot;--surfaceAtomTypesColors&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceAtomTypesColors&quot;</span><span class="p">])</span>
 1442     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AtomTypesColorNames&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">AtomTypesColorNamesInfo</span>
 1443 
 1444 <span class="k">def</span> <span class="nf">ProcessChainSelections</span><span class="p">():</span>
 1445     <span class="sd">&quot;&quot;&quot;Process custom selections for chains. &quot;&quot;&quot;</span>
 1446 
 1447     <span class="n">ChainSelectionsInfo</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">ProcessChainSelectionsOptionsInfo</span><span class="p">(</span><span class="s2">&quot;--selectionsChain&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SelectionsChain&quot;</span><span class="p">])</span>
 1448     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ChainSelectionsInfo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ChainSelectionsInfo</span>
 1449 
 1450 <span class="k">def</span> <span class="nf">ProcessOptions</span><span class="p">():</span>
 1451     <span class="sd">&quot;&quot;&quot;Process and validate command line arguments and options&quot;&quot;&quot;</span>
 1452 
 1453     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Processing options...&quot;</span><span class="p">)</span>
 1454     
 1455     <span class="c1"># Validate options...</span>
 1456     <span class="n">ValidateOptions</span><span class="p">()</span>
 1457     
 1458     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Align&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Yes$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--align&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1459     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AlignMethod&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--alignMethod&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
 1460     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AlignMode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--alignMode&quot;</span><span class="p">]</span>
 1461     
 1462     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AllowEmptyObjects&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Yes$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--allowEmptyObjects&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1463 
 1464     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Infiles&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--infiles&quot;</span><span class="p">]</span>
 1465     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--infileNames&quot;</span><span class="p">]</span>
 1466 
 1467     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AlignRefFile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--alignRefFile&quot;</span><span class="p">]</span>
 1468     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^FirstInputFile$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--alignRefFile&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1469         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;RefFileName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
 1470     <span class="k">else</span><span class="p">:</span>
 1471         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;RefFileName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--alignRefFile&quot;</span><span class="p">]</span>
 1472     
 1473     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Overwrite&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--overwrite&quot;</span><span class="p">]</span>
 1474     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMLOut&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Yes$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--PMLOut&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1475     
 1476     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Outfile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--outfile&quot;</span><span class="p">]</span>
 1477     <span class="n">FileDir</span><span class="p">,</span> <span class="n">FileName</span><span class="p">,</span> <span class="n">FileExt</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ParseFileName</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Outfile&quot;</span><span class="p">])</span>
 1478     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PSEOut&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span> 
 1479     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^pml$&quot;</span><span class="p">,</span> <span class="n">FileExt</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1480         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMLOutfile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Outfile&quot;</span><span class="p">]</span> 
 1481         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMEOutfile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;.pml$&quot;</span><span class="p">,</span> <span class="s2">&quot;.pme&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Outfile&quot;</span><span class="p">])</span> 
 1482     <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^pse$&quot;</span><span class="p">,</span> <span class="n">FileExt</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1483         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PSEOut&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span> 
 1484         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PSEOutfile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Outfile&quot;</span><span class="p">]</span> 
 1485         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMLOutfile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;.pse$&quot;</span><span class="p">,</span> <span class="s2">&quot;.pml&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Outfile&quot;</span><span class="p">])</span> 
 1486         <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMLOutfile&quot;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Overwrite&quot;</span><span class="p">]):</span>
 1487             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The intermediate output file to be generated, </span><span class="si">%s</span><span class="s2">, already exist. Use option </span><span class="se">\&quot;</span><span class="s2">--ov</span><span class="se">\&quot;</span><span class="s2"> or </span><span class="se">\&quot;</span><span class="s2">--overwrite</span><span class="se">\&quot;</span><span class="s2"> and try again.&quot;</span> <span class="o">%</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMLOutfile&quot;</span><span class="p">]</span> <span class="p">)</span>
 1488 
 1489     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;LabelFontID&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--labelFontID&quot;</span><span class="p">])</span>
 1490     
 1491     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketContactsLigandColor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketContactsLigandColor&quot;</span><span class="p">]</span>
 1492     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketContactsLigandHydrophobicColor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketContactsLigandHydrophobicColor&quot;</span><span class="p">]</span>
 1493     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketContactsSolventColor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketContactsSolventColor&quot;</span><span class="p">]</span>
 1494     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketContactsInorganicColor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketContactsInorganicColor&quot;</span><span class="p">]</span>
 1495 
 1496     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketContactsCutoff&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketContactsCutoff&quot;</span><span class="p">])</span>
 1497     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketDistanceCutoff&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketDistanceCutoff&quot;</span><span class="p">])</span>
 1498     
 1499     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketLabelColor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketLabelColor&quot;</span><span class="p">]</span>
 1500     
 1501     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketResidueTypes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketResidueTypes&quot;</span><span class="p">]</span>
 1502     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketSurface&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketSurface&quot;</span><span class="p">]</span>
 1503     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketSurfaceElectrostatics&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketSurfaceElectrostatics&quot;</span><span class="p">]</span>
 1504     
 1505     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesChain&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--residueTypesChain&quot;</span><span class="p">]</span>
 1506     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--residueTypes&quot;</span><span class="p">]</span>
 1507     <span class="n">ProcessResidueTypes</span><span class="p">()</span>
 1508 
 1509     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SelectionsChain&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--selectionsChain&quot;</span><span class="p">]</span>
 1510     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SelectionsChainSurface&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--selectionsChainSurface&quot;</span><span class="p">]</span>
 1511     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SelectionsChainStyle&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--selectionsChainStyle&quot;</span><span class="p">]</span>
 1512     <span class="n">ProcessChainSelections</span><span class="p">()</span>
 1513     
 1514     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChain&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceChain&quot;</span><span class="p">]</span>
 1515     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChainElectrostatics&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceChainElectrostatics&quot;</span><span class="p">]</span>
 1516     
 1517     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChainComplex&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Yes$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceChainComplex&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1518     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceComplex&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Yes$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceComplex&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1519     
 1520     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceColor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceColor&quot;</span><span class="p">]</span>
 1521     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceColorPalette&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceColorPalette&quot;</span><span class="p">]</span>
 1522     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceAtomTypesColors&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceAtomTypesColors&quot;</span><span class="p">]</span>
 1523     <span class="n">ProcessSurfaceAtomTypesColors</span><span class="p">()</span>
 1524     
 1525     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceTransparency&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceTransparency&quot;</span><span class="p">])</span>
 1526     
 1527     <span class="n">RetrieveInfilesInfo</span><span class="p">()</span>
 1528     <span class="n">RetrieveRefFileInfo</span><span class="p">()</span>
 1529     
 1530     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--chainIDs&quot;</span><span class="p">]</span>
 1531     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--ligandIDs&quot;</span><span class="p">]</span>
 1532     
 1533     <span class="n">ProcessChainAndLigandIDs</span><span class="p">()</span>
 1534 
 1535 <span class="k">def</span> <span class="nf">RetrieveOptions</span><span class="p">():</span> 
 1536     <span class="sd">&quot;&quot;&quot;Retrieve command line arguments and options&quot;&quot;&quot;</span>
 1537     
 1538     <span class="c1"># Get options...</span>
 1539     <span class="k">global</span> <span class="n">Options</span>
 1540     <span class="n">Options</span> <span class="o">=</span> <span class="n">docopt</span><span class="p">(</span><span class="n">_docoptUsage_</span><span class="p">)</span>
 1541 
 1542     <span class="c1"># Set current working directory to the specified directory...</span>
 1543     <span class="n">WorkingDir</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--workingdir&quot;</span><span class="p">]</span>
 1544     <span class="k">if</span> <span class="n">WorkingDir</span><span class="p">:</span>
 1545         <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">WorkingDir</span><span class="p">)</span>
 1546     
 1547     <span class="c1"># Handle examples option...</span>
 1548     <span class="k">if</span> <span class="s2">&quot;--examples&quot;</span> <span class="ow">in</span> <span class="n">Options</span> <span class="ow">and</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--examples&quot;</span><span class="p">]:</span>
 1549         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="n">MiscUtil</span><span class="o">.</span><span class="n">GetExamplesTextFromDocOptText</span><span class="p">(</span><span class="n">_docoptUsage_</span><span class="p">))</span>
 1550         <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
 1551 
 1552 <span class="k">def</span> <span class="nf">ValidateOptions</span><span class="p">():</span>
 1553     <span class="sd">&quot;&quot;&quot;Validate option values&quot;&quot;&quot;</span>
 1554     
 1555     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--align&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--align&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
 1556     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--alignMethod&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--alignMethod&quot;</span><span class="p">],</span> <span class="s2">&quot;align cealign super&quot;</span><span class="p">)</span>
 1557     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--alignMode&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--alignMode&quot;</span><span class="p">],</span> <span class="s2">&quot;FirstChain Complex&quot;</span><span class="p">)</span>
 1558     
 1559     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--allowEmptyObjects&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--allowEmptyObjects&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
 1560 
 1561     <span class="c1"># Expand infiles to handle presence of multiple input files...</span>
 1562     <span class="n">InfileNames</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ExpandFileNames</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--infiles&quot;</span><span class="p">],</span> <span class="s2">&quot;,&quot;</span><span class="p">)</span>
 1563     <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">InfileNames</span><span class="p">):</span>
 1564         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;No input files specified for </span><span class="se">\&quot;</span><span class="s2">-i, --infiles</span><span class="se">\&quot;</span><span class="s2"> option&quot;</span><span class="p">)</span>
 1565 
 1566     <span class="c1"># Validate file extensions...</span>
 1567     <span class="k">for</span> <span class="n">Infile</span> <span class="ow">in</span> <span class="n">InfileNames</span><span class="p">:</span>
 1568         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFilePath</span><span class="p">(</span><span class="s2">&quot;-i, --infiles&quot;</span><span class="p">,</span> <span class="n">Infile</span><span class="p">)</span>
 1569         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFileExt</span><span class="p">(</span><span class="s2">&quot;-i, --infiles&quot;</span><span class="p">,</span> <span class="n">Infile</span><span class="p">,</span> <span class="s2">&quot;pdb cif&quot;</span><span class="p">)</span>
 1570         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionsDistinctFileNames</span><span class="p">(</span><span class="s2">&quot;-i, --infiles&quot;</span><span class="p">,</span> <span class="n">Infile</span><span class="p">,</span> <span class="s2">&quot;-o, --outfile&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--outfile&quot;</span><span class="p">])</span>
 1571     <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--infileNames&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">InfileNames</span>
 1572     
 1573     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFileExt</span><span class="p">(</span><span class="s2">&quot;-o, --outfile&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--outfile&quot;</span><span class="p">],</span> <span class="s2">&quot;pml pse&quot;</span><span class="p">)</span>
 1574     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionsOutputFileOverwrite</span><span class="p">(</span><span class="s2">&quot;-o, --outfile&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--outfile&quot;</span><span class="p">],</span> <span class="s2">&quot;--overwrite&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--overwrite&quot;</span><span class="p">])</span>
 1575 
 1576     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^yes$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--align&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1577         <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^FirstInputFile$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--alignRefFile&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1578             <span class="n">AlignRefFile</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--alignRefFile&quot;</span><span class="p">]</span>
 1579             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFilePath</span><span class="p">(</span><span class="s2">&quot;--alignRefFile&quot;</span><span class="p">,</span> <span class="n">AlignRefFile</span><span class="p">)</span>
 1580             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFileExt</span><span class="p">(</span><span class="s2">&quot;--alignRefFile&quot;</span><span class="p">,</span> <span class="n">AlignRefFile</span><span class="p">,</span> <span class="s2">&quot;pdb cif&quot;</span><span class="p">)</span>
 1581             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionsDistinctFileNames</span><span class="p">(</span><span class="s2">&quot;--AlignRefFile&quot;</span><span class="p">,</span> <span class="n">AlignRefFile</span><span class="p">,</span> <span class="s2">&quot;-o, --outfile&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--outfile&quot;</span><span class="p">])</span>
 1582     
 1583     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--PMLOut&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--PMLOut&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
 1584     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionIntegerValue</span><span class="p">(</span><span class="s2">&quot;--labelFontID&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--labelFontID&quot;</span><span class="p">],</span> <span class="p">{})</span>
 1585 
 1586     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFloatValue</span><span class="p">(</span><span class="s2">&quot;--pocketContactsCutoff&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketContactsCutoff&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s2">&quot;&gt;&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">})</span>
 1587     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFloatValue</span><span class="p">(</span><span class="s2">&quot;--pocketDistanceCutoff&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketDistanceCutoff&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s2">&quot;&gt;&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">})</span>
 1588     <span class="k">if</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketContactsCutoff&quot;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="nb">float</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketDistanceCutoff&quot;</span><span class="p">])):</span>
 1589         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The value, </span><span class="si">%s</span><span class="s2">, specified using option </span><span class="se">\&quot;</span><span class="s2">--pocketContactsCutoff</span><span class="se">\&quot;</span><span class="s2"> must be less than value, </span><span class="si">%s</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="s2">-pocketDistanceCutoff</span><span class="se">\&quot;</span><span class="s2"> option.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketContactsCutoff&quot;</span><span class="p">],</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketDistanceCutoff&quot;</span><span class="p">]))</span>
 1590         
 1591     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--pocketResidueTypes&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketResidueTypes&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no auto&quot;</span><span class="p">)</span>
 1592     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--pocketSurface&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketSurface&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no auto&quot;</span><span class="p">)</span>
 1593     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--pocketSurfaceElectrostatics&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketSurfaceElectrostatics&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no auto&quot;</span><span class="p">)</span>
 1594     
 1595     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--residueTypesChain&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--residueTypesChain&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no auto&quot;</span><span class="p">)</span>
 1596     
 1597     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--surfaceComplex&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceComplex&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
 1598     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--surfaceChainComplex&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceChainComplex&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
 1599     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--surfaceChain&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceChain&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no auto&quot;</span><span class="p">)</span>
 1600     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--surfaceChainElectrostatics&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceChainElectrostatics&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no auto&quot;</span><span class="p">)</span>
 1601     
 1602     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--surfaceColorPalette&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceColorPalette&quot;</span><span class="p">],</span> <span class="s2">&quot;RedToWhite WhiteToGreen&quot;</span><span class="p">)</span>
 1603     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFloatValue</span><span class="p">(</span><span class="s2">&quot;--surfaceTransparency&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceTransparency&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s2">&quot;&gt;=&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s2">&quot;&lt;=&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">})</span>
 1604     
 1605 <span class="c1"># Setup a usage string for docopt...</span>
 1606 <span class="n">_docoptUsage_</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
 1607 <span class="s2">PyMOLVisualizeMacromolecules.py - Visualize macromolecules</span>
 1608 
 1609 <span class="s2">Usage:</span>
 1610 <span class="s2">    PyMOLVisualizeMacromolecules.py [--align &lt;yes or no&gt;] [--alignMethod &lt;align, cealign, super&gt;]</span>
 1611 <span class="s2">                                    [--alignMode &lt;FirstChain or Complex&gt;] [--alignRefFile &lt;filename&gt;]</span>
 1612 <span class="s2">                                    [--allowEmptyObjects &lt;yes or no&gt;] [--chainIDs &lt;First, All or ID1,ID2...&gt;]</span>
 1613 <span class="s2">                                    [--ligandIDs &lt;Largest, All or ID1,ID2...&gt;] [--labelFontID &lt;number&gt;]</span>
 1614 <span class="s2">                                    [--PMLOut &lt;yes or no&gt;] [--pocketContactsInorganicColor &lt;text&gt;]</span>
 1615 <span class="s2">                                    [--pocketContactsLigandColor &lt;text&gt;] [--pocketContactsLigandHydrophobicColor &lt;text&gt;]</span>
 1616 <span class="s2">                                    [--pocketContactsSolventColor &lt;text&gt;] [--pocketContactsCutoff &lt;number&gt;]</span>
 1617 <span class="s2">                                    [--pocketDistanceCutoff &lt;number&gt;] [--pocketLabelColor &lt;text&gt;] [--pocketResidueTypes &lt;yes or no&gt;]</span>
 1618 <span class="s2">                                    [--pocketSurface &lt;yes or no&gt;] [--pocketSurfaceElectrostatics &lt;yes or no&gt;]</span>
 1619 <span class="s2">                                    [--residueTypes &lt;Type,Color,ResNames,...&gt;] [--residueTypesChain &lt;yes or no&gt;]</span>
 1620 <span class="s2">                                    [--selectionsChain &lt;ObjectName,SelectionSpec,...&gt;] [--selectionsChainSurface &lt;yes or no&gt;]</span>
 1621 <span class="s2">                                    [--selectionsChainStyle &lt;DisplayStyle&gt;] [--surfaceChain &lt;yes or no&gt;] [--surfaceChainElectrostatics &lt;yes or no&gt;]</span>
 1622 <span class="s2">                                    [--surfaceChainComplex &lt;yes or no&gt;] [--surfaceComplex &lt;yes or no&gt;]</span>
 1623 <span class="s2">                                    [--surfaceColor &lt;ColorName&gt;] [--surfaceColorPalette &lt;RedToWhite or WhiteToGreen&gt;]</span>
 1624 <span class="s2">                                    [--surfaceAtomTypesColors &lt;ColorType,ColorSpec,...&gt;]</span>
 1625 <span class="s2">                                    [--surfaceTransparency &lt;number&gt;] [--overwrite] [-w &lt;dir&gt;] -i &lt;infile1,infile2,infile3...&gt; -o &lt;outfile&gt;</span>
 1626 <span class="s2">    PyMOLVisualizeMacromolecules.py -h | --help | -e | --examples</span>
 1627 
 1628 <span class="s2">Description:</span>
 1629 <span class="s2">    Generate PyMOL visualization files for viewing surfaces, chains, ligands, ligand</span>
 1630 <span class="s2">    binding pockets, and interactions between ligands and binding pockets in</span>
 1631 <span class="s2">    macromolecules including proteins and nucleic acids.</span>
 1632 
 1633 <span class="s2">    The supported input file format are: PDB (.pdb), CIF (.cif)</span>
 1634 
 1635 <span class="s2">    The supported output file formats are: PyMOL script file (.pml), PyMOL session</span>
 1636 <span class="s2">    file (.pse)</span>
 1637 
 1638 <span class="s2">    A variety of PyMOL groups and objects may be  created for visualization of</span>
 1639 <span class="s2">    macromolecules. These groups and objects correspond to complexes, surfaces,</span>
 1640 <span class="s2">    chains, ligands, inorganics, ligand binding pockets, pocket, polar interactions,</span>
 1641 <span class="s2">    and pocket hydrophobic surfaces. A complete hierarchy of all possible PyMOL</span>
 1642 <span class="s2">    groups and objects is shown below:</span>
 1643 <span class="s2">    </span>
 1644 <span class="s2">        &lt;PDBFileRoot&gt;</span>
 1645 <span class="s2">            .Complex</span>
 1646 <span class="s2">                .Complex</span>
 1647 <span class="s2">                .Surface</span>
 1648 <span class="s2">            .Chain&lt;ID&gt;</span>
 1649 <span class="s2">                .Complex</span>
 1650 <span class="s2">                    .Complex</span>
 1651 <span class="s2">                    .Surface</span>
 1652 <span class="s2">                .Chain</span>
 1653 <span class="s2">                    .Chain</span>
 1654 <span class="s2">                    .Selections</span>
 1655 <span class="s2">                        .&lt;Name1&gt;</span>
 1656 <span class="s2">                            .Selection</span>
 1657 <span class="s2">                            .Surface</span>
 1658 <span class="s2">                                .Surface</span>
 1659 <span class="s2">                                .Hydrophobicity</span>
 1660 <span class="s2">                                .Hydrophobicity_Charge</span>
 1661 <span class="s2">                        .&lt;Name2&gt;</span>
 1662 <span class="s2">                            ... ... ..</span>
 1663 <span class="s2">                    .Residues</span>
 1664 <span class="s2">                        .Aromatic</span>
 1665 <span class="s2">                            .Residues</span>
 1666 <span class="s2">                            .Surface</span>
 1667 <span class="s2">                        .Hydrophobic</span>
 1668 <span class="s2">                            .Residues</span>
 1669 <span class="s2">                            .Surface</span>
 1670 <span class="s2">                        .Polar</span>
 1671 <span class="s2">                            .Residues</span>
 1672 <span class="s2">                            .Surface</span>
 1673 <span class="s2">                        .Positively_Charged</span>
 1674 <span class="s2">                            .Residues</span>
 1675 <span class="s2">                            .Surface</span>
 1676 <span class="s2">                        .Negatively_Charged</span>
 1677 <span class="s2">                            .Residues</span>
 1678 <span class="s2">                            .Surface</span>
 1679 <span class="s2">                        .Other</span>
 1680 <span class="s2">                            .Residues</span>
 1681 <span class="s2">                            .Surface</span>
 1682 <span class="s2">                    .Surface</span>
 1683 <span class="s2">                        .Surface</span>
 1684 <span class="s2">                        .Hydrophobicity</span>
 1685 <span class="s2">                        .Hydrophobicity_Charge</span>
 1686 <span class="s2">                        .Vacuum_Electrostatics</span>
 1687 <span class="s2">                            .Contact_Potentials</span>
 1688 <span class="s2">                            .Map</span>
 1689 <span class="s2">                            .Legend</span>
 1690 <span class="s2">                            .Volume</span>
 1691 <span class="s2">                .Solvent</span>
 1692 <span class="s2">                .Inorganic</span>
 1693 <span class="s2">                .Ligand&lt;ID&gt;</span>
 1694 <span class="s2">                    .Ligand</span>
 1695 <span class="s2">                        .Ligand</span>
 1696 <span class="s2">                        .BallAndStick</span>
 1697 <span class="s2">                    .Pocket</span>
 1698 <span class="s2">                        .Pocket</span>
 1699 <span class="s2">                        .Polar_Contacts</span>
 1700 <span class="s2">                        .Hydrophobic_Contacts</span>
 1701 <span class="s2">                        .Residues</span>
 1702 <span class="s2">                            .Aromatic</span>
 1703 <span class="s2">                                .Residues</span>
 1704 <span class="s2">                                .Surface</span>
 1705 <span class="s2">                            .Hydrophobic</span>
 1706 <span class="s2">                                .Residues</span>
 1707 <span class="s2">                                .Surface</span>
 1708 <span class="s2">                            .Polar</span>
 1709 <span class="s2">                                .Residues</span>
 1710 <span class="s2">                                .Surface</span>
 1711 <span class="s2">                            .Positively_Charged</span>
 1712 <span class="s2">                                .Residues</span>
 1713 <span class="s2">                                .Surface</span>
 1714 <span class="s2">                            .Negatively_Charged</span>
 1715 <span class="s2">                                .Residues</span>
 1716 <span class="s2">                                .Surface</span>
 1717 <span class="s2">                            .Other</span>
 1718 <span class="s2">                                .Residues</span>
 1719 <span class="s2">                                .Surface</span>
 1720 <span class="s2">                        .Surfaces</span>
 1721 <span class="s2">                            .Surface</span>
 1722 <span class="s2">                                .Surface</span>
 1723 <span class="s2">                                .Hydrophobicity</span>
 1724 <span class="s2">                                .Hydrophobicity_Charge</span>
 1725 <span class="s2">                                .Vacuum_Electrostatics</span>
 1726 <span class="s2">                                    .Contact_Potentials</span>
 1727 <span class="s2">                                    .Map</span>
 1728 <span class="s2">                                    .Legend</span>
 1729 <span class="s2">                            .Cavity</span>
 1730 <span class="s2">                                .Surface</span>
 1731 <span class="s2">                                .Hydrophobicity</span>
 1732 <span class="s2">                                .Hydrophobicity_Charge</span>
 1733 <span class="s2">                                .Vacuum_Electrostatics</span>
 1734 <span class="s2">                                    .Contact_Potentials</span>
 1735 <span class="s2">                                    .Map</span>
 1736 <span class="s2">                                    .Legend</span>
 1737 <span class="s2">                    .Pocket_Solvent</span>
 1738 <span class="s2">                        .Pocket_Solvent</span>
 1739 <span class="s2">                        .Polar_Contacts</span>
 1740 <span class="s2">                    .Pocket_Inorganic</span>
 1741 <span class="s2">                        .Pocket_Inorganic</span>
 1742 <span class="s2">                        .Polar_Contacts</span>
 1743 <span class="s2">                .Ligand&lt;ID&gt;</span>
 1744 <span class="s2">                    .Ligand</span>
 1745 <span class="s2">                        ... ... ...</span>
 1746 <span class="s2">                    .Pocket</span>
 1747 <span class="s2">                        ... ... ...</span>
 1748 <span class="s2">                    .Pocket_Solvent</span>
 1749 <span class="s2">                        ... ... ...</span>
 1750 <span class="s2">                    .Pocket_Inorganic</span>
 1751 <span class="s2">                        ... ... ...</span>
 1752 <span class="s2">            .Chain&lt;ID&gt;</span>
 1753 <span class="s2">                ... ... ...</span>
 1754 <span class="s2">                .Ligand&lt;ID&gt;</span>
 1755 <span class="s2">                    ... ... ...</span>
 1756 <span class="s2">                .Ligand&lt;ID&gt;</span>
 1757 <span class="s2">                    ... ... ...</span>
 1758 <span class="s2">            .Chain&lt;ID&gt;</span>
 1759 <span class="s2">                ... ... ...</span>
 1760 <span class="s2">        &lt;PDBFileRoot&gt;</span>
 1761 <span class="s2">            .Complex</span>
 1762 <span class="s2">                ... ... ...</span>
 1763 <span class="s2">            .Chain&lt;ID&gt;</span>
 1764 <span class="s2">                ... ... ...</span>
 1765 <span class="s2">                .Ligand&lt;ID&gt;</span>
 1766 <span class="s2">                    ... ... ...</span>
 1767 <span class="s2">                .Ligand&lt;ID&gt;</span>
 1768 <span class="s2">                    ... ... ...</span>
 1769 <span class="s2">            .Chain&lt;ID&gt;</span>
 1770 <span class="s2">                ... ... ...</span>
 1771 <span class="s2">    </span>
 1772 <span class="s2">    The hydrophobic and electrostatic surfaces are not created for complete complex</span>
 1773 <span class="s2">    and chain complex in input file(s) by default. A word to the wise: The creation of</span>
 1774 <span class="s2">    surface objects may slow down loading of PML file and generation of PSE file, based</span>
 1775 <span class="s2">    on the size of input complexes. The generation of PSE file may also fail.</span>
 1776 
 1777 <span class="s2">Options:</span>
 1778 <span class="s2">    -a, --align &lt;yes or no&gt;  [default: no]</span>
 1779 <span class="s2">        Align input files to a reference file before visualization.</span>
 1780 <span class="s2">    --alignMethod &lt;align, cealign, super&gt;  [default: super]</span>
 1781 <span class="s2">        Alignment methodology to use for aligning input files to a</span>
 1782 <span class="s2">        reference file.</span>
 1783 <span class="s2">    --alignMode &lt;FirstChain or Complex&gt;  [default: FirstChain]</span>
 1784 <span class="s2">        Portion of input and reference files to use for spatial alignment of</span>
 1785 <span class="s2">        input files against reference file.  Possible values: FirstChain or</span>
 1786 <span class="s2">        Complex.</span>
 1787 <span class="s2">        </span>
 1788 <span class="s2">        The FirstChain mode allows alignment of the first chain in each input</span>
 1789 <span class="s2">        file to the first chain in the reference file along with moving the rest</span>
 1790 <span class="s2">        of the complex to coordinate space of the reference file. The complete</span>
 1791 <span class="s2">        complex in each input file is aligned to the complete complex in reference</span>
 1792 <span class="s2">        file for the Complex mode.</span>
 1793 <span class="s2">    --alignRefFile &lt;filename&gt;  [default: FirstInputFile]</span>
 1794 <span class="s2">        Reference input file name. The default is to use the first input file</span>
 1795 <span class="s2">        name specified using &#39;-i, --infiles&#39; option.</span>
 1796 <span class="s2">    --allowEmptyObjects &lt;yes or no&gt;  [default: no]</span>
 1797 <span class="s2">        Allow creation of empty PyMOL objects corresponding to solvent and</span>
 1798 <span class="s2">        inorganic atom selections across chains and ligands in input file(s). By</span>
 1799 <span class="s2">        default, the empty objects are marked for deletion.</span>
 1800 <span class="s2">    -c, --chainIDs &lt;First, All or ID1,ID2...&gt;  [default: First]</span>
 1801 <span class="s2">        List of chain IDs to use for visualizing macromolecules. Possible values:</span>
 1802 <span class="s2">        First, All, or a comma delimited list of chain IDs. The default is to use the</span>
 1803 <span class="s2">        chain ID for the first chain in each input file.</span>
 1804 <span class="s2">    -e, --examples</span>
 1805 <span class="s2">        Print examples.</span>
 1806 <span class="s2">    -h, --help</span>
 1807 <span class="s2">        Print this help message.</span>
 1808 <span class="s2">    -i, --infiles &lt;infile1,infile2,infile3...&gt;</span>
 1809 <span class="s2">        Input file names.</span>
 1810 <span class="s2">    -l, --ligandIDs &lt;Largest, All or ID1,ID2...&gt;  [default: Largest]</span>
 1811 <span class="s2">        List of ligand IDs present in chains for visualizing macromolecules to</span>
 1812 <span class="s2">        highlight ligand interactions. Possible values: Largest, All, or a comma</span>
 1813 <span class="s2">        delimited list of ligand IDs. The default is to use the largest ligand present</span>
 1814 <span class="s2">        in all or specified chains in each input file.</span>
 1815 <span class="s2">        </span>
 1816 <span class="s2">        Ligands are identified using organic selection operator available in PyMOL.</span>
 1817 <span class="s2">        It&#39;ll also  identify buffer molecules as ligands. The largest ligand contains</span>
 1818 <span class="s2">        the highest number of heavy atoms.</span>
 1819 <span class="s2">    --labelFontID &lt;number&gt;  [default: 7]</span>
 1820 <span class="s2">        Font ID for drawing labels. Default: 7 (Sans Bold). Valid values: 5 to 16.</span>
 1821 <span class="s2">        The specified value must be a valid PyMOL font ID. No validation is</span>
 1822 <span class="s2">        performed. The complete lists of valid font IDs is available at:</span>
 1823 <span class="s2">        pymolwiki.org/index.php/Label_font_id. Examples: 5 - Sans;</span>
 1824 <span class="s2">        7 - Sans Bold; 9 - Serif; 10 - Serif Bold.</span>
 1825 <span class="s2">    -o, --outfile &lt;outfile&gt;</span>
 1826 <span class="s2">        Output file name.</span>
 1827 <span class="s2">    -p, --PMLOut &lt;yes or no&gt;  [default: yes]</span>
 1828 <span class="s2">        Save PML file during generation of PSE file.</span>
 1829 <span class="s2">    --pocketContactsInorganicColor &lt;text&gt;  [default: deepsalmon]</span>
 1830 <span class="s2">        Color for drawing polar contacts between inorganic and pocket residues.</span>
 1831 <span class="s2">        The specified value must be valid color. No validation is performed.</span>
 1832 <span class="s2">    --pocketContactsLigandColor &lt;text&gt;  [default: orange]</span>
 1833 <span class="s2">        Color for drawing polar contacts between ligand and pocket residues.</span>
 1834 <span class="s2">        The specified value must be valid color. No validation is performed.</span>
 1835 <span class="s2">    --pocketContactsLigandHydrophobicColor &lt;text&gt;  [default: purpleblue]</span>
 1836 <span class="s2">        Color for drawing hydrophobic contacts between ligand and pocket residues.</span>
 1837 <span class="s2">        The specified value must be valid color. No validation is performed. The</span>
 1838 <span class="s2">        hydrophobic contacts are shown between pairs of carbon atoms not</span>
 1839 <span class="s2">        connected to hydrogen bond donor or acceptors atoms as identified</span>
 1840 <span class="s2">        by PyMOL.</span>
 1841 <span class="s2">    --pocketContactsSolventColor &lt;text&gt;  [default: marine]</span>
 1842 <span class="s2">        Color for drawing polar contacts between solvent and pocket residues..</span>
 1843 <span class="s2">        The specified value must be valid color. No validation is performed.</span>
 1844 <span class="s2">    --pocketContactsCutoff &lt;number&gt;  [default: 4.0]</span>
 1845 <span class="s2">        Distance in Angstroms for identifying polar and hyrdophobic contacts</span>
 1846 <span class="s2">        between atoms in pocket residues and ligands.</span>
 1847 <span class="s2">    --pocketDistanceCutoff &lt;number&gt;  [default: 5.0]</span>
 1848 <span class="s2">        Distance in Angstroms for identifying pocket residues around ligands.</span>
 1849 <span class="s2">    --pocketLabelColor &lt;text&gt;  [default: magenta]</span>
 1850 <span class="s2">        Color for drawing residue or atom level labels for a pocket. The specified</span>
 1851 <span class="s2">        value must be valid color. No validation is performed.</span>
 1852 <span class="s2">    --pocketResidueTypes &lt;yes or no&gt;  [default: auto]</span>
 1853 <span class="s2">        Pocket residue types. The residue groups are generated using residue types,</span>
 1854 <span class="s2">        colors, and names specified by &#39;--residueTypes&#39; option. It is only valid for</span>
 1855 <span class="s2">        amino acids.  By default, the residue type groups are automatically created</span>
 1856 <span class="s2">        for pockets containing amino acids and skipped for chains only containing</span>
 1857 <span class="s2">        nucleic acids.</span>
 1858 <span class="s2">    --pocketSurface &lt;yes or no&gt;  [default: auto]</span>
 1859 <span class="s2">        Surfaces around pocket residues colored by hydrophobicity alone and</span>
 1860 <span class="s2">        both hydrophobicity and charge. The hydrophobicity surface is colored</span>
 1861 <span class="s2">        at residue level using Eisenberg hydrophobicity scale for residues and color</span>
 1862 <span class="s2">        gradient specified by &#39;--surfaceColorPalette&#39; option. The  hydrophobicity and</span>
 1863 <span class="s2">        charge surface is colored [ Ref 140 ] at atom level using colors specified for</span>
 1864 <span class="s2">        groups of atoms by &#39;--surfaceAtomTypesColors&#39; option. This scheme allows</span>
 1865 <span class="s2">        simultaneous mapping of hyrophobicity and charge values on the surfaces.</span>
 1866 <span class="s2">        </span>
 1867 <span class="s2">        The cavity surfaces around ligands are also generated. These surfaces are</span>
 1868 <span class="s2">        colored by hydrophobicity along and both hydrophobicity and charge.</span>
 1869 <span class="s2">        </span>
 1870 <span class="s2">        This option is only valid for amino acids. By default, both surfaces are</span>
 1871 <span class="s2">        automatically created for pockets containing amino acids and skipped for</span>
 1872 <span class="s2">        pockets containing only nucleic acids.</span>
 1873 <span class="s2">        </span>
 1874 <span class="s2">        In addition, generic pockect and cavity surfaces colored by &#39;--surfaceColor&#39;</span>
 1875 <span class="s2">        are always created for pocket residues containing amino acids and nucleic</span>
 1876 <span class="s2">        acids.</span>
 1877 <span class="s2">    --pocketSurfaceElectrostatics &lt;yes or no&gt;  [default: no]</span>
 1878 <span class="s2">        Vacuum electrostatics contact potential surface around pocket residues.</span>
 1879 <span class="s2">        A word to the wise from PyMOL documentation: The computed protein</span>
 1880 <span class="s2">        contact potentials are only qualitatively useful, due to short cutoffs,</span>
 1881 <span class="s2">        truncation, and lack of solvent &quot;screening&quot;.</span>
 1882 <span class="s2">        </span>
 1883 <span class="s2">        The cavity surface around ligands is also generated. This surface is</span>
 1884 <span class="s2">        colored by vacuum electrostatics contact potential.</span>
 1885 <span class="s2">        </span>
 1886 <span class="s2">        This option is only valid for amino acids. By default, the electrostatics surface</span>
 1887 <span class="s2">        is automatically created for chains containing amino acids and skipped for chains</span>
 1888 <span class="s2">        containing only nucleic acids.</span>
 1889 <span class="s2">    -r, --residueTypes &lt;Type,Color,ResNames,...&gt;  [default: auto]</span>
 1890 <span class="s2">        Residue types, colors, and names to generate for residue groups during</span>
 1891 <span class="s2">        &#39;--pocketResidueTypes&#39; and &#39;--residueTypesChain&#39; option. It is only</span>
 1892 <span class="s2">        valid for amino acids.</span>
 1893 <span class="s2">        </span>
 1894 <span class="s2">        It is a triplet of comma delimited list of amino acid residues type, residues</span>
 1895 <span class="s2">        color, and a space delimited list three letter residue names. </span>
 1896 <span class="s2">        </span>
 1897 <span class="s2">        The default values for residue type, color, and name triplets  are shown</span>
 1898 <span class="s2">        below:</span>
 1899 <span class="s2">            </span>
 1900 <span class="s2">            Aromatic,brightorange,HIS PHE TRP TYR,</span>
 1901 <span class="s2">            Hydrophobic,orange,ALA GLY VAL LEU ILE PRO MET,</span>
 1902 <span class="s2">            Polar,palegreen,ASN GLN SER THR CYS,</span>
 1903 <span class="s2">            Positively_Charged,marine,ARG LYS,</span>
 1904 <span class="s2">            Negatively_Charged,red,ASP GLU</span>
 1905 <span class="s2">            </span>
 1906 <span class="s2">        The color name must be a valid PyMOL name. No validation is performed.</span>
 1907 <span class="s2">        An amino acid name may appear across multiple residue types. All other</span>
 1908 <span class="s2">        residues are grouped under &#39;Other&#39;.</span>
 1909 <span class="s2">    --residueTypesChain &lt;yes or no&gt;  [default: auto]</span>
 1910 <span class="s2">        Chain residue types. The residue groups are generated using residue types,</span>
 1911 <span class="s2">        colors, and names specified by &#39;--residueTypes&#39; option. It is only valid for</span>
 1912 <span class="s2">        amino acids.  By default, the residue type groups are automatically created</span>
 1913 <span class="s2">        for chains containing amino acids and skipped for chains only containing</span>
 1914 <span class="s2">        nucleic acids.</span>
 1915 <span class="s2">    --selectionsChain &lt;ObjectName,SelectionSpec,...&gt;  [default: None]</span>
 1916 <span class="s2">        Custom selections for chains. It is a pairwise list of comma delimited values</span>
 1917 <span class="s2">        corresponding to PyMOL object names and selection specifications.  The</span>
 1918 <span class="s2">        selection specification must be a valid PyMOL specification. No validation is</span>
 1919 <span class="s2">        performed.</span>
 1920 <span class="s2">        </span>
 1921 <span class="s2">        The PyMOL objects are created for each chain corresponding to the</span>
 1922 <span class="s2">        specified selections. The display style for PyMOL objects is set using</span>
 1923 <span class="s2">        value of &#39;--selectionsChainStyle&#39; option.</span>
 1924 <span class="s2">        </span>
 1925 <span class="s2">        The specified selection specification is automatically appended to appropriate</span>
 1926 <span class="s2">        chain specification before creating PyMOL objects.</span>
 1927 <span class="s2">        </span>
 1928 <span class="s2">        For example, the following specification for &#39;--selectionsChain&#39; option will</span>
 1929 <span class="s2">        generate PyMOL objects for chains containing Cysteines and Serines:</span>
 1930 <span class="s2">            </span>
 1931 <span class="s2">            Cysteines,resn CYS,Serines,resn SER</span>
 1932 <span class="s2">            </span>
 1933 <span class="s2">    --selectionsChainSurface &lt;yes or no&gt;  [default: auto]</span>
 1934 <span class="s2">        Surfaces around individual chain selections colored by hydrophobicity alone</span>
 1935 <span class="s2">        and both hydrophobicity and charge. This option is similar to &#39;--surafceChain&#39;</span>
 1936 <span class="s2">        options for creating surfaces for chain. Additional details are available in the</span>
 1937 <span class="s2">        documentation section for &#39;--surfaceChain&#39; options.</span>
 1938 <span class="s2">    --selectionsChainStyle &lt;DisplayStyle&gt;  [default: sticks]</span>
 1939 <span class="s2">        Display style for PyMOL objects created for &#39;--selectionsChain&#39; option. It</span>
 1940 <span class="s2">        must be a valid PyMOL display style. No validation is performed.</span>
 1941 <span class="s2">    --surfaceChain &lt;yes or no&gt;  [default: auto]</span>
 1942 <span class="s2">        Surfaces around individual chain colored by hydrophobicity alone and</span>
 1943 <span class="s2">        both hydrophobicity and charge. The hydrophobicity surface is colored</span>
 1944 <span class="s2">        at residue level using Eisenberg hydrophobicity scale for residues and color</span>
 1945 <span class="s2">        gradient specified by &#39;--surfaceColorPalette&#39; option. The  hydrophobicity and</span>
 1946 <span class="s2">        charge surface is colored [ Ref 140 ] at atom level using colors specified for</span>
 1947 <span class="s2">        groups of atoms by &#39;--surfaceAtomTypesColors&#39; option. This scheme allows</span>
 1948 <span class="s2">        simultaneous mapping of hyrophobicity and charge values on the surfaces.</span>
 1949 <span class="s2">        </span>
 1950 <span class="s2">        This option is only valid for amino acids. By default, both surfaces are</span>
 1951 <span class="s2">        automatically created for chains containing amino acids and skipped for</span>
 1952 <span class="s2">        chains containing only nucleic acids.</span>
 1953 <span class="s2">        </span>
 1954 <span class="s2">        In addition, generic surfaces colored by &#39;--surfaceColor&#39; are always created</span>
 1955 <span class="s2">        for chain residues containing amino acids and nucleic acids.</span>
 1956 <span class="s2">    --surfaceChainElectrostatics &lt;yes or no&gt;  [default: no]</span>
 1957 <span class="s2">        Vacuum electrostatics contact potential surface and volume around individual</span>
 1958 <span class="s2">        chain. A word to the wise from PyMOL documentation: The computed protein</span>
 1959 <span class="s2">        contact potentials are only qualitatively useful, due to short cutoffs,</span>
 1960 <span class="s2">        truncation, and lack of solvent &quot;screening&quot;.</span>
 1961 <span class="s2">        </span>
 1962 <span class="s2">        This option is only valid for amino acids. By default, the electrostatics surface</span>
 1963 <span class="s2">        and volume are automatically created for chains containing amino acids and</span>
 1964 <span class="s2">        skipped for chains containing only nucleic acids.</span>
 1965 <span class="s2">    --surfaceChainComplex &lt;yes or no&gt;  [default: no]</span>
 1966 <span class="s2">        Hydrophobic surface around chain complex. The  surface is colored by</span>
 1967 <span class="s2">        hydrophobicity. It is only valid for amino acids.</span>
 1968 <span class="s2">    --surfaceComplex &lt;yes or no&gt;  [default: no]</span>
 1969 <span class="s2">        Hydrophobic surface around complete complex. The  surface is colored by</span>
 1970 <span class="s2">        hydrophobicity. It is only valid for amino acids.</span>
 1971 <span class="s2">    --surfaceAtomTypesColors &lt;ColorType,ColorSpec,...&gt;  [default: auto]</span>
 1972 <span class="s2">        Atom colors for generating surfaces colored by hyrophobicity and charge</span>
 1973 <span class="s2">        around chains and pockets in proteins. It&#39;s a pairwise comma delimited list</span>
 1974 <span class="s2">        of atom color type and color specification for goups of atoms.</span>
 1975 <span class="s2">        </span>
 1976 <span class="s2">        The default values for color types [ Ref 140 ] along wth color specifications</span>
 1977 <span class="s2">        are shown below: </span>
 1978 <span class="s2">            </span>
 1979 <span class="s2">            HydrophobicAtomsColor, yellow,</span>
 1980 <span class="s2">            NegativelyChargedAtomsColor, red,</span>
 1981 <span class="s2">            PositivelyChargedAtomsColor, blue,</span>
 1982 <span class="s2">            OtherAtomsColor, gray90</span>
 1983 <span class="s2">            </span>
 1984 <span class="s2">        The color names must be valid PyMOL names.</span>
 1985 <span class="s2">        </span>
 1986 <span class="s2">        The color values may also be specified as space delimited RGB triplets:</span>
 1987 <span class="s2">             </span>
 1988 <span class="s2">            HydrophobicAtomsColor, 0.95 0.78 0.0,</span>
 1989 <span class="s2">            NegativelyChargedAtomsColor, 1.0 0.4 0.4,</span>
 1990 <span class="s2">            PositivelyChargedAtomsColor, 0.2 0.5 0.8,</span>
 1991 <span class="s2">            OtherAtomsColor, 0.95 0.95 0.95</span>
 1992 <span class="s2">            </span>
 1993 <span class="s2">    --surfaceColor &lt;ColorName&gt;  [default: lightblue]</span>
 1994 <span class="s2">        Color name for surfaces around chains and pockets. This color is not used</span>
 1995 <span class="s2">        for surfaces colored by hydrophobicity and charge. The color name must be</span>
 1996 <span class="s2">        a valid PyMOL name.</span>
 1997 <span class="s2">    --surfaceColorPalette &lt;RedToWhite or WhiteToGreen&gt;  [default: RedToWhite]</span>
 1998 <span class="s2">        Color palette for hydrophobic surfaces around chains and pockets in proteins.</span>
 1999 <span class="s2">        Possible values: RedToWhite or WhiteToGreen from most hydrophobic amino</span>
 2000 <span class="s2">        acid to least hydrophobic. The colors values for amino acids are taken from</span>
 2001 <span class="s2">        color_h script available as part of the Script Library at PyMOL Wiki.</span>
 2002 <span class="s2">    --surfaceTransparency &lt;number&gt;  [default: 0.25]</span>
 2003 <span class="s2">        Surface transparency for molecular surfaces.</span>
 2004 <span class="s2">    --overwrite</span>
 2005 <span class="s2">        Overwrite existing files.</span>
 2006 <span class="s2">    -w, --workingdir &lt;dir&gt;</span>
 2007 <span class="s2">        Location of working directory which defaults to the current directory.</span>
 2008 
 2009 <span class="s2">Examples:</span>
 2010 <span class="s2">    To visualize the first chain, the largest ligand in the first chain, and ligand</span>
 2011 <span class="s2">    binding pockets to highlight ligand interaction with pocket resiudes, solvents</span>
 2012 <span class="s2">    and inorganics, in a PDB file, and generate a PML file, type:</span>
 2013 
 2014 <span class="s2">        % PyMOLVisualizeMacromolecules.py -i Sample4.pdb -o Sample4.pml</span>
 2015 
 2016 <span class="s2">    To visualize the first chain along with all cysteines and serines, the largest</span>
 2017 <span class="s2">    ligand in the first chain, and ligand binding pockets to highlight ligand</span>
 2018 <span class="s2">    interaction with pocket resiudes, solvents and inorganics, in a PDB file,</span>
 2019 <span class="s2">    and generate a PML file, type:</span>
 2020 
 2021 <span class="s2">        % PyMOLVisualizeMacromolecules.py -i Sample4.pdb -o Sample4.pml</span>
 2022 <span class="s2">          --selectionsChain &quot;Cysteines,resn cys,Serines,resn ser&quot;</span>
 2023 
 2024 <span class="s2">    To visualize all chains, all ligands in all chains, and all ligand binding pockets to</span>
 2025 <span class="s2">    highlight ligand interaction with pocket resiudes, solvents and inorganics, in a</span>
 2026 <span class="s2">    PDB file, and generate a PML file, type:</span>
 2027 
 2028 <span class="s2">        % PyMOLVisualizeMacromolecules.py -c All -l All -i Sample4.pdb -o</span>
 2029 <span class="s2">          Sample4.pml</span>
 2030 
 2031 <span class="s2">    To visualize all chains, ligands, and ligand binding pockets along with displaying</span>
 2032 <span class="s2">    all hydrophibic surfaces and chain electrostatic surface, in a PDB file, and</span>
 2033 <span class="s2">    generate a PML file, type:</span>
 2034 
 2035 <span class="s2">        % PyMOLVisualizeMacromolecules.py -c All -l All</span>
 2036 <span class="s2">          --surfaceChainElectrostatics yes --surfaceChainComplex yes</span>
 2037 <span class="s2">          --surfaceComplex yes -i Sample4.pdb -o Sample4.pml</span>
 2038 
 2039 <span class="s2">    To visualize chain E, ligand ADP in chain E, and ligand binding pockets to</span>
 2040 <span class="s2">    highlight ligand interaction with pocket resiudes, solvents and inorganics,</span>
 2041 <span class="s2">    in a PDB file, and generate a PML file, type:</span>
 2042 
 2043 <span class="s2">        % PyMOLVisualizeMacromolecules.py -c E -l ADP -i Sample3.pdb</span>
 2044 <span class="s2">          -o Sample3.pml</span>
 2045 
 2046 <span class="s2">    To visualize chain E, ligand ADP in chain E, and ligand binding pockets to</span>
 2047 <span class="s2">    highlight ligand interaction with pocket resiudes, solvents and inorganics,</span>
 2048 <span class="s2">    in a PDB file, and generate a PSE file, type:</span>
 2049 
 2050 <span class="s2">        % PyMOLVisualizeMacromolecules.py -c E -l ADP -i Sample3.pdb</span>
 2051 <span class="s2">          -o Sample3.pse</span>
 2052 
 2053 <span class="s2">    To visualize the first chain, the largest ligand in the first chain, and ligand</span>
 2054 <span class="s2">    binding pockets to highlight ligand interaction with pocket resiudes, solvents</span>
 2055 <span class="s2">    and inorganics, in PDB files, along with aligning first chain in each input file to</span>
 2056 <span class="s2">    the first chain in first input file, and generate a PML file, type:</span>
 2057 
 2058 <span class="s2">        % PyMOLVisualizeMacromolecules.py --align yes -i</span>
 2059 <span class="s2">          &quot;Sample5.pdb,Sample6.pdb,Sample7.pdb&quot; -o SampleOut.pml</span>
 2060 
 2061 <span class="s2">    To visualize all chains, all ligands in all chains, and all ligand binding pockets to</span>
 2062 <span class="s2">    highlight ligand interaction with pocket resiudes, solvents and inorganics, in</span>
 2063 <span class="s2">    PDB files, along with aligning first chain in each input file to the first chain in</span>
 2064 <span class="s2">    first input file, and generate a PML file, type:</span>
 2065 
 2066 <span class="s2">        % PyMOLVisualizeMacromolecules.py --align yes  -c All -l All -i</span>
 2067 <span class="s2">          &quot;Sample5.pdb,Sample6.pdb,Sample7.pdb&quot; -o SampleOut.pml</span>
 2068 
 2069 <span class="s2">    To visualize all chains, all ligands in all chains, and all ligand binding pockets to</span>
 2070 <span class="s2">    highlight ligand interaction with pocket resiudes, solvents and inorganics, in</span>
 2071 <span class="s2">    PDB files, along with aligning first chain in each input file to the first chain in a</span>
 2072 <span class="s2">    specified PDB file using a specified alignment method, and generate a PML</span>
 2073 <span class="s2">    file, type:</span>
 2074 
 2075 <span class="s2">        % PyMOLVisualizeMacromolecules.py --align yes  --alignMode FirstChain</span>
 2076 <span class="s2">          --alignRefFile Sample5.pdb --alignMethod super   -c All  -l All -i</span>
 2077 <span class="s2">          &quot;Sample5.pdb,Sample6.pdb,Sample7.pdb&quot; -o SampleOut.pml</span>
 2078 
 2079 <span class="s2">Author:</span>
 2080 <span class="s2">    Manish Sud(msud@san.rr.com)</span>
 2081 
 2082 <span class="s2">See also:</span>
 2083 <span class="s2">    DownloadPDBFiles.pl, PyMOLVisualizeCavities.py,</span>
 2084 <span class="s2">    PyMOLVisualizeCryoEMDensity.py, PyMOLVisualizeElectronDensity.py,</span>
 2085 <span class="s2">    PyMOLVisualizeInterfaces.py, PyMOLVisualizeSurfaceAndBuriedResidues.py</span>
 2086 
 2087 <span class="s2">Copyright:</span>
 2088 <span class="s2">    Copyright (C) 2020 Manish Sud. All rights reserved.</span>
 2089 
 2090 <span class="s2">    The functionality available in this script is implemented using PyMOL, a</span>
 2091 <span class="s2">    molecular visualization system on an open source foundation originally</span>
 2092 <span class="s2">    developed by Warren DeLano.</span>
 2093 
 2094 <span class="s2">    This file is part of MayaChemTools.</span>
 2095 
 2096 <span class="s2">    MayaChemTools is free software; you can redistribute it and/or modify it under</span>
 2097 <span class="s2">    the terms of the GNU Lesser General Public License as published by the Free</span>
 2098 <span class="s2">    Software Foundation; either version 3 of the License, or (at your option) any</span>
 2099 <span class="s2">    later version.</span>
 2100 
 2101 <span class="s2">&quot;&quot;&quot;</span>
 2102 
 2103 <span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
 2104     <span class="n">main</span><span class="p">()</span>
</pre>
<br />
<center>
<img src="../../../images/h2o2.png">
</center>
</body>
</html>
