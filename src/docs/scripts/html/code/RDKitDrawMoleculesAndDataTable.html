<html>
<head>
<title>MayaChemTools:Code:RDKitDrawMoleculesAndDataTable.py</title>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<link rel="stylesheet" type="text/css" href="../../../css/MayaChemToolsPythonCode.css">
</head>
<body leftmargin="20" rightmargin="20" topmargin="10" bottommargin="10">
<br/>
<center>
<a href="http://www.mayachemtools.org" title="MayaChemTools Home"><img src="../../../images/MayaChemToolsLogo.gif" border="0" alt="MayaChemTools"></a>
</center>
<br/>
<pre>
    1 <span class="ch">#!/bin/env python</span>
    2 <span class="c1">#</span>
    3 <span class="c1"># File: RDKitDrawMoleculesAndDataTable.py</span>
    4 <span class="c1"># Author: Manish Sud &lt;msud@san.rr.com&gt;</span>
    5 <span class="c1">#</span>
    6 <span class="c1"># Copyright (C) 2020 Manish Sud. All rights reserved.</span>
    7 <span class="c1">#</span>
    8 <span class="c1"># The functionality available in this script is implemented using RDKit, an</span>
    9 <span class="c1"># open source toolkit for cheminformatics developed by Greg Landrum.</span>
   10 <span class="c1">#</span>
   11 <span class="c1"># This file is part of MayaChemTools.</span>
   12 <span class="c1">#</span>
   13 <span class="c1"># MayaChemTools is free software; you can redistribute it and/or modify it under</span>
   14 <span class="c1"># the terms of the GNU Lesser General Public License as published by the Free</span>
   15 <span class="c1"># Software Foundation; either version 3 of the License, or (at your option) any</span>
   16 <span class="c1"># later version.</span>
   17 <span class="c1">#</span>
   18 <span class="c1"># MayaChemTools is distributed in the hope that it will be useful, but without</span>
   19 <span class="c1"># any warranty; without even the implied warranty of merchantability of fitness</span>
   20 <span class="c1"># for a particular purpose.  See the GNU Lesser General Public License for more</span>
   21 <span class="c1"># details.</span>
   22 <span class="c1">#</span>
   23 <span class="c1"># You should have received a copy of the GNU Lesser General Public License</span>
   24 <span class="c1"># along with MayaChemTools; if not, see &lt;http://www.gnu.org/licenses/&gt; or</span>
   25 <span class="c1"># write to the Free Software Foundation Inc., 59 Temple Place, Suite 330,</span>
   26 <span class="c1"># Boston, MA, 02111-1307, USA.</span>
   27 <span class="c1">#</span>
   28 
   29 <span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
   30 
   31 <span class="c1"># Add local python path to the global path and import standard library modules...</span>
   32 <span class="kn">import</span> <span class="nn">os</span>
   33 <span class="kn">import</span> <span class="nn">sys</span><span class="p">;</span>  <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="s2">&quot;..&quot;</span><span class="p">,</span> <span class="s2">&quot;lib&quot;</span><span class="p">,</span> <span class="s2">&quot;Python&quot;</span><span class="p">))</span>
   34 <span class="kn">import</span> <span class="nn">time</span>
   35 <span class="kn">import</span> <span class="nn">re</span>
   36 <span class="kn">import</span> <span class="nn">random</span>
   37 
   38 <span class="c1"># RDKit imports...</span>
   39 <span class="k">try</span><span class="p">:</span>
   40     <span class="kn">from</span> <span class="nn">rdkit</span> <span class="kn">import</span> <span class="n">rdBase</span>
   41     <span class="kn">from</span> <span class="nn">rdkit</span> <span class="kn">import</span> <span class="n">Chem</span>
   42     <span class="kn">from</span> <span class="nn">rdkit.Chem</span> <span class="kn">import</span> <span class="n">AllChem</span>
   43 <span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">ErrMsg</span><span class="p">:</span>
   44     <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Failed to import RDKit module/package: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ErrMsg</span><span class="p">)</span>
   45     <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Check/update your RDKit environment and try again.</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
   46     <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
   47 
   48 <span class="c1"># MayaChemTools imports...</span>
   49 <span class="k">try</span><span class="p">:</span>
   50     <span class="kn">from</span> <span class="nn">docopt</span> <span class="kn">import</span> <span class="n">docopt</span>
   51     <span class="kn">import</span> <span class="nn">MiscUtil</span>
   52     <span class="kn">import</span> <span class="nn">RDKitUtil</span>
   53 <span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">ErrMsg</span><span class="p">:</span>
   54     <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Failed to import MayaChemTools module/package: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ErrMsg</span><span class="p">)</span>
   55     <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Check/update your MayaChemTools environment and try again.</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
   56     <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
   57 
   58 <span class="n">ScriptName</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
   59 <span class="n">Options</span> <span class="o">=</span> <span class="p">{}</span>
   60 <span class="n">OptionsInfo</span> <span class="o">=</span> <span class="p">{}</span>
   61 
   62 <span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
   63     <span class="sd">&quot;&quot;&quot;Start execution of the script&quot;&quot;&quot;</span>
   64     
   65     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="s2"> (RDK v</span><span class="si">%s</span><span class="s2">; </span><span class="si">%s</span><span class="s2">): Starting...</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ScriptName</span><span class="p">,</span> <span class="n">rdBase</span><span class="o">.</span><span class="n">rdkitVersion</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">asctime</span><span class="p">()))</span>
   66     
   67     <span class="p">(</span><span class="n">WallClockTime</span><span class="p">,</span> <span class="n">ProcessorTime</span><span class="p">)</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">GetWallClockAndProcessorTime</span><span class="p">()</span>
   68     
   69     <span class="c1"># Retrieve command line arguments and options...</span>
   70     <span class="n">RetrieveOptions</span><span class="p">()</span>
   71     
   72     <span class="c1"># Process and validate command line arguments and options...</span>
   73     <span class="n">ProcessOptions</span><span class="p">()</span>
   74     
   75     <span class="c1"># Perform actions required by the script...</span>
   76     <span class="n">GenerateMoleculesAndDataTable</span><span class="p">()</span>
   77     
   78     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="s2">: Done...</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ScriptName</span><span class="p">)</span>
   79     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Total time: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">GetFormattedElapsedTime</span><span class="p">(</span><span class="n">WallClockTime</span><span class="p">,</span> <span class="n">ProcessorTime</span><span class="p">))</span>
   80 
   81 <span class="k">def</span> <span class="nf">GenerateMoleculesAndDataTable</span><span class="p">():</span>
   82     <span class="sd">&quot;&quot;&quot;Generate a HTML table containing molecules and alphanumerical data.&quot;&quot;&quot;</span>
   83     
   84     <span class="c1"># Retrieve data...</span>
   85     <span class="n">ValidMols</span> <span class="o">=</span> <span class="n">RetrieveMoleculesAndData</span><span class="p">()</span>
   86 
   87     <span class="c1"># Setup data type map...</span>
   88     <span class="n">DataMap</span> <span class="o">=</span> <span class="n">IdentifyStructureAndNumericalData</span><span class="p">(</span><span class="n">ValidMols</span><span class="p">)</span>
   89 
   90     <span class="c1"># Validate data labels used to specify highlighting data...</span>
   91     <span class="n">ValidateSpecifiedDataLabels</span><span class="p">(</span><span class="n">DataMap</span><span class="p">)</span>
   92 
   93     <span class="c1"># Validate show molecule name option...</span>
   94     <span class="n">ValidateShowMolNameOption</span><span class="p">(</span><span class="n">DataMap</span><span class="p">)</span>
   95     
   96     <span class="c1"># Compute 2D coordinates before alignment...</span>
   97     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Compute2DCoords&quot;</span><span class="p">]:</span>
   98         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Computing 2D coordinates for primary structure data...&quot;</span><span class="p">)</span>
   99         <span class="k">for</span> <span class="n">Mol</span> <span class="ow">in</span> <span class="n">ValidMols</span><span class="p">:</span>
  100             <span class="n">AllChem</span><span class="o">.</span><span class="n">Compute2DCoords</span><span class="p">(</span><span class="n">Mol</span><span class="p">)</span>
  101             
  102     <span class="c1"># Perform alignment to a common template for primary molecular structure data...</span>
  103     <span class="n">PerformAlignment</span><span class="p">(</span><span class="n">ValidMols</span><span class="p">)</span>
  104 
  105     <span class="c1"># Write out a HTML file...</span>
  106     <span class="n">WriteHTMLTableFile</span><span class="p">(</span><span class="n">ValidMols</span><span class="p">,</span> <span class="n">DataMap</span><span class="p">)</span>
  107 
  108 <span class="k">def</span> <span class="nf">WriteHTMLTableFile</span><span class="p">(</span><span class="n">ValidMols</span><span class="p">,</span> <span class="n">DataMap</span><span class="p">):</span>
  109     <span class="sd">&quot;&quot;&quot;Write out a HTML table file.&quot;&quot;&quot;</span>
  110     
  111     <span class="n">Outfile</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Outfile&quot;</span><span class="p">]</span>
  112     
  113     <span class="n">Writer</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">Outfile</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
  114     <span class="k">if</span> <span class="n">Writer</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
  115         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;Failed to setup a writer for output fie </span><span class="si">%s</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">Outfile</span><span class="p">)</span>
  116     
  117     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Generating file </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">Outfile</span><span class="p">)</span>
  118 
  119     <span class="n">WriteHTMLPageHeader</span><span class="p">(</span><span class="n">Writer</span><span class="p">,</span> <span class="n">DataMap</span><span class="p">)</span>
  120     <span class="n">WriteHTMLPageTitle</span><span class="p">(</span><span class="n">Writer</span><span class="p">)</span>
  121     
  122     <span class="n">WriteHTMLTableHeader</span><span class="p">(</span><span class="n">Writer</span><span class="p">)</span>
  123     <span class="n">WriteHTMLTableRows</span><span class="p">(</span><span class="n">Writer</span><span class="p">,</span> <span class="n">ValidMols</span><span class="p">,</span> <span class="n">DataMap</span><span class="p">)</span>
  124     <span class="n">WriteHTMLTableEnd</span><span class="p">(</span><span class="n">Writer</span><span class="p">)</span>
  125     
  126     <span class="n">WriteHTMLPageFooter</span><span class="p">(</span><span class="n">Writer</span><span class="p">)</span>
  127     <span class="n">WriteHTMLPageEnd</span><span class="p">(</span><span class="n">Writer</span><span class="p">)</span>
  128     
  129     <span class="k">if</span> <span class="n">Writer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
  130         <span class="n">Writer</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
  131 
  132 <span class="k">def</span> <span class="nf">WriteHTMLTableRows</span><span class="p">(</span><span class="n">Writer</span><span class="p">,</span> <span class="n">ValidMols</span><span class="p">,</span> <span class="n">DataMap</span><span class="p">):</span>
  133     <span class="sd">&quot;&quot;&quot;Write out HTML table rows.&quot;&quot;&quot;</span>
  134 
  135     <span class="n">WriteTableHeaderRow</span><span class="p">(</span><span class="n">Writer</span><span class="p">,</span> <span class="n">ValidMols</span><span class="p">,</span> <span class="n">DataMap</span><span class="p">)</span>
  136     <span class="n">WriteTableDataRows</span><span class="p">(</span><span class="n">Writer</span><span class="p">,</span> <span class="n">ValidMols</span><span class="p">,</span> <span class="n">DataMap</span><span class="p">)</span>
  137     <span class="n">WriteTableFooterRow</span><span class="p">(</span><span class="n">Writer</span><span class="p">,</span> <span class="n">ValidMols</span><span class="p">,</span> <span class="n">DataMap</span><span class="p">)</span>
  138 
  139 <span class="k">def</span> <span class="nf">WriteTableDataRows</span><span class="p">(</span><span class="n">Writer</span><span class="p">,</span> <span class="n">ValidMols</span><span class="p">,</span> <span class="n">DataMap</span><span class="p">):</span>
  140     <span class="sd">&quot;&quot;&quot;Write out table data row.&quot;&quot;&quot;</span>
  141 
  142     <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;        &lt;tbody&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  143     
  144     <span class="n">MolCount</span> <span class="o">=</span> <span class="mi">0</span>
  145     <span class="k">for</span> <span class="n">Mol</span> <span class="ow">in</span> <span class="n">ValidMols</span><span class="p">:</span>
  146         <span class="n">MolCount</span> <span class="o">+=</span> <span class="mi">1</span>
  147         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;          &lt;tr&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  148 
  149         <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;CounterCol&quot;</span><span class="p">]:</span>
  150             <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;            &lt;td&gt;&lt;/td&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  151             
  152         <span class="n">SetupPrimaryStructureTableData</span><span class="p">(</span><span class="n">Writer</span><span class="p">,</span> <span class="n">Mol</span><span class="p">)</span>
  153         
  154         <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ShowMolName&quot;</span><span class="p">]:</span>
  155             <span class="n">MolName</span> <span class="o">=</span> <span class="n">RDKitUtil</span><span class="o">.</span><span class="n">GetMolName</span><span class="p">(</span><span class="n">Mol</span><span class="p">,</span> <span class="n">MolCount</span><span class="p">)</span>
  156             <span class="n">WrappedMolName</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">WrapText</span><span class="p">(</span><span class="n">MolName</span><span class="p">,</span> <span class="s2">&quot;&lt;br/&gt;&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;WrapTextWidth&quot;</span><span class="p">])</span>
  157             <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;            &lt;td&gt;</span><span class="si">%s</span><span class="s2">&lt;/td&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">WrappedMolName</span><span class="p">)</span>
  158 
  159         <span class="c1"># Set up rest of the data..</span>
  160         <span class="n">AvailableDataLabelsMap</span> <span class="o">=</span> <span class="n">Mol</span><span class="o">.</span><span class="n">GetPropsAsDict</span><span class="p">(</span><span class="n">includePrivate</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">includeComputed</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
  161         <span class="k">for</span> <span class="n">DataLabel</span> <span class="ow">in</span> <span class="n">DataMap</span><span class="p">[</span><span class="s2">&quot;DataLabels&quot;</span><span class="p">]:</span>
  162             <span class="k">if</span> <span class="ow">not</span> <span class="n">DataLabel</span> <span class="ow">in</span> <span class="n">AvailableDataLabelsMap</span><span class="p">:</span>
  163                 <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;            &lt;td&gt;&lt;/td&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  164                 <span class="k">continue</span>
  165 
  166             <span class="c1"># Check for empty value...</span>
  167             <span class="n">DataValue</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">AvailableDataLabelsMap</span><span class="p">[</span><span class="n">DataLabel</span><span class="p">]</span>
  168             <span class="n">DataValue</span> <span class="o">=</span> <span class="n">DataValue</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
  169             <span class="k">if</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">IsEmpty</span><span class="p">(</span><span class="n">DataValue</span><span class="p">):</span>
  170                 <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;            &lt;td&gt;&lt;/td&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  171                 <span class="k">continue</span>
  172             
  173             <span class="k">if</span> <span class="n">DataMap</span><span class="p">[</span><span class="s2">&quot;StructureDataMap&quot;</span><span class="p">][</span><span class="n">DataLabel</span><span class="p">]:</span>
  174                 <span class="n">SetupNonPrimaryStructureTableData</span><span class="p">(</span><span class="n">Writer</span><span class="p">,</span> <span class="n">DataLabel</span><span class="p">,</span> <span class="n">DataValue</span><span class="p">,</span> <span class="n">DataMap</span><span class="p">)</span>
  175             <span class="k">else</span><span class="p">:</span>
  176                 <span class="n">SetupAlphanumericTableData</span><span class="p">(</span><span class="n">Writer</span><span class="p">,</span> <span class="n">DataLabel</span><span class="p">,</span> <span class="n">DataValue</span><span class="p">,</span> <span class="n">DataMap</span><span class="p">)</span>
  177         
  178         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;          &lt;/tr&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  179         
  180     <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;        &lt;/tbody&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  181 
  182 <span class="k">def</span> <span class="nf">SetupPrimaryStructureTableData</span><span class="p">(</span><span class="n">Writer</span><span class="p">,</span> <span class="n">Mol</span><span class="p">):</span>
  183     <span class="sd">&quot;&quot;&quot;Set up an inline SVG image for primary structure data for a table cell.&quot;&quot;&quot;</span>
  184     
  185     <span class="n">HightlightAtomList</span> <span class="o">=</span> <span class="n">SetupAtomListToHighlight</span><span class="p">(</span><span class="n">Mol</span><span class="p">,</span> <span class="s2">&quot;Structure&quot;</span><span class="p">)</span>
  186     <span class="n">SVGImageTag</span> <span class="o">=</span> <span class="n">SetupMolInLineSVGImageTag</span><span class="p">(</span><span class="n">Mol</span><span class="p">,</span> <span class="n">HightlightAtomList</span><span class="p">)</span>
  187     
  188     <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;            &lt;td bgcolor=&quot;white&quot;&gt;&lt;</span><span class="si">%s</span><span class="s2">&gt;&lt;/td&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">SVGImageTag</span><span class="p">)</span>
  189 
  190 <span class="k">def</span> <span class="nf">SetupNonPrimaryStructureTableData</span><span class="p">(</span><span class="n">Writer</span><span class="p">,</span> <span class="n">DataLabel</span><span class="p">,</span> <span class="n">DataValue</span><span class="p">,</span> <span class="n">DataMap</span><span class="p">):</span>
  191     <span class="sd">&quot;&quot;&quot;Set up an inline SVG image for non primary structure data cell.&quot;&quot;&quot;</span>
  192 
  193     <span class="n">WrappedDataValue</span> <span class="o">=</span> <span class="n">DataValue</span>
  194     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;WrapText&quot;</span><span class="p">]:</span>
  195         <span class="n">WrappedDataValue</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">WrapText</span><span class="p">(</span><span class="n">DataValue</span><span class="p">,</span> <span class="s2">&quot;&lt;br/&gt;&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;WrapTextWidth&quot;</span><span class="p">])</span>
  196 
  197     <span class="k">if</span> <span class="n">DataMap</span><span class="p">[</span><span class="s2">&quot;SMILESDataMap&quot;</span><span class="p">][</span><span class="n">DataLabel</span><span class="p">]:</span>
  198         <span class="n">Mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">DataValue</span><span class="p">,</span> <span class="n">sanitize</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
  199         <span class="n">Mol</span><span class="o">.</span><span class="n">UpdatePropertyCache</span><span class="p">(</span><span class="n">strict</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
  200     <span class="k">else</span><span class="p">:</span>
  201         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Ignoring uknown structure data column type with column label </span><span class="si">%s</span><span class="s2">: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">DataLabel</span><span class="p">,</span> <span class="n">DataValue</span><span class="p">))</span>
  202         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;            &lt;td&gt;</span><span class="si">%s</span><span class="s2">&lt;/td&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">WrappedDataValue</span><span class="p">)</span>
  203         <span class="k">return</span>
  204 
  205     <span class="k">if</span> <span class="n">Mol</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
  206         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">SMILES parsing failed for data label </span><span class="si">%s</span><span class="s2">: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">DataLabel</span><span class="p">,</span> <span class="n">DataValue</span><span class="p">))</span>
  207         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;            &lt;td&gt;</span><span class="si">%s</span><span class="s2">&lt;/td&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">WrappedDataValue</span><span class="p">)</span>
  208         <span class="k">return</span>
  209     <span class="k">elif</span>  <span class="ow">not</span> <span class="n">Mol</span><span class="o">.</span><span class="n">GetNumHeavyAtoms</span><span class="p">():</span>
  210         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;            &lt;td&gt;</span><span class="si">%s</span><span class="s2">&lt;/td&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">WrappedDataValue</span><span class="p">)</span>
  211         <span class="k">return</span>
  212     <span class="k">elif</span> <span class="n">AllChem</span><span class="o">.</span><span class="n">Compute2DCoords</span><span class="p">(</span><span class="n">Mol</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
  213         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;            &lt;td&gt;</span><span class="si">%s</span><span class="s2">&lt;/td&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">WrappedDataValue</span><span class="p">)</span>
  214         <span class="k">return</span>
  215     
  216     <span class="n">HightlightAtomList</span> <span class="o">=</span> <span class="n">SetupAtomListToHighlight</span><span class="p">(</span><span class="n">Mol</span><span class="p">,</span> <span class="n">DataLabel</span><span class="p">)</span>
  217     <span class="n">SVGImageTag</span> <span class="o">=</span> <span class="n">SetupMolInLineSVGImageTag</span><span class="p">(</span><span class="n">Mol</span><span class="p">,</span> <span class="n">HightlightAtomList</span><span class="p">)</span>
  218     
  219     <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;            &lt;td bgcolor=&quot;white&quot;&gt;&lt;</span><span class="si">%s</span><span class="s2">&gt;&lt;/td&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">SVGImageTag</span><span class="p">)</span>
  220 
  221 <span class="k">def</span> <span class="nf">SetupAlphanumericTableData</span><span class="p">(</span><span class="n">Writer</span><span class="p">,</span> <span class="n">DataLabel</span><span class="p">,</span> <span class="n">DataValue</span><span class="p">,</span> <span class="n">DataMap</span><span class="p">):</span>
  222     <span class="sd">&quot;&quot;&quot;Set up alphanumeric data.&quot;&quot;&quot;</span>
  223 
  224     <span class="n">BackgroundColor</span><span class="p">,</span> <span class="n">BackgroundColorType</span> <span class="o">=</span> <span class="n">GetAlphanumeircValueHighlightBackgroundColor</span><span class="p">(</span><span class="n">DataLabel</span><span class="p">,</span> <span class="n">DataValue</span><span class="p">,</span> <span class="n">DataMap</span><span class="p">)</span>
  225     <span class="n">SetupAlphanumericTableDataValue</span><span class="p">(</span><span class="n">Writer</span><span class="p">,</span> <span class="n">DataValue</span><span class="p">,</span> <span class="n">BackgroundColor</span><span class="p">,</span> <span class="n">BackgroundColorType</span><span class="p">)</span>
  226 
  227 <span class="k">def</span> <span class="nf">WriteTableHeaderRow</span><span class="p">(</span><span class="n">Writer</span><span class="p">,</span> <span class="n">ValidMols</span><span class="p">,</span> <span class="n">DataMap</span><span class="p">):</span>
  228     <span class="sd">&quot;&quot;&quot;Write out table header row.&quot;&quot;&quot;</span>
  229 
  230     <span class="n">TableHeaderStyle</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;TableHeaderStyle&quot;</span><span class="p">]</span>
  231     <span class="k">if</span> <span class="n">TableHeaderStyle</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
  232         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;      &lt;thead&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  233         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;        &lt;tr&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  234     <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(thead|table)&quot;</span><span class="p">,</span> <span class="n">TableHeaderStyle</span><span class="p">):</span>
  235         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;      &lt;thead class=&quot;</span><span class="si">%s</span><span class="s2">&quot;&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">TableHeaderStyle</span><span class="p">)</span>
  236         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;        &lt;tr&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  237     <span class="k">else</span><span class="p">:</span>
  238         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;      &lt;thead&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  239         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;        &lt;tr bgcolor=&quot;</span><span class="si">%s</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">TableHeaderStyle</span><span class="p">)</span>
  240 
  241     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;CounterCol&quot;</span><span class="p">]:</span>
  242         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;          &lt;th&gt;&lt;/th&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  243     <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;          &lt;th&gt;Structure&lt;/th&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  244     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ShowMolName&quot;</span><span class="p">]:</span>
  245         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;          &lt;th&gt;</span><span class="si">%s</span><span class="s2">&lt;/th&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ShowMolNameDataLabel&quot;</span><span class="p">])</span>
  246     
  247     <span class="c1"># Write out rest of the column headers...</span>
  248     <span class="k">for</span> <span class="n">DataLabel</span> <span class="ow">in</span> <span class="n">DataMap</span><span class="p">[</span><span class="s2">&quot;DataLabels&quot;</span><span class="p">]:</span>
  249         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;          &lt;th&gt;</span><span class="si">%s</span><span class="s2">&lt;/th&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">DataLabel</span><span class="p">)</span>
  250         
  251     <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;        &lt;/tr&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  252     <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;      &lt;/thead&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  253 
  254 <span class="k">def</span> <span class="nf">WriteTableFooterRow</span><span class="p">(</span><span class="n">Writer</span><span class="p">,</span> <span class="n">ValidMols</span><span class="p">,</span> <span class="n">DataMap</span><span class="p">):</span>
  255     <span class="sd">&quot;&quot;&quot;Write out table footer row.&quot;&quot;&quot;</span>
  256 
  257     <span class="k">if</span> <span class="ow">not</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;TableFooter&quot;</span><span class="p">]:</span>
  258         <span class="k">return</span>
  259     
  260     <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;      &lt;tfoot&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  261     <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;        &lt;tr&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  262 
  263     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;CounterCol&quot;</span><span class="p">]:</span>
  264         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;          &lt;td&gt;&lt;/td&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  265     <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;          &lt;td&gt;Structure&lt;/td&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  266     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ShowMolName&quot;</span><span class="p">]:</span>
  267         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;          &lt;td&gt;</span><span class="si">%s</span><span class="s2">&lt;/td&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ShowMolNameDataLabel&quot;</span><span class="p">])</span>
  268 
  269     <span class="c1"># Write out rest of the column headers...</span>
  270     <span class="k">for</span> <span class="n">DataLabel</span> <span class="ow">in</span> <span class="n">DataMap</span><span class="p">[</span><span class="s2">&quot;DataLabels&quot;</span><span class="p">]:</span>
  271         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;          &lt;td&gt;</span><span class="si">%s</span><span class="s2">&lt;/td&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">DataLabel</span><span class="p">)</span>
  272         
  273     <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;        &lt;/tr&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  274     <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;      &lt;/tfoot&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  275 
  276 <span class="k">def</span> <span class="nf">WriteHTMLPageHeader</span><span class="p">(</span><span class="n">Writer</span><span class="p">,</span> <span class="n">DataMap</span><span class="p">):</span>
  277     <span class="sd">&quot;&quot;&quot;Write out HTML page header.&quot;&quot;&quot;</span>
  278 
  279     <span class="c1"># Collect column indices containing counter and structure data to disable</span>
  280     <span class="c1"># sorting and searching. In addition, set up a list to exclude counter and</span>
  281     <span class="c1"># primary structure columns from column visibility pulldown along with</span>
  282     <span class="c1"># any other columns...</span>
  283     <span class="c1">#</span>
  284     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;CounterCol&quot;</span><span class="p">]:</span>
  285         <span class="n">StrColIndicesList</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">]</span>
  286         <span class="n">ColVisibilityExcludeColIndicesList</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;0&quot;</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">]</span>
  287         <span class="n">ColIndexOffset</span> <span class="o">=</span> <span class="mi">2</span>
  288         <span class="n">FreezeLeftColumns</span> <span class="o">=</span> <span class="s2">&quot;2&quot;</span>
  289     <span class="k">else</span><span class="p">:</span>
  290         <span class="n">StrColIndicesList</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;0&quot;</span><span class="p">]</span>
  291         <span class="n">ColVisibilityExcludeColIndicesList</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;0&quot;</span><span class="p">]</span>
  292         <span class="n">ColIndexOffset</span> <span class="o">=</span> <span class="mi">1</span>
  293         <span class="n">FreezeLeftColumns</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span>
  294 
  295     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ShowMolName&quot;</span><span class="p">]:</span>
  296         <span class="n">ColIndexOffset</span> <span class="o">+=</span> <span class="mi">1</span>
  297         
  298     <span class="n">MaxColVisColCount</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ColVisibilityCtrlMax&quot;</span><span class="p">]</span>
  299     <span class="n">MaxDataColVisColCount</span> <span class="o">=</span> <span class="n">MaxColVisColCount</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">ColVisibilityExcludeColIndicesList</span><span class="p">)</span>
  300     <span class="n">MaxDataColVisColCount</span> <span class="o">=</span> <span class="n">MaxColVisColCount</span>
  301 
  302     <span class="n">DataColVisibilityExclude</span> <span class="o">=</span> <span class="bp">False</span>
  303     <span class="n">ColCount</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">DataMap</span><span class="p">[</span><span class="s2">&quot;DataLabels&quot;</span><span class="p">])</span>
  304     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ColVisibility&quot;</span><span class="p">]:</span>
  305         <span class="k">if</span> <span class="n">ColCount</span> <span class="o">&gt;</span> <span class="n">MaxDataColVisColCount</span><span class="p">:</span>
  306             <span class="n">DataColVisibilityExclude</span> <span class="o">=</span> <span class="bp">True</span>
  307             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;The number of data columns, </span><span class="si">%d</span><span class="s2">, is more than </span><span class="si">%d</span><span class="s2">. Only first </span><span class="si">%d</span><span class="s2"> data columns will be available in column visibility pulldown.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ColCount</span><span class="p">,</span> <span class="n">MaxColVisColCount</span><span class="p">,</span> <span class="n">MaxColVisColCount</span><span class="p">))</span>
  308     
  309     <span class="n">DisplayButtons</span> <span class="o">=</span> <span class="bp">False</span>
  310     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ColVisibility&quot;</span><span class="p">]:</span>
  311         <span class="k">if</span> <span class="n">ColCount</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ShowMolName&quot;</span><span class="p">]:</span>
  312             <span class="n">DisplayButtons</span> <span class="o">=</span> <span class="bp">True</span>
  313     
  314     <span class="n">FreezeCols</span> <span class="o">=</span> <span class="bp">False</span>
  315     <span class="k">if</span> <span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;FreezeCols&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ScrollX&quot;</span><span class="p">]):</span>
  316         <span class="n">FreezeCols</span> <span class="o">=</span> <span class="bp">True</span>
  317     
  318     <span class="k">for</span> <span class="n">Index</span><span class="p">,</span> <span class="n">DataLabel</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">DataMap</span><span class="p">[</span><span class="s2">&quot;DataLabels&quot;</span><span class="p">]):</span>
  319         <span class="k">if</span> <span class="n">DataMap</span><span class="p">[</span><span class="s2">&quot;StructureDataMap&quot;</span><span class="p">][</span><span class="n">DataLabel</span><span class="p">]:</span>
  320             <span class="n">StrColIndex</span> <span class="o">=</span> <span class="n">Index</span> <span class="o">+</span> <span class="n">ColIndexOffset</span>
  321             <span class="n">StrColIndicesList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">StrColIndex</span><span class="p">)</span>
  322         
  323         <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ColVisibility&quot;</span><span class="p">]:</span>
  324             <span class="k">if</span> <span class="n">Index</span> <span class="o">&gt;=</span> <span class="n">MaxDataColVisColCount</span><span class="p">:</span>
  325                 <span class="n">ColIndex</span> <span class="o">=</span> <span class="n">Index</span> <span class="o">+</span> <span class="n">ColIndexOffset</span>
  326                 <span class="n">ColVisibilityExcludeColIndicesList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="n">ColIndex</span><span class="p">)</span>
  327             
  328     <span class="n">StrColIndices</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">JoinWords</span><span class="p">(</span><span class="n">StrColIndicesList</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="p">)</span>
  329     <span class="n">ColVisibilityExcludeColIndices</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">JoinWords</span><span class="p">(</span><span class="n">ColVisibilityExcludeColIndicesList</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="p">)</span>
  330 
  331     <span class="n">Paging</span> <span class="o">=</span> <span class="s2">&quot;true&quot;</span> <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Paging&quot;</span><span class="p">]</span> <span class="k">else</span> <span class="s2">&quot;false&quot;</span>
  332     <span class="n">PageLength</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PageLength&quot;</span><span class="p">]</span>
  333     <span class="n">PagingType</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PagingType&quot;</span><span class="p">]</span>
  334 
  335     <span class="n">ScrollX</span> <span class="o">=</span> <span class="s2">&quot;true&quot;</span> <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ScrollX&quot;</span><span class="p">]</span> <span class="k">else</span> <span class="s2">&quot;false&quot;</span>
  336     
  337     <span class="n">ScrollY</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
  338     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ScrollY&quot;</span><span class="p">]:</span>
  339         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">&quot;vh$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ScrollYSize&quot;</span><span class="p">]):</span>
  340             <span class="n">ScrollY</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ScrollYSize&quot;</span><span class="p">]</span>
  341         <span class="k">else</span><span class="p">:</span>
  342             <span class="n">ScrollY</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ScrollYSize&quot;</span><span class="p">]</span>
  343     
  344     <span class="n">RegexSearch</span> <span class="o">=</span> <span class="s2">&quot;true&quot;</span> <span class="k">if</span>  <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;RegexSearch&quot;</span><span class="p">]</span> <span class="k">else</span> <span class="s2">&quot;false&quot;</span>
  345 
  346     <span class="c1"># Start HTML header...</span>
  347     <span class="n">Title</span> <span class="o">=</span> <span class="s2">&quot;Molecules and data table&quot;</span> <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Header&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Header&quot;</span><span class="p">]</span>
  348 
  349     <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
  350 <span class="s2">&lt;!doctype html&gt;</span>
  351 <span class="s2">&lt;html lang=&quot;en&quot;&gt;</span>
  352 <span class="s2">&lt;head&gt;</span>
  353 <span class="s2">    &lt;title&gt;</span><span class="si">%s</span><span class="s2">&lt;/title&gt;</span>
  354 <span class="s2">    &lt;meta charset=&quot;utf-8&quot;&gt;</span>
  355 <span class="s2">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1, shrink-to-fit=no&quot;&gt;</span>
  356 <span class="s2">    &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css&quot;&gt;</span>
  357 <span class="s2">    &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://cdn.datatables.net/1.10.16/css/dataTables.bootstrap4.min.css&quot;&gt;</span>
  358 <span class="s2">  </span>
  359 <span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Title</span><span class="p">))</span>
  360 
  361     <span class="k">if</span> <span class="p">(</span><span class="n">FreezeCols</span><span class="p">):</span>
  362         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
  363 <span class="s2">    &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://cdn.datatables.net/fixedcolumns/3.2.4/css/fixedColumns.bootstrap4.min.css&quot;&gt;</span>
  364 <span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  365     
  366     <span class="k">if</span> <span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;KeysNavigation&quot;</span><span class="p">]):</span>
  367         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
  368 <span class="s2">    &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://cdn.datatables.net/keytable/2.3.2/css/keyTable.bootstrap4.min.css&quot;&gt;</span>
  369 <span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  370     
  371     <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
  372 
  373 <span class="s2">    &lt;script type=&quot;text/javascript&quot; language=&quot;javascript&quot; src=&quot;https://code.jquery.com/jquery-1.12.4.js&quot;&gt;&lt;/script&gt;</span>
  374 <span class="s2">    &lt;script type=&quot;text/javascript&quot; language=&quot;javascript&quot; src=&quot;https://cdn.datatables.net/1.10.16/js/jquery.dataTables.min.js&quot;&gt;&lt;/script&gt;</span>
  375 <span class="s2">    &lt;script type=&quot;text/javascript&quot; language=&quot;javascript&quot; src=&quot;https://cdn.datatables.net/1.10.16/js/dataTables.bootstrap4.min.js&quot;&gt;&lt;/script&gt;</span>
  376 
  377 <span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  378 
  379     <span class="k">if</span> <span class="n">DisplayButtons</span><span class="p">:</span>
  380         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
  381 <span class="s2">    &lt;script type=&quot;text/javascript&quot; language=&quot;javascript&quot; src=&quot;https://cdn.datatables.net/buttons/1.5.1/js/dataTables.buttons.min.js&quot;&gt;&lt;/script&gt;</span>
  382 <span class="s2">    &lt;script type=&quot;text/javascript&quot; language=&quot;javascript&quot; src=&quot;https://cdn.datatables.net/buttons/1.5.1/js/buttons.bootstrap4.min.js&quot;&gt;&lt;/script&gt;</span>
  383 <span class="s2">    &lt;script type=&quot;text/javascript&quot; language=&quot;javascript&quot; src=&quot;https://cdn.datatables.net/buttons/1.5.1/js/buttons.colVis.min.js&quot;&gt;&lt;/script&gt;</span>
  384 
  385 <span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  386     
  387     <span class="k">if</span> <span class="p">(</span><span class="n">FreezeCols</span><span class="p">):</span>
  388         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
  389 <span class="s2">    &lt;script type=&quot;text/javascript&quot; language=&quot;javascript&quot; src=&quot;https://cdn.datatables.net/fixedcolumns/3.2.4/js/dataTables.fixedColumns.min.js&quot;&gt;&lt;/script&gt;</span>
  390 <span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  391     
  392     <span class="k">if</span> <span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;KeysNavigation&quot;</span><span class="p">]):</span>
  393         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
  394 <span class="s2">    &lt;script type=&quot;text/javascript&quot; language=&quot;javascript&quot; src=&quot;https://cdn.datatables.net/keytable/2.3.2/js/dataTables.keyTable.min.js&quot;&gt;&lt;/script&gt;</span>
  395 <span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  396     
  397     <span class="c1"># Intialize table using Bootstrap, DataTables and JQuery frameworks...</span>
  398     <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
  399 
  400 <span class="s2">    &lt;script type=&quot;text/javascript&quot; class=&quot;init&quot;&gt;</span>
  401 
  402 <span class="s2">$(document).ready(function() {</span>
  403 <span class="s2">    var MolsAndDataTable = $(&#39;#MolsAndDataTable&#39;).DataTable( {</span>
  404 <span class="s2">        &quot;columnDefs&quot;: [</span>
  405 <span class="s2">            {</span>
  406 <span class="s2">                &quot;orderable&quot;: false,</span>
  407 <span class="s2">                &quot;searchable&quot;: false,</span>
  408 <span class="s2">                &quot;targets&quot;: [</span><span class="si">%s</span><span class="s2">]</span>
  409 <span class="s2">            },</span>
  410 <span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">StrColIndices</span><span class="p">))</span>
  411 
  412     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ColVisibility&quot;</span><span class="p">]:</span>
  413         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
  414 <span class="s2">            {</span>
  415 <span class="s2">                &quot;className&quot;: &quot;noColVisCtrl&quot;,</span>
  416 <span class="s2">                &quot;targets&quot;: [</span><span class="si">%s</span><span class="s2">]</span>
  417 <span class="s2">            }</span>
  418 <span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ColVisibilityExcludeColIndices</span><span class="p">))</span>
  419 
  420     <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
  421 <span class="s2">        ],</span>
  422 <span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  423     
  424     <span class="c1"># Setup column visibility control pulldown by excluding counter column</span>
  425     <span class="c1"># and primary structure column from the list...</span>
  426     <span class="c1">#</span>
  427     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ColVisibility&quot;</span><span class="p">]:</span>
  428         <span class="c1"># Set up dom for button display...</span>
  429         <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Paging&quot;</span><span class="p">]:</span>
  430             <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
  431 <span class="s2">        &quot;dom&quot;:  &quot;&lt;&#39;row&#39;&lt;&#39;col&#39;l&gt;&lt;&#39;col&#39;B&gt;&lt;&#39;col&#39;f&gt;&gt;&quot; +</span>
  432 <span class="s2">            &quot;&lt;&#39;row&#39;&lt;&#39;col-sm-12&#39;tr&gt;&gt;&quot; +</span>
  433 <span class="s2">            &quot;&lt;&#39;row&#39;&lt;&#39;col-sm-5&#39;i&gt;&lt;&#39;col-sm-7&#39;p&gt;&gt;&quot;,</span>
  434 <span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  435         <span class="k">else</span><span class="p">:</span>
  436             <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
  437 <span class="s2">        &quot;dom&quot;:  &quot;&lt;&#39;row&#39;&lt;&#39;col-sm-6&#39;B&gt;&lt;&#39;col-sm-6&#39;f&gt;&gt;&quot; +</span>
  438 <span class="s2">            &quot;&lt;&#39;row&#39;&lt;&#39;col-sm-12&#39;tr&gt;&gt;&quot; +</span>
  439 <span class="s2">            &quot;&lt;&#39;row&#39;&lt;&#39;col-sm-5&#39;i&gt;&lt;&#39;col-sm-7&#39;p&gt;&gt;&quot;,</span>
  440 <span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  441         <span class="c1"># Set up buttons...</span>
  442         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
  443 <span class="s2">        &quot;buttons&quot;: [</span>
  444 <span class="s2">            {</span>
  445 <span class="s2">                &quot;extend&quot;: &quot;colvis&quot;,</span>
  446 <span class="s2">                &quot;text&quot;: &quot;Column visibility&quot;,</span>
  447 <span class="s2">                &quot;className&quot;: &quot;btn btn-outline-light text-dark&quot;,</span>
  448 <span class="s2">                &quot;columns&quot;: &quot;:not(.noColVisCtrl)&quot;,</span>
  449 <span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  450         <span class="k">if</span> <span class="ow">not</span> <span class="n">DataColVisibilityExclude</span><span class="p">:</span>
  451             <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
  452 <span class="s2">                &quot;prefixButtons&quot;: [ &quot;colvisRestore&quot; ],</span>
  453 <span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  454         
  455         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
  456 <span class="s2">                &quot;columnText&quot;: function ( dt, colIndex, colLabel ) {</span>
  457 <span class="s2">                    return (colIndex + 1) + &quot;: &quot; + colLabel;</span>
  458 <span class="s2">                },</span>
  459 <span class="s2">            }</span>
  460 <span class="s2">        ],</span>
  461 <span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  462 
  463     <span class="c1"># Write out rest of the variables for DataTables...</span>
  464     <span class="k">if</span> <span class="n">FreezeCols</span><span class="p">:</span>
  465         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
  466 <span class="s2">        &quot;fixedColumns&quot;: {</span>
  467 <span class="s2">            &quot;leftColumns&quot;: </span><span class="si">%s</span><span class="s2"></span>
  468 <span class="s2">        },</span>
  469 <span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">FreezeLeftColumns</span><span class="p">))</span>
  470     
  471     <span class="k">if</span> <span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;KeysNavigation&quot;</span><span class="p">]):</span>
  472         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
  473 <span class="s2">        &quot;keys&quot;: true,</span>
  474 <span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  475     
  476     <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
  477 <span class="s2">        &quot;pageLength&quot;: </span><span class="si">%s</span><span class="s2">,</span>
  478 <span class="s2">        &quot;lengthMenu&quot;: [ [10, 15, 25, 50, 100, 500, 1000, -1], [10, 15, 25, 50, 100, 500, 1000, &quot;All&quot;] ],</span>
  479 <span class="s2">        &quot;paging&quot;: </span><span class="si">%s</span><span class="s2">,</span>
  480 <span class="s2">        &quot;pagingType&quot;: </span><span class="si">%s</span><span class="s2">,</span>
  481 <span class="s2">        &quot;scrollX&quot;: </span><span class="si">%s</span><span class="s2">,</span>
  482 <span class="s2">        &quot;scrollY&quot;: </span><span class="si">%s</span><span class="s2">,</span>
  483 <span class="s2">        &quot;scrollCollapse&quot;: true,</span>
  484 <span class="s2">        &quot;order&quot;: [],</span>
  485 <span class="s2">        &quot;search&quot; : {&quot;regex&quot; : </span><span class="si">%s</span><span class="s2">},</span>
  486 <span class="s2">    } );</span>
  487 <span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">PageLength</span><span class="p">,</span> <span class="n">Paging</span><span class="p">,</span> <span class="n">PagingType</span><span class="p">,</span> <span class="n">ScrollX</span><span class="p">,</span> <span class="n">ScrollY</span><span class="p">,</span> <span class="n">RegexSearch</span><span class="p">))</span>
  488     
  489     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;CounterCol&quot;</span><span class="p">]:</span>
  490         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
  491 <span class="s2">    MolsAndDataTable.on( &#39;order.dt search.dt&#39;, function () {</span>
  492 <span class="s2">        MolsAndDataTable.column(0, {search:&#39;applied&#39;, order:&#39;applied&#39;}).nodes().each( function (cell, rowIndex) {</span>
  493 <span class="s2">            cell.innerHTML = rowIndex + 1;</span>
  494 <span class="s2">        } );</span>
  495 <span class="s2">    } ).draw();</span>
  496 <span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  497     
  498     <span class="c1"># End of Javacscript code...</span>
  499     <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
  500 <span class="s2">} );</span>
  501 
  502 <span class="s2">    &lt;/script&gt;</span>
  503 <span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  504 
  505     <span class="c1"># Finish up HTML header...</span>
  506     <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
  507 <span class="s2">  </span>
  508 <span class="s2">&lt;/head&gt;</span>
  509 <span class="s2">&lt;body&gt;</span>
  510 <span class="s2">  &lt;div class=&quot;container-fluid&quot;&gt;</span>
  511 <span class="s2">    &lt;br/&gt;</span>
  512 <span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  513 
  514 <span class="k">def</span> <span class="nf">WriteHTMLPageEnd</span><span class="p">(</span><span class="n">Writer</span><span class="p">):</span>
  515     <span class="sd">&quot;&quot;&quot;Write out HTML page end.&quot;&quot;&quot;</span>
  516 
  517     <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
  518 <span class="s2">  &lt;/div&gt;</span>
  519 <span class="s2">&lt;/body&gt;</span>
  520 <span class="s2">&lt;/html&gt;</span>
  521 <span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  522 
  523 <span class="k">def</span> <span class="nf">WriteHTMLPageTitle</span><span class="p">(</span><span class="n">Writer</span><span class="p">):</span>
  524     <span class="sd">&quot;&quot;&quot;Write out HTML page title.&quot;&quot;&quot;</span>
  525 
  526     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Header&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
  527         <span class="k">return</span>
  528 
  529     <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;    &lt;</span><span class="si">%s</span><span class="s2"> class=&quot;text-center&quot;&gt;</span><span class="si">%s</span><span class="s2">&lt;/</span><span class="si">%s</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HeaderStyle&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Header&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HeaderStyle&quot;</span><span class="p">]))</span>
  530 
  531 <span class="k">def</span> <span class="nf">WriteHTMLPageFooter</span><span class="p">(</span><span class="n">Writer</span><span class="p">):</span>
  532     <span class="sd">&quot;&quot;&quot;Write out HTML page footer.&quot;&quot;&quot;</span>
  533 
  534     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Footer&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
  535         <span class="k">return</span>
  536 
  537     <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;    &lt;br/&gt;</span><span class="se">\n</span><span class="s2">    &lt;p class=&quot;</span><span class="si">%s</span><span class="s2">&quot;&gt;</span><span class="si">%s</span><span class="s2">&lt;/p&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;FooterClass&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Footer&quot;</span><span class="p">]))</span>
  538 
  539 <span class="k">def</span> <span class="nf">WriteHTMLTableHeader</span><span class="p">(</span><span class="n">Writer</span><span class="p">):</span>
  540     <span class="sd">&quot;&quot;&quot;Write out HTML table header.&quot;&quot;&quot;</span>
  541 
  542     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;TableStyle&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
  543         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">    &lt;table id=&quot;MolsAndDataTable&quot; cellspacing=&quot;0&quot; width=&quot;100%&quot;&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  544     <span class="k">else</span><span class="p">:</span>
  545         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;    &lt;table id=&quot;MolsAndDataTable&quot; class=&quot;</span><span class="si">%s</span><span class="s2">&quot; cellspacing=&quot;0&quot; width=&quot;100</span><span class="si">%s</span><span class="s2">&quot;&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;TableStyle&quot;</span><span class="p">],</span> <span class="s2">&quot;%&quot;</span><span class="p">))</span>
  546         
  547 <span class="k">def</span> <span class="nf">WriteHTMLTableEnd</span><span class="p">(</span><span class="n">Writer</span><span class="p">):</span>
  548     <span class="sd">&quot;&quot;&quot;Write out HTML table end.&quot;&quot;&quot;</span>
  549 
  550     <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;    &lt;/table&gt;</span><span class="se">\n\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  551 
  552 <span class="k">def</span> <span class="nf">RetrieveMoleculesAndData</span><span class="p">():</span>
  553     <span class="sd">&quot;&quot;&quot;Retrieve molecules and data from input file.&quot;&quot;&quot;</span>
  554 
  555     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Reading file </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Infile&quot;</span><span class="p">])</span>
  556 
  557     <span class="k">if</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">CheckFileExt</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Infile&quot;</span><span class="p">]</span> <span class="p">,</span><span class="s2">&quot;smi csv tsv txt&quot;</span><span class="p">):</span>
  558         <span class="c1"># Check for the presence of SMILES column name in title line...</span>
  559         <span class="n">Infile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Infile&quot;</span><span class="p">],</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
  560         <span class="k">if</span> <span class="n">Infile</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
  561             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;Couldn&#39;t open file </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Infile&quot;</span><span class="p">])</span>
  562         <span class="n">Line</span> <span class="o">=</span> <span class="n">Infile</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
  563         <span class="n">Infile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
  564         
  565         <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">&quot;SMILES&quot;</span><span class="p">,</span> <span class="n">Line</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  566             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The input file, </span><span class="si">%s</span><span class="s2">, must contain a title line containing a column name with SMILES in its name.&quot;</span> <span class="o">%</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Infile&quot;</span><span class="p">])</span>
  567     
  568     <span class="k">if</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">CheckFileExt</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Infile&quot;</span><span class="p">],</span><span class="s2">&quot;sdf sd smi&quot;</span><span class="p">):</span>
  569         <span class="n">ValidMols</span><span class="p">,</span> <span class="n">MolCount</span><span class="p">,</span> <span class="n">ValidMolCount</span>  <span class="o">=</span> <span class="n">RDKitUtil</span><span class="o">.</span><span class="n">ReadAndValidateMolecules</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Infile&quot;</span><span class="p">],</span> <span class="o">**</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfileParams&quot;</span><span class="p">])</span>
  570     <span class="k">else</span><span class="p">:</span>
  571         <span class="n">ValidMols</span><span class="p">,</span> <span class="n">MolCount</span><span class="p">,</span> <span class="n">ValidMolCount</span>  <span class="o">=</span> <span class="n">RetrieveMoleculesFromTextFile</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Infile&quot;</span><span class="p">])</span>
  572     
  573     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Total number of molecules: </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">MolCount</span><span class="p">)</span>
  574     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Number of valid molecules: </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ValidMolCount</span><span class="p">)</span>
  575     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Number of ignored molecules: </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MolCount</span> <span class="o">-</span> <span class="n">ValidMolCount</span><span class="p">))</span>
  576 
  577     <span class="k">return</span> <span class="n">ValidMols</span>
  578 
  579 <span class="k">def</span> <span class="nf">RetrieveMoleculesFromTextFile</span><span class="p">(</span><span class="n">Infile</span><span class="p">):</span>
  580     <span class="sd">&quot;&quot;&quot;Retrieve molecules from a CSV/TSV text file.&quot;&quot;&quot;</span>
  581 
  582     <span class="c1"># Read and parse text lines...</span>
  583     <span class="n">Delimiter</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span> <span class="k">if</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">CheckFileExt</span><span class="p">(</span><span class="n">Infile</span> <span class="p">,</span><span class="s2">&quot;csv&quot;</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
  584     <span class="n">QuoteChar</span> <span class="o">=</span> <span class="s1">&#39;&quot;&#39;</span>
  585     <span class="n">IgnoreHeaderLine</span> <span class="o">=</span> <span class="bp">False</span>
  586     <span class="n">TextLinesWords</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">GetTextLinesWords</span><span class="p">(</span><span class="n">Infile</span><span class="p">,</span> <span class="n">Delimiter</span><span class="p">,</span> <span class="n">QuoteChar</span><span class="p">,</span> <span class="n">IgnoreHeaderLine</span><span class="p">)</span>
  587 
  588     <span class="c1"># Process column names...</span>
  589     <span class="n">ColNames</span> <span class="o">=</span> <span class="n">TextLinesWords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
  590     <span class="n">ColCount</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ColNames</span><span class="p">)</span>
  591     
  592     <span class="n">MolColIndex</span> <span class="o">=</span> <span class="bp">None</span>
  593     <span class="n">MolDataColIndices</span> <span class="o">=</span> <span class="p">[]</span>
  594 
  595     <span class="n">FirstSMILES</span> <span class="o">=</span> <span class="bp">True</span>
  596     <span class="k">for</span> <span class="n">ColIndex</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ColCount</span><span class="p">):</span>
  597         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">&quot;SMILES&quot;</span><span class="p">,</span> <span class="n">ColNames</span><span class="p">[</span><span class="n">ColIndex</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="ow">and</span> <span class="n">FirstSMILES</span><span class="p">:</span>
  598             <span class="n">MolColIndex</span> <span class="o">=</span> <span class="n">ColIndex</span>
  599             <span class="n">FirstSMILES</span> <span class="o">=</span> <span class="bp">False</span>
  600             <span class="k">continue</span>
  601         
  602         <span class="n">MolDataColIndices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ColIndex</span><span class="p">)</span>
  603     
  604     <span class="k">if</span> <span class="n">MolColIndex</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
  605             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The input file, </span><span class="si">%s</span><span class="s2">, must contain a title line containing a column name with SMILES in its name.&quot;</span> <span class="o">%</span> <span class="n">Infile</span><span class="p">)</span>
  606 
  607     <span class="n">ValidMols</span> <span class="o">=</span> <span class="p">[]</span>
  608     <span class="n">MolCount</span> <span class="o">=</span> <span class="mi">0</span>
  609 
  610     <span class="n">Sanitize</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfileParams&quot;</span><span class="p">][</span><span class="s2">&quot;Sanitize&quot;</span><span class="p">]</span>
  611     
  612     <span class="c1"># Process data lines...</span>
  613     <span class="k">for</span> <span class="n">LineIndex</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">TextLinesWords</span><span class="p">)):</span>
  614         <span class="n">MolCount</span> <span class="o">+=</span> <span class="mi">1</span>
  615         <span class="n">LineWords</span> <span class="o">=</span> <span class="n">TextLinesWords</span><span class="p">[</span><span class="n">LineIndex</span><span class="p">]</span>
  616         <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">LineWords</span><span class="p">)</span> <span class="o">!=</span> <span class="n">ColCount</span><span class="p">:</span>
  617             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;Ignoring text line number </span><span class="si">%d</span><span class="s2">: Number of columns, </span><span class="si">%d</span><span class="s2">, must match number of columns, </span><span class="si">%d</span><span class="s2">, in title line.</span><span class="se">\n</span><span class="s2">Line: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MolCount</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">LineWords</span><span class="p">),</span> <span class="n">ColCount</span><span class="p">,</span> <span class="n">Delimiter</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">LineWords</span><span class="p">)))</span>
  618             <span class="k">continue</span>
  619 
  620         <span class="c1"># Process molecule column...</span>
  621         <span class="n">MolSMILES</span> <span class="o">=</span> <span class="n">LineWords</span><span class="p">[</span><span class="n">MolColIndex</span><span class="p">]</span>
  622         <span class="n">Mol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">MolSMILES</span><span class="p">,</span> <span class="n">sanitize</span> <span class="o">=</span> <span class="n">Sanitize</span><span class="p">)</span>
  623         <span class="k">if</span> <span class="n">Mol</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
  624             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;Ignoring text line number </span><span class="si">%d</span><span class="s2">: SMILES parsing failed</span><span class="se">\n</span><span class="s2">Line: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MolCount</span><span class="p">,</span> <span class="n">Delimiter</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">LineWords</span><span class="p">)))</span>
  625             <span class="k">continue</span>
  626 
  627         <span class="c1"># Process molecule data columns...</span>
  628         <span class="k">for</span> <span class="n">ColIndex</span> <span class="ow">in</span> <span class="n">MolDataColIndices</span><span class="p">:</span>
  629             <span class="n">Name</span> <span class="o">=</span> <span class="n">ColNames</span><span class="p">[</span><span class="n">ColIndex</span><span class="p">]</span>
  630             <span class="n">Value</span> <span class="o">=</span> <span class="n">LineWords</span><span class="p">[</span><span class="n">ColIndex</span><span class="p">]</span>
  631             <span class="n">Mol</span><span class="o">.</span><span class="n">SetProp</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Value</span><span class="p">)</span>
  632         
  633         <span class="n">ValidMols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Mol</span><span class="p">)</span>
  634     
  635     <span class="n">ValidMolCount</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ValidMols</span><span class="p">)</span>
  636     
  637     <span class="k">return</span> <span class="p">(</span><span class="n">ValidMols</span><span class="p">,</span> <span class="n">MolCount</span><span class="p">,</span> <span class="n">ValidMolCount</span><span class="p">)</span>
  638 
  639 <span class="k">def</span> <span class="nf">IdentifyStructureAndNumericalData</span><span class="p">(</span><span class="n">ValidMols</span><span class="p">):</span>
  640     <span class="sd">&quot;&quot;&quot;Identify structure and alphanumerical data.&quot;&quot;&quot;</span>
  641 
  642     <span class="n">DataMap</span> <span class="o">=</span> <span class="p">{}</span>
  643     <span class="n">DataMap</span><span class="p">[</span><span class="s2">&quot;DataLabels&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  644     <span class="n">DataMap</span><span class="p">[</span><span class="s2">&quot;DataLabelsMap&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  645     <span class="n">DataMap</span><span class="p">[</span><span class="s2">&quot;CanonicalDataLabelsMap&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  646     
  647     <span class="n">DataMap</span><span class="p">[</span><span class="s2">&quot;StructureDataMap&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  648     <span class="n">DataMap</span><span class="p">[</span><span class="s2">&quot;SMILESDataMap&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  649 
  650     <span class="c1"># Retrieve all possible data labels...</span>
  651     <span class="k">if</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">CheckFileExt</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Infile&quot;</span><span class="p">]</span> <span class="p">,</span><span class="s2">&quot;smi csv tsv txt&quot;</span><span class="p">):</span>
  652         <span class="c1"># First molecule contains all possible data fields...</span>
  653         <span class="n">Mol</span> <span class="o">=</span> <span class="n">ValidMols</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
  654         <span class="n">ProcessMolDataLabels</span><span class="p">(</span><span class="n">ValidMols</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">DataMap</span><span class="p">)</span>
  655     <span class="k">else</span><span class="p">:</span>
  656         <span class="c1"># Go over all molecules to identify unique data labels...</span>
  657         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Retrieving unique data labels for data in file </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Infile&quot;</span><span class="p">])</span>
  658         <span class="k">for</span> <span class="n">Mol</span> <span class="ow">in</span> <span class="n">ValidMols</span><span class="p">:</span>
  659             <span class="n">ProcessMolDataLabels</span><span class="p">(</span><span class="n">Mol</span><span class="p">,</span> <span class="n">DataMap</span><span class="p">)</span>
  660 
  661     <span class="k">return</span> <span class="n">DataMap</span>
  662 
  663 <span class="k">def</span> <span class="nf">ProcessMolDataLabels</span><span class="p">(</span><span class="n">Mol</span><span class="p">,</span> <span class="n">DataMap</span><span class="p">):</span>
  664     <span class="sd">&quot;&quot;&quot;Process data label to identify and track its type&quot;&quot;&quot;</span>
  665     
  666     <span class="k">for</span> <span class="n">DataLabel</span> <span class="ow">in</span> <span class="n">Mol</span><span class="o">.</span><span class="n">GetPropNames</span><span class="p">(</span><span class="n">includePrivate</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">includeComputed</span> <span class="o">=</span> <span class="bp">False</span><span class="p">):</span>
  667         <span class="k">if</span> <span class="n">DataLabel</span> <span class="ow">in</span> <span class="n">DataMap</span><span class="p">[</span><span class="s2">&quot;DataLabelsMap&quot;</span><span class="p">]:</span>
  668             <span class="k">continue</span>
  669 
  670         <span class="c1"># Track labels...</span>
  671         <span class="n">DataMap</span><span class="p">[</span><span class="s2">&quot;DataLabels&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DataLabel</span><span class="p">)</span>
  672         <span class="n">DataMap</span><span class="p">[</span><span class="s2">&quot;DataLabelsMap&quot;</span><span class="p">][</span><span class="n">DataLabel</span><span class="p">]</span> <span class="o">=</span> <span class="n">DataLabel</span>
  673         <span class="n">DataMap</span><span class="p">[</span><span class="s2">&quot;CanonicalDataLabelsMap&quot;</span><span class="p">][</span><span class="n">DataLabel</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="o">=</span> <span class="n">DataLabel</span>
  674         
  675         <span class="n">DataMap</span><span class="p">[</span><span class="s2">&quot;StructureDataMap&quot;</span><span class="p">][</span><span class="n">DataLabel</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
  676         <span class="n">DataMap</span><span class="p">[</span><span class="s2">&quot;SMILESDataMap&quot;</span><span class="p">][</span><span class="n">DataLabel</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
  677         
  678         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">&quot;SMILES&quot;</span><span class="p">,</span> <span class="n">DataLabel</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  679             <span class="n">DataMap</span><span class="p">[</span><span class="s2">&quot;StructureDataMap&quot;</span><span class="p">][</span><span class="n">DataLabel</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
  680             <span class="n">DataMap</span><span class="p">[</span><span class="s2">&quot;SMILESDataMap&quot;</span><span class="p">][</span><span class="n">DataLabel</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
  681 
  682 <span class="k">def</span> <span class="nf">ValidateShowMolNameOption</span><span class="p">(</span><span class="n">DataMap</span><span class="p">):</span>
  683     <span class="sd">&quot;&quot;&quot;Validate show molecule name option. &quot;&quot;&quot;</span>
  684     
  685     <span class="k">if</span> <span class="ow">not</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ShowMolName&quot;</span><span class="p">]:</span>
  686         <span class="k">return</span>
  687 
  688     <span class="k">if</span> <span class="ow">not</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">CheckFileExt</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Infile&quot;</span><span class="p">],</span><span class="s2">&quot;sdf sd smi&quot;</span><span class="p">):</span>
  689         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ShowMolName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
  690         <span class="k">return</span>
  691 
  692     <span class="n">CanonicalDataLabel</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ShowMolNameDataLabel&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
  693     <span class="k">if</span> <span class="n">CanonicalDataLabel</span> <span class="ow">in</span> <span class="n">DataMap</span><span class="p">[</span><span class="s2">&quot;CanonicalDataLabelsMap&quot;</span><span class="p">]:</span>
  694         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ShowMolName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
  695         <span class="k">if</span> <span class="ow">not</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ShowMolNameAuto&quot;</span><span class="p">]:</span>
  696             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;Ignoring </span><span class="se">\&quot;</span><span class="s2">--showMolName</span><span class="se">\&quot;</span><span class="s2"> option: Data label </span><span class="se">\&quot;</span><span class="s2">Name</span><span class="se">\&quot;</span><span class="s2"> corresponding to molecule name is already present in input file.&quot;</span><span class="p">)</span>
  697 
  698 <span class="k">def</span> <span class="nf">ValidateSpecifiedDataLabels</span><span class="p">(</span><span class="n">DataMap</span><span class="p">):</span>
  699     <span class="sd">&quot;&quot;&quot;Validate data labels used to specify highlighting data. &quot;&quot;&quot;</span>
  700     
  701     <span class="n">ValidateSpecifiedDataLabelsForHighlightSMARTS</span><span class="p">(</span><span class="n">DataMap</span><span class="p">)</span>
  702     
  703     <span class="n">ValidateSpecifiedDataLabelsForHighlightValues</span><span class="p">(</span><span class="n">DataMap</span><span class="p">)</span>
  704     <span class="n">ValidateSpecifiedDataLabelsForHighlightRanges</span><span class="p">(</span><span class="n">DataMap</span><span class="p">)</span>
  705     <span class="n">ValidateSpecifiedDataLabelsForHighlightClasses</span><span class="p">(</span><span class="n">DataMap</span><span class="p">)</span>
  706     
  707 <span class="k">def</span> <span class="nf">ValidateSpecifiedDataLabelsForHighlightSMARTS</span><span class="p">(</span><span class="n">DataMap</span><span class="p">):</span>
  708     <span class="sd">&quot;&quot;&quot;Validate data labels used to specify highlighting SMARTS option. &quot;&quot;&quot;</span>
  709 
  710     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightSMARTSAllMode&quot;</span><span class="p">]:</span>
  711         <span class="k">return</span>
  712 
  713     <span class="k">for</span> <span class="n">DataLabel</span> <span class="ow">in</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightSMARTSDataLabels&quot;</span><span class="p">]:</span>
  714         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Structure$&quot;</span><span class="p">,</span> <span class="n">DataLabel</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  715             <span class="k">continue</span>
  716         
  717         <span class="n">CanonicalDataLabel</span> <span class="o">=</span> <span class="n">DataLabel</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
  718         <span class="k">if</span> <span class="ow">not</span> <span class="n">CanonicalDataLabel</span> <span class="ow">in</span> <span class="n">DataMap</span><span class="p">[</span><span class="s2">&quot;CanonicalDataLabelsMap&quot;</span><span class="p">]:</span>
  719             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The data label specified, </span><span class="si">%s</span><span class="s2">, using option </span><span class="se">\&quot;</span><span class="s2">--highlightSMARTS</span><span class="se">\&quot;</span><span class="s2"> doesn&#39;t exist in input file.&quot;</span> <span class="o">%</span> <span class="n">DataLabel</span><span class="p">)</span>
  720         
  721         <span class="n">Label</span> <span class="o">=</span> <span class="n">DataMap</span><span class="p">[</span><span class="s2">&quot;CanonicalDataLabelsMap&quot;</span><span class="p">][</span><span class="n">CanonicalDataLabel</span><span class="p">]</span>
  722         <span class="k">if</span> <span class="ow">not</span> <span class="n">DataMap</span><span class="p">[</span><span class="s2">&quot;StructureDataMap&quot;</span><span class="p">][</span><span class="n">Label</span><span class="p">]:</span>
  723             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The data label specified, </span><span class="si">%s</span><span class="s2">, using option </span><span class="se">\&quot;</span><span class="s2">--highlightSMARTS</span><span class="se">\&quot;</span><span class="s2"> doesn&#39;t correspond to structure data: Valid structure data labels: SMILES in data label.&quot;</span> <span class="o">%</span> <span class="n">DataLabel</span><span class="p">)</span>
  724             
  725 <span class="k">def</span> <span class="nf">ValidateSpecifiedDataLabelsForHighlightValues</span><span class="p">(</span><span class="n">DataMap</span><span class="p">):</span>
  726     <span class="sd">&quot;&quot;&quot;Validate data labels used to specify highlighting values option. &quot;&quot;&quot;</span>
  727 
  728     <span class="n">ValidateDataLabels</span><span class="p">(</span><span class="s2">&quot;--highlightValues&quot;</span><span class="p">,</span> <span class="n">DataMap</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightValuesLabels&quot;</span><span class="p">])</span>
  729 
  730 <span class="k">def</span> <span class="nf">ValidateSpecifiedDataLabelsForHighlightRanges</span><span class="p">(</span><span class="n">DataMap</span><span class="p">):</span>
  731     <span class="sd">&quot;&quot;&quot;Validate data labels used to specify highlighting ranges option. &quot;&quot;&quot;</span>
  732     
  733     <span class="n">ValidateDataLabels</span><span class="p">(</span><span class="s2">&quot;--highlightRanges&quot;</span><span class="p">,</span> <span class="n">DataMap</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightRangesLabels&quot;</span><span class="p">])</span>
  734 
  735 <span class="k">def</span> <span class="nf">ValidateSpecifiedDataLabelsForHighlightClasses</span><span class="p">(</span><span class="n">DataMap</span><span class="p">):</span>
  736     <span class="sd">&quot;&quot;&quot;Validate data labels used to specify highlighting classes option. &quot;&quot;&quot;</span>
  737 
  738     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightClassesRules&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
  739         <span class="k">return</span>
  740     
  741     <span class="n">ValidDataLabelsList</span> <span class="o">=</span> <span class="p">[]</span>
  742     <span class="n">NotValidDataLabelsList</span> <span class="o">=</span> <span class="p">[]</span>
  743     <span class="k">for</span> <span class="n">Label</span> <span class="ow">in</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightClassesLabels&quot;</span><span class="p">]:</span>
  744         <span class="n">ValidCanonicalLabel</span> <span class="o">=</span> <span class="bp">None</span>
  745         
  746         <span class="k">for</span> <span class="n">LabelSynonym</span> <span class="ow">in</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightClassesSynonymsMap&quot;</span><span class="p">][</span><span class="n">Label</span><span class="p">]:</span>
  747             <span class="n">CanonicalLabel</span> <span class="o">=</span> <span class="n">LabelSynonym</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
  748             
  749             <span class="c1"># Is this label already in use...</span>
  750             <span class="k">if</span> <span class="n">CanonicalLabel</span> <span class="ow">in</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightValuesCanonicalLabelsMap&quot;</span><span class="p">]:</span>
  751                 <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
  752                 <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;The data label, </span><span class="si">%s</span><span class="s2">, for class, </span><span class="si">%s</span><span class="s2"> , in option </span><span class="se">\&quot;</span><span class="s2">--highlightValuesClasses</span><span class="se">\&quot;</span><span class="s2"> has already been used in </span><span class="se">\&quot;</span><span class="s2">--highlightValues</span><span class="se">\&quot;</span><span class="s2"> option. It&#39;ll be ignored during highlighting.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">LabelSynonym</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightClasses&quot;</span><span class="p">]))</span>
  753                 <span class="k">continue</span>
  754 
  755             <span class="k">if</span> <span class="n">CanonicalLabel</span> <span class="ow">in</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightRangesCanonicalLabelsMap&quot;</span><span class="p">]:</span>
  756                 <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
  757                 <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;The data label, </span><span class="si">%s</span><span class="s2">, for class, </span><span class="si">%s</span><span class="s2"> , in option </span><span class="se">\&quot;</span><span class="s2">--highlightValuesClasses</span><span class="se">\&quot;</span><span class="s2"> has already been used in </span><span class="se">\&quot;</span><span class="s2">--highlightValuesRanges</span><span class="se">\&quot;</span><span class="s2"> option. It&#39;ll be ignored during highlighting.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">LabelSynonym</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightClasses&quot;</span><span class="p">]))</span>
  758                 <span class="k">continue</span>
  759             
  760             <span class="c1"># Is this label present in input file...</span>
  761             <span class="k">if</span>  <span class="n">CanonicalLabel</span> <span class="ow">in</span> <span class="n">DataMap</span><span class="p">[</span><span class="s2">&quot;CanonicalDataLabelsMap&quot;</span><span class="p">]:</span>
  762                 <span class="n">ValidCanonicalLabel</span> <span class="o">=</span> <span class="n">CanonicalLabel</span>
  763                 <span class="k">break</span>
  764         
  765         <span class="k">if</span> <span class="n">ValidCanonicalLabel</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
  766             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;The data label or its synonyms - </span><span class="si">%s</span><span class="s2"> - for class, </span><span class="si">%s</span><span class="s2"> , in option </span><span class="se">\&quot;</span><span class="s2">--highlightValuesClasses</span><span class="se">\&quot;</span><span class="s2"> either don&#39;t exist in input file or have already been used for highlighting in option </span><span class="se">\&quot;</span><span class="s2">--highlightValuesClasses</span><span class="se">\&quot;</span><span class="s2"> or </span><span class="se">\&quot;</span><span class="s2">--highlightValuesRanges</span><span class="se">\&quot;</span><span class="s2">. It&#39;ll be ignored during highlighting.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MiscUtil</span><span class="o">.</span><span class="n">JoinWords</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightClassesSynonymsMap&quot;</span><span class="p">][</span><span class="n">Label</span><span class="p">],</span> <span class="s2">&quot;, &quot;</span><span class="p">),</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightClasses&quot;</span><span class="p">]))</span>
  767             <span class="n">NotValidDataLabelsList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Label</span><span class="p">)</span>
  768             <span class="k">continue</span>
  769         
  770         <span class="c1"># Track label...</span>
  771         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightClassesCanonicalLabelsMap&quot;</span><span class="p">][</span><span class="n">ValidCanonicalLabel</span><span class="p">]</span> <span class="o">=</span> <span class="n">Label</span>
  772         <span class="n">ValidDataLabelsList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DataMap</span><span class="p">[</span><span class="s2">&quot;CanonicalDataLabelsMap&quot;</span><span class="p">][</span><span class="n">ValidCanonicalLabel</span><span class="p">])</span>
  773 
  774     <span class="n">ValidDataLabelsCount</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ValidDataLabelsList</span><span class="p">)</span>
  775     <span class="n">NotValidDataLabelsCount</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">NotValidDataLabelsList</span><span class="p">)</span>
  776     <span class="n">DataLabelsCount</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightClassesLabels&quot;</span><span class="p">])</span>
  777     
  778     <span class="k">if</span> <span class="n">ValidDataLabelsCount</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
  779         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
  780         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;The data labels and their synonyms for class, </span><span class="si">%s</span><span class="s2"> , in option </span><span class="se">\&quot;</span><span class="s2">--highlightValuesClasses</span><span class="se">\&quot;</span><span class="s2"> either don&#39;t exists in input file or have already been used for highlighting in option </span><span class="se">\&quot;</span><span class="s2">--highlightValuesClasses</span><span class="se">\&quot;</span><span class="s2"> or </span><span class="se">\&quot;</span><span class="s2">--highlightValuesRanges</span><span class="se">\&quot;</span><span class="s2">. No class highlighting will be performed. Missing data labels:  </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightClasses&quot;</span><span class="p">],</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">JoinWords</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightClassesLabels&quot;</span><span class="p">],</span> <span class="s2">&quot;, &quot;</span><span class="p">)))</span>
  781     <span class="k">elif</span>  <span class="n">ValidDataLabelsCount</span> <span class="o">&lt;</span> <span class="n">DataLabelsCount</span><span class="p">:</span>
  782         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
  783         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;The class, </span><span class="si">%s</span><span class="s2">, based highlighting specified using </span><span class="se">\&quot;</span><span class="s2">--highlightValuesClasses</span><span class="se">\&quot;</span><span class="s2"> option will be performed using only, </span><span class="si">%d</span><span class="s2">, out of, </span><span class="si">%d</span><span class="s2">, data labels: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">The rest of the data label(s) - </span><span class="si">%s</span><span class="s2"> - either don&#39;t exist in the input file or have aready been used for highlighting in option </span><span class="se">\&quot;</span><span class="s2">--highlightValuesClasses</span><span class="se">\&quot;</span><span class="s2"> or </span><span class="se">\&quot;</span><span class="s2">--highlightValuesRanges</span><span class="se">\&quot;</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightClasses&quot;</span><span class="p">],</span> <span class="n">ValidDataLabelsCount</span><span class="p">,</span>  <span class="n">DataLabelsCount</span><span class="p">,</span>  <span class="n">MiscUtil</span><span class="o">.</span><span class="n">JoinWords</span><span class="p">(</span><span class="n">ValidDataLabelsList</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="p">),</span>  <span class="n">MiscUtil</span><span class="o">.</span><span class="n">JoinWords</span><span class="p">(</span><span class="n">NotValidDataLabelsList</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="p">)</span> <span class="p">))</span>
  784         
  785 <span class="k">def</span> <span class="nf">ValidateDataLabels</span><span class="p">(</span><span class="n">OptionName</span><span class="p">,</span> <span class="n">DataMap</span><span class="p">,</span> <span class="n">DataLabels</span><span class="p">):</span>
  786     <span class="sd">&quot;&quot;&quot;Validate data labels.&quot;&quot;&quot;</span>
  787     
  788     <span class="k">for</span> <span class="n">DataLabel</span> <span class="ow">in</span> <span class="n">DataLabels</span><span class="p">:</span>
  789         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Structure$&quot;</span><span class="p">,</span> <span class="n">DataLabel</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  790             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The data label specified, </span><span class="si">%s</span><span class="s2">, using option </span><span class="se">\&quot;</span><span class="s2">-</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> must not correspond to structure data. Structure label is not allowed.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">DataLabel</span><span class="p">,</span> <span class="n">OptionName</span><span class="p">))</span>
  791             
  792         <span class="n">CanonicalDataLabel</span> <span class="o">=</span> <span class="n">DataLabel</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
  793         <span class="k">if</span> <span class="ow">not</span> <span class="n">CanonicalDataLabel</span> <span class="ow">in</span> <span class="n">DataMap</span><span class="p">[</span><span class="s2">&quot;CanonicalDataLabelsMap&quot;</span><span class="p">]:</span>
  794             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The data label specified, </span><span class="si">%s</span><span class="s2">, using option </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> doesn&#39;t exist in input file.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">DataLabel</span><span class="p">,</span> <span class="n">OptionName</span><span class="p">))</span>
  795         
  796         <span class="n">Label</span> <span class="o">=</span> <span class="n">DataMap</span><span class="p">[</span><span class="s2">&quot;CanonicalDataLabelsMap&quot;</span><span class="p">][</span><span class="n">CanonicalDataLabel</span><span class="p">]</span>
  797         <span class="k">if</span> <span class="n">DataMap</span><span class="p">[</span><span class="s2">&quot;StructureDataMap&quot;</span><span class="p">][</span><span class="n">Label</span><span class="p">]:</span>
  798             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The data label specified, </span><span class="si">%s</span><span class="s2">, using option </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> must not correspond to structure data: Valid structure data labels contain </span><span class="se">\&quot;</span><span class="s2">SMILES</span><span class="se">\&quot;</span><span class="s2"> in their name..&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">DataLabel</span><span class="p">,</span> <span class="n">OptionName</span><span class="p">))</span>
  799 
  800 <span class="k">def</span> <span class="nf">SetupMolInLineSVGImageTag</span><span class="p">(</span><span class="n">Mol</span><span class="p">,</span> <span class="n">HightlightAtomList</span><span class="p">):</span>
  801     <span class="sd">&quot;&quot;&quot;Setup a inline SVG image tag for molecule.&quot;&quot;&quot;</span>
  802 
  803     <span class="n">SVGText</span> <span class="o">=</span> <span class="n">RDKitUtil</span><span class="o">.</span><span class="n">GetInlineSVGForMolecule</span><span class="p">(</span><span class="n">Mol</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MolImageWidth&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MolImageHeight&quot;</span><span class="p">],</span> <span class="n">AtomListToHighlight</span> <span class="o">=</span> <span class="n">HightlightAtomList</span><span class="p">,</span> <span class="n">Base64Encoded</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MolImageEncoded&quot;</span><span class="p">])</span>
  804 
  805     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MolImageEncoded&quot;</span><span class="p">]:</span>
  806         <span class="n">SVGInlineImageTag</span> <span class="o">=</span> <span class="s2">&quot;img src=</span><span class="se">\&quot;</span><span class="s2">data:image/svg+xml;base64,</span><span class="se">\n</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">SVGText</span>
  807     <span class="k">else</span><span class="p">:</span>
  808         <span class="n">SVGInlineImageTag</span> <span class="o">=</span> <span class="s2">&quot;img src=</span><span class="se">\&quot;</span><span class="s2">data:image/svg+xml;charset=UTF-8,</span><span class="se">\n</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">SVGText</span>
  809     
  810     <span class="k">return</span> <span class="n">SVGInlineImageTag</span>
  811 
  812 <span class="k">def</span> <span class="nf">SetupAtomListToHighlight</span><span class="p">(</span><span class="n">Mol</span><span class="p">,</span> <span class="n">DataLabel</span><span class="p">):</span>
  813     <span class="sd">&quot;&quot;&quot;Set up atom list to highlight using specified SMARTS patterns.&quot;&quot;&quot;</span>
  814 
  815     <span class="n">HighlightAtomList</span> <span class="o">=</span> <span class="bp">None</span>
  816     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightSMARTS&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
  817         <span class="k">return</span>  <span class="n">HighlightAtomList</span>
  818 
  819     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightSMARTSAllMode&quot;</span><span class="p">]:</span>
  820         <span class="n">PatternMol</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightSMARTSPatternMol&quot;</span><span class="p">]</span>
  821     <span class="k">else</span><span class="p">:</span>
  822         <span class="n">CanonicalDataLabel</span> <span class="o">=</span> <span class="n">DataLabel</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
  823         <span class="k">if</span> <span class="ow">not</span> <span class="n">CanonicalDataLabel</span> <span class="ow">in</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightSMARTSCanonicalDataLabelsMap&quot;</span><span class="p">]:</span>
  824             <span class="k">return</span>  <span class="n">HighlightAtomList</span>
  825         
  826         <span class="n">Label</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightSMARTSCanonicalDataLabelsMap&quot;</span><span class="p">][</span><span class="n">CanonicalDataLabel</span><span class="p">]</span>
  827         <span class="n">PatternMol</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightSMARTSPatternMolsMap&quot;</span><span class="p">][</span><span class="n">Label</span><span class="p">]</span>
  828         
  829     <span class="c1"># Get matched atom lists and flatten it...</span>
  830     <span class="n">MatchedAtomsLists</span> <span class="o">=</span> <span class="n">Mol</span><span class="o">.</span><span class="n">GetSubstructMatches</span><span class="p">(</span><span class="n">PatternMol</span><span class="p">)</span>
  831     <span class="n">MatchedAtoms</span> <span class="o">=</span> <span class="p">[</span> <span class="n">Atom</span> <span class="k">for</span> <span class="n">AtomsList</span> <span class="ow">in</span> <span class="n">MatchedAtomsLists</span> <span class="k">for</span> <span class="n">Atom</span> <span class="ow">in</span> <span class="n">AtomsList</span><span class="p">]</span>
  832 
  833     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">MatchedAtoms</span><span class="p">):</span>
  834         <span class="n">HighlightAtomList</span> <span class="o">=</span> <span class="n">MatchedAtoms</span>
  835     
  836     <span class="k">return</span>  <span class="n">HighlightAtomList</span>
  837 
  838 <span class="k">def</span> <span class="nf">GetAlphanumeircValueHighlightBackgroundColor</span><span class="p">(</span><span class="n">DataLabel</span><span class="p">,</span> <span class="n">DataValue</span><span class="p">,</span> <span class="n">DataMap</span><span class="p">):</span>
  839     <span class="sd">&quot;&quot;&quot;Get background highlight color for a value.&quot;&quot;&quot;</span>
  840 
  841     <span class="n">BackgroundColor</span> <span class="o">=</span> <span class="bp">None</span>
  842     <span class="n">BackgroundColorType</span> <span class="o">=</span> <span class="bp">None</span>
  843     
  844     <span class="n">CanonicalDataLabel</span> <span class="o">=</span><span class="n">DataLabel</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
  845     <span class="k">if</span> <span class="n">CanonicalDataLabel</span> <span class="ow">in</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightValuesCanonicalLabelsMap&quot;</span><span class="p">]:</span>
  846         <span class="k">return</span> <span class="n">GetBackgroundColorUsingHighlightValuesMode</span><span class="p">(</span><span class="n">DataLabel</span><span class="p">,</span> <span class="n">DataValue</span><span class="p">,</span> <span class="n">DataMap</span><span class="p">)</span>
  847     <span class="k">elif</span> <span class="n">CanonicalDataLabel</span> <span class="ow">in</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightRangesCanonicalLabelsMap&quot;</span><span class="p">]:</span>
  848         <span class="k">return</span> <span class="n">GetBackgroundColorUsingHighlightRangesMode</span><span class="p">(</span><span class="n">DataLabel</span><span class="p">,</span> <span class="n">DataValue</span><span class="p">,</span> <span class="n">DataMap</span><span class="p">)</span>
  849     <span class="k">elif</span> <span class="n">CanonicalDataLabel</span> <span class="ow">in</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightClassesCanonicalLabelsMap&quot;</span><span class="p">]:</span>
  850         <span class="k">return</span> <span class="n">GetBackgroundColorUsingHighlightClassesMode</span><span class="p">(</span><span class="n">DataLabel</span><span class="p">,</span> <span class="n">DataValue</span><span class="p">,</span> <span class="n">DataMap</span><span class="p">)</span>
  851     <span class="k">elif</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightClassesRandom&quot;</span><span class="p">]:</span>
  852         <span class="k">return</span> <span class="n">GetBackgroundColorUsingRandomMode</span><span class="p">(</span><span class="n">DataLabel</span><span class="p">,</span> <span class="n">DataValue</span><span class="p">,</span> <span class="n">DataMap</span><span class="p">)</span>
  853     
  854     <span class="k">return</span> <span class="p">(</span><span class="n">BackgroundColor</span><span class="p">,</span> <span class="n">BackgroundColorType</span><span class="p">)</span>
  855     
  856 <span class="k">def</span> <span class="nf">GetBackgroundColorUsingHighlightValuesMode</span><span class="p">(</span><span class="n">DataLabel</span><span class="p">,</span> <span class="n">DataValue</span><span class="p">,</span> <span class="n">DataMap</span><span class="p">):</span>
  857     <span class="sd">&quot;&quot;&quot;Get background highlight color for a value.&quot;&quot;&quot;</span>
  858 
  859     <span class="n">BackgroundColor</span> <span class="o">=</span> <span class="bp">None</span>
  860     <span class="n">BackgroundColorType</span> <span class="o">=</span> <span class="bp">None</span>
  861 
  862     <span class="n">CanonicalDataLabel</span> <span class="o">=</span><span class="n">DataLabel</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
  863     <span class="k">if</span> <span class="ow">not</span> <span class="n">CanonicalDataLabel</span> <span class="ow">in</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightValuesCanonicalLabelsMap&quot;</span><span class="p">]:</span>
  864         <span class="k">return</span> <span class="p">(</span><span class="n">BackgroundColor</span><span class="p">,</span> <span class="n">BackgroundColorType</span><span class="p">)</span>
  865 
  866     <span class="n">Label</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightValuesCanonicalLabelsMap&quot;</span><span class="p">][</span><span class="n">CanonicalDataLabel</span><span class="p">]</span>
  867     <span class="n">DataType</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightValuesTypesMap&quot;</span><span class="p">][</span><span class="n">Label</span><span class="p">]</span>
  868     <span class="n">Criterion</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightValuesCriteriaMap&quot;</span><span class="p">][</span><span class="n">Label</span><span class="p">]</span>
  869     <span class="n">CriterionValue</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightValuesCriteriaValuesMap&quot;</span><span class="p">][</span><span class="n">Label</span><span class="p">]</span>
  870 
  871     <span class="k">return</span> <span class="n">GetBackgroundColorForHighlightingValue</span><span class="p">(</span><span class="n">DataLabel</span><span class="p">,</span> <span class="n">DataValue</span><span class="p">,</span> <span class="n">DataType</span><span class="p">,</span> <span class="n">Criterion</span><span class="p">,</span> <span class="n">CriterionValue</span><span class="p">)</span>
  872     
  873 <span class="k">def</span> <span class="nf">GetBackgroundColorUsingHighlightClassesMode</span><span class="p">(</span><span class="n">DataLabel</span><span class="p">,</span> <span class="n">DataValue</span><span class="p">,</span> <span class="n">DataMap</span><span class="p">):</span>
  874     <span class="sd">&quot;&quot;&quot;Get background highlight color for a value.&quot;&quot;&quot;</span>
  875 
  876     <span class="n">BackgroundColor</span> <span class="o">=</span> <span class="bp">None</span>
  877     <span class="n">BackgroundColorType</span> <span class="o">=</span> <span class="bp">None</span>
  878 
  879     <span class="n">CanonicalDataLabel</span> <span class="o">=</span><span class="n">DataLabel</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
  880     <span class="k">if</span> <span class="ow">not</span> <span class="n">CanonicalDataLabel</span> <span class="ow">in</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightClassesCanonicalLabelsMap&quot;</span><span class="p">]:</span>
  881         <span class="k">return</span> <span class="p">(</span><span class="n">BackgroundColor</span><span class="p">,</span> <span class="n">BackgroundColorType</span><span class="p">)</span>
  882 
  883     <span class="n">Label</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightClassesCanonicalLabelsMap&quot;</span><span class="p">][</span><span class="n">CanonicalDataLabel</span><span class="p">]</span>
  884     <span class="n">DataType</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightClassesTypesMap&quot;</span><span class="p">][</span><span class="n">Label</span><span class="p">]</span>
  885     <span class="n">Criterion</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightClassesCriteriaMap&quot;</span><span class="p">][</span><span class="n">Label</span><span class="p">]</span>
  886     <span class="n">CriterionValue</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightClassesCriteriaValuesMap&quot;</span><span class="p">][</span><span class="n">Label</span><span class="p">]</span>
  887 
  888     <span class="k">return</span> <span class="n">GetBackgroundColorForHighlightingValue</span><span class="p">(</span><span class="n">DataLabel</span><span class="p">,</span> <span class="n">DataValue</span><span class="p">,</span> <span class="n">DataType</span><span class="p">,</span> <span class="n">Criterion</span><span class="p">,</span> <span class="n">CriterionValue</span><span class="p">)</span>
  889 
  890 <span class="k">def</span> <span class="nf">GetBackgroundColorForHighlightingValue</span><span class="p">(</span><span class="n">DataLabel</span><span class="p">,</span> <span class="n">DataValue</span><span class="p">,</span> <span class="n">DataType</span><span class="p">,</span> <span class="n">Criterion</span><span class="p">,</span> <span class="n">CriterionValue</span><span class="p">):</span>
  891     <span class="sd">&quot;&quot;&quot;Get background color for highlighting a value.&quot;&quot;&quot;</span>
  892     
  893     <span class="n">ValueOkay</span> <span class="o">=</span> <span class="bp">False</span>
  894     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^numeric$&quot;</span><span class="p">,</span> <span class="n">DataType</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  895         <span class="k">if</span> <span class="ow">not</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">IsNumber</span><span class="p">(</span><span class="n">DataValue</span><span class="p">):</span>
  896             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;Ignoring data value, </span><span class="si">%s</span><span class="s2">, for data label, </span><span class="si">%s</span><span class="s2">, during numeric highlighting: It must be a number&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">DataValue</span><span class="p">,</span> <span class="n">DataLabel</span><span class="p">))</span>
  897             <span class="k">return</span> <span class="p">(</span><span class="n">BackgroundColor</span><span class="p">,</span> <span class="n">BackgroundColorType</span><span class="p">)</span>
  898         
  899         <span class="n">DataValue</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">DataValue</span><span class="p">)</span>
  900         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^gt$&quot;</span><span class="p">,</span> <span class="n">Criterion</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  901             <span class="n">ValueOkay</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">DataValue</span> <span class="o">&gt;</span> <span class="n">CriterionValue</span> <span class="k">else</span> <span class="bp">False</span>
  902         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^lt$&quot;</span><span class="p">,</span> <span class="n">Criterion</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  903             <span class="n">ValueOkay</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">DataValue</span> <span class="o">&lt;</span> <span class="n">CriterionValue</span> <span class="k">else</span> <span class="bp">False</span>
  904         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^ge$&quot;</span><span class="p">,</span> <span class="n">Criterion</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  905             <span class="n">ValueOkay</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">DataValue</span> <span class="o">&gt;=</span> <span class="n">CriterionValue</span> <span class="k">else</span> <span class="bp">False</span>
  906         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^le$&quot;</span><span class="p">,</span> <span class="n">Criterion</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  907             <span class="n">ValueOkay</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">DataValue</span> <span class="o">&lt;=</span> <span class="n">CriterionValue</span> <span class="k">else</span> <span class="bp">False</span>
  908         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^eq$&quot;</span><span class="p">,</span> <span class="n">Criterion</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  909             <span class="n">ValueOkay</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">DataValue</span> <span class="o">==</span> <span class="n">CriterionValue</span> <span class="k">else</span> <span class="bp">False</span>
  910         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^ne$&quot;</span><span class="p">,</span> <span class="n">Criterion</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  911             <span class="n">ValueOkay</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">DataValue</span> <span class="o">!=</span> <span class="n">CriterionValue</span> <span class="k">else</span> <span class="bp">False</span>
  912         <span class="k">else</span><span class="p">:</span>
  913             <span class="k">return</span> <span class="p">(</span><span class="n">BackgroundColor</span><span class="p">,</span> <span class="n">BackgroundColorType</span><span class="p">)</span>
  914     <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^text$&quot;</span><span class="p">,</span> <span class="n">DataType</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  915         <span class="n">DataValue</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">DataValue</span>
  916         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^gt$&quot;</span><span class="p">,</span> <span class="n">Criterion</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  917             <span class="n">ValueOkay</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">DataValue</span> <span class="o">&gt;</span> <span class="n">CriterionValue</span> <span class="k">else</span> <span class="bp">False</span>
  918         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^lt$&quot;</span><span class="p">,</span> <span class="n">Criterion</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  919             <span class="n">ValueOkay</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">DataValue</span> <span class="o">&lt;</span> <span class="n">CriterionValue</span> <span class="k">else</span> <span class="bp">False</span>
  920         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^ge$&quot;</span><span class="p">,</span> <span class="n">Criterion</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  921             <span class="n">ValueOkay</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">DataValue</span> <span class="o">&gt;=</span> <span class="n">CriterionValue</span> <span class="k">else</span> <span class="bp">False</span>
  922         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^le$&quot;</span><span class="p">,</span> <span class="n">Criterion</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  923             <span class="n">ValueOkay</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">DataValue</span> <span class="o">&lt;=</span> <span class="n">CriterionValue</span> <span class="k">else</span> <span class="bp">False</span>
  924         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^eq$&quot;</span><span class="p">,</span> <span class="n">Criterion</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  925             <span class="n">ValueOkay</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">DataValue</span> <span class="o">==</span> <span class="n">CriterionValue</span> <span class="k">else</span> <span class="bp">False</span>
  926         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^ne$&quot;</span><span class="p">,</span> <span class="n">Criterion</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  927             <span class="n">ValueOkay</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">DataValue</span> <span class="o">!=</span> <span class="n">CriterionValue</span> <span class="k">else</span> <span class="bp">False</span>
  928         <span class="k">else</span><span class="p">:</span>
  929             <span class="k">return</span> <span class="p">(</span><span class="n">BackgroundColor</span><span class="p">,</span> <span class="n">BackgroundColorType</span><span class="p">)</span>
  930     <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^regex$&quot;</span><span class="p">,</span> <span class="n">DataType</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  931         <span class="n">DataValue</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">DataValue</span>
  932         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^eq$&quot;</span><span class="p">,</span> <span class="n">Criterion</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  933             <span class="n">ValueOkay</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">CriterionValue</span><span class="p">,</span> <span class="n">DataValue</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
  934         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^ne$&quot;</span><span class="p">,</span> <span class="n">Criterion</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  935             <span class="n">ValueOkay</span> <span class="o">=</span> <span class="bp">False</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">CriterionValue</span><span class="p">,</span> <span class="n">DataValue</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">True</span>
  936         <span class="k">else</span><span class="p">:</span>
  937             <span class="k">return</span> <span class="p">(</span><span class="n">BackgroundColor</span><span class="p">,</span> <span class="n">BackgroundColorType</span><span class="p">)</span>
  938 
  939     <span class="n">BackgroundColor</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightColorsList&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">ValueOkay</span> <span class="k">else</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightColorsList&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
  940     <span class="n">BackgroundColorType</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightColorsType&quot;</span><span class="p">]</span>
  941     
  942     <span class="k">return</span> <span class="p">(</span><span class="n">BackgroundColor</span><span class="p">,</span> <span class="n">BackgroundColorType</span><span class="p">)</span>
  943 
  944 <span class="k">def</span> <span class="nf">GetBackgroundColorUsingHighlightRangesMode</span><span class="p">(</span><span class="n">DataLabel</span><span class="p">,</span> <span class="n">DataValue</span><span class="p">,</span> <span class="n">DataMap</span><span class="p">):</span>
  945     <span class="sd">&quot;&quot;&quot;Get background highlight color for value range.&quot;&quot;&quot;</span>
  946 
  947     <span class="n">BackgroundColor</span> <span class="o">=</span> <span class="bp">None</span>
  948     <span class="n">BackgroundColorType</span> <span class="o">=</span> <span class="bp">None</span>
  949 
  950     <span class="n">CanonicalDataLabel</span> <span class="o">=</span><span class="n">DataLabel</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
  951     <span class="k">if</span> <span class="ow">not</span> <span class="n">CanonicalDataLabel</span> <span class="ow">in</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightRangesCanonicalLabelsMap&quot;</span><span class="p">]:</span>
  952         <span class="k">return</span> <span class="p">(</span><span class="n">BackgroundColor</span><span class="p">,</span> <span class="n">BackgroundColorType</span><span class="p">)</span>
  953 
  954     <span class="n">Label</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightRangesCanonicalLabelsMap&quot;</span><span class="p">][</span><span class="n">CanonicalDataLabel</span><span class="p">]</span>
  955     <span class="n">DataType</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightRangesTypesMap&quot;</span><span class="p">][</span><span class="n">Label</span><span class="p">]</span>
  956     <span class="n">CriterionLower</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightRangesCriteriaLowerMap&quot;</span><span class="p">][</span><span class="n">Label</span><span class="p">]</span>
  957     <span class="n">CriterionLowerValue</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightRangesCriteriaLowerValuesMap&quot;</span><span class="p">][</span><span class="n">Label</span><span class="p">]</span>
  958     <span class="n">CriterionUpper</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightRangesCriteriaUpperMap&quot;</span><span class="p">][</span><span class="n">Label</span><span class="p">]</span>
  959     <span class="n">CriterionUpperValue</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightRangesCriteriaUpperValuesMap&quot;</span><span class="p">][</span><span class="n">Label</span><span class="p">]</span>
  960     
  961     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^numeric$&quot;</span><span class="p">,</span> <span class="n">DataType</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  962         <span class="k">if</span> <span class="ow">not</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">IsNumber</span><span class="p">(</span><span class="n">DataValue</span><span class="p">):</span>
  963             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;Ignoring data value, </span><span class="si">%s</span><span class="s2">, for data label, </span><span class="si">%s</span><span class="s2">, during numeric highlighting: It must be a number&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">DataValue</span><span class="p">,</span> <span class="n">DataLabel</span><span class="p">))</span>
  964             <span class="k">return</span> <span class="p">(</span><span class="n">BackgroundColor</span><span class="p">,</span> <span class="n">BackgroundColorType</span><span class="p">)</span>
  965         
  966         <span class="n">DataValue</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">DataValue</span><span class="p">)</span>
  967         <span class="n">ColorIndex</span> <span class="o">=</span> <span class="mi">1</span>
  968         
  969         <span class="k">if</span> <span class="n">DataValue</span> <span class="o">&lt;</span> <span class="n">CriterionLowerValue</span> <span class="ow">and</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^lt$&quot;</span><span class="p">,</span> <span class="n">CriterionLower</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  970             <span class="n">ColorIndex</span> <span class="o">=</span> <span class="mi">0</span>
  971         <span class="k">elif</span> <span class="n">DataValue</span> <span class="o">&lt;=</span> <span class="n">CriterionLowerValue</span> <span class="ow">and</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^le$&quot;</span><span class="p">,</span> <span class="n">CriterionLower</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  972             <span class="n">ColorIndex</span> <span class="o">=</span> <span class="mi">0</span>
  973         <span class="k">elif</span> <span class="n">DataValue</span> <span class="o">&gt;</span> <span class="n">CriterionUpperValue</span> <span class="ow">and</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^gt$&quot;</span><span class="p">,</span> <span class="n">CriterionUpper</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  974             <span class="n">ColorIndex</span> <span class="o">=</span> <span class="mi">2</span>
  975         <span class="k">elif</span> <span class="n">DataValue</span> <span class="o">&gt;=</span> <span class="n">CriterionUpperValue</span> <span class="ow">and</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^ge$&quot;</span><span class="p">,</span> <span class="n">CriterionUpper</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  976             <span class="n">ColorIndex</span> <span class="o">=</span> <span class="mi">2</span>
  977     <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^text$&quot;</span><span class="p">,</span> <span class="n">DataType</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  978         <span class="n">DataValue</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">DataValue</span>
  979         <span class="n">ColorIndex</span> <span class="o">=</span> <span class="mi">1</span>
  980         
  981         <span class="k">if</span> <span class="n">DataValue</span> <span class="o">&lt;</span> <span class="n">CriterionLowerValue</span> <span class="ow">and</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^lt$&quot;</span><span class="p">,</span> <span class="n">CriterionLower</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  982             <span class="n">ColorIndex</span> <span class="o">=</span> <span class="mi">0</span>
  983         <span class="k">elif</span> <span class="n">DataValue</span> <span class="o">&lt;=</span> <span class="n">CriterionLowerValue</span> <span class="ow">and</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^le$&quot;</span><span class="p">,</span> <span class="n">CriterionLower</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  984             <span class="n">ColorIndex</span> <span class="o">=</span> <span class="mi">0</span>
  985         <span class="k">elif</span> <span class="n">DataValue</span> <span class="o">&gt;</span> <span class="n">CriterionUpperValue</span> <span class="ow">and</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^gt$&quot;</span><span class="p">,</span> <span class="n">CriterionUpper</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  986             <span class="n">ColorIndex</span> <span class="o">=</span> <span class="mi">2</span>
  987         <span class="k">elif</span> <span class="n">DataValue</span> <span class="o">&gt;=</span> <span class="n">CriterionUpperValue</span> <span class="ow">and</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^ge$&quot;</span><span class="p">,</span> <span class="n">CriterionUpper</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  988             <span class="n">ColorIndex</span> <span class="o">=</span> <span class="mi">2</span>
  989     <span class="k">else</span><span class="p">:</span>
  990         <span class="k">return</span> <span class="p">(</span><span class="n">BackgroundColor</span><span class="p">,</span> <span class="n">BackgroundColorType</span><span class="p">)</span>
  991 
  992     <span class="n">BackgroundColor</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightColorsRangesList&quot;</span><span class="p">][</span><span class="n">ColorIndex</span><span class="p">]</span>
  993     <span class="n">BackgroundColorType</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightColorsRangesType&quot;</span><span class="p">]</span>
  994     
  995     <span class="k">return</span> <span class="p">(</span><span class="n">BackgroundColor</span><span class="p">,</span> <span class="n">BackgroundColorType</span><span class="p">)</span>
  996 
  997 <span class="k">def</span> <span class="nf">GetBackgroundColorUsingRandomMode</span><span class="p">(</span><span class="n">DataLabel</span><span class="p">,</span> <span class="n">DataValue</span><span class="p">,</span> <span class="n">DataMap</span><span class="p">):</span>
  998     <span class="sd">&quot;&quot;&quot;Get a random background highlight color for a value.&quot;&quot;&quot;</span>
  999 
 1000     <span class="n">BackgroundColor</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightColorsRandomList&quot;</span><span class="p">])</span>
 1001     <span class="n">BackgroundColorType</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightColorsRandomType&quot;</span><span class="p">]</span>
 1002     
 1003     <span class="k">return</span> <span class="p">(</span><span class="n">BackgroundColor</span><span class="p">,</span> <span class="n">BackgroundColorType</span><span class="p">)</span>
 1004     
 1005 <span class="k">def</span> <span class="nf">SetupAlphanumericTableDataValue</span><span class="p">(</span><span class="n">Writer</span><span class="p">,</span> <span class="n">DataValue</span><span class="p">,</span> <span class="n">BackgroundColor</span><span class="p">,</span> <span class="n">BackgroundColorType</span><span class="p">):</span>
 1006     <span class="sd">&quot;&quot;&quot;Set up alphanumeric data value for a table cell.&quot;&quot;&quot;</span>
 1007     
 1008     <span class="n">WrappedDataValue</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">DataValue</span>
 1009 
 1010     <span class="c1"># Look for new lines...</span>
 1011     <span class="n">Delim</span> <span class="o">=</span> <span class="s2">&quot;&lt;br/&gt;&quot;</span>
 1012     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">&quot;(</span><span class="se">\r\n</span><span class="s2">|</span><span class="se">\r</span><span class="s2">|</span><span class="se">\n</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">WrappedDataValue</span><span class="p">):</span>
 1013         <span class="n">WrappedDataValue</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;(</span><span class="se">\r\n</span><span class="s2">|</span><span class="se">\r</span><span class="s2">|</span><span class="se">\n</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="s2">&quot;&lt;br/&gt;&quot;</span><span class="p">,</span> <span class="n">DataValue</span><span class="p">)</span>
 1014 
 1015     <span class="c1"># Wrap text...</span>
 1016     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;WrapText&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">WrappedDataValue</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;WrapTextWidth&quot;</span><span class="p">]:</span>
 1017         <span class="n">WrappedDataLines</span> <span class="o">=</span> <span class="p">[]</span>
 1018         <span class="k">for</span> <span class="n">DataLine</span> <span class="ow">in</span> <span class="n">WrappedDataValue</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;&lt;br/&gt;&quot;</span><span class="p">):</span>
 1019             <span class="n">WrappedDataLine</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">WrapText</span><span class="p">(</span><span class="n">DataLine</span><span class="p">,</span> <span class="s2">&quot;&lt;br/&gt;&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;WrapTextWidth&quot;</span><span class="p">])</span>
 1020             <span class="n">WrappedDataLines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">WrappedDataLine</span><span class="p">)</span>
 1021         
 1022         <span class="n">WrappedDataValue</span> <span class="o">=</span> <span class="s2">&quot;&lt;br/&gt;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">WrappedDataLines</span><span class="p">)</span>
 1023     
 1024     <span class="c1"># Highlight value...</span>
 1025     <span class="k">if</span> <span class="n">BackgroundColor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
 1026         <span class="n">ColorTypeTag</span> <span class="o">=</span> <span class="n">GetBackgroundColorTypeTagForTableValue</span><span class="p">(</span><span class="n">BackgroundColor</span><span class="p">,</span> <span class="n">BackgroundColorType</span><span class="p">)</span>
 1027         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;            &lt;td </span><span class="si">%s</span><span class="s2"> = &quot;</span><span class="si">%s</span><span class="s2">&quot;&gt;</span><span class="si">%s</span><span class="s2">&lt;/td&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ColorTypeTag</span><span class="p">,</span> <span class="n">BackgroundColor</span><span class="p">,</span> <span class="n">WrappedDataValue</span><span class="p">))</span>
 1028     <span class="k">else</span><span class="p">:</span>
 1029         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;            &lt;td&gt;</span><span class="si">%s</span><span class="s2">&lt;/td&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">WrappedDataValue</span><span class="p">)</span>
 1030 
 1031 <span class="k">def</span> <span class="nf">GetBackgroundColorTypeTagForTableValue</span><span class="p">(</span><span class="n">Color</span><span class="p">,</span> <span class="n">ColorType</span><span class="p">):</span>
 1032     <span class="sd">&quot;&quot;&quot;Setup color type tage for setting background of a table value.&quot;&quot;&quot;</span>
 1033 
 1034     <span class="n">ColorTypeTag</span> <span class="o">=</span> <span class="s2">&quot;class&quot;</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^colorclass&quot;</span><span class="p">,</span> <span class="n">ColorType</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;bgcolor&quot;</span>
 1035     
 1036     <span class="k">return</span> <span class="n">ColorTypeTag</span>
 1037     
 1038 <span class="k">def</span> <span class="nf">PerformAlignment</span><span class="p">(</span><span class="n">ValidMols</span><span class="p">):</span>
 1039     <span class="sd">&quot;&quot;&quot;Perform alignment to a common template specified by a SMARTS pattern.&quot;&quot;&quot;</span>
 1040     
 1041     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AlignmentSMARTSPattern&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
 1042         <span class="k">return</span>
 1043     
 1044     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Performing alignment for primary structure data...&quot;</span><span class="p">)</span>
 1045     
 1046     <span class="n">PatternMol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmarts</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AlignmentSMARTSPattern&quot;</span><span class="p">])</span>
 1047     <span class="n">AllChem</span><span class="o">.</span><span class="n">Compute2DCoords</span><span class="p">(</span><span class="n">PatternMol</span><span class="p">)</span>
 1048         
 1049     <span class="n">MatchedValidMols</span> <span class="o">=</span> <span class="p">[</span><span class="n">ValidMol</span> <span class="k">for</span> <span class="n">ValidMol</span> <span class="ow">in</span> <span class="n">ValidMols</span> <span class="k">if</span> <span class="n">ValidMol</span><span class="o">.</span><span class="n">HasSubstructMatch</span><span class="p">(</span><span class="n">PatternMol</span><span class="p">)]</span>
 1050     <span class="k">for</span> <span class="n">ValidMol</span> <span class="ow">in</span> <span class="n">MatchedValidMols</span><span class="p">:</span>
 1051         <span class="n">AllChem</span><span class="o">.</span><span class="n">GenerateDepictionMatching2DStructure</span><span class="p">(</span><span class="n">ValidMol</span><span class="p">,</span> <span class="n">PatternMol</span><span class="p">)</span>
 1052 
 1053 <span class="k">def</span> <span class="nf">ProcessHighlightSMARTSOption</span><span class="p">():</span>
 1054     <span class="sd">&quot;&quot;&quot;Process highlight SMARTS option&quot;&quot;&quot;</span>
 1055 
 1056     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightSMARTS&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="bp">None</span>
 1057     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightSMARTSAllMode&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="bp">False</span>
 1058     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightSMARTSPatternMol&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="bp">None</span>
 1059     
 1060     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightSMARTSDataLabels&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="p">[]</span>
 1061     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightSMARTSDataLabelsMap&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="p">{}</span>
 1062     
 1063     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightSMARTSCanonicalDataLabelsMap&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="p">{}</span>
 1064     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightSMARTSPatternsMap&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="p">{}</span>
 1065     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightSMARTSPatternMolsMap&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="p">{}</span>
 1066 
 1067     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^None$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--highlightSMARTS&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1068         <span class="c1"># Nothing to proecess...</span>
 1069         <span class="k">return</span>
 1070     
 1071     <span class="n">HighlightSMARTS</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--highlightSMARTS&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
 1072     <span class="k">if</span> <span class="ow">not</span> <span class="n">HighlightSMARTS</span><span class="p">:</span>
 1073         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;No valid values specified using </span><span class="se">\&quot;</span><span class="s2">--highlightSMARTS</span><span class="se">\&quot;</span><span class="s2"> option.&quot;</span><span class="p">)</span>
 1074 
 1075     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightSMARTS&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">HighlightSMARTS</span>
 1076     <span class="n">HighlightSMARTSWords</span> <span class="o">=</span> <span class="n">HighlightSMARTS</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
 1077 
 1078     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">HighlightSMARTSWords</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
 1079         <span class="n">PatternMol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmarts</span><span class="p">(</span><span class="n">HighlightSMARTS</span><span class="p">)</span>
 1080         <span class="k">if</span> <span class="n">PatternMol</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
 1081             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The value specified, </span><span class="si">%s</span><span class="s2">, using option </span><span class="se">\&quot;</span><span class="s2">--highlightSMARTS</span><span class="se">\&quot;</span><span class="s2"> is not a valid SMARTS: Failed to create pattern molecule&quot;</span> <span class="o">%</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--highlightSMARTS&quot;</span><span class="p">])</span>
 1082         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightSMARTSAllMode&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="bp">True</span>
 1083         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightSMARTSPatternMol&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">PatternMol</span>
 1084         <span class="k">return</span>
 1085     
 1086     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">HighlightSMARTSWords</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span><span class="p">:</span>
 1087         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The number of comma delimited paramater names and values, </span><span class="si">%d</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="s2">--highlightSMARTS</span><span class="se">\&quot;</span><span class="s2"> option must be an even number.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">HighlightSMARTSWords</span><span class="p">)))</span>
 1088     
 1089     <span class="n">HighlightSMARTSAllMode</span> <span class="o">=</span> <span class="bp">False</span>
 1090             
 1091     <span class="k">for</span> <span class="n">Index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">HighlightSMARTSWords</span><span class="p">),</span> <span class="mi">2</span><span class="p">):</span>
 1092         <span class="n">DataLabel</span> <span class="o">=</span> <span class="n">HighlightSMARTSWords</span><span class="p">[</span><span class="n">Index</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
 1093         <span class="n">SMARTSPattern</span> <span class="o">=</span> <span class="n">HighlightSMARTSWords</span><span class="p">[</span><span class="n">Index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
 1094                 
 1095         <span class="n">PatternMol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmarts</span><span class="p">(</span><span class="n">SMARTSPattern</span><span class="p">)</span>
 1096         <span class="k">if</span> <span class="n">PatternMol</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
 1097             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The value specified, </span><span class="si">%s</span><span class="s2">, using option </span><span class="se">\&quot;</span><span class="s2">--highlightSMARTS</span><span class="se">\&quot;</span><span class="s2"> is not a valid SMARTS: Failed to create pattern molecule&quot;</span> <span class="o">%</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--highlightSMARTS&quot;</span><span class="p">])</span>
 1098 
 1099         <span class="k">if</span> <span class="n">DataLabel</span> <span class="ow">in</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightSMARTSDataLabelsMap&quot;</span><span class="p">]:</span>
 1100             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The datalabel, </span><span class="si">%s</span><span class="s2">, specified in pair, </span><span class="se">\&quot;</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">, using option </span><span class="se">\&quot;</span><span class="s2">--highlightSMARTS</span><span class="se">\&quot;</span><span class="s2"> is not a valid: Multiple occurences of data label&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">DataLabel</span><span class="p">,</span> <span class="n">DataLabel</span><span class="p">,</span> <span class="n">SMARTSPattern</span><span class="p">))</span>
 1101             
 1102         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightSMARTSDataLabels&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DataLabel</span><span class="p">)</span>
 1103         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightSMARTSDataLabelsMap&quot;</span><span class="p">][</span><span class="n">DataLabel</span><span class="p">]</span> <span class="o">=</span> <span class="n">DataLabel</span>
 1104         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightSMARTSCanonicalDataLabelsMap&quot;</span><span class="p">][</span><span class="n">DataLabel</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="o">=</span> <span class="n">DataLabel</span>
 1105         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightSMARTSPatternsMap&quot;</span><span class="p">][</span><span class="n">DataLabel</span><span class="p">]</span> <span class="o">=</span> <span class="n">SMARTSPattern</span>
 1106         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightSMARTSPatternMolsMap&quot;</span><span class="p">][</span><span class="n">DataLabel</span><span class="p">]</span> <span class="o">=</span> <span class="n">PatternMol</span>
 1107 
 1108 <span class="k">def</span> <span class="nf">ProcessHighlightDataOptions</span><span class="p">():</span>
 1109     <span class="sd">&quot;&quot;&quot;Process highlight values and colors option&quot;&quot;&quot;</span>
 1110     
 1111     <span class="n">ProcessHighlightValuesOption</span><span class="p">()</span>
 1112     <span class="n">ProcessHighlightValuesRangesOption</span><span class="p">()</span>
 1113     <span class="n">ProcessHighlightValuesClassesOption</span><span class="p">()</span>
 1114     
 1115     <span class="n">ProcessHighlightColorsOption</span><span class="p">()</span>
 1116     <span class="n">ProcessHighlightColorsRangesOption</span><span class="p">()</span>
 1117     <span class="n">ProcessHighlightColorsRandomOption</span><span class="p">()</span>
 1118 
 1119 <span class="k">def</span> <span class="nf">ProcessHighlightValuesOption</span><span class="p">():</span>
 1120     <span class="sd">&quot;&quot;&quot;Process highlight values option&quot;&quot;&quot;</span>
 1121 
 1122     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightValues&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="bp">None</span>
 1123     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightValuesLabels&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="p">[]</span>
 1124     
 1125     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightValuesLabelsMap&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="p">{}</span>
 1126     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightValuesCanonicalLabelsMap&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="p">{}</span>
 1127     
 1128     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightValuesTypesMap&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="p">{}</span>
 1129     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightValuesCriteriaMap&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="p">{}</span>
 1130     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightValuesCriteriaValuesMap&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="p">{}</span>
 1131 
 1132     <span class="n">HighlightValues</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--highlightValues&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
 1133     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^None$&quot;</span><span class="p">,</span> <span class="n">HighlightValues</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1134         <span class="k">return</span>
 1135     
 1136     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightValues&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">HighlightValues</span>
 1137     <span class="n">HighlightValuesWords</span> <span class="o">=</span> <span class="n">HighlightValues</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
 1138     
 1139     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">HighlightValuesWords</span><span class="p">)</span> <span class="o">%</span> <span class="mi">4</span><span class="p">:</span>
 1140         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The number of comma delimited paramater names and values, </span><span class="si">%d</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="s2">--highlightValues</span><span class="se">\&quot;</span><span class="s2"> option must be a multiple of 4.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">HighlightValuesWords</span><span class="p">)))</span>
 1141 
 1142     <span class="k">for</span> <span class="n">Index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">HighlightValuesWords</span><span class="p">),</span> <span class="mi">4</span><span class="p">):</span>
 1143         <span class="n">DataLabel</span> <span class="o">=</span> <span class="n">HighlightValuesWords</span><span class="p">[</span><span class="n">Index</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
 1144         <span class="n">DataType</span> <span class="o">=</span> <span class="n">HighlightValuesWords</span><span class="p">[</span><span class="n">Index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
 1145         <span class="n">DataCriterion</span> <span class="o">=</span> <span class="n">HighlightValuesWords</span><span class="p">[</span><span class="n">Index</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
 1146         <span class="n">DataValue</span> <span class="o">=</span> <span class="n">HighlightValuesWords</span><span class="p">[</span><span class="n">Index</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
 1147         
 1148         <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(numeric|text|regex)$&quot;</span><span class="p">,</span> <span class="n">DataType</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1149             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The data type, </span><span class="si">%s</span><span class="s2">, specified in quratet </span><span class="se">\&quot;</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="s2">--highlightValues</span><span class="se">\&quot;</span><span class="s2"> option is not valid. Supported values: numeric, regex or text.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">DataType</span><span class="p">,</span> <span class="n">DataLabel</span><span class="p">,</span> <span class="n">DataType</span><span class="p">,</span> <span class="n">DataCriterion</span><span class="p">,</span> <span class="n">DataValue</span><span class="p">))</span>
 1150         
 1151         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^regex$&quot;</span><span class="p">,</span> <span class="n">DataType</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1152             <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(eq|ne)$&quot;</span><span class="p">,</span> <span class="n">DataCriterion</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1153                 <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The data criterion, </span><span class="si">%s</span><span class="s2">, specified in quratet </span><span class="se">\&quot;</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="s2">--highlightValues</span><span class="se">\&quot;</span><span class="s2"> option is not valid. Supported values: eq or ne&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">DataType</span><span class="p">,</span> <span class="n">DataLabel</span><span class="p">,</span> <span class="n">DataType</span><span class="p">,</span> <span class="n">DataCriterion</span><span class="p">,</span> <span class="n">DataValue</span><span class="p">))</span>
 1154         <span class="k">else</span><span class="p">:</span>
 1155             <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(gt|lt|ge|le|eq|ne)$&quot;</span><span class="p">,</span> <span class="n">DataCriterion</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1156                 <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The data criterion, </span><span class="si">%s</span><span class="s2">, specified in quratet </span><span class="se">\&quot;</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="s2">--highlightValues</span><span class="se">\&quot;</span><span class="s2"> option is not valid. Supported values: gt, lt, ge, le, eq, or  ne.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">DataType</span><span class="p">,</span> <span class="n">DataLabel</span><span class="p">,</span> <span class="n">DataType</span><span class="p">,</span> <span class="n">DataCriterion</span><span class="p">,</span> <span class="n">DataValue</span><span class="p">))</span>
 1157 
 1158         <span class="c1"># Check criterion value...</span>
 1159         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^numeric$&quot;</span><span class="p">,</span> <span class="n">DataType</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1160             <span class="k">if</span> <span class="ow">not</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">IsNumber</span><span class="p">(</span><span class="n">DataValue</span><span class="p">):</span>
 1161                 <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The data value, </span><span class="si">%s</span><span class="s2">, specified in quratet </span><span class="se">\&quot;</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="s2">--highlightValues</span><span class="se">\&quot;</span><span class="s2"> option is not valid. It must be a number for data type, </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">DataType</span><span class="p">,</span> <span class="n">DataLabel</span><span class="p">,</span> <span class="n">DataType</span><span class="p">,</span> <span class="n">DataCriterion</span><span class="p">,</span> <span class="n">DataValue</span><span class="p">,</span> <span class="n">DataType</span><span class="p">))</span>
 1162             <span class="n">DataValue</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">DataValue</span><span class="p">)</span>
 1163         
 1164         <span class="c1"># Track values...</span>
 1165         <span class="k">if</span> <span class="n">DataLabel</span> <span class="ow">in</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightValuesLabelsMap&quot;</span><span class="p">]:</span>
 1166             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The data label, </span><span class="si">%s</span><span class="s2">, specified in quratet </span><span class="se">\&quot;</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="s2">--highlightValues</span><span class="se">\&quot;</span><span class="s2"> option is not valid: Multiple occurences of data label&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">DataLabel</span><span class="p">,</span> <span class="n">DataLabel</span><span class="p">,</span> <span class="n">DataType</span><span class="p">,</span> <span class="n">DataCriterion</span><span class="p">,</span> <span class="n">DataValue</span><span class="p">))</span>
 1167 
 1168         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightValuesLabels&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DataLabel</span><span class="p">)</span>
 1169         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightValuesLabelsMap&quot;</span><span class="p">][</span><span class="n">DataLabel</span><span class="p">]</span>  <span class="o">=</span> <span class="n">DataLabel</span>
 1170         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightValuesCanonicalLabelsMap&quot;</span><span class="p">][</span><span class="n">DataLabel</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span>  <span class="o">=</span> <span class="n">DataLabel</span>
 1171         
 1172         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightValuesTypesMap&quot;</span><span class="p">][</span><span class="n">DataLabel</span><span class="p">]</span>  <span class="o">=</span> <span class="n">DataType</span>
 1173         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightValuesCriteriaMap&quot;</span><span class="p">][</span><span class="n">DataLabel</span><span class="p">]</span>  <span class="o">=</span> <span class="n">DataCriterion</span> 
 1174         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightValuesCriteriaValuesMap&quot;</span><span class="p">][</span><span class="n">DataLabel</span><span class="p">]</span>  <span class="o">=</span> <span class="n">DataValue</span>
 1175 
 1176 <span class="k">def</span> <span class="nf">ProcessHighlightValuesRangesOption</span><span class="p">():</span>
 1177     <span class="sd">&quot;&quot;&quot;Process highlight values ranges option&quot;&quot;&quot;</span>
 1178     
 1179     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightRanges&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="bp">None</span>
 1180     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightRangesLabels&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="p">[]</span>
 1181     
 1182     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightRangesLabelsMap&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="p">{}</span>
 1183     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightRangesCanonicalLabelsMap&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="p">{}</span>
 1184     
 1185     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightRangesTypesMap&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="p">{}</span>
 1186     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightRangesCriteriaLowerMap&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="p">{}</span>
 1187     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightRangesCriteriaLowerValuesMap&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="p">{}</span>
 1188     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightRangesCriteriaUpperMap&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="p">{}</span>
 1189     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightRangesCriteriaUpperValuesMap&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="p">{}</span>
 1190 
 1191     <span class="n">HighlightRanges</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--highlightValuesRanges&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
 1192     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^None$&quot;</span><span class="p">,</span> <span class="n">HighlightRanges</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1193         <span class="k">return</span>
 1194     
 1195     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightRanges&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">HighlightRanges</span>
 1196     <span class="n">HighlightRangesWords</span> <span class="o">=</span> <span class="n">HighlightRanges</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
 1197     
 1198     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">HighlightRangesWords</span><span class="p">)</span> <span class="o">%</span> <span class="mi">6</span><span class="p">:</span>
 1199         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The number of comma delimited paramater names and values, </span><span class="si">%d</span><span class="s2">, specified in sextet </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> using </span><span class="se">\&quot;</span><span class="s2">--highlightValuesRanges</span><span class="se">\&quot;</span><span class="s2"> option must be a multiple of 6.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">HighlightRangesWords</span><span class="p">),</span> <span class="n">HighlightRanges</span><span class="p">))</span>
 1200 
 1201     <span class="k">for</span> <span class="n">Index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">HighlightRangesWords</span><span class="p">),</span> <span class="mi">6</span><span class="p">):</span>
 1202         <span class="n">DataLabel</span> <span class="o">=</span> <span class="n">HighlightRangesWords</span><span class="p">[</span><span class="n">Index</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
 1203         <span class="n">DataType</span> <span class="o">=</span> <span class="n">HighlightRangesWords</span><span class="p">[</span><span class="n">Index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
 1204         <span class="n">LowerBoundDataCriterion</span> <span class="o">=</span> <span class="n">HighlightRangesWords</span><span class="p">[</span><span class="n">Index</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
 1205         <span class="n">LowerBoundDataValue</span> <span class="o">=</span> <span class="n">HighlightRangesWords</span><span class="p">[</span><span class="n">Index</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
 1206         <span class="n">UpperBoundDataCriterion</span> <span class="o">=</span> <span class="n">HighlightRangesWords</span><span class="p">[</span><span class="n">Index</span> <span class="o">+</span> <span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
 1207         <span class="n">UpperBoundDataValue</span> <span class="o">=</span> <span class="n">HighlightRangesWords</span><span class="p">[</span><span class="n">Index</span> <span class="o">+</span> <span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
 1208 
 1209         <span class="n">SpecifiedSextet</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">DataLabel</span><span class="p">,</span> <span class="n">DataType</span><span class="p">,</span> <span class="n">LowerBoundDataCriterion</span><span class="p">,</span> <span class="n">LowerBoundDataValue</span><span class="p">,</span> <span class="n">UpperBoundDataCriterion</span><span class="p">,</span> <span class="n">UpperBoundDataValue</span><span class="p">)</span>
 1210 
 1211         <span class="n">CanonicalDataLabel</span> <span class="o">=</span> <span class="n">DataLabel</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
 1212         <span class="k">if</span> <span class="n">CanonicalDataLabel</span> <span class="ow">in</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightValuesCanonicalLabelsMap&quot;</span><span class="p">]:</span>
 1213             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The data label specified, </span><span class="si">%s</span><span class="s2">, using option </span><span class="se">\&quot;</span><span class="s2">--highlightRanges</span><span class="se">\&quot;</span><span class="s2"> has already been used in </span><span class="se">\&quot;</span><span class="s2">--highlightValues</span><span class="se">\&quot;</span><span class="s2"> option&quot;</span> <span class="o">%</span> <span class="n">DataLabel</span><span class="p">)</span>
 1214         
 1215         <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(numeric|text)$&quot;</span><span class="p">,</span> <span class="n">DataType</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1216             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The data type, </span><span class="si">%s</span><span class="s2">, specified in sextet </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> using </span><span class="se">\&quot;</span><span class="s2">--highlightValuesRanges</span><span class="se">\&quot;</span><span class="s2"> option is not valid. Supported values: numeric text.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">DataType</span><span class="p">,</span> <span class="n">SpecifiedSextet</span><span class="p">))</span>
 1217         
 1218         <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(lt|le)$&quot;</span><span class="p">,</span> <span class="n">LowerBoundDataCriterion</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1219             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The lower bound criterion, </span><span class="si">%s</span><span class="s2">, specified in sextet </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> using </span><span class="se">\&quot;</span><span class="s2">--highlightValuesRanges</span><span class="se">\&quot;</span><span class="s2"> option is not valid. Supported values: lt or le.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">LowerBoundDataCriterion</span><span class="p">,</span> <span class="n">SpecifiedSextet</span><span class="p">))</span>
 1220         
 1221         <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(gt|ge)$&quot;</span><span class="p">,</span> <span class="n">UpperBoundDataCriterion</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1222             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The upper bound criterion, </span><span class="si">%s</span><span class="s2">, specified in sextet </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> using </span><span class="se">\&quot;</span><span class="s2">--highlightValuesRanges</span><span class="se">\&quot;</span><span class="s2"> option is not valid. Supported values: gt or ge.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">UpperBoundDataCriterion</span><span class="p">,</span> <span class="n">SpecifiedSextet</span><span class="p">))</span>
 1223 
 1224         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^numeric$&quot;</span><span class="p">,</span> <span class="n">DataType</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1225             <span class="k">if</span> <span class="ow">not</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">IsNumber</span><span class="p">(</span><span class="n">LowerBoundDataValue</span><span class="p">):</span>
 1226                 <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The lower bound data value, </span><span class="si">%s</span><span class="s2">, specified in sextet </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="s2">--highlightValuesRanges</span><span class="se">\&quot;</span><span class="s2"> option is not valid. It must be a number for </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> data type.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">LowerBoundDataValue</span><span class="p">,</span> <span class="n">SpecifiedSextet</span><span class="p">,</span> <span class="n">DataType</span><span class="p">))</span>
 1227             
 1228             <span class="k">if</span> <span class="ow">not</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">IsNumber</span><span class="p">(</span><span class="n">UpperBoundDataValue</span><span class="p">):</span>
 1229                 <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The upper bound data value, </span><span class="si">%s</span><span class="s2">, specified in sextet </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="s2">--highlightValuesRanges</span><span class="se">\&quot;</span><span class="s2"> option is not valid. It must be a number for </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">data type.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">UpperBoundDataValue</span><span class="p">,</span> <span class="n">SpecifiedSextet</span><span class="p">,</span> <span class="n">DataType</span><span class="p">))</span>
 1230             
 1231             <span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">LowerBoundDataValue</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="nb">float</span><span class="p">(</span><span class="n">UpperBoundDataValue</span><span class="p">):</span>
 1232                 <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The lower bound data value, </span><span class="si">%s</span><span class="s2">, must be less than upper bound value, </span><span class="si">%s</span><span class="s2">, specified in sextet </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> using </span><span class="se">\&quot;</span><span class="s2">--highlightValuesRanges</span><span class="se">\&quot;</span><span class="s2"> option.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">LowerBoundDataValue</span><span class="p">,</span> <span class="n">UpperBoundDataValue</span><span class="p">,</span>  <span class="n">SpecifiedSextet</span><span class="p">))</span>
 1233             
 1234             <span class="n">LowerBoundDataValue</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">LowerBoundDataValue</span><span class="p">)</span>
 1235             <span class="n">UpperBoundDataValue</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">UpperBoundDataValue</span><span class="p">)</span>
 1236         <span class="k">else</span><span class="p">:</span>
 1237             <span class="k">if</span> <span class="n">LowerBoundDataValue</span> <span class="o">&gt;=</span> <span class="n">UpperBoundDataValue</span><span class="p">:</span>
 1238                 <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The lower bound data value, </span><span class="si">%s</span><span class="s2">, must be less than upper bound value, </span><span class="si">%s</span><span class="s2">, specified in sextet </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="s2">--highlightValuesRanges</span><span class="se">\&quot;</span><span class="s2"> option is not valid. It must be a number for data type, </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">LowerBoundDataValue</span><span class="p">,</span> <span class="n">UpperBoundDataValue</span><span class="p">,</span>  <span class="n">SpecifiedSextet</span><span class="p">,</span> <span class="n">DataType</span><span class="p">))</span>
 1239 
 1240         <span class="c1"># Track values...</span>
 1241         <span class="k">if</span> <span class="n">DataLabel</span> <span class="ow">in</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightRangesLabelsMap&quot;</span><span class="p">]:</span>
 1242             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The data label, </span><span class="si">%s</span><span class="s2">, specified in sextet </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="s2">--highlightValuesRanges</span><span class="se">\&quot;</span><span class="s2"> option is not valid. Multiple occurences of data label&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">DataLabel</span><span class="p">,</span> <span class="n">SpecifiedSextet</span><span class="p">))</span>
 1243 
 1244         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightRangesLabels&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DataLabel</span><span class="p">)</span>
 1245         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightRangesLabelsMap&quot;</span><span class="p">][</span><span class="n">DataLabel</span><span class="p">]</span>  <span class="o">=</span> <span class="n">DataLabel</span>
 1246         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightRangesCanonicalLabelsMap&quot;</span><span class="p">][</span><span class="n">CanonicalDataLabel</span><span class="p">]</span>  <span class="o">=</span> <span class="n">DataLabel</span>
 1247         
 1248         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightRangesTypesMap&quot;</span><span class="p">][</span><span class="n">DataLabel</span><span class="p">]</span>  <span class="o">=</span> <span class="n">DataType</span>
 1249         
 1250         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightRangesCriteriaLowerMap&quot;</span><span class="p">][</span><span class="n">DataLabel</span><span class="p">]</span>  <span class="o">=</span> <span class="n">LowerBoundDataCriterion</span> 
 1251         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightRangesCriteriaLowerValuesMap&quot;</span><span class="p">][</span><span class="n">DataLabel</span><span class="p">]</span>  <span class="o">=</span> <span class="n">LowerBoundDataValue</span>
 1252         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightRangesCriteriaUpperMap&quot;</span><span class="p">][</span><span class="n">DataLabel</span><span class="p">]</span>  <span class="o">=</span> <span class="n">UpperBoundDataCriterion</span> 
 1253         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightRangesCriteriaUpperValuesMap&quot;</span><span class="p">][</span><span class="n">DataLabel</span><span class="p">]</span>  <span class="o">=</span> <span class="n">UpperBoundDataValue</span>
 1254 
 1255 <span class="k">def</span> <span class="nf">ProcessHighlightValuesClassesOption</span><span class="p">():</span>
 1256     <span class="sd">&quot;&quot;&quot;Process highlight values classes option&quot;&quot;&quot;</span>
 1257     
 1258     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightClasses&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="bp">None</span>
 1259     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightClassesRules&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="bp">None</span>
 1260     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightClassesSynonymsMap&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="bp">None</span>
 1261     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightClassesRandom&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="bp">False</span>
 1262 
 1263     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightClassesLabels&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="p">[]</span>
 1264     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightClassesLabelsMap&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="p">{}</span>
 1265     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightClassesCanonicalLabelsMap&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="p">{}</span>
 1266     
 1267     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightClassesTypesMap&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="p">{}</span>
 1268     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightClassesCriteriaMap&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="p">{}</span>
 1269     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightClassesCriteriaValuesMap&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="p">{}</span>
 1270     
 1271     <span class="n">HighlightClasses</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--highlightValuesClasses&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
 1272     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^None$&quot;</span><span class="p">,</span> <span class="n">HighlightClasses</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1273         <span class="k">return</span>
 1274 
 1275     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightClasses&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">HighlightClasses</span>
 1276     
 1277     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^RuleOf5$&quot;</span><span class="p">,</span> <span class="n">HighlightClasses</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1278         <span class="n">HighlightClassessRules</span> <span class="o">=</span> <span class="s2">&quot;MolecularWeight,numeric,le,500,HydrogenBondDonors,numeric,le,5,HydrogenBondAcceptors,numeric,le,10,LogP,numeric,le,5&quot;</span>
 1279     <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^RuleOf3$&quot;</span><span class="p">,</span> <span class="n">HighlightClasses</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1280         <span class="n">HighlightClassessRules</span> <span class="o">=</span> <span class="s2">&quot;MolecularWeight,numeric,le,300,HydrogenBondDonors,numeric,le,3,HydrogenBondAcceptors,numeric,le,3,LogP,numeric,le,3,RotatableBonds,numeric,le,3,TPSA,numeric,le,60&quot;</span>
 1281     <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^DrugLike$&quot;</span><span class="p">,</span> <span class="n">HighlightClasses</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1282         <span class="n">HighlightClassessRules</span> <span class="o">=</span> <span class="s2">&quot;MolecularWeight,numeric,le,500,HydrogenBondDonors,numeric,le,5,HydrogenBondAcceptors,numeric,le,10,LogP,numeric,le,5,RotatableBonds,numeric,le,10,TPSA,numeric,le,140&quot;</span>
 1283     <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Random$&quot;</span><span class="p">,</span> <span class="n">HighlightClasses</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1284         <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightValues&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
 1285             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The value specified, </span><span class="si">%s</span><span class="s2">, using option </span><span class="se">\&quot;</span><span class="s2">--highlightValuesClasses</span><span class="se">\&quot;</span><span class="s2"> is not allowed in conjunction with </span><span class="se">\&quot;</span><span class="s2">--highlightValues</span><span class="se">\&quot;</span><span class="s2"> option.&quot;</span> <span class="o">%</span> <span class="n">HighlightClasses</span><span class="p">)</span>
 1286         <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightRanges&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
 1287             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The value specified, </span><span class="si">%s</span><span class="s2">, using option </span><span class="se">\&quot;</span><span class="s2">--highlightValuesClasses</span><span class="se">\&quot;</span><span class="s2"> is not allowed in conjunction with </span><span class="se">\&quot;</span><span class="s2">--highlightRanges</span><span class="se">\&quot;</span><span class="s2"> option .&quot;</span> <span class="o">%</span> <span class="n">HighlightClasses</span><span class="p">)</span>
 1288             
 1289         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightClassesRandom&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="bp">True</span>
 1290         <span class="k">return</span>
 1291     <span class="k">else</span><span class="p">:</span>
 1292         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The value specified, </span><span class="si">%d</span><span class="s2">, using option </span><span class="se">\&quot;</span><span class="s2">--highlightValuesClasses</span><span class="se">\&quot;</span><span class="s2"> is not supported.&quot;</span> <span class="o">%</span> <span class="n">HighlightClasses</span><span class="p">)</span>
 1293         <span class="k">return</span>
 1294         
 1295     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightClassesRules&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">HighlightClassessRules</span>
 1296 
 1297     <span class="c1"># Process rules for highlighting values...</span>
 1298     <span class="n">HighlightClassesWords</span> <span class="o">=</span> <span class="n">HighlightClassessRules</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
 1299     <span class="k">for</span> <span class="n">Index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">HighlightClassesWords</span><span class="p">),</span> <span class="mi">4</span><span class="p">):</span>
 1300         <span class="n">DataLabel</span> <span class="o">=</span> <span class="n">HighlightClassesWords</span><span class="p">[</span><span class="n">Index</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
 1301         <span class="n">DataType</span> <span class="o">=</span> <span class="n">HighlightClassesWords</span><span class="p">[</span><span class="n">Index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
 1302         <span class="n">DataCriterion</span> <span class="o">=</span> <span class="n">HighlightClassesWords</span><span class="p">[</span><span class="n">Index</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
 1303         <span class="n">DataValue</span> <span class="o">=</span> <span class="n">HighlightClassesWords</span><span class="p">[</span><span class="n">Index</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
 1304         
 1305         <span class="n">DataValue</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">DataValue</span><span class="p">)</span>
 1306 
 1307         <span class="k">if</span> <span class="n">DataLabel</span> <span class="ow">in</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightClassesLabelsMap&quot;</span><span class="p">]:</span>
 1308             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;Ignoring duplicate datalabel, </span><span class="si">%s</span><span class="s2">, specified in highlighting values rule for class, </span><span class="si">%s</span><span class="s2">, in </span><span class="se">\&quot;</span><span class="s2">--highlightClassesValue</span><span class="se">\&quot;</span><span class="s2"> option...&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">DataLabel</span><span class="p">,</span> <span class="n">HighlightClasses</span><span class="p">))</span>
 1309             <span class="k">continue</span>
 1310             
 1311         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightClassesLabels&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DataLabel</span><span class="p">)</span>
 1312         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightClassesLabelsMap&quot;</span><span class="p">][</span><span class="n">DataLabel</span><span class="p">]</span> <span class="o">=</span> <span class="n">DataLabel</span>
 1313         
 1314         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightClassesTypesMap&quot;</span><span class="p">][</span><span class="n">DataLabel</span><span class="p">]</span> <span class="o">=</span> <span class="n">DataType</span>
 1315         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightClassesCriteriaMap&quot;</span><span class="p">][</span><span class="n">DataLabel</span><span class="p">]</span> <span class="o">=</span> <span class="n">DataCriterion</span>
 1316         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightClassesCriteriaValuesMap&quot;</span><span class="p">][</span><span class="n">DataLabel</span><span class="p">]</span> <span class="o">=</span> <span class="n">DataValue</span>
 1317     
 1318     <span class="c1"># Set up synonyms for data labels corresponding to physicochemical properties</span>
 1319     <span class="c1"># calculated by MayaChemTools and RDKit...</span>
 1320     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightClassesSynonymsMap&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="p">{}</span>
 1321     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightClassesSynonymsMap&quot;</span><span class="p">][</span><span class="s2">&quot;MolecularWeight&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;MolecularWeight&quot;</span><span class="p">,</span> <span class="s2">&quot;MolWt&quot;</span><span class="p">]</span>
 1322     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightClassesSynonymsMap&quot;</span><span class="p">][</span><span class="s2">&quot;HydrogenBondDonors&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;HydrogenBondDonors&quot;</span><span class="p">,</span> <span class="s2">&quot;NHOHCount&quot;</span><span class="p">]</span>
 1323     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightClassesSynonymsMap&quot;</span><span class="p">][</span><span class="s2">&quot;HydrogenBondAcceptors&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;HydrogenBondAcceptors&quot;</span><span class="p">,</span> <span class="s2">&quot;NOCount&quot;</span><span class="p">]</span>
 1324     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightClassesSynonymsMap&quot;</span><span class="p">][</span><span class="s2">&quot;LogP&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;SLogP&quot;</span><span class="p">,</span> <span class="s2">&quot;MolLogP&quot;</span><span class="p">]</span>
 1325     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightClassesSynonymsMap&quot;</span><span class="p">][</span><span class="s2">&quot;RotatableBonds&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;RotatableBonds&quot;</span><span class="p">,</span> <span class="s2">&quot;NumRotatableBonds&quot;</span><span class="p">]</span>
 1326     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightClassesSynonymsMap&quot;</span><span class="p">][</span><span class="s2">&quot;TPSA&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;TPSA&quot;</span><span class="p">,</span> <span class="s2">&quot;TPSA&quot;</span><span class="p">]</span>
 1327 
 1328 <span class="k">def</span> <span class="nf">ProcessHighlightColorsOption</span><span class="p">():</span>
 1329     <span class="sd">&quot;&quot;&quot;Process highlight colors option&quot;&quot;&quot;</span>
 1330 
 1331     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightColors&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
 1332     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightColorsType&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
 1333     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightColorsList&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
 1334 
 1335     <span class="n">HighlightColors</span> <span class="o">=</span> <span class="s2">&quot;colorclass,table-success, table-danger&quot;</span>
 1336     <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--highlightColors&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1337         <span class="n">HighlightColors</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--highlightColors&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
 1338         <span class="k">if</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">IsEmpty</span><span class="p">(</span><span class="n">HighlightColors</span><span class="p">):</span>
 1339             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The value specified using </span><span class="se">\&quot;</span><span class="s2">--highlightColors</span><span class="se">\&quot;</span><span class="s2"> is empty.&quot;</span><span class="p">)</span>
 1340 
 1341     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightColors&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">HighlightColors</span><span class="p">)</span>
 1342     <span class="n">HighlightColorsList</span> <span class="o">=</span> <span class="p">[</span><span class="n">Color</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">Color</span> <span class="ow">in</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightColors&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)]</span>
 1343         
 1344     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">HighlightColorsList</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span>
 1345         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The number of comma delimited paramater names and values, </span><span class="si">%d</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="s2">--highlightColors</span><span class="se">\&quot;</span><span class="s2"> option must be 3.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">HighlightColorsList</span><span class="p">)))</span>
 1346         
 1347     <span class="n">ColorsType</span><span class="p">,</span> <span class="n">Color1</span><span class="p">,</span> <span class="n">Color2</span> <span class="o">=</span> <span class="n">HighlightColorsList</span>
 1348     <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(colorclass|colorspec)$&quot;</span><span class="p">,</span> <span class="n">ColorsType</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1349         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The color type, </span><span class="si">%s</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="s2">--highlightColors</span><span class="se">\&quot;</span><span class="s2"> option is not valid. Supported values: colorclass or colorspec.&quot;</span> <span class="o">%</span> <span class="n">ColorsType</span><span class="p">)</span>
 1350 
 1351     <span class="n">ColorsList</span> <span class="o">=</span> <span class="p">[</span><span class="n">Color1</span><span class="p">,</span> <span class="n">Color2</span><span class="p">]</span>
 1352     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^colorclass$&quot;</span><span class="p">,</span> <span class="n">ColorsType</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1353         <span class="n">CheckOptionTableClassColorValues</span><span class="p">(</span><span class="s2">&quot;--highlightColors&quot;</span><span class="p">,</span> <span class="n">ColorsList</span><span class="p">)</span>
 1354         
 1355     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightColorsList&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ColorsList</span>
 1356     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightColorsType&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ColorsType</span>
 1357 
 1358 <span class="k">def</span> <span class="nf">ProcessHighlightColorsRangesOption</span><span class="p">():</span>
 1359     <span class="sd">&quot;&quot;&quot;Process highlight colors ranges option&quot;&quot;&quot;</span>
 1360 
 1361     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightColorsRanges&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
 1362     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightColorsRangesType&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
 1363     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightColorsRangesList&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
 1364 
 1365     <span class="n">HighlightColors</span> <span class="o">=</span> <span class="s2">&quot;colorclass,table-success, table-warning, table-danger&quot;</span>
 1366     <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--highlightColorsRanges&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1367         <span class="n">HighlightColors</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--highlightColorsRanges&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
 1368         <span class="k">if</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">IsEmpty</span><span class="p">(</span><span class="n">HighlightColors</span><span class="p">):</span>
 1369             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The value specified using </span><span class="se">\&quot;</span><span class="s2">--highlightColorsRanges</span><span class="se">\&quot;</span><span class="s2"> is empty.&quot;</span><span class="p">)</span>
 1370 
 1371     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightColorsRanges&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">HighlightColors</span><span class="p">)</span>
 1372     <span class="n">HighlightColorsList</span> <span class="o">=</span> <span class="p">[</span><span class="n">Color</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">Color</span> <span class="ow">in</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightColorsRanges&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)]</span>
 1373         
 1374     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">HighlightColorsList</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">4</span><span class="p">:</span>
 1375         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The number of comma delimited paramater names and values, </span><span class="si">%d</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="s2">--highlightColorsRanges</span><span class="se">\&quot;</span><span class="s2"> option must be 4.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">HighlightColorsList</span><span class="p">)))</span>
 1376     
 1377     <span class="n">ColorsType</span><span class="p">,</span> <span class="n">Color1</span><span class="p">,</span> <span class="n">Color2</span><span class="p">,</span> <span class="n">Color3</span> <span class="o">=</span> <span class="n">HighlightColorsList</span>
 1378     <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(colorclass|colorspec)$&quot;</span><span class="p">,</span> <span class="n">ColorsType</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1379         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The color type, </span><span class="si">%s</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="s2">--highlightColorsRanges</span><span class="se">\&quot;</span><span class="s2"> option is not valid. Supported values: colorclass or colorspec.&quot;</span> <span class="o">%</span> <span class="n">ColorsType</span><span class="p">)</span>
 1380     
 1381     <span class="n">ColorsList</span> <span class="o">=</span> <span class="p">[</span><span class="n">Color1</span><span class="p">,</span> <span class="n">Color2</span><span class="p">,</span> <span class="n">Color3</span><span class="p">]</span>
 1382     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^colorclass$&quot;</span><span class="p">,</span> <span class="n">ColorsType</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1383         <span class="n">CheckOptionTableClassColorValues</span><span class="p">(</span><span class="s2">&quot;--highlightColorsRanges&quot;</span><span class="p">,</span> <span class="n">ColorsList</span><span class="p">)</span>
 1384     
 1385     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightColorsRangesList&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ColorsList</span>
 1386     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightColorsRangesType&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ColorsType</span>
 1387 
 1388 <span class="k">def</span> <span class="nf">ProcessHighlightColorsRandomOption</span><span class="p">():</span>
 1389     <span class="sd">&quot;&quot;&quot;Process highlight colors random option&quot;&quot;&quot;</span>
 1390 
 1391     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightColorsRandom&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
 1392     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightColorsRandomType&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
 1393     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightColorsRandomList&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
 1394 
 1395     <span class="n">HighlightColors</span> <span class="o">=</span> <span class="s2">&quot;colorclass,table-primary,table-success,table-danger,table-info,table-warning,table-secondary&quot;</span>
 1396     <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--highlightColorsRandom&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1397         <span class="n">HighlightColors</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--highlightColorsRandom&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
 1398         <span class="k">if</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">IsEmpty</span><span class="p">(</span><span class="n">HighlightColors</span><span class="p">):</span>
 1399             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The value specified using </span><span class="se">\&quot;</span><span class="s2">--highlightColorsRandom</span><span class="se">\&quot;</span><span class="s2"> is empty.&quot;</span><span class="p">)</span>
 1400 
 1401     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightColorsRandom&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">HighlightColors</span><span class="p">)</span>
 1402     <span class="n">HighlightColorsList</span> <span class="o">=</span> <span class="p">[</span><span class="n">Color</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="k">for</span> <span class="n">Color</span> <span class="ow">in</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightColorsRandom&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)]</span>
 1403         
 1404     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">HighlightColorsList</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
 1405         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The number of comma delimited paramater names and values, </span><span class="si">%d</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="s2">--highlightColorsRandom</span><span class="se">\&quot;</span><span class="s2"> option must be &gt; 1.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">HighlightColorsList</span><span class="p">)))</span>
 1406         
 1407     <span class="n">ColorsType</span> <span class="o">=</span> <span class="n">HighlightColorsList</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
 1408     <span class="n">ColorsList</span> <span class="o">=</span> <span class="n">HighlightColorsList</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
 1409     
 1410     <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(colorclass|colorspec)$&quot;</span><span class="p">,</span> <span class="n">ColorsType</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1411         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The color type, </span><span class="si">%s</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="s2">--highlightColorsRandim</span><span class="se">\&quot;</span><span class="s2"> option is not valid. Supported values: colorclass or colorspec.&quot;</span> <span class="o">%</span> <span class="n">ColorsType</span><span class="p">)</span>
 1412 
 1413     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^colorclass$&quot;</span><span class="p">,</span> <span class="n">ColorsType</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1414         <span class="n">CheckOptionTableClassColorValues</span><span class="p">(</span><span class="s2">&quot;--highlightColorsRandom&quot;</span><span class="p">,</span> <span class="n">ColorsList</span><span class="p">)</span>
 1415         
 1416     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightColorsRandomList&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ColorsList</span>
 1417     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightColorsRandomType&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ColorsType</span>
 1418 
 1419 <span class="k">def</span> <span class="nf">CheckOptionTableClassColorValues</span><span class="p">(</span><span class="n">OptionName</span><span class="p">,</span> <span class="n">ColorsList</span><span class="p">):</span>
 1420     <span class="sd">&quot;&quot;&quot;Check names of table color classes and issue a warning for unknown names.&quot;&quot;&quot;</span>
 1421 
 1422     <span class="n">TableClassColors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;thead-dark&quot;</span><span class="p">,</span> <span class="s2">&quot;thead-light&quot;</span><span class="p">,</span> <span class="s2">&quot;table-primary&quot;</span><span class="p">,</span> <span class="s2">&quot;table-success&quot;</span><span class="p">,</span> <span class="s2">&quot;table-danger&quot;</span><span class="p">,</span> <span class="s2">&quot;table-info&quot;</span><span class="p">,</span> <span class="s2">&quot;table-warning&quot;</span><span class="p">,</span> <span class="s2">&quot;table-active&quot;</span><span class="p">,</span> <span class="s2">&quot;table-secondary&quot;</span><span class="p">,</span> <span class="s2">&quot;table-light&quot;</span><span class="p">,</span> <span class="s2">&quot;table-dark&quot;</span><span class="p">,</span> <span class="s2">&quot;bg-primary&quot;</span><span class="p">,</span> <span class="s2">&quot;bg-success&quot;</span><span class="p">,</span> <span class="s2">&quot;bg-danger&quot;</span><span class="p">,</span>  <span class="s2">&quot;bg-info&quot;</span><span class="p">,</span> <span class="s2">&quot;bg-warning&quot;</span><span class="p">,</span> <span class="s2">&quot;bg-secondary&quot;</span><span class="p">,</span> <span class="s2">&quot;bg-dark&quot;</span><span class="p">,</span> <span class="s2">&quot;bg-light&quot;</span><span class="p">]</span>
 1423 
 1424     <span class="k">for</span> <span class="n">Color</span> <span class="ow">in</span> <span class="n">ColorsList</span><span class="p">:</span>
 1425         <span class="k">if</span> <span class="ow">not</span> <span class="n">Color</span> <span class="ow">in</span> <span class="n">TableClassColors</span><span class="p">:</span>
 1426             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;The color class name, </span><span class="si">%s</span><span class="s2">, specified using option </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> appears to be a unknown name...&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Color</span><span class="p">,</span> <span class="n">OptionName</span><span class="p">))</span>
 1427         
 1428 <span class="k">def</span> <span class="nf">ProcessOptions</span><span class="p">():</span>
 1429     <span class="sd">&quot;&quot;&quot;Process and validate command line arguments and options&quot;&quot;&quot;</span>
 1430     
 1431     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Processing options...&quot;</span><span class="p">)</span>
 1432     
 1433     <span class="c1"># Validate options...</span>
 1434     <span class="n">ValidateOptions</span><span class="p">()</span>
 1435     
 1436     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Infile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--infile&quot;</span><span class="p">]</span>
 1437     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Outfile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--outfile&quot;</span><span class="p">]</span>
 1438     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Overwrite&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--overwrite&quot;</span><span class="p">]</span>
 1439     
 1440     <span class="c1"># No need for any RDKit specific --outfileParams....</span>
 1441     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfileParams&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ProcessOptionInfileParameters</span><span class="p">(</span><span class="s2">&quot;--infileParams&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--infileParams&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Infile&quot;</span><span class="p">])</span>
 1442 
 1443     <span class="n">AlignmentSMARTSPattern</span> <span class="o">=</span> <span class="bp">None</span>
 1444     <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^None$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--alignmentSMARTS&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1445         <span class="n">AlignmentSMARTSPattern</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--alignmentSMARTS&quot;</span><span class="p">]</span>
 1446     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AlignmentSMARTSPattern&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">AlignmentSMARTSPattern</span>
 1447     
 1448     <span class="n">Compute2DCoords</span> <span class="o">=</span> <span class="bp">True</span>
 1449     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^no$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--compute2DCoords&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1450         <span class="n">Compute2DCoords</span> <span class="o">=</span> <span class="bp">False</span>
 1451     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Compute2DCoords&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">Compute2DCoords</span>
 1452 
 1453     <span class="n">CounterCol</span> <span class="o">=</span> <span class="bp">True</span>
 1454     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^no$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--counterCol&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1455         <span class="n">CounterCol</span> <span class="o">=</span> <span class="bp">False</span>
 1456     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;CounterCol&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">CounterCol</span>
 1457     
 1458     <span class="n">ColVisibility</span> <span class="o">=</span> <span class="bp">True</span>
 1459     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^no$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--colVisibility&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1460         <span class="n">ColVisibility</span> <span class="o">=</span> <span class="bp">False</span>
 1461     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ColVisibility&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">ColVisibility</span>
 1462     
 1463     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ColVisibilityCtrlMax&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--colVisibilityCtrlMax&quot;</span><span class="p">])</span>
 1464     
 1465     <span class="n">Footer</span> <span class="o">=</span> <span class="bp">None</span>
 1466     <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^None$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--footer&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1467         <span class="n">Footer</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--footer&quot;</span><span class="p">]</span>
 1468     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Footer&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">Footer</span>
 1469 
 1470     <span class="n">FooterClass</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--footerClass&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
 1471     <span class="k">if</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">IsEmpty</span><span class="p">(</span><span class="n">FooterClass</span><span class="p">):</span>
 1472         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The value specified using option </span><span class="se">\&quot;</span><span class="s2">--footerClass</span><span class="se">\&quot;</span><span class="s2"> is empty.&quot;</span><span class="p">)</span>
 1473     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;FooterClass&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">FooterClass</span>
 1474     
 1475     <span class="n">FreezeCols</span> <span class="o">=</span> <span class="bp">True</span>
 1476     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^no$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--freezeCols&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1477         <span class="n">FreezeCols</span> <span class="o">=</span> <span class="bp">False</span>
 1478     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;FreezeCols&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">FreezeCols</span>
 1479     
 1480     <span class="n">Header</span> <span class="o">=</span> <span class="bp">None</span>
 1481     <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^None$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--header&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1482         <span class="n">Header</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--header&quot;</span><span class="p">]</span>
 1483     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Header&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">Header</span>
 1484     
 1485     <span class="n">HeaderStyle</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--headerStyle&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
 1486     <span class="k">if</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">IsEmpty</span><span class="p">(</span><span class="n">HeaderStyle</span><span class="p">):</span>
 1487         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The value specified using option </span><span class="se">\&quot;</span><span class="s2">--headerStyle</span><span class="se">\&quot;</span><span class="s2"> is empty.&quot;</span><span class="p">)</span>
 1488     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HeaderStyle&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">HeaderStyle</span>
 1489 
 1490     <span class="n">ProcessHighlightSMARTSOption</span><span class="p">()</span>
 1491     <span class="n">ProcessHighlightDataOptions</span><span class="p">()</span>
 1492     
 1493     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;KeysNavigation&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
 1494     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^no$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--keysNavigation&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1495         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;KeysNavigation&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
 1496     
 1497     <span class="n">SizeValues</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--molImageSize&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
 1498     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MolImageWidth&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">SizeValues</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
 1499     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MolImageHeight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">SizeValues</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
 1500     
 1501     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MolImageEncoded&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
 1502     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^no$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--molImageEncoded&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1503         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MolImageEncoded&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
 1504     
 1505     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Paging&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
 1506     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^no$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--paging&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1507         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Paging&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
 1508     
 1509     <span class="n">PagingType</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pagingType&quot;</span><span class="p">]</span>
 1510     <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(numbers|simple|simple_numbers|full|full_numbers|simple_number)$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pagingType&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1511         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;The paging type name, </span><span class="si">%s</span><span class="s2">, specified using option </span><span class="se">\&quot;</span><span class="s2">--pagingType</span><span class="se">\&quot;</span><span class="s2"> appears to be a unknown type...&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">PagingType</span><span class="p">))</span>
 1512     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PagingType&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PagingType</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
 1513     
 1514     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PageLength&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pageLength&quot;</span><span class="p">])</span>
 1515     
 1516     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;RegexSearch&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
 1517     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^no$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--regexSearch&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1518         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;RegexSearch&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
 1519     
 1520     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ShowMolName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
 1521     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ShowMolNameDataLabel&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Name&quot;</span>
 1522     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^no$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--showMolName&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1523         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ShowMolName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
 1524     
 1525     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ShowMolNameAuto&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--showMolName&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1526 
 1527     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ScrollX&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
 1528     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^no$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--scrollX&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1529         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ScrollX&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
 1530         
 1531     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ScrollY&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
 1532     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^no$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--scrollY&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1533         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ScrollY&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
 1534 
 1535     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ScrollYSize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--scrollYSize&quot;</span><span class="p">]</span>
 1536     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;vh$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--scrollYSize&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1537         <span class="n">ScrollYSize</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;vh$&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--scrollYSize&quot;</span><span class="p">]))</span>
 1538         <span class="k">if</span> <span class="n">ScrollYSize</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
 1539             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The value specified, </span><span class="si">%s</span><span class="s2">, for option </span><span class="se">\&quot;</span><span class="s2">--scrollYSize</span><span class="se">\&quot;</span><span class="s2"> is not valid. Supported value: &gt; 0 followed by </span><span class="se">\&quot;</span><span class="s2">vh</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--scrollYSize&quot;</span><span class="p">])</span>
 1540     
 1541     <span class="n">TableStyle</span> <span class="o">=</span> <span class="bp">None</span>
 1542     <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^None$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--tableStyle&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1543         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^All$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--tableStyle&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1544             <span class="n">TableStyle</span> <span class="o">=</span> <span class="s2">&quot;table table-striped table-bordered table-hover table-dark&quot;</span>
 1545         <span class="k">else</span><span class="p">:</span>
 1546             <span class="n">TableStyle</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--tableStyle&quot;</span><span class="p">])</span>
 1547             <span class="k">for</span> <span class="n">Style</span> <span class="ow">in</span> <span class="p">[</span><span class="n">Style</span> <span class="k">for</span> <span class="n">Style</span> <span class="ow">in</span> <span class="n">TableStyle</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)]:</span>
 1548                 <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(table|table-striped|table-bordered|table-hover|table-dark|table-sm)$&quot;</span><span class="p">,</span> <span class="n">Style</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1549                     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;The table style name, </span><span class="si">%s</span><span class="s2">, specified using option </span><span class="se">\&quot;</span><span class="s2">-t, --tableStyle</span><span class="se">\&quot;</span><span class="s2"> appears to be a unknown style...&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Style</span><span class="p">))</span>
 1550             <span class="n">TableStyle</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">TableStyle</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
 1551     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;TableStyle&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">TableStyle</span>
 1552 
 1553     <span class="n">TableHeaderStyle</span> <span class="o">=</span> <span class="bp">None</span>
 1554     <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^None$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--tableHeaderStyle&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1555         <span class="n">TableHeaderStyle</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--tableHeaderStyle&quot;</span><span class="p">]</span>
 1556         <span class="n">TableHeaderStyle</span> <span class="o">=</span> <span class="n">TableHeaderStyle</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
 1557         <span class="n">CheckOptionTableClassColorValues</span><span class="p">(</span><span class="s2">&quot;--tableHeaderStyle&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">TableHeaderStyle</span><span class="p">])</span>
 1558     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;TableHeaderStyle&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">TableHeaderStyle</span>
 1559     
 1560     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;TableFooter&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
 1561     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^no$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--tableFooter&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1562         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;TableFooter&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
 1563 
 1564     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;WrapText&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
 1565     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^no$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--wrapText&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1566         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;WrapText&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
 1567 
 1568     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;WrapTextWidth&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--wrapTextWidth&quot;</span><span class="p">])</span>
 1569 
 1570 <span class="k">def</span> <span class="nf">RetrieveOptions</span><span class="p">():</span>
 1571     <span class="sd">&quot;&quot;&quot;Retrieve command line arguments and options&quot;&quot;&quot;</span>
 1572     
 1573     <span class="c1"># Get options...</span>
 1574     <span class="k">global</span> <span class="n">Options</span>
 1575     <span class="n">Options</span> <span class="o">=</span> <span class="n">docopt</span><span class="p">(</span><span class="n">_docoptUsage_</span><span class="p">)</span>
 1576     
 1577     <span class="c1"># Set current working directory to the specified directory...</span>
 1578     <span class="n">WorkingDir</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--workingdir&quot;</span><span class="p">]</span>
 1579     <span class="k">if</span> <span class="n">WorkingDir</span><span class="p">:</span>
 1580         <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">WorkingDir</span><span class="p">)</span>
 1581     
 1582     <span class="c1"># Handle examples option...</span>
 1583     <span class="k">if</span> <span class="s2">&quot;--examples&quot;</span> <span class="ow">in</span> <span class="n">Options</span> <span class="ow">and</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--examples&quot;</span><span class="p">]:</span>
 1584         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="n">MiscUtil</span><span class="o">.</span><span class="n">GetExamplesTextFromDocOptText</span><span class="p">(</span><span class="n">_docoptUsage_</span><span class="p">))</span>
 1585         <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
 1586 
 1587 <span class="k">def</span> <span class="nf">ValidateOptions</span><span class="p">():</span>
 1588     <span class="sd">&quot;&quot;&quot;Validate option values&quot;&quot;&quot;</span>
 1589     
 1590     <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^None$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--alignmentSMARTS&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1591         <span class="n">PatternMol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmarts</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--alignmentSMARTS&quot;</span><span class="p">])</span>
 1592         <span class="k">if</span> <span class="n">PatternMol</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
 1593             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The value specified, </span><span class="si">%s</span><span class="s2">, using option </span><span class="se">\&quot;</span><span class="s2">--alignmentSMARTS</span><span class="se">\&quot;</span><span class="s2"> is not a valid SMARTS: Failed to create pattern molecule&quot;</span> <span class="o">%</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--alignmentSMARTS&quot;</span><span class="p">])</span>
 1594     
 1595     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;-c, --compute2DCoords&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--compute2DCoords&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no auto&quot;</span><span class="p">)</span>
 1596     
 1597     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--counterCol&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--counterCol&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
 1598     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--colVisibility&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--colVisibility&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
 1599     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionIntegerValue</span><span class="p">(</span><span class="s2">&quot;--colVisibilityCtrlMax&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--colVisibilityCtrlMax&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s2">&quot;&gt;&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>
 1600     
 1601     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--freezeCols&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--freezeCols&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
 1602     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--highlightValuesClasses&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--highlightValuesClasses&quot;</span><span class="p">],</span> <span class="s2">&quot;RuleOf5 RuleOf3 DrugLike Random None&quot;</span><span class="p">)</span>
 1603     
 1604     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFilePath</span><span class="p">(</span><span class="s2">&quot;-i, --infile&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--infile&quot;</span><span class="p">])</span>
 1605     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFileExt</span><span class="p">(</span><span class="s2">&quot;-i, --infile&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--infile&quot;</span><span class="p">],</span> <span class="s2">&quot;sdf sd mol smi csv tsv txt&quot;</span><span class="p">)</span>
 1606 
 1607     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFileExt</span><span class="p">(</span><span class="s2">&quot;-o, --outfile&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--outfile&quot;</span><span class="p">],</span> <span class="s2">&quot;html&quot;</span><span class="p">)</span>
 1608     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionsOutputFileOverwrite</span><span class="p">(</span><span class="s2">&quot;-o, --outfile&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--outfile&quot;</span><span class="p">],</span> <span class="s2">&quot;--overwrite&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--overwrite&quot;</span><span class="p">])</span>
 1609     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionsDistinctFileNames</span><span class="p">(</span><span class="s2">&quot;-i, --infile&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--infile&quot;</span><span class="p">],</span> <span class="s2">&quot;-o, --outfile&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--outfile&quot;</span><span class="p">])</span>
 1610     
 1611     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;-k, --keysNavigation&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--keysNavigation&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
 1612     
 1613     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionNumberValues</span><span class="p">(</span><span class="s2">&quot;-m, --molImageSize&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--molImageSize&quot;</span><span class="p">],</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="s2">&quot;integer&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;&gt;&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>
 1614     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--molImageEncoded&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--molImageEncoded&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
 1615     
 1616     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;-p, --paging&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--paging&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
 1617     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionIntegerValue</span><span class="p">(</span><span class="s2">&quot;--pageLength&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pageLength&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s2">&quot;&gt;&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>
 1618     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;-r, --regexSearch&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--regexSearch&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
 1619     
 1620     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--showMolName&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--showMolName&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no auto&quot;</span><span class="p">)</span>
 1621     
 1622     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--scrollX&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--scrollX&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
 1623     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--scrollY&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--scrollY&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
 1624     <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">&quot;vh$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--scrollYSize&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1625         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionIntegerValue</span><span class="p">(</span><span class="s2">&quot;--scrollYSize&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--scrollYSize&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s2">&quot;&gt;&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>
 1626     
 1627     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--tableFooter&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--tableFooter&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
 1628     
 1629     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--wrapText&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--wrapText&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
 1630     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionIntegerValue</span><span class="p">(</span><span class="s2">&quot;--wrapTextWidth&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--wrapTextWidth&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s2">&quot;&gt;&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>
 1631 
 1632 <span class="c1"># Setup a usage string for docopt...</span>
 1633 <span class="n">_docoptUsage_</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
 1634 <span class="s2">RDKitDrawMoleculesAndDataTable.py - Generate a HTML data table</span>
 1635 
 1636 <span class="s2">Usage:</span>
 1637 <span class="s2">    RDKitDrawMoleculesAndDataTable.py [--alignmentSMARTS &lt;SMARTS&gt;]</span>
 1638 <span class="s2">                             [--compute2DCoords &lt;yes or  no&gt;] [--counterCol &lt;yes or no&gt;]</span>
 1639 <span class="s2">                             [--colVisibility &lt;yes or no&gt;] [--colVisibilityCtrlMax &lt;number&gt;] [--footer &lt;text&gt;]</span>
 1640 <span class="s2">                             [--footerClass &lt;text&gt;] [--freezeCols &lt;yes or no&gt;] [--header &lt;text&gt;]</span>
 1641 <span class="s2">                             [--headerStyle &lt;text&gt;] [--highlightSMARTS &lt;SMARTS,...&gt;]</span>
 1642 <span class="s2">                             [--highlightValues &lt;datalabel,datatype,criterion,value,...&gt;]</span>
 1643 <span class="s2">                             [--highlightValuesRanges &lt;datalabel,datatype,criterion1,vaue1,criterion2,value2...&gt;]</span>
 1644 <span class="s2">                             [--highlightValuesClasses &lt;RuleOf5,RuleOf3,...&gt;]</span>
 1645 <span class="s2">                             [--highlightColors &lt;colortype,color1,color2&gt;]</span>
 1646 <span class="s2">                             [--highlightColorsRanges &lt;colortype,color1,color2,color3&gt;]</span>
 1647 <span class="s2">                             [--highlightColorsRandom &lt;colottype,color1,color2,...&gt;]</span>
 1648 <span class="s2">                             [--infileParams &lt;Name,Value,...&gt;] [--keysNavigation &lt;yes or no&gt;]</span>
 1649 <span class="s2">                             [--molImageSize &lt;width,height&gt;] [--molImageEncoded &lt;yes or no&gt; ] [--overwrite]</span>
 1650 <span class="s2">                             [--paging &lt;yes or no&gt;] [--pagingType &lt;numbers,simple, ...&gt;] [--pageLength &lt;number&gt;]</span>
 1651 <span class="s2">                             [--regexSearch &lt;yes or no&gt;] [--showMolName &lt;yes or no&gt;]</span>
 1652 <span class="s2">                             [--scrollX &lt;yes or no&gt;] [--scrollY &lt;yes or no&gt;] [--scrollYSize &lt;number&gt;]</span>
 1653 <span class="s2">                             [--tableStyle &lt;table,table-striped,...&gt;] [--tableFooter &lt;yes or no&gt;]</span>
 1654 <span class="s2">                             [--tableHeaderStyle &lt;thead-dark,thead-light,...&gt;] [--wrapText &lt;yes or no&gt;] </span>
 1655 <span class="s2">                             [--wrapTextWidth &lt;number&gt;] [-w &lt;dir&gt;] -i &lt;infile&gt; -o &lt;outfile&gt;</span>
 1656 <span class="s2">    RDKitDrawMoleculesAndDataTable.py -h | --help | -e | --examples</span>
 1657 
 1658 <span class="s2">Description:</span>
 1659 <span class="s2">    Generate an interactive HTML table with columns corresponding to molecules</span>
 1660 <span class="s2">    and available alphanumerical data in an input file. The drawing of molecules are</span>
 1661 <span class="s2">    embedded in the columns as in line SVG images.</span>
 1662 
 1663 <span class="s2">    The interactive HTML table may contain multiple columns with drawing of</span>
 1664 <span class="s2">    molecules. These columns are automatically generated for each data field in SD</span>
 1665 <span class="s2">    file or a column name in SMILES and CSV/TSV file containing SMILES</span>
 1666 <span class="s2">    string in their names. The first molecular drawing column in the HTML table</span>
 1667 <span class="s2">    represents primary molecular structure data available in an input file. It</span>
 1668 <span class="s2">    corresponds to MOL block is SD file or a first column containing SMILES string</span>
 1669 <span class="s2">    in its name in SMILES and CSV/TSV files.</span>
 1670 <span class="s2"> </span>
 1671 <span class="s2">    The interactive table requires internet access for viewing in a browser and</span>
 1672 <span class="s2">    employs the following frameworks: JQuery, Bootstrap, and DataTable. It provides</span>
 1673 <span class="s2">    the following functionality: sorting by columns, page length control, page </span>
 1674 <span class="s2">    navigation, searching data with regular expressions, and horizontal/vertical</span>
 1675 <span class="s2">    scrolling, row highlighting during hovering, a counter column, freezing of primary</span>
 1676 <span class="s2">    structure and counter columns, and column visibility control.</span>
 1677 
 1678 <span class="s2">    The supported input file formats are: Mol (.mol), SD (.sdf, .sd), SMILES (.smi),</span>
 1679 <span class="s2">    CSV/TSV (.csv, .tsv, .txt)</span>
 1680 
 1681 <span class="s2">    The supported output file format is HTML (.html).</span>
 1682 
 1683 <span class="s2">Options:</span>
 1684 <span class="s2">    -a, --alignmentSMARTS &lt;SMARTS&gt;  [default: none]</span>
 1685 <span class="s2">        SMARTS pattern for aligning molecules to a common template. This option is</span>
 1686 <span class="s2">        only used for primary molecular data in SD, SMILES and CSV/TSV files. It is </span>
 1687 <span class="s2">        ignored for all other molecular coordinates corresponding to data fields in SD</span>
 1688 <span class="s2">        file or columns in SMILES and CSV/TSV files containing SMILES string in their</span>
 1689 <span class="s2">        names.</span>
 1690 <span class="s2">    -c, --compute2DCoords &lt;yes or no&gt;  [default: yes]</span>
 1691 <span class="s2">        Compute 2D coordinates of molecules before drawing. Default: yes for SMILES</span>
 1692 <span class="s2">        strings in SMILES, CSV/TSV, and SD file data fields. In addition, 2D coordinated are</span>
 1693 <span class="s2">        always calculated for molecules corresponding to data fields in SD file or columns</span>
 1694 <span class="s2">        in SMILES and CSV/TSV files containing SMILES string in their names.</span>
 1695 <span class="s2">    --counterCol &lt;yes or no&gt;  [default: yes]</span>
 1696 <span class="s2">        Show a counter column as the first column in the table. It contains the position</span>
 1697 <span class="s2">        for each row in the table.</span>
 1698 <span class="s2">    --colVisibility &lt;yes or no&gt;  [default: yes]</span>
 1699 <span class="s2">        Show a dropdown button to toggle visibility of columns in the table. The counter</span>
 1700 <span class="s2">        and primary structure columns are excluded from the list.</span>
 1701 <span class="s2">    --colVisibilityCtrlMax &lt;number&gt;  [default: 25]</span>
 1702 <span class="s2">        Maximum number of columns to show in column visibility dropdown button. The</span>
 1703 <span class="s2">        rest of the data columns are not listed in the dropdown and are shown in the table.</span>
 1704 <span class="s2">        A word to the wise: The display of too many columns appear to hang interactive</span>
 1705 <span class="s2">        Javascript framework for Bootstrap and DataTables.</span>
 1706 <span class="s2">    --freezeCols &lt;yes or no&gt;  [default: yes]</span>
 1707 <span class="s2">        Lock counter and primary structure columns in place during horizontal scrolling.</span>
 1708 <span class="s2">    --footer &lt;text&gt;  [default: none]</span>
 1709 <span class="s2">        Footer text to insert at the bottom of the HTML page after the table.</span>
 1710 <span class="s2">    --footerClass &lt;text&gt;  [default: small text-center text-muted]</span>
 1711 <span class="s2">        Footer class style to use with &lt;p&gt; tag.</span>
 1712 <span class="s2">    -e, --examples</span>
 1713 <span class="s2">        Print examples.</span>
 1714 <span class="s2">    -h, --help</span>
 1715 <span class="s2">        Print this help message.</span>
 1716 <span class="s2">    --header &lt;text&gt;  [default: none]</span>
 1717 <span class="s2">        Header text to insert at the top of the HTML page before the table.</span>
 1718 <span class="s2">    --headerStyle &lt;text&gt;  [default: h5]</span>
 1719 <span class="s2">        Header style to use. Possible values: h1 to h6.</span>
 1720 <span class="s2">    --highlightSMARTS &lt;SMARTS,...&gt;  [default: none]</span>
 1721 <span class="s2">        SMARTS pattern for highlighting atoms and bonds in molecules. All matched</span>
 1722 <span class="s2">        substructures are highlighted.</span>
 1723 <span class="s2">        </span>
 1724 <span class="s2">        The SMARTS string is used to highlight atoms and bonds in drawing of</span>
 1725 <span class="s2">        molecules present in a HTML table across multiple columns. These columns</span>
 1726 <span class="s2">        correspond to data field labels in SD file or a column name in SMILES and</span>
 1727 <span class="s2">        CSV/TSV file containing SMILES string in their names. The first molecular</span>
 1728 <span class="s2">        drawing column in HTML table corresponds to primary molecular structure</span>
 1729 <span class="s2">        data available in an input file. It is identified by a label &#39;Structure&#39; across</span>
 1730 <span class="s2">        all input formats.</span>
 1731 <span class="s2">        </span>
 1732 <span class="s2">        A single SMARTS string is used to highlight a common substructure across</span>
 1733 <span class="s2">        all columns containing drawing of molecules in HTML table.</span>
 1734 <span class="s2">        </span>
 1735 <span class="s2">        Format:</span>
 1736 <span class="s2">            </span>
 1737 <span class="s2">            SMARTS</span>
 1738 <span class="s2">            Structure,SMARTS1,DataLabel,SMARTS2,...</span>
 1739 <span class="s2">            Structure,SMARTS1,Collabel,SMARTS2,...</span>
 1740 <span class="s2">            </span>
 1741 <span class="s2">        Example:</span>
 1742 <span class="s2">            </span>
 1743 <span class="s2">            c1ccccc1</span>
 1744 <span class="s2">            Structure,c1ccccc1,SMILESR1,c1ccccc1,SMILESR2,c1ccccc1</span>
 1745 <span class="s2">            </span>
 1746 <span class="s2">    --highlightValues &lt;datalabel,datatype,criterion,value,...&gt;  [default: none]</span>
 1747 <span class="s2">        Highlighting methodology to use for highlighting  alphanumerical data</span>
 1748 <span class="s2">        corresponding to data fields in SD file or column names in SMILES and</span>
 1749 <span class="s2">        CSV/TSV text files.</span>
 1750 <span class="s2">        </span>
 1751 <span class="s2">        Input text contains these quartets: DataLabel, DataType, Criterion, Value.</span>
 1752 <span class="s2">        Possible datatype values: numeric, text. Possible criterion values for numeric</span>
 1753 <span class="s2">        and text: gt, lt, ge, le.</span>
 1754 <span class="s2">        </span>
 1755 <span class="s2">        The &#39;datalabel&#39; corresponds to either data field label in SD file or column name</span>
 1756 <span class="s2">        in SMILES and CSV/TSV text files.</span>
 1757 <span class="s2">        </span>
 1758 <span class="s2">        Examples:</span>
 1759 <span class="s2">            </span>
 1760 <span class="s2">            MolecularWeight,numeric,le,500</span>
 1761 <span class="s2">            MolecularWeight,numeric,le,450,SLogP,numeric,le,5</span>
 1762 <span class="s2">            Name,text,eq,Aspirin</span>
 1763 <span class="s2">            Name,regex,eq,acid|amine</span>
 1764 <span class="s2">            </span>
 1765 <span class="s2">    --highlightValuesRanges &lt;datalabel,datatype,...&gt;  [default: none]</span>
 1766 <span class="s2">        Highlighting methodology to use for highlighting ranges of alphanumerical</span>
 1767 <span class="s2">        data corresponding to data fields in SD file or column names in SMILES and</span>
 1768 <span class="s2">        CSV/TSV text files.</span>
 1769 <span class="s2">        </span>
 1770 <span class="s2">        Input text contains these sextets: DataLabel, DataType, CriterionLowerBound,</span>
 1771 <span class="s2">        LowerBoundValue, CriterionUpperBound, UpperBoundValue.</span>
 1772 <span class="s2">        </span>
 1773 <span class="s2">        Possible datatype values: numeric or text. Possible criterion values: Lower</span>
 1774 <span class="s2">        bound value - lt, le; Upper bound value: gt, ge.</span>
 1775 <span class="s2">        </span>
 1776 <span class="s2">        The &#39;datalabel&#39; corresponds to either data field label in SD file or column name</span>
 1777 <span class="s2">        in SMILES and CSV/TSV text files.</span>
 1778 <span class="s2">        </span>
 1779 <span class="s2">        Examples:</span>
 1780 <span class="s2">            </span>
 1781 <span class="s2">            MolecularWeight,numeric,lt,450,gt,1000</span>
 1782 <span class="s2">            MolecularWeight,numeric,lt,450,gt,1000,SLogP,numeric,lt,0,gt,5</span>
 1783 <span class="s2">            </span>
 1784 <span class="s2">    --highlightValuesClasses &lt;RuleOf5,RuleOf3,...&gt;  [default: none]</span>
 1785 <span class="s2">        Highlighting methodology to use for highlighting ranges of numerical data</span>
 1786 <span class="s2">        data corresponding to specific set of data fields in SD file or column names in</span>
 1787 <span class="s2">        SMILES and CSV/TSV text files. Possible values: RuleOf5, RuleOf3, DrugLike,</span>
 1788 <span class="s2">        Random.</span>
 1789 <span class="s2">        </span>
 1790 <span class="s2">        The following value classes are supported: RuleOf5, RuleOf3, LeadLike, DrugLike.</span>
 1791 <span class="s2">        LeadLike is equivalent to RuleOf3.</span>
 1792 <span class="s2">        </span>
 1793 <span class="s2">        Each supported class encompasses a specific set of data labels along with</span>
 1794 <span class="s2">        appropriate criteria to compare and highlight column values, except for</span>
 1795 <span class="s2">        &#39;Random&#39; class. The data labels in these classes are automatically associated</span>
 1796 <span class="s2">        with appropriate data fields in SD file or column names in SMILES and CSV/TSV</span>
 1797 <span class="s2">        text files.</span>
 1798 <span class="s2">        </span>
 1799 <span class="s2">        No data labels are associated with &#39;Random&#39; class. It is used to highlight</span>
 1800 <span class="s2">        available alphanumeric data by randomly selecting a highlight color from the</span>
 1801 <span class="s2">        list of colors specified using &#39;--highlightColorsRandom&#39; option. The &#39;Random&#39;</span>
 1802 <span class="s2">        class value is not allowed in conjunction with &#39;--highlightValues&#39; or</span>
 1803 <span class="s2">        &#39;--highlightValuesRanges&#39;.</span>
 1804 <span class="s2">        </span>
 1805 <span class="s2">        The rules to highlight values for the supported classes are as follows.</span>
 1806 <span class="s2">        </span>
 1807 <span class="s2">        RuleOf5 [ Ref 91 ]:</span>
 1808 <span class="s2">         </span>
 1809 <span class="s2">            MolecularWeight,numeric,le,500 (MolecularWeight &lt;= 500)</span>
 1810 <span class="s2">            HydrogenBondDonors,numeric,le,5 (HydrogenBondDonors &lt;= 5)</span>
 1811 <span class="s2">            HydrogenBondAcceptors,numeric,le,10 (HydrogenBondAcceptors &lt;= 10)</span>
 1812 <span class="s2">            LogP,numeric,le,5 (LogP &lt;= 5)</span>
 1813 <span class="s2">         </span>
 1814 <span class="s2">        RuleOf3 or LeadLike [ Ref 92 ]:</span>
 1815 <span class="s2">         </span>
 1816 <span class="s2">            MolecularWeight,numeric,le,300 (MolecularWeight &lt;= 300)</span>
 1817 <span class="s2">            HydrogenBondDonors,numeric,le,3 (HydrogenBondDonors &lt;= 3)</span>
 1818 <span class="s2">            HydrogenBondAcceptors,numeric,le,3 (HydrogenBondAcceptors &lt;= 3)</span>
 1819 <span class="s2">            LogP,numeric,le,3 (LogP &lt;= 3)</span>
 1820 <span class="s2">            RotatableBonds,numeric,le,3 (RotatableBonds &lt;= 3)</span>
 1821 <span class="s2">            TPSA,numeric,le,60 (TPSA &lt;= 60)</span>
 1822 <span class="s2">         </span>
 1823 <span class="s2">        DrugLike:</span>
 1824 <span class="s2">         </span>
 1825 <span class="s2">            MolecularWeight,numeric,le,500 (MolecularWeight &lt;= 500)</span>
 1826 <span class="s2">            HydrogenBondDonors,numeric,le,5 (HydrogenBondDonors &lt;= 5)</span>
 1827 <span class="s2">            HydrogenBondAcceptors,numeric,le,10 (HydrogenBondAcceptors &lt;= 10)</span>
 1828 <span class="s2">            LogP,numeric,le,5 (LogP &lt;= 5)</span>
 1829 <span class="s2">            RotatableBonds,numeric,le,10 (RotatableBonds &lt;= 10)</span>
 1830 <span class="s2">            TPSA,numeric,le,140 (TPSA &lt;= 140)</span>
 1831 <span class="s2">            </span>
 1832 <span class="s2">        The following synonyms are automatically detected for data labels used</span>
 1833 <span class="s2">        by MayaChemTools and RDKit packages during the calculation of</span>
 1834 <span class="s2">        physicochemical properties.</span>
 1835 <span class="s2">        </span>
 1836 <span class="s2">        MayaChemTools: MolecularWeight, HydrogenBondDonors, HydrogenBondAcceptors,</span>
 1837 <span class="s2">        SLogP, RotatableBonds, TPSA.</span>
 1838 <span class="s2">            </span>
 1839 <span class="s2">        RDKit: MolWt,  NHOHCount, NOCount, MolLogP, NumRotatableBonds, TPSA</span>
 1840 <span class="s2">        </span>
 1841 <span class="s2">    --highlightColors &lt;colortype,color1,color2&gt;  [default: auto]</span>
 1842 <span class="s2">        Background colors used to highlight column values based on criterion</span>
 1843 <span class="s2">        specified by &#39;--highlightValues&#39; and &#39;--highlightColorsClasses&#39; option. Default</span>
 1844 <span class="s2">        value: colorclass,table-success, table-danger.</span>
 1845 <span class="s2">        </span>
 1846 <span class="s2">        The first color is used to highlight column values that satisfy the specified</span>
 1847 <span class="s2">        criterion for the column. The second color highlights the rest of the values</span>
 1848 <span class="s2">        in the column. </span>
 1849 <span class="s2">        </span>
 1850 <span class="s2">        Possible values for colortype: colorclass or colorspec.</span>
 1851 <span class="s2">        </span>
 1852 <span class="s2">        Any valid bootstrap contextual color class is supported for &#39;colorclass&#39;</span>
 1853 <span class="s2">        color type. For example: table-primary (Blue), table-success (Green),</span>
 1854 <span class="s2">        table-danger (Red), table-info (Light blue), table-warning (Orange),</span>
 1855 <span class="s2">        table-secondary (Grey), table-light (Light grey), and  table-dark (Dark grey).</span>
 1856 <span class="s2">        </span>
 1857 <span class="s2">        The following bootstrap color classes may also used: bg-primary bg-success,</span>
 1858 <span class="s2">        bg-danger bg-info, bg-warning, bg-secondary.</span>
 1859 <span class="s2">        </span>
 1860 <span class="s2">        Any valid color name or hexadecimal color specification is supported for</span>
 1861 <span class="s2">        &#39;colorspec&#39; color type: For example: red, green, blue, #ff000, #00ff00, #0000ff.</span>
 1862 <span class="s2">    --highlightColorsRanges &lt;colortype,color1,color2,color3&gt;  [default: auto]</span>
 1863 <span class="s2">        Background colors used to highlight column values using criteria specified</span>
 1864 <span class="s2">        by &#39;--highlightValuesRanges&#39; option. Default value:  colorclass, table-success,</span>
 1865 <span class="s2">        table-warning, table-danger.</span>
 1866 <span class="s2">        </span>
 1867 <span class="s2">        The first and third color are used to highlight column values lower and higher</span>
 1868 <span class="s2">        than the specified values for the lower and upper bound. The middle color highlights</span>
 1869 <span class="s2">        the rest of the values in the column.</span>
 1870 <span class="s2">        </span>
 1871 <span class="s2">        The supported color type and values are explained in the section for &#39;--highlightColors&#39;.</span>
 1872 <span class="s2">    --highlightColorsRandom &lt;colortype,color1,color2,...&gt;  [default: auto]</span>
 1873 <span class="s2">        Background color list to use for randomly selecting a color  to highlight</span>
 1874 <span class="s2">        column values during &#39;Random&quot; value of &#39;--highlightValuesClasses&#39; option.</span>
 1875 <span class="s2">        </span>
 1876 <span class="s2">        Default value:  colorclass,table-primary,table-success,table-danger,table-info,</span>
 1877 <span class="s2">        table-warning,table-secondary.</span>
 1878 <span class="s2">        </span>
 1879 <span class="s2">        The supported color type and values are explained in the section for &#39;--highlightColors&#39;.</span>
 1880 <span class="s2">    -i, --infile &lt;infile&gt;</span>
 1881 <span class="s2">        Input file name.</span>
 1882 <span class="s2">    --infileParams &lt;Name,Value,...&gt;  [default: auto]</span>
 1883 <span class="s2">        A comma delimited list of parameter name and value pairs for reading</span>
 1884 <span class="s2">        molecules from files. The supported parameter names for different file</span>
 1885 <span class="s2">        formats, along with their default values, are shown below:</span>
 1886 <span class="s2">            </span>
 1887 <span class="s2">            SD, MOL: removeHydrogens,yes,sanitize,yes,strictParsing,yes</span>
 1888 <span class="s2">            SMILES: smilesColumn,1,smilesNameColumn,2,smilesDelimiter,space,</span>
 1889 <span class="s2">                sanitize,yes</span>
 1890 <span class="s2">            </span>
 1891 <span class="s2">        Possible values for smilesDelimiter: space, comma or tab.</span>
 1892 <span class="s2">    -k, --keysNavigation &lt;yes or no&gt;  [default: yes]</span>
 1893 <span class="s2">        Provide Excel like keyboard cell navigation for the table.</span>
 1894 <span class="s2">    -m, --molImageSize &lt;width,height&gt;  [default: 200,150]</span>
 1895 <span class="s2">        Image size of a molecule in pixels.</span>
 1896 <span class="s2">    --molImageEncoded &lt;yes or no&gt;  [default: yes]</span>
 1897 <span class="s2">        Base64 encode SVG image of a molecule for inline embedding in a HTML page.</span>
 1898 <span class="s2">        The inline SVG image may fail to display in browsers without encoding.</span>
 1899 <span class="s2">    -o, --outfile &lt;outfile&gt;</span>
 1900 <span class="s2">        Output file name.</span>
 1901 <span class="s2">    --overwrite</span>
 1902 <span class="s2">        Overwrite existing files.</span>
 1903 <span class="s2">    -p, --paging &lt;yes or no&gt;  [default: yes]</span>
 1904 <span class="s2">        Provide page navigation for browsing data in the table.</span>
 1905 <span class="s2">    --pagingType &lt;numbers, simple, ...&gt;  [default: full_numbers]</span>
 1906 <span class="s2">        Type of page navigation. Possible values: numbers, simple, simple_numbers,</span>
 1907 <span class="s2">        full, full_numbers, or first_last_numbers.</span>
 1908 <span class="s2">            </span>
 1909 <span class="s2">            numbers - Page number buttons only</span>
 1910 <span class="s2">            simple - &#39;Previous&#39; and &#39;Next&#39; buttons only</span>
 1911 <span class="s2">            simple_numbers - &#39;Previous&#39; and &#39;Next&#39; buttons, plus page numbers</span>
 1912 <span class="s2">            full - &#39;First&#39;, &#39;Previous&#39;, &#39;Next&#39; and &#39;Last&#39; buttons</span>
 1913 <span class="s2">            full_numbers - &#39;First&#39;, &#39;Previous&#39;, &#39;Next&#39; and &#39;Last&#39; buttons, plus</span>
 1914 <span class="s2">                page numbers</span>
 1915 <span class="s2">            first_last_numbers - &#39;First&#39; and &#39;Last&#39; buttons, plus page numbers</span>
 1916 <span class="s2">            </span>
 1917 <span class="s2">    --pageLength &lt;number&gt;  [default: 15]</span>
 1918 <span class="s2">        Number of rows to show per page.</span>
 1919 <span class="s2">    -r, --regexSearch &lt;yes or no&gt;  [default: yes]</span>
 1920 <span class="s2">        Allow regular expression search through alphanumerical data in the table.</span>
 1921 <span class="s2">    -s, --showMolName &lt;yes or no&gt;  [default: auto]</span>
 1922 <span class="s2">        Show molecule names in a column next to the column corresponding to primary</span>
 1923 <span class="s2">        structure data in SD and SMILES file. The default value is yes for SD and SMILES file.</span>
 1924 <span class="s2">        This option is ignored for CSV/TSV text files.</span>
 1925 <span class="s2">    --scrollX &lt;yes or no&gt;  [default: yes]</span>
 1926 <span class="s2">        Provide horizontal scroll bar in the table as needed.</span>
 1927 <span class="s2">    --scrollY &lt;yes or no&gt;  [default: yes]</span>
 1928 <span class="s2">        Provide vertical scroll bar in the table as needed.</span>
 1929 <span class="s2">    --scrollYSize &lt;number&gt;  [default: 75vh]</span>
 1930 <span class="s2">        Maximum height of table viewport either in pixels or percentage of the browser</span>
 1931 <span class="s2">        window height before providing a vertical scroll bar. Default: 75</span><span class="si">% o</span><span class="s2">f the height of</span>
 1932 <span class="s2">        browser window.</span>
 1933 <span class="s2">    -t, --tableStyle &lt;table,table-striped,...&gt;  [default: table,table-hover,table-sm]</span>
 1934 <span class="s2">        Style of table. Possible values: table, table-striped, table-bordered,</span>
 1935 <span class="s2">        table-hover, table-dark, table-sm, none, or All. Default: &#39;table,table-hover&#39;. A</span>
 1936 <span class="s2">        comma delimited list of any valid Bootstrap table styles is also supported.</span>
 1937 <span class="s2">    --tableFooter &lt;yes or no&gt;  [default: yes]</span>
 1938 <span class="s2">        Show column headers at the end of the table.</span>
 1939 <span class="s2">    --tableHeaderStyle &lt;thead-dark,thead-light,...&gt;  [default: thead-dark]</span>
 1940 <span class="s2">        Style of table header. Possible values: thead-dark, thead-light, or none.</span>
 1941 <span class="s2">        The names of the following contextual color classes are also supported:</span>
 1942 <span class="s2">        table-primary (Blue), table-success (Green), table-danger (Red), table-info</span>
 1943 <span class="s2">        (Light blue), table-warning (Orange), table-active (Grey), table-light (Light</span>
 1944 <span class="s2">        grey), and  table-dark (Dark grey).</span>
 1945 <span class="s2">    -w, --workingdir &lt;dir&gt;</span>
 1946 <span class="s2">        Location of working directory which defaults to the current directory.</span>
 1947 <span class="s2">    --wrapText &lt;yes or no&gt;  [default: yes]</span>
 1948 <span class="s2">        Wrap alphanumeric text using &lt;br/&gt; delimiter for display in a HTML table.</span>
 1949 <span class="s2">    --wrapTextWidth &lt;number&gt;  [default: 40]</span>
 1950 <span class="s2">        Maximum width in characters before wraping alphanumeric text for display</span>
 1951 <span class="s2">        in a HTML table.</span>
 1952 
 1953 <span class="s2">Examples:</span>
 1954 <span class="s2">    To generate a HTML table containing structure and alphanumeric data for</span>
 1955 <span class="s2">    molecules in a SD file along with all the bells and whistles to interact with</span>
 1956 <span class="s2">    the table, type:</span>
 1957 
 1958 <span class="s2">        % RDKitDrawMoleculesAndDataTable.py -i Sample.sdf -o SampleOut.html</span>
 1959 
 1960 <span class="s2">    To generate a HTML table containing structure and alphanumeric data for</span>
 1961 <span class="s2">    molecules in a SMILES file along with all the bells and whistles to interact</span>
 1962 <span class="s2">    with the table, type:</span>
 1963 
 1964 <span class="s2">        % RDKitDrawMoleculesAndDataTable.py  -i Sample.smi -o SampleOut.html</span>
 1965 
 1966 <span class="s2">    To generate a HTML table containing multiple structure columns for molecules</span>
 1967 <span class="s2">    in a CSV file along with all the bells and whistles to interact with the table, type:</span>
 1968 
 1969 <span class="s2">        % RDKitDrawMoleculesAndDataTable.py -i SampleSeriesRGroupsD3R.csv</span>
 1970 <span class="s2">          -o SampleSeriesRGroupsD3ROut.html</span>
 1971 
 1972 <span class="s2">    To generate a HTML table containing structure and alphanumeric data for</span>
 1973 <span class="s2">    molecules in a SD file along without any bells and whistles to interact with</span>
 1974 <span class="s2">    the table, type:</span>
 1975 
 1976 <span class="s2">        % RDKitDrawMoleculesAndDataTable.py --colVisibility no --freezeCols no</span>
 1977 <span class="s2">          --keysNavigation no --paging no --regexSearch no --scrollX no</span>
 1978 <span class="s2">          --scrollY no -i Sample.sdf -o SampleOut.html</span>
 1979 
 1980 <span class="s2">    To generate a HTML table containing structure and alphanumeric data for</span>
 1981 <span class="s2">    molecules in a SD file along with highlighting molecular weight values</span>
 1982 <span class="s2">    using a specified criterion, type:</span>
 1983 
 1984 <span class="s2">        % RDKitDrawMoleculesAndDataTable.py  --highlightValues</span>
 1985 <span class="s2">          &quot;MolecularWeight,numeric,le,500&quot; -i Sample.sdf -o SampleOut.html</span>
 1986 
 1987 <span class="s2">    To generate a HTML table containing structure and alphanumeric data for</span>
 1988 <span class="s2">    molecules in a SD file along with highlighting range of molecular weight values</span>
 1989 <span class="s2">    using a specified criterion, type:</span>
 1990 
 1991 <span class="s2">        % RDKitDrawMoleculesAndDataTable.py  --highlightValuesRanges</span>
 1992 <span class="s2">          &quot;MolecularWeight,numeric,lt,400,gt,500&quot; -i Sample.sdf -o SampleOut.html</span>
 1993 
 1994 <span class="s2">    To generate a HTML table containing structure and alphanumeric data for</span>
 1995 <span class="s2">    molecules in a SD file along with highlighting molecular weight values and</span>
 1996 <span class="s2">    ranges of SLogP values using a specified criterion and color schemes, type:</span>
 1997 
 1998 <span class="s2">        % RDKitDrawMoleculesAndDataTable.py  --highlightValues</span>
 1999 <span class="s2">          &quot;MolecularWeight,numeric,le,500&quot; --highlightValuesRanges</span>
 2000 <span class="s2">          &quot;SLogP,numeric,lt,0,gt,5&quot; --highlightColors &quot;colorclass,table-success,</span>
 2001 <span class="s2">          table-danger&quot; --highlightColorsRanges &quot;colorclass,table-danger,</span>
 2002 <span class="s2">          table-success,table-warning&quot; -i Sample.sdf -o SampleOut.html</span>
 2003 
 2004 <span class="s2">    To generate a HTML table containing structure and alphanumeric data for</span>
 2005 <span class="s2">    molecules in a SD file along with highlighting RuleOf5 physicochemical</span>
 2006 <span class="s2">    properties using a pre-defined set of criteria, type:</span>
 2007 
 2008 <span class="s2">        % RDKitDrawMoleculesAndDataTable.py  --highlightValuesClasses RuleOf5</span>
 2009 <span class="s2">          -i Sample.sdf -o SampleOut.html</span>
 2010 
 2011 <span class="s2">    To generate a HTML table containing structure and alphanumeric data for</span>
 2012 <span class="s2">    molecules in a SD file along with all the bells and whistles to interact</span>
 2013 <span class="s2">    with the table and highlight a specific SMARTS pattern in molecules, type:</span>
 2014 
 2015 <span class="s2">        % RDKitDrawMoleculesAndDataTable.py  --highlightSMARTS &quot;c1ccccc1&quot;</span>
 2016 <span class="s2">          -i Sample.sdf -o SampleOut.html</span>
 2017 
 2018 <span class="s2">    To generate a HTML table containing structure and alphanumeric data for</span>
 2019 <span class="s2">    molecules in a SD file along with highlighting of values using random colors</span>
 2020 <span class="s2">    from a default list of colors, type:</span>
 2021 
 2022 <span class="s2">        % RDKitDrawMoleculesAndDataTable.py --highlightValuesClasses Random</span>
 2023 <span class="s2">          -i Sample.sdf -o SampleOut.html</span>
 2024 
 2025 <span class="s2">    To generate a HTML table containing structure and alphanumeric data for</span>
 2026 <span class="s2">    molecules in a SD file along with highlighting of values using random colors</span>
 2027 <span class="s2">    from a specified list of colors, type:</span>
 2028 
 2029 <span class="s2">        % RDKitDrawMoleculesAndDataTable.py --highlightValuesClasses Random</span>
 2030 <span class="s2">          --highlightColorsRandom &quot;colorspec,Lavendar,MediumPurple,SkyBlue,</span>
 2031 <span class="s2">          CornflowerBlue,LightGreen,MediumSeaGreen,Orange,Coral,Khaki,Gold,</span>
 2032 <span class="s2">          Salmon,LightPink,Aquamarine,MediumTurquoise,LightGray&quot; </span>
 2033 <span class="s2">          -i Sample.sdf -o SampleOut.html</span>
 2034 
 2035 <span class="s2">    To generate a HTML table containing structure and alphanumeric data for</span>
 2036 <span class="s2">    molecules in a SMILES file specific columns, type:</span>
 2037 
 2038 <span class="s2">        % RDKitDrawMoleculesAndDataTable.py --infileParams &quot;smilesDelimiter,</span>
 2039 <span class="s2">          comma, smilesColumn,1,smilesNameColumn,2&quot;</span>
 2040 <span class="s2">          -i SampleSMILES.csv -o SampleOut.html</span>
 2041 
 2042 <span class="s2">Author:</span>
 2043 <span class="s2">    Manish Sud(msud@san.rr.com)</span>
 2044 
 2045 <span class="s2">See also:</span>
 2046 <span class="s2">    RDKitConvertFileFormat.py, RDKitDrawMolecules.py, RDKitRemoveDuplicateMolecules.py,</span>
 2047 <span class="s2">    RDKitSearchFunctionalGroups.py, RDKitSearchSMARTS.py</span>
 2048 
 2049 <span class="s2">Copyright:</span>
 2050 <span class="s2">    Copyright (C) 2020 Manish Sud. All rights reserved.</span>
 2051 
 2052 <span class="s2">    The functionality available in this script is implemented using RDKit, an</span>
 2053 <span class="s2">    open source toolkit for cheminformatics developed by Greg Landrum.</span>
 2054 
 2055 <span class="s2">    This file is part of MayaChemTools.</span>
 2056 
 2057 <span class="s2">    MayaChemTools is free software; you can redistribute it and/or modify it under</span>
 2058 <span class="s2">    the terms of the GNU Lesser General Public License as published by the Free</span>
 2059 <span class="s2">    Software Foundation; either version 3 of the License, or (at your option) any</span>
 2060 <span class="s2">    later version.</span>
 2061 
 2062 <span class="s2">&quot;&quot;&quot;</span>
 2063 
 2064 <span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
 2065     <span class="n">main</span><span class="p">()</span>
</pre>
<br />
<center>
<img src="../../../images/h2o2.png">
</center>
</body>
</html>
