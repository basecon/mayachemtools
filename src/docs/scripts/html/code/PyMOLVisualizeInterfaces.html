<html>
<head>
<title>MayaChemTools:Code:PyMOLVisualizeInterfaces.py</title>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<link rel="stylesheet" type="text/css" href="../../../css/MayaChemToolsPythonCode.css">
</head>
<body leftmargin="20" rightmargin="20" topmargin="10" bottommargin="10">
<br/>
<center>
<a href="http://www.mayachemtools.org" title="MayaChemTools Home"><img src="../../../images/MayaChemToolsLogo.gif" border="0" alt="MayaChemTools"></a>
</center>
<br/>
<pre>
    1 <span class="ch">#!/bin/env python</span>
    2 <span class="c1">#</span>
    3 <span class="c1"># File: PyMOLVisualizeInterfaces.py</span>
    4 <span class="c1"># Author: Manish Sud &lt;msud@san.rr.com&gt;</span>
    5 <span class="c1">#</span>
    6 <span class="c1"># Copyright (C) 2020 Manish Sud. All rights reserved.</span>
    7 <span class="c1">#</span>
    8 <span class="c1"># The functionality available in this script is implemented using PyMOL, a</span>
    9 <span class="c1"># molecular visualization system on an open source foundation originally</span>
   10 <span class="c1"># developed by Warren DeLano.</span>
   11 <span class="c1">#</span>
   12 <span class="c1"># This file is part of MayaChemTools.</span>
   13 <span class="c1">#</span>
   14 <span class="c1"># MayaChemTools is free software; you can redistribute it and/or modify it under</span>
   15 <span class="c1"># the terms of the GNU Lesser General Public License as published by the Free</span>
   16 <span class="c1"># Software Foundation; either version 3 of the License, or (at your option) any</span>
   17 <span class="c1"># later version.</span>
   18 <span class="c1">#</span>
   19 <span class="c1"># MayaChemTools is distributed in the hope that it will be useful, but without</span>
   20 <span class="c1"># any warranty; without even the implied warranty of merchantability of fitness</span>
   21 <span class="c1"># for a particular purpose.  See the GNU Lesser General Public License for more</span>
   22 <span class="c1"># details.</span>
   23 <span class="c1">#</span>
   24 <span class="c1"># You should have received a copy of the GNU Lesser General Public License</span>
   25 <span class="c1"># along with MayaChemTools; if not, see &lt;http://www.gnu.org/licenses/&gt; or</span>
   26 <span class="c1"># write to the Free Software Foundation Inc., 59 Temple Place, Suite 330,</span>
   27 <span class="c1"># Boston, MA, 02111-1307, USA.</span>
   28 <span class="c1">#</span>
   29 
   30 <span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
   31 
   32 <span class="c1"># Add local python path to the global path and import standard library modules...</span>
   33 <span class="kn">import</span> <span class="nn">os</span>
   34 <span class="kn">import</span> <span class="nn">sys</span><span class="p">;</span>  <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="s2">&quot;..&quot;</span><span class="p">,</span> <span class="s2">&quot;lib&quot;</span><span class="p">,</span> <span class="s2">&quot;Python&quot;</span><span class="p">))</span>
   35 <span class="kn">import</span> <span class="nn">time</span>
   36 <span class="kn">import</span> <span class="nn">re</span>
   37 
   38 <span class="c1"># PyMOL imports...</span>
   39 <span class="k">try</span><span class="p">:</span>
   40     <span class="kn">import</span> <span class="nn">pymol</span>
   41     <span class="c1"># Finish launching PyMOL in  a command line mode for batch processing (-c)</span>
   42     <span class="c1"># along with the following options:  disable loading of pymolrc and plugins (-k);</span>
   43     <span class="c1"># suppress start up messages (-q)</span>
   44     <span class="n">pymol</span><span class="o">.</span><span class="n">finish_launching</span><span class="p">([</span><span class="s1">&#39;pymol&#39;</span><span class="p">,</span> <span class="s1">&#39;-ckq&#39;</span><span class="p">])</span>
   45 <span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">ErrMsg</span><span class="p">:</span>
   46     <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Failed to import PyMOL module/package: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ErrMsg</span><span class="p">)</span>
   47     <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Check/update your PyMOL environment and try again.</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
   48     <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
   49 
   50 <span class="c1"># MayaChemTools imports...</span>
   51 <span class="k">try</span><span class="p">:</span>
   52     <span class="kn">from</span> <span class="nn">docopt</span> <span class="kn">import</span> <span class="n">docopt</span>
   53     <span class="kn">import</span> <span class="nn">MiscUtil</span>
   54     <span class="kn">import</span> <span class="nn">PyMOLUtil</span>
   55 <span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">ErrMsg</span><span class="p">:</span>
   56     <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Failed to import MayaChemTools module/package: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ErrMsg</span><span class="p">)</span>
   57     <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Check/update your MayaChemTools environment and try again.</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
   58     <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
   59 
   60 <span class="n">ScriptName</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
   61 <span class="n">Options</span> <span class="o">=</span> <span class="p">{}</span>
   62 <span class="n">OptionsInfo</span> <span class="o">=</span> <span class="p">{}</span>
   63 
   64 <span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
   65     <span class="sd">&quot;&quot;&quot;Start execution of the script&quot;&quot;&quot;</span>
   66     
   67     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="s2"> (PyMOL v</span><span class="si">%s</span><span class="s2">; </span><span class="si">%s</span><span class="s2">) Starting...</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ScriptName</span><span class="p">,</span> <span class="n">pymol</span><span class="o">.</span><span class="n">cmd</span><span class="o">.</span><span class="n">get_version</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="n">time</span><span class="o">.</span><span class="n">asctime</span><span class="p">()))</span>
   68     
   69     <span class="p">(</span><span class="n">WallClockTime</span><span class="p">,</span> <span class="n">ProcessorTime</span><span class="p">)</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">GetWallClockAndProcessorTime</span><span class="p">()</span>
   70     
   71     <span class="c1"># Retrieve command line arguments and options...</span>
   72     <span class="n">RetrieveOptions</span><span class="p">()</span>
   73     
   74     <span class="c1"># Process and validate command line arguments and options...</span>
   75     <span class="n">ProcessOptions</span><span class="p">()</span>
   76 
   77     <span class="c1"># Perform actions required by the script...</span>
   78     <span class="n">GenerateMacromolecularInterfacesVisualization</span><span class="p">()</span>
   79     
   80     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="s2">: Done...</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ScriptName</span><span class="p">)</span>
   81     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Total time: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">GetFormattedElapsedTime</span><span class="p">(</span><span class="n">WallClockTime</span><span class="p">,</span> <span class="n">ProcessorTime</span><span class="p">))</span>
   82 
   83 <span class="k">def</span> <span class="nf">GenerateMacromolecularInterfacesVisualization</span><span class="p">():</span>
   84     <span class="sd">&quot;&quot;&quot;Generate visualization for macromolecular interfaces.&quot;&quot;&quot;</span>
   85 
   86     <span class="n">Outfile</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMLOutfile&quot;</span><span class="p">]</span>
   87     <span class="n">OutFH</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">Outfile</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
   88     <span class="k">if</span> <span class="n">OutFH</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
   89         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;Failed to open output fie </span><span class="si">%s</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">Outfile</span><span class="p">)</span>
   90     
   91     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Generating file </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">Outfile</span><span class="p">)</span>
   92 
   93     <span class="c1"># Setup header...</span>
   94     <span class="n">WritePMLHeader</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">ScriptName</span><span class="p">)</span>
   95     <span class="n">WritePyMOLParameters</span><span class="p">(</span><span class="n">OutFH</span><span class="p">)</span>
   96     
   97     <span class="n">WriteComplexesAndChainsViews</span><span class="p">(</span><span class="n">OutFH</span><span class="p">)</span>
   98     <span class="n">WriteInterfaceViews</span><span class="p">(</span><span class="n">OutFH</span><span class="p">)</span>
   99 
  100     <span class="n">OutFH</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
  101 
  102     <span class="c1"># Generate PSE file as needed...</span>
  103     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PSEOut&quot;</span><span class="p">]:</span>
  104         <span class="n">GeneratePyMOLSessionFile</span><span class="p">()</span>
  105 
  106 <span class="k">def</span> <span class="nf">WriteComplexesAndChainsViews</span><span class="p">(</span><span class="n">OutFH</span><span class="p">):</span>
  107     <span class="sd">&quot;&quot;&quot;Write out PML for viewing complexes and chains in input files. &quot;&quot;&quot;</span>
  108     
  109     <span class="c1"># Setup views for input file(s)...</span>
  110     <span class="k">for</span> <span class="n">FileIndex</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">])):</span>
  111         <span class="c1"># Setup PyMOL object names...</span>
  112         <span class="n">PyMOLObjectNamesInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;PyMOLObjectNamesInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
  113 
  114         <span class="c1"># Setup complex view...</span>
  115         <span class="n">WriteComplexView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNamesInfo</span><span class="p">)</span>
  116 
  117         <span class="c1"># Setup chain views...</span>
  118         <span class="n">SpecifiedChainsAndLigandsInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
  119 
  120         <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]:</span>
  121             <span class="n">WriteChainView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNamesInfo</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
  122             
  123             <span class="c1"># Setup ligand views...</span>
  124             <span class="k">for</span> <span class="n">LigandID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]:</span>
  125                 <span class="n">WriteChainLigandView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNamesInfo</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">)</span>
  126                 
  127                 <span class="c1"># Set up ligand level group...</span>
  128                 <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span> <span class="o">=</span> <span class="p">[</span><span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">]</span>
  129                 <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNamesInfo</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="s2">&quot;ChainLigandGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNamesInfo</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="s2">&quot;ChainLigandGroupMembers&quot;</span><span class="p">],</span> <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span><span class="p">)</span>
  130             
  131             <span class="c1"># Setup Chain level group...</span>
  132             <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span> <span class="o">=</span> <span class="p">[</span><span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;open&quot;</span><span class="p">]</span>
  133             <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNamesInfo</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNamesInfo</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroupMembers&quot;</span><span class="p">],</span> <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span><span class="p">)</span>
  134     
  135         <span class="c1"># Set up complex level group...</span>
  136         <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span> <span class="o">=</span> <span class="p">[</span><span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">]</span>
  137         <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNamesInfo</span><span class="p">[</span><span class="s2">&quot;PDBGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNamesInfo</span><span class="p">[</span><span class="s2">&quot;PDBGroupMembers&quot;</span><span class="p">],</span> <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span><span class="p">)</span>
  138         
  139         <span class="c1"># Delete empty PyMOL objects...</span>
  140         <span class="n">DeleteEmptyPyMOLObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNamesInfo</span><span class="p">)</span>
  141     
  142 <span class="k">def</span> <span class="nf">WriteInterfaceViews</span><span class="p">(</span><span class="n">OutFH</span><span class="p">):</span>
  143     <span class="sd">&quot;&quot;&quot;Write out PML for viewing macromolecular interfaces among specified chains.&quot;&quot;&quot;</span>
  144     
  145     <span class="n">InterfaceChainsAndResiduesInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InterfaceChainsAndResiduesInfo&quot;</span><span class="p">]</span>
  146     <span class="k">if</span> <span class="n">InterfaceChainsAndResiduesInfo</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
  147         <span class="k">return</span>
  148 
  149     <span class="n">PyMOLInterfaceObjectNamesInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;PyMOLInterfaceObjectNamesInfo&quot;</span><span class="p">]</span>
  150     <span class="n">InterfaceChainPairsAndResiduesInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InterfaceChainPairsAndResiduesInfo&quot;</span><span class="p">]</span>
  151     
  152     <span class="n">FirstInterfaceID</span> <span class="o">=</span> <span class="bp">True</span>
  153     <span class="k">for</span> <span class="n">InterfaceID</span> <span class="ow">in</span> <span class="n">InterfaceChainsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;InterfaceIDs&quot;</span><span class="p">]:</span>
  154         <span class="n">WriteInterfacePolarContactsView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">InterfaceID</span><span class="p">,</span> <span class="n">InterfaceChainPairsAndResiduesInfo</span><span class="p">,</span> <span class="n">PyMOLInterfaceObjectNamesInfo</span><span class="p">)</span>
  155         <span class="n">WriteInterfaceHydrophobicContactsView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">InterfaceID</span><span class="p">,</span> <span class="n">InterfaceChainPairsAndResiduesInfo</span><span class="p">,</span> <span class="n">PyMOLInterfaceObjectNamesInfo</span><span class="p">)</span>
  156         
  157         <span class="k">for</span> <span class="n">InterfaceChainID</span> <span class="ow">in</span> <span class="n">InterfaceChainsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">]:</span>
  158             <span class="n">ChainID</span> <span class="o">=</span> <span class="n">InterfaceChainsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">]</span>
  159             <span class="n">ResNums</span> <span class="o">=</span> <span class="n">InterfaceChainsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDsResNums&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">]</span>
  160             <span class="n">ComplexName</span> <span class="o">=</span> <span class="n">InterfaceChainsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDsComplexNames&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">]</span>
  161             <span class="n">FileIndex</span> <span class="o">=</span> <span class="n">InterfaceChainsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDsInfileIndices&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">]</span>
  162 
  163             <span class="n">WriteInterfaceChainView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">InterfaceID</span><span class="p">,</span> <span class="n">InterfaceChainID</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">ResNums</span><span class="p">,</span> <span class="n">ComplexName</span><span class="p">,</span> <span class="n">PyMOLInterfaceObjectNamesInfo</span><span class="p">)</span>
  164 
  165             <span class="c1"># Setup interface Chain level group...</span>
  166             <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span> <span class="o">=</span> <span class="p">[</span><span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;open&quot;</span><span class="p">]</span>
  167             <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLInterfaceObjectNamesInfo</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLInterfaceObjectNamesInfo</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroupMembers&quot;</span><span class="p">],</span> <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span><span class="p">)</span>
  168 
  169         <span class="k">if</span> <span class="n">FirstInterfaceID</span><span class="p">:</span>
  170             <span class="n">FirstInterfaceID</span> <span class="o">=</span> <span class="bp">False</span>
  171             <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span> <span class="o">=</span> <span class="p">[</span><span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;open&quot;</span><span class="p">]</span>
  172         <span class="k">else</span><span class="p">:</span>
  173             <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span> <span class="o">=</span> <span class="p">[</span><span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">]</span>
  174             
  175         <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLInterfaceObjectNamesInfo</span><span class="p">[</span><span class="s2">&quot;InterfaceIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="s2">&quot;InterfaceIDGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLInterfaceObjectNamesInfo</span><span class="p">[</span><span class="s2">&quot;InterfaceIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="s2">&quot;InterfaceIDGroupMembers&quot;</span><span class="p">],</span> <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span><span class="p">)</span>
  176 
  177     <span class="c1"># Setup interfaces level group...</span>
  178     <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span> <span class="o">=</span> <span class="p">[</span><span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;open&quot;</span><span class="p">]</span>
  179     <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLInterfaceObjectNamesInfo</span><span class="p">[</span><span class="s2">&quot;InterfacesGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLInterfaceObjectNamesInfo</span><span class="p">[</span><span class="s2">&quot;InterfacesGroupMembers&quot;</span><span class="p">],</span> <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span><span class="p">)</span>
  180 
  181     <span class="n">DeleteEmptyPyMOLInterfaceObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">)</span>
  182     
  183     <span class="c1"># Setup orientation...</span>
  184     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">cmd.orient(&quot;visible&quot;, animate = -1)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  185 
  186 <span class="k">def</span> <span class="nf">WritePMLHeader</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">ScriptName</span><span class="p">):</span>
  187     <span class="sd">&quot;&quot;&quot;Write out PML setting up complex view&quot;&quot;&quot;</span>
  188 
  189     <span class="n">HeaderInfo</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLHeaderInfo</span><span class="p">(</span><span class="n">ScriptName</span><span class="p">)</span>
  190     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">HeaderInfo</span><span class="p">)</span>
  191 
  192 <span class="k">def</span> <span class="nf">WritePyMOLParameters</span><span class="p">(</span><span class="n">OutFH</span><span class="p">):</span>
  193     <span class="sd">&quot;&quot;&quot;Write out PyMOL global parameters. &quot;&quot;&quot;</span>
  194 
  195     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
  196     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;transparency&quot;, </span><span class="si">%.2f</span><span class="s2">, &quot;&quot;, 0)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceTransparency&quot;</span><span class="p">]))</span>
  197     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;label_font_id&quot;, </span><span class="si">%s</span><span class="s2">)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;LabelFontID&quot;</span><span class="p">]))</span>
  198     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
  199     
  200     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Setting up PyMOL gobal parameters...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  201     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  202     
  203 <span class="k">def</span> <span class="nf">WriteComplexView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">):</span>
  204     <span class="sd">&quot;&quot;&quot;Write out PML for viewing polymer complex.&quot;&quot;&quot;</span>
  205 
  206     <span class="c1"># Setup complex...</span>
  207     <span class="n">Infile</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
  208     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForPolymerComplexView</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Complex&quot;</span><span class="p">],</span> <span class="n">Infile</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
  209     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Loading </span><span class="si">%s</span><span class="s2"> and setting up view for complex...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">Infile</span><span class="p">)</span>
  210     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  211 
  212     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceComplex&quot;</span><span class="p">]:</span>
  213         <span class="c1"># Setup hydrophobic surface...</span>
  214         <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForHydrophobicSurfaceView</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexHydrophobicSurface&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Complex&quot;</span><span class="p">],</span> <span class="n">ColorPalette</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceColorPalette&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
  215         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  216     
  217     <span class="c1"># Setup complex group...</span>
  218     <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexGroupMembers&quot;</span><span class="p">],</span> <span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  219 
  220 <span class="k">def</span> <span class="nf">WriteChainView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  221     <span class="sd">&quot;&quot;&quot;Write out PML for viewing chain.&quot;&quot;&quot;</span>
  222     
  223     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Setting up views for chain </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">ChainID</span><span class="p">)</span>
  224     
  225     <span class="n">ChainComplexName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplex&quot;</span><span class="p">]</span>
  226     
  227     <span class="c1"># Setup chain complex group view...</span>
  228     <span class="n">WriteChainComplexViews</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
  229 
  230     <span class="c1"># Setup chain view...</span>
  231     <span class="n">WriteChainAloneViews</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
  232     
  233     <span class="c1"># Setup chain solvent view...</span>
  234     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForSolventView</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;Solvent&quot;</span><span class="p">],</span> <span class="n">ChainComplexName</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
  235     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  236 
  237     <span class="c1"># Setup chain inorganic view...</span>
  238     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForInorganicView</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;Inorganic&quot;</span><span class="p">],</span> <span class="n">ChainComplexName</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
  239     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  240 
  241 <span class="k">def</span> <span class="nf">WriteChainComplexViews</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  242     <span class="sd">&quot;&quot;&quot;Write chain complex views. &quot;&quot;&quot;</span>
  243 
  244     <span class="c1"># Setup chain complex...</span>
  245     <span class="n">ChainComplexName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplex&quot;</span><span class="p">]</span>
  246     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForPolymerChainComplexView</span><span class="p">(</span><span class="n">ChainComplexName</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Complex&quot;</span><span class="p">],</span> <span class="n">ChainID</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
  247     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  248 
  249     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChainComplex&quot;</span><span class="p">]:</span>
  250         <span class="c1"># Setup hydrophobic surface...</span>
  251         <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForHydrophobicSurfaceView</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexHydrophobicSurface&quot;</span><span class="p">],</span> <span class="n">ChainComplexName</span><span class="p">,</span> <span class="n">ColorPalette</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceColorPalette&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
  252         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  253     
  254     <span class="c1"># Setup chain complex group...</span>
  255     <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexGroupMembers&quot;</span><span class="p">],</span> <span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  256     
  257 <span class="k">def</span> <span class="nf">WriteChainAloneViews</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  258     <span class="sd">&quot;&quot;&quot;Write individual chain views. &quot;&quot;&quot;</span>
  259 
  260     <span class="n">ChainComplexName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplex&quot;</span><span class="p">]</span>
  261 
  262     <span class="c1"># Setup chain view...</span>
  263     <span class="n">ChainName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAlone&quot;</span><span class="p">]</span>
  264     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForPolymerChainView</span><span class="p">(</span><span class="n">ChainName</span><span class="p">,</span> <span class="n">ChainComplexName</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
  265     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  266 
  267     <span class="c1"># Setup a non-interface chain view...</span>
  268     <span class="n">NonInterfaceChainName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneNonInterface&quot;</span><span class="p">]</span>
  269     
  270     <span class="n">InterfaceResNums</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">][</span><span class="s2">&quot;InterfaceResNums&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
  271     <span class="n">InterfaceResNumsSelection</span> <span class="o">=</span> <span class="s2">&quot;+&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">InterfaceResNums</span><span class="p">)</span>
  272     
  273     <span class="n">Selection</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2"> and polymer and (not (resi </span><span class="si">%s</span><span class="s2">))&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainComplexName</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">InterfaceResNumsSelection</span><span class="p">)</span>
  274     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForSelectionDisplayView</span><span class="p">(</span><span class="n">NonInterfaceChainName</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="s2">&quot;cartoon&quot;</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
  275     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  276     
  277     <span class="k">if</span> <span class="n">GetChainAloneContainsSurfacesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  278         <span class="c1"># Setup a generic colored surface...</span>
  279         <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForSurfaceView</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSurface&quot;</span><span class="p">],</span> <span class="n">NonInterfaceChainName</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">Color</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceNonInterfaceColor&quot;</span><span class="p">])</span>
  280         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  281         
  282         <span class="k">if</span> <span class="n">GetChainAloneSurfaceChainStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  283             <span class="c1"># Setup surface colored by hydrophobicity...</span>
  284             <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForHydrophobicSurfaceView</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneHydrophobicSurface&quot;</span><span class="p">],</span> <span class="n">NonInterfaceChainName</span><span class="p">,</span> <span class="n">ColorPalette</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceColorPalette&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
  285             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  286             
  287             <span class="c1"># Setup surface colored by hyrdophobicity and charge...</span>
  288             <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForHydrophobicAndChargeSurfaceView</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneHydrophobicChargeSurface&quot;</span><span class="p">],</span> <span class="n">NonInterfaceChainName</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AtomTypesColorNames&quot;</span><span class="p">][</span><span class="s2">&quot;HydrophobicAtomsColor&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AtomTypesColorNames&quot;</span><span class="p">][</span><span class="s2">&quot;NegativelyChargedAtomsColor&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AtomTypesColorNames&quot;</span><span class="p">][</span><span class="s2">&quot;PositivelyChargedAtomsColor&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AtomTypesColorNames&quot;</span><span class="p">][</span><span class="s2">&quot;OtherAtomsColor&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">DisplayAs</span> <span class="o">=</span> <span class="bp">None</span><span class="p">)</span>
  289             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  290         
  291         <span class="k">if</span> <span class="n">GetChainAloneSurfaceChainElectrostaticsStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  292             <span class="c1"># Setup electrostatics surface...</span>
  293             <span class="n">SelectionObjectName</span> <span class="o">=</span> <span class="n">NonInterfaceChainName</span>
  294             <span class="n">ElectrostaticsGroupName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneElectrostaticsGroup&quot;</span><span class="p">]</span>
  295             <span class="n">ElectrostaticsGroupMembers</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneElectrostaticsGroupMembers&quot;</span><span class="p">]</span>
  296             <span class="n">WriteSurfaceElectrostaticsView</span><span class="p">(</span><span class="s2">&quot;Chain&quot;</span><span class="p">,</span> <span class="n">OutFH</span><span class="p">,</span> <span class="n">SelectionObjectName</span><span class="p">,</span> <span class="n">ElectrostaticsGroupName</span><span class="p">,</span> <span class="n">ElectrostaticsGroupMembers</span><span class="p">)</span>
  297 
  298         <span class="c1"># Setup surface group...</span>
  299         <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSurfaceGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSurfaceGroupMembers&quot;</span><span class="p">],</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;open&quot;</span><span class="p">)</span>
  300 
  301     <span class="c1"># Setup a non-interface group...</span>
  302     <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneNonInterfaceGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneNonInterfaceGroupMembers&quot;</span><span class="p">],</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;open&quot;</span><span class="p">)</span>
  303     
  304     <span class="c1"># Setup chain group...</span>
  305     <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneGroupMembers&quot;</span><span class="p">],</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  306     
  307 <span class="k">def</span> <span class="nf">WriteChainLigandView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">):</span>
  308     <span class="sd">&quot;&quot;&quot;Write out PML for viewing ligand in a chain.&quot;&quot;&quot;</span>
  309 
  310     <span class="n">GroupID</span> <span class="o">=</span> <span class="s2">&quot;Ligand&quot;</span>
  311     <span class="n">ComplexName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplex&quot;</span><span class="p">]</span>
  312     <span class="n">LigandName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="s2">&quot;Ligand&quot;</span><span class="p">]</span>
  313     
  314     <span class="c1"># Setup main object...</span>
  315     <span class="n">GroupTypeObjectID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  316     <span class="n">GroupTypeObjectName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupTypeObjectID</span><span class="p">]</span>
  317     
  318     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Setting up views for ligand </span><span class="si">%s</span><span class="s2"> in chain </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">LigandID</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">))</span>
  319     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForLigandView</span><span class="p">(</span><span class="n">GroupTypeObjectName</span><span class="p">,</span> <span class="n">ComplexName</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
  320     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  321     
  322     <span class="c1"># Setup ball and stick view...</span>
  323     <span class="n">BallAndStickNameID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">BallAndStick&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  324     <span class="n">BallAndStickName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">BallAndStickNameID</span><span class="p">]</span>
  325     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForBallAndStickView</span><span class="p">(</span><span class="n">BallAndStickName</span><span class="p">,</span> <span class="n">GroupTypeObjectName</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
  326     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  327             
  328     <span class="c1"># Setup group....</span>
  329     <span class="n">GroupNameID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  330     <span class="n">GroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">GroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  331     <span class="n">GroupName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupNameID</span><span class="p">]</span>
  332     <span class="n">GroupMembers</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupMembersID</span><span class="p">]</span>
  333 
  334     <span class="n">Action</span> <span class="o">=</span> <span class="s2">&quot;open&quot;</span>
  335     <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span>
  336     <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">GroupName</span><span class="p">,</span> <span class="n">GroupMembers</span><span class="p">,</span> <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span><span class="p">)</span>
  337 
  338 <span class="k">def</span> <span class="nf">WriteInterfacePolarContactsView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">InterfaceID</span><span class="p">,</span> <span class="n">InterfaceChainPairsAndResiduesInfo</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">):</span>
  339     <span class="sd">&quot;&quot;&quot;Write out PML for viewing polar contacts between interface residues.&quot;&quot;&quot;</span>
  340     
  341     <span class="k">if</span> <span class="ow">not</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InterfacePolarContacts&quot;</span><span class="p">]:</span>
  342         <span class="k">return</span>
  343     
  344     <span class="n">WriteInterfaceContactsView</span><span class="p">(</span><span class="s2">&quot;InterfacePolarConatcts&quot;</span><span class="p">,</span> <span class="n">OutFH</span><span class="p">,</span> <span class="n">InterfaceID</span><span class="p">,</span> <span class="n">InterfaceChainPairsAndResiduesInfo</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">)</span>
  345     
  346 <span class="k">def</span> <span class="nf">WriteInterfaceHydrophobicContactsView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">InterfaceID</span><span class="p">,</span> <span class="n">InterfaceChainPairsAndResiduesInfo</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">):</span>
  347     <span class="sd">&quot;&quot;&quot;Write out PML for viewing hydrophobic contacts between interface residues.&quot;&quot;&quot;</span>
  348     
  349     <span class="k">if</span> <span class="ow">not</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InterfaceHydrophobicContacts&quot;</span><span class="p">]:</span>
  350         <span class="k">return</span>
  351 
  352     <span class="n">WriteInterfaceContactsView</span><span class="p">(</span><span class="s2">&quot;InterfaceHydrophobicContacts&quot;</span><span class="p">,</span> <span class="n">OutFH</span><span class="p">,</span> <span class="n">InterfaceID</span><span class="p">,</span> <span class="n">InterfaceChainPairsAndResiduesInfo</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">)</span>
  353     
  354 <span class="k">def</span> <span class="nf">WriteInterfaceContactsView</span><span class="p">(</span><span class="n">Mode</span><span class="p">,</span> <span class="n">OutFH</span><span class="p">,</span> <span class="n">InterfaceID</span><span class="p">,</span> <span class="n">InterfaceChainPairsAndResiduesInfo</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">):</span>
  355     <span class="sd">&quot;&quot;&quot;Write out PML for viewing polar or hydrophobic contacts between interface residues.&quot;&quot;&quot;</span>
  356     
  357     <span class="n">InterfacePolarContacts</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^InterfacePolarConatcts$&quot;</span><span class="p">,</span> <span class="n">Mode</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
  358     
  359     <span class="n">ChainIDs1</span><span class="p">,</span> <span class="n">ChainIDs2</span> <span class="o">=</span>  <span class="n">InterfaceChainPairsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDsPairs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">]</span>
  360     <span class="n">ResNums1</span><span class="p">,</span> <span class="n">ResNums2</span> <span class="o">=</span> <span class="n">InterfaceChainPairsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDsResNumsPairs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">]</span>
  361     
  362     <span class="n">FileIndex1</span><span class="p">,</span> <span class="n">FileIndex2</span> <span class="o">=</span> <span class="n">InterfaceChainPairsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;InfileIndicesPairs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">]</span>
  363     <span class="n">ComplexName1</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;PyMOLObjectNamesInfo&quot;</span><span class="p">][</span><span class="n">FileIndex1</span><span class="p">][</span><span class="s2">&quot;Complex&quot;</span><span class="p">]</span>
  364     <span class="n">ComplexName2</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;PyMOLObjectNamesInfo&quot;</span><span class="p">][</span><span class="n">FileIndex2</span><span class="p">][</span><span class="s2">&quot;Complex&quot;</span><span class="p">]</span>
  365     
  366     <span class="n">Selection1</span> <span class="o">=</span> <span class="n">SetupSelectionForInterfaceContactsView</span><span class="p">(</span><span class="n">ComplexName1</span><span class="p">,</span> <span class="n">ChainIDs1</span><span class="p">,</span> <span class="n">ResNums1</span><span class="p">)</span>
  367     <span class="n">Selection2</span> <span class="o">=</span> <span class="n">SetupSelectionForInterfaceContactsView</span><span class="p">(</span><span class="n">ComplexName2</span><span class="p">,</span> <span class="n">ChainIDs2</span><span class="p">,</span> <span class="n">ResNums2</span><span class="p">)</span>
  368 
  369     <span class="k">if</span> <span class="n">InterfacePolarContacts</span><span class="p">:</span>
  370         <span class="n">ContactsName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="s2">&quot;PolarContacts&quot;</span><span class="p">]</span>
  371         <span class="n">ContactsColor</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InterfacePolarContactsColor&quot;</span><span class="p">]</span>
  372         <span class="n">ContactsCutoff</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InterfaceContactsCutoff&quot;</span><span class="p">]</span>
  373         
  374         <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForPolarContactsView</span><span class="p">(</span><span class="n">ContactsName</span><span class="p">,</span> <span class="n">Selection1</span><span class="p">,</span> <span class="n">Selection2</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">Color</span> <span class="o">=</span> <span class="n">ContactsColor</span><span class="p">,</span> <span class="n">Cutoff</span> <span class="o">=</span> <span class="n">ContactsCutoff</span><span class="p">)</span>
  375     <span class="k">else</span><span class="p">:</span>
  376         <span class="n">ContactsName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="s2">&quot;HydrophobicContacts&quot;</span><span class="p">]</span>
  377         <span class="n">ContactsColor</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InterfaceHydrophobicContactsColor&quot;</span><span class="p">]</span>
  378         <span class="n">ContactsCutoff</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InterfaceContactsCutoff&quot;</span><span class="p">]</span>
  379         
  380         <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForHydrophobicContactsView</span><span class="p">(</span><span class="n">ContactsName</span><span class="p">,</span> <span class="n">Selection1</span><span class="p">,</span> <span class="n">Selection2</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">Color</span> <span class="o">=</span> <span class="n">ContactsColor</span><span class="p">,</span> <span class="n">Cutoff</span> <span class="o">=</span> <span class="n">ContactsCutoff</span><span class="p">)</span>
  381     
  382     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  383     
  384     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;label_color&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ContactsColor</span><span class="p">,</span> <span class="n">ContactsName</span><span class="p">))</span>
  385 
  386 <span class="k">def</span> <span class="nf">SetupSelectionForInterfaceContactsView</span><span class="p">(</span><span class="n">ComplexName</span><span class="p">,</span> <span class="n">ChainIDs</span><span class="p">,</span> <span class="n">ResNums</span><span class="p">):</span>
  387     <span class="sd">&quot;&quot;&quot;Setup a selection for generating polar or hyrophobic contacts for an interface.&quot;&quot;&quot;</span>
  388 
  389     <span class="n">ChainSelections</span> <span class="o">=</span> <span class="p">[]</span>
  390     
  391     <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">ChainIDs</span><span class="p">:</span>
  392         <span class="n">ChainResNumsSelection</span> <span class="o">=</span> <span class="s2">&quot;+&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ResNums</span><span class="p">[</span><span class="s2">&quot;ResNums&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">])</span>
  393         <span class="n">Selection</span> <span class="o">=</span> <span class="s2">&quot;(</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2"> and polymer and (resi </span><span class="si">%s</span><span class="s2">))&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ComplexName</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">ChainResNumsSelection</span><span class="p">)</span>
  394         <span class="n">ChainSelections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Selection</span><span class="p">)</span>
  395 
  396     <span class="n">Selection</span> <span class="o">=</span> <span class="s2">&quot; or &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ChainSelections</span><span class="p">)</span>
  397     
  398     <span class="k">return</span> <span class="n">Selection</span>
  399 
  400 <span class="k">def</span> <span class="nf">WriteInterfaceChainView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">InterfaceID</span><span class="p">,</span> <span class="n">InterfaceChainID</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">ResiduesNums</span><span class="p">,</span> <span class="n">ComplexName</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">):</span>
  401     <span class="sd">&quot;&quot;&quot;Write out PML for viewing interface residues in a chain.&quot;&quot;&quot;</span>
  402 
  403     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Setting up interface views for interface in </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">InterfaceChainID</span><span class="p">)</span>
  404     
  405     <span class="n">ResiduesNumsSelection</span> <span class="o">=</span> <span class="s2">&quot;+&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ResiduesNums</span><span class="p">)</span>
  406     
  407     <span class="c1"># Setup a chain for interface residues...</span>
  408     <span class="n">ChainName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">][</span><span class="s2">&quot;Chain&quot;</span><span class="p">]</span>
  409     <span class="n">Selection</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2"> and polymer and (resi </span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ComplexName</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">ResiduesNumsSelection</span><span class="p">)</span>
  410 
  411     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForSelectionDisplayView</span><span class="p">(</span><span class="n">ChainName</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="s2">&quot;lines&quot;</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
  412     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  413 
  414     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;label_color&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InterfaceLabelColor&quot;</span><span class="p">],</span> <span class="n">ChainName</span><span class="p">))</span>
  415 
  416     <span class="n">WriteInterfaceChainResidueTypesView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">InterfaceID</span><span class="p">,</span> <span class="n">InterfaceChainID</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">)</span>
  417     
  418     <span class="k">if</span> <span class="n">GetInterfaceContainsSurfacesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  419         <span class="c1"># Setup generic colored surface...</span>
  420         <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForSurfaceView</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">][</span><span class="s2">&quot;ChainSurface&quot;</span><span class="p">],</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">Color</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceInterfaceColor&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">DisplayAs</span> <span class="o">=</span> <span class="s2">&quot;lines&quot;</span><span class="p">)</span>
  421         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  422         
  423         <span class="k">if</span> <span class="n">GetInterfaceSurfaceChainStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  424             <span class="c1"># Setup surface colored by hydrophobicity...</span>
  425             <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForHydrophobicSurfaceView</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">][</span><span class="s2">&quot;ChainHydrophobicSurface&quot;</span><span class="p">],</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">ColorPalette</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceColorPalette&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">DisplayAs</span> <span class="o">=</span> <span class="s2">&quot;lines&quot;</span><span class="p">)</span>
  426             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  427             
  428             <span class="c1"># Setup surface colored by hyrdophobicity and charge...</span>
  429             <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForHydrophobicAndChargeSurfaceView</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">][</span><span class="s2">&quot;ChainHydrophobicChargeSurface&quot;</span><span class="p">],</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AtomTypesColorNames&quot;</span><span class="p">][</span><span class="s2">&quot;HydrophobicAtomsColor&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AtomTypesColorNames&quot;</span><span class="p">][</span><span class="s2">&quot;NegativelyChargedAtomsColor&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AtomTypesColorNames&quot;</span><span class="p">][</span><span class="s2">&quot;PositivelyChargedAtomsColor&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AtomTypesColorNames&quot;</span><span class="p">][</span><span class="s2">&quot;OtherAtomsColor&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">DisplayAs</span> <span class="o">=</span> <span class="s2">&quot;lines&quot;</span><span class="p">)</span>
  430             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  431         
  432         <span class="k">if</span> <span class="n">GetInterfaceSurfaceChainElectrostaticsStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  433             <span class="c1"># Setup electrostatics surface...</span>
  434             <span class="n">SelectionObjectName</span> <span class="o">=</span> <span class="n">ChainName</span>
  435             <span class="n">ElectrostaticsGroupName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">][</span><span class="s2">&quot;ChainElectrostaticsGroup&quot;</span><span class="p">]</span>
  436             <span class="n">ElectrostaticsGroupMembers</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">][</span><span class="s2">&quot;ChainElectrostaticsGroupMembers&quot;</span><span class="p">]</span>
  437             <span class="n">WriteSurfaceElectrostaticsView</span><span class="p">(</span><span class="s2">&quot;InterfaceResidues&quot;</span><span class="p">,</span> <span class="n">OutFH</span><span class="p">,</span> <span class="n">SelectionObjectName</span><span class="p">,</span> <span class="n">ElectrostaticsGroupName</span><span class="p">,</span> <span class="n">ElectrostaticsGroupMembers</span><span class="p">)</span>
  438         
  439         <span class="c1"># Setup surface group...</span>
  440         <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">][</span><span class="s2">&quot;ChainSurfaceGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">][</span><span class="s2">&quot;ChainSurfaceGroupMembers&quot;</span><span class="p">],</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;open&quot;</span><span class="p">)</span>
  441         
  442     <span class="c1"># Setup chain group...</span>
  443     <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroupMembers&quot;</span><span class="p">],</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  444     
  445 <span class="k">def</span> <span class="nf">WriteInterfaceChainResidueTypesView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">InterfaceID</span><span class="p">,</span> <span class="n">InterfaceChainID</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">):</span>
  446     <span class="sd">&quot;&quot;&quot;Write out PML for viewing interface residue types for a chain. &quot;&quot;&quot;</span>
  447 
  448     <span class="k">if</span> <span class="ow">not</span> <span class="n">GetInterfaceResidueTypesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  449         <span class="k">return</span>
  450     
  451     <span class="n">ChainName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">][</span><span class="s2">&quot;Chain&quot;</span><span class="p">]</span>
  452     
  453     <span class="c1"># Setup residue types objects...</span>
  454     <span class="n">ResiduesGroupIDPrefix</span> <span class="o">=</span> <span class="s2">&quot;ChainResidues&quot;</span>
  455     <span class="k">for</span> <span class="n">SubGroupType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Aromatic&quot;</span><span class="p">,</span> <span class="s2">&quot;Hydrophobic&quot;</span><span class="p">,</span> <span class="s2">&quot;Polar&quot;</span><span class="p">,</span> <span class="s2">&quot;Positively_Charged&quot;</span><span class="p">,</span> <span class="s2">&quot;Negatively_Charged&quot;</span><span class="p">,</span> <span class="s2">&quot;Other&quot;</span><span class="p">]:</span>
  456         <span class="n">SubGroupID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">SubGroupType</span><span class="p">)</span>
  457 
  458         <span class="n">ResiduesObjectID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Residues&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupIDPrefix</span><span class="p">,</span> <span class="n">SubGroupID</span><span class="p">)</span>
  459         <span class="n">ResiduesObjectName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">][</span><span class="n">ResiduesObjectID</span><span class="p">]</span>
  460 
  461         <span class="n">ResiduesSurfaceObjectID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Surface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupIDPrefix</span><span class="p">,</span> <span class="n">SubGroupID</span><span class="p">)</span>
  462         <span class="n">ResiduesSurfaceObjectName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">][</span><span class="n">ResiduesSurfaceObjectID</span><span class="p">]</span>
  463 
  464         <span class="n">ResiduesColor</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesParams&quot;</span><span class="p">][</span><span class="n">SubGroupType</span><span class="p">][</span><span class="s2">&quot;Color&quot;</span><span class="p">]</span> 
  465         <span class="n">ResiduesNames</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesParams&quot;</span><span class="p">][</span><span class="n">SubGroupType</span><span class="p">][</span><span class="s2">&quot;Residues&quot;</span><span class="p">]</span>
  466 
  467         <span class="n">NegateResidueNames</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Other$&quot;</span><span class="p">,</span> <span class="n">SubGroupType</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
  468         <span class="n">WriteResidueTypesResiduesAndSurfaceView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">ResiduesObjectName</span><span class="p">,</span> <span class="n">ResiduesSurfaceObjectName</span><span class="p">,</span> <span class="n">ResiduesColor</span><span class="p">,</span> <span class="n">ResiduesNames</span><span class="p">,</span> <span class="n">NegateResidueNames</span><span class="p">)</span>
  469 
  470         <span class="c1"># Setup residue type sub groups...</span>
  471         <span class="n">ResiduesSubGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupIDPrefix</span><span class="p">,</span> <span class="n">SubGroupID</span><span class="p">)</span>
  472         <span class="n">ResiduesSubGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">GroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupIDPrefix</span><span class="p">,</span> <span class="n">SubGroupID</span><span class="p">)</span>
  473 
  474         <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">][</span><span class="n">ResiduesSubGroupID</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">][</span><span class="n">ResiduesSubGroupMembersID</span><span class="p">],</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  475         
  476     <span class="c1"># Setup residue types group...</span>
  477     <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">][</span><span class="s2">&quot;ChainResiduesGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">][</span><span class="s2">&quot;ChainResiduesGroupMembers&quot;</span><span class="p">],</span> <span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  478 
  479 <span class="k">def</span> <span class="nf">WriteResidueTypesResiduesAndSurfaceView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">SelectionObjectName</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">SurfaceName</span><span class="p">,</span> <span class="n">ResiduesColor</span><span class="p">,</span> <span class="n">ResiduesNames</span><span class="p">,</span> <span class="n">NegateResidueNames</span><span class="p">):</span>
  480     <span class="sd">&quot;&quot;&quot;Write residue types residues and surface view. &quot;&quot;&quot;</span>
  481 
  482     <span class="n">ResidueNamesSelection</span> <span class="o">=</span> <span class="s2">&quot;+&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ResiduesNames</span><span class="p">)</span>
  483     <span class="k">if</span> <span class="n">NegateResidueNames</span><span class="p">:</span>
  484         <span class="n">Selection</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> and (not resn </span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionObjectName</span><span class="p">,</span> <span class="n">ResidueNamesSelection</span><span class="p">)</span>
  485     <span class="k">else</span><span class="p">:</span>
  486         <span class="n">Selection</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> and (resn </span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionObjectName</span><span class="p">,</span> <span class="n">ResidueNamesSelection</span><span class="p">)</span>
  487 
  488     <span class="c1"># Setup residues...</span>
  489     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForSelectionDisplayView</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="s2">&quot;lines&quot;</span><span class="p">,</span> <span class="n">ResiduesColor</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
  490     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  491 
  492     <span class="c1"># Setup surface...</span>
  493     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForSelectionDisplayView</span><span class="p">(</span><span class="n">SurfaceName</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="s2">&quot;surface&quot;</span><span class="p">,</span> <span class="n">ResiduesColor</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
  494     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  495     
  496 <span class="k">def</span> <span class="nf">WriteSurfaceElectrostaticsView</span><span class="p">(</span><span class="n">Mode</span><span class="p">,</span> <span class="n">OutFH</span><span class="p">,</span> <span class="n">SelectionObjectName</span><span class="p">,</span> <span class="n">ElectrostaticsGroupName</span><span class="p">,</span> <span class="n">ElectrostaticsGroupMembers</span><span class="p">):</span>
  497     <span class="sd">&quot;&quot;&quot;Write out PML for viewing surface electrostatics. &quot;&quot;&quot;</span>
  498 
  499     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ElectrostaticsGroupMembers</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
  500         <span class="n">Name</span><span class="p">,</span> <span class="n">ContactPotentialName</span><span class="p">,</span> <span class="n">MapName</span><span class="p">,</span> <span class="n">LegendName</span><span class="p">,</span> <span class="n">VolumeName</span> <span class="o">=</span> <span class="n">ElectrostaticsGroupMembers</span>
  501     <span class="k">else</span><span class="p">:</span>
  502         <span class="n">Name</span><span class="p">,</span> <span class="n">ContactPotentialName</span><span class="p">,</span> <span class="n">MapName</span><span class="p">,</span> <span class="n">LegendName</span> <span class="o">=</span> <span class="n">ElectrostaticsGroupMembers</span>
  503         <span class="n">VolumeName</span> <span class="o">=</span> <span class="bp">None</span>
  504 
  505     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
  506 
  507     <span class="c1"># Setup chain...</span>
  508     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.create(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;(</span><span class="si">%s</span><span class="s2">)&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">SelectionObjectName</span><span class="p">))</span>
  509 
  510     <span class="c1"># Setup vacuum electrostatics surface along with associated objects...</span>
  511     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;util.protein_vacuum_esp(&quot;</span><span class="si">%s</span><span class="s2">&quot;, mode=2, quiet=0, _self=cmd)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
  512     
  513     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set_name(&quot;</span><span class="si">%s</span><span class="s2">_e_chg&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">ContactPotentialName</span><span class="p">))</span>
  514     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Chain$&quot;</span><span class="p">,</span> <span class="n">Mode</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  515         <span class="n">DisplayStyle</span> <span class="o">=</span> <span class="s2">&quot;cartoon&quot;</span>
  516     <span class="k">else</span><span class="p">:</span>
  517         <span class="n">DisplayStyle</span> <span class="o">=</span> <span class="s2">&quot;lines&quot;</span>
  518     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.show(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;(</span><span class="si">%s</span><span class="s2">)&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">DisplayStyle</span><span class="p">,</span> <span class="n">ContactPotentialName</span><span class="p">))</span>
  519     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">ContactPotentialName</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">))</span>
  520     
  521     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set_name(&quot;</span><span class="si">%s</span><span class="s2">_e_map&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">MapName</span><span class="p">))</span>
  522     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">MapName</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">))</span>
  523     
  524     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set_name(&quot;</span><span class="si">%s</span><span class="s2">_e_pot&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">LegendName</span><span class="p">))</span>
  525     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">LegendName</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">))</span>
  526 
  527     <span class="k">if</span> <span class="n">VolumeName</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
  528         <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.volume(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;(</span><span class="si">%s</span><span class="s2">)&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">VolumeName</span><span class="p">,</span> <span class="n">MapName</span><span class="p">,</span> <span class="s2">&quot;esp&quot;</span><span class="p">,</span> <span class="n">Name</span><span class="p">))</span>
  529         <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">VolumeName</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">))</span>
  530     
  531     <span class="c1"># Delete name and take it out from the group membership. It is</span>
  532     <span class="c1"># is already part of ContactPotential object.</span>
  533     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.delete(&quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
  534     <span class="n">ElectrostaticsGroupMembers</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
  535     
  536     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
  537     
  538     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  539     
  540     <span class="c1"># Setup group...</span>
  541     <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">ElectrostaticsGroupName</span><span class="p">,</span> <span class="n">ElectrostaticsGroupMembers</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  542 
  543 <span class="k">def</span> <span class="nf">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">GroupName</span><span class="p">,</span> <span class="n">GroupMembers</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">Action</span> <span class="o">=</span> <span class="s2">&quot;close&quot;</span><span class="p">):</span>
  544     <span class="sd">&quot;&quot;&quot;Generate and write PML for group. &quot;&quot;&quot;</span>
  545     
  546     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForGroup</span><span class="p">(</span><span class="n">GroupName</span><span class="p">,</span> <span class="n">GroupMembers</span><span class="p">,</span> <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span><span class="p">)</span>
  547     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Setting up group </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">GroupName</span><span class="p">)</span>
  548     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  549 
  550 <span class="k">def</span> <span class="nf">GeneratePyMOLSessionFile</span><span class="p">():</span>
  551     <span class="sd">&quot;&quot;&quot;Generate PME file from PML file. &quot;&quot;&quot;</span>
  552 
  553     <span class="n">PSEOutfile</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PSEOutfile&quot;</span><span class="p">]</span>
  554     <span class="n">PMLOutfile</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMLOutfile&quot;</span><span class="p">]</span>
  555     
  556     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Generating file </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">PSEOutfile</span><span class="p">)</span>
  557     
  558     <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">ConvertPMLFileToPSEFile</span><span class="p">(</span><span class="n">PMLOutfile</span><span class="p">,</span> <span class="n">PSEOutfile</span><span class="p">)</span>
  559     
  560     <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">PSEOutfile</span><span class="p">):</span>
  561         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;Failed to generate PSE file, </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">PSEOutfile</span><span class="p">))</span>
  562     
  563     <span class="k">if</span> <span class="ow">not</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMLOut&quot;</span><span class="p">]:</span>
  564         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Deleting file </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">PMLOutfile</span><span class="p">)</span>
  565         <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">PMLOutfile</span><span class="p">)</span>
  566 
  567 <span class="k">def</span> <span class="nf">DeleteEmptyPyMOLObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">):</span>
  568     <span class="sd">&quot;&quot;&quot;Delete empty PyMOL objects. &quot;&quot;&quot;</span>
  569     
  570     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AllowEmptyObjects&quot;</span><span class="p">]:</span>
  571         <span class="k">return</span>
  572     
  573     <span class="n">SpecifiedChainsAndLigandsInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
  574     <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]:</span>
  575         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Checking and deleting empty objects for chain </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainID</span><span class="p">))</span>
  576         
  577         <span class="c1"># Delete any chain level objects...</span>
  578         <span class="n">WritePMLToCheckAndDeleteEmptyObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;Solvent&quot;</span><span class="p">])</span>
  579         <span class="n">WritePMLToCheckAndDeleteEmptyObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;Inorganic&quot;</span><span class="p">])</span>
  580 
  581 <span class="k">def</span> <span class="nf">DeleteEmptyPyMOLInterfaceObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">):</span>
  582     <span class="sd">&quot;&quot;&quot;Delete empty PyMOL interface objects. &quot;&quot;&quot;</span>
  583     
  584     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AllowEmptyObjects&quot;</span><span class="p">]:</span>
  585         <span class="k">return</span>
  586     
  587     <span class="n">InterfaceChainsAndResiduesInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InterfaceChainsAndResiduesInfo&quot;</span><span class="p">]</span>
  588     <span class="n">PyMOLInterfaceObjectNamesInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;PyMOLInterfaceObjectNamesInfo&quot;</span><span class="p">]</span>
  589     
  590     <span class="k">if</span> <span class="n">InterfaceChainsAndResiduesInfo</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
  591         <span class="k">return</span>
  592     
  593     <span class="k">for</span> <span class="n">InterfaceID</span> <span class="ow">in</span> <span class="n">InterfaceChainsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;InterfaceIDs&quot;</span><span class="p">]:</span>
  594         <span class="k">for</span> <span class="n">InterfaceChainID</span> <span class="ow">in</span> <span class="n">InterfaceChainsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">]:</span>
  595             <span class="n">ChainID</span> <span class="o">=</span> <span class="n">InterfaceChainsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">]</span>
  596             <span class="n">FileIndex</span> <span class="o">=</span> <span class="n">InterfaceChainsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDsInfileIndices&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">]</span>
  597             
  598             <span class="c1"># Delete interface residue type objects...</span>
  599             <span class="n">DeleteEmptyInterfaceChainResidueTypesObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">InterfaceID</span><span class="p">,</span> <span class="n">InterfaceChainID</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">PyMOLInterfaceObjectNamesInfo</span><span class="p">)</span>
  600             
  601 <span class="k">def</span> <span class="nf">DeleteEmptyInterfaceChainResidueTypesObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">InterfaceID</span><span class="p">,</span> <span class="n">InterfaceChainID</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">):</span>
  602     <span class="sd">&quot;&quot;&quot;Delete empty interface chain residue objects. &quot;&quot;&quot;</span>
  603     
  604     <span class="k">if</span> <span class="ow">not</span> <span class="n">GetInterfaceResidueTypesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  605         <span class="k">return</span>
  606     
  607     <span class="n">ResiduesGroupIDPrefix</span> <span class="o">=</span> <span class="s2">&quot;ChainResidues&quot;</span>
  608     <span class="k">for</span> <span class="n">GroupType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Aromatic&quot;</span><span class="p">,</span> <span class="s2">&quot;Hydrophobic&quot;</span><span class="p">,</span> <span class="s2">&quot;Polar&quot;</span><span class="p">,</span> <span class="s2">&quot;Positively_Charged&quot;</span><span class="p">,</span> <span class="s2">&quot;Negatively_Charged&quot;</span><span class="p">,</span> <span class="s2">&quot;Other&quot;</span><span class="p">]:</span>
  609         <span class="n">GroupID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">GroupType</span><span class="p">)</span>
  610         
  611         <span class="n">ResiduesGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupIDPrefix</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">)</span>
  612         <span class="n">GroupName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">][</span><span class="n">ResiduesGroupID</span><span class="p">]</span>
  613         
  614         <span class="n">GroupObjectNamesList</span> <span class="o">=</span> <span class="p">[]</span>
  615         
  616         <span class="n">ResiduesObjectID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Residues&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupIDPrefix</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">)</span>
  617         <span class="n">ResiduesObjectName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">][</span><span class="n">ResiduesObjectID</span><span class="p">]</span>
  618         <span class="n">GroupObjectNamesList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ResiduesObjectName</span><span class="p">)</span>
  619         
  620         <span class="n">ResiduesSurfaceObjectID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Surface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupIDPrefix</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">)</span>
  621         <span class="n">ResiduesSurfaceObjectName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">][</span><span class="n">ResiduesSurfaceObjectID</span><span class="p">]</span>
  622         <span class="n">GroupObjectNamesList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ResiduesSurfaceObjectName</span><span class="p">)</span>
  623         
  624         <span class="n">GroupObjectNames</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">GroupObjectNamesList</span><span class="p">)</span>
  625         <span class="n">WritePMLToCheckAndDeleteEmptyObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">GroupObjectNames</span><span class="p">,</span> <span class="n">GroupName</span><span class="p">)</span>
  626     
  627 <span class="k">def</span> <span class="nf">WritePMLToCheckAndDeleteEmptyObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">ObjectName</span><span class="p">,</span> <span class="n">ParentObjectName</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
  628     <span class="sd">&quot;&quot;&quot;Write PML to check and delete empty PyMOL objects. &quot;&quot;&quot;</span>
  629     
  630     <span class="k">if</span> <span class="n">ParentObjectName</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
  631         <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;CheckAndDeleteEmptyObjects(&quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ObjectName</span><span class="p">)</span>
  632     <span class="k">else</span><span class="p">:</span>
  633         <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;CheckAndDeleteEmptyObjects(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ObjectName</span><span class="p">,</span> <span class="n">ParentObjectName</span><span class="p">)</span>
  634     
  635     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  636     
  637 <span class="k">def</span> <span class="nf">RetrieveInfilesInfo</span><span class="p">():</span>
  638     <span class="sd">&quot;&quot;&quot;Retrieve information for input files.&quot;&quot;&quot;</span>
  639 
  640     <span class="n">InfilesInfo</span> <span class="o">=</span> <span class="p">{}</span>
  641     
  642     <span class="n">InfilesInfo</span><span class="p">[</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  643     <span class="n">InfilesInfo</span><span class="p">[</span><span class="s2">&quot;InfilesRoots&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  644     <span class="n">InfilesInfo</span><span class="p">[</span><span class="s2">&quot;ChainsAndLigandsInfo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  645     <span class="n">InfilesInfo</span><span class="p">[</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  646     
  647     <span class="n">InfilesInfo</span><span class="p">[</span><span class="s2">&quot;PyMOLObjectNamesInfo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  648     
  649     <span class="n">InfilesInfo</span><span class="p">[</span><span class="s2">&quot;SingleInfileMode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
  650     <span class="n">InfilesInfo</span><span class="p">[</span><span class="s2">&quot;InterfaceChainsAndResiduesInfo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
  651     <span class="n">InfilesInfo</span><span class="p">[</span><span class="s2">&quot;InterfaceChainPairsAndResiduesInfo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
  652     
  653     <span class="n">InfilesInfo</span><span class="p">[</span><span class="s2">&quot;PyMOLInterfaceObjectNamesInfo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
  654 
  655     <span class="n">InfilesCount</span> <span class="o">=</span> <span class="mi">0</span>
  656     <span class="k">for</span> <span class="n">Infile</span> <span class="ow">in</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">]:</span>
  657         <span class="n">InfilesCount</span> <span class="o">+=</span> <span class="mi">1</span>
  658         <span class="n">FileDir</span><span class="p">,</span> <span class="n">FileName</span><span class="p">,</span> <span class="n">FileExt</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ParseFileName</span><span class="p">(</span><span class="n">Infile</span><span class="p">)</span>
  659         <span class="n">InfileRoot</span> <span class="o">=</span> <span class="n">FileName</span>
  660         
  661         <span class="n">ChainsAndLigandInfo</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">GetChainsAndLigandsInfo</span><span class="p">(</span><span class="n">Infile</span><span class="p">,</span> <span class="n">InfileRoot</span><span class="p">)</span>
  662         
  663         <span class="n">InfilesInfo</span><span class="p">[</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Infile</span><span class="p">)</span>
  664         <span class="n">InfilesInfo</span><span class="p">[</span><span class="s2">&quot;InfilesRoots&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">InfileRoot</span><span class="p">)</span>
  665         <span class="n">InfilesInfo</span><span class="p">[</span><span class="s2">&quot;ChainsAndLigandsInfo&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ChainsAndLigandInfo</span><span class="p">)</span>
  666 
  667     <span class="k">if</span> <span class="n">InfilesCount</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
  668         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;Number of input files, </span><span class="si">%s</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="s2">-i, --infiles</span><span class="se">\&quot;</span><span class="s2"> option is not valid. Number of allowed files: 1 or 2&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">InfilesCount</span><span class="p">))</span>
  669     
  670     <span class="n">InfilesInfo</span><span class="p">[</span><span class="s2">&quot;SingleInfileMode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">InfilesCount</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="bp">False</span>
  671     
  672     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">InfilesInfo</span>
  673 
  674 <span class="k">def</span> <span class="nf">ProcessInterfaceChainIDs</span><span class="p">():</span>
  675     <span class="sd">&quot;&quot;&quot;Process specified interface chain IDs for input files.&quot;&quot;&quot;</span>
  676 
  677     <span class="n">ValidateInterfaceChainIDs</span><span class="p">()</span>
  678 
  679     <span class="n">SetupChainsAndLigandsInfo</span><span class="p">()</span>
  680     <span class="n">SetupPyMOLObjectNamesInfo</span><span class="p">()</span>
  681     
  682     <span class="n">SetupInterfaceChainPairsAndResiduesInfo</span><span class="p">()</span>
  683     <span class="n">ProcessInterfaceChainPairsAndResiduesInfo</span><span class="p">()</span>
  684 
  685     <span class="n">SetupPyMOLInterfaceObjectNamesInfo</span><span class="p">()</span>
  686 
  687 <span class="k">def</span> <span class="nf">ValidateInterfaceChainIDs</span><span class="p">():</span>
  688     <span class="sd">&quot;&quot;&quot;Check for the presence of interface IDs in input file(s). &quot;&quot;&quot;</span>
  689 
  690     <span class="k">if</span>  <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  691         <span class="n">AutoAssignInterfaceChainIDs</span><span class="p">()</span>
  692         <span class="n">SetupInfilesInterfaceChainIDsLists</span><span class="p">()</span>
  693         <span class="k">return</span>
  694 
  695     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Validating interface chain IDs...&quot;</span><span class="p">)</span>
  696     
  697     <span class="c1"># Check for the presences of interface chain IDs across input files..</span>
  698     <span class="n">SingleInfileMode</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SingleInfileMode&quot;</span><span class="p">]</span>
  699     <span class="n">Infile1ChainIDs</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;ChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]</span>
  700     <span class="n">Infile2ChainIDs</span> <span class="o">=</span> <span class="p">[]</span>
  701     <span class="k">if</span> <span class="ow">not</span> <span class="n">SingleInfileMode</span><span class="p">:</span>
  702         <span class="n">Infile2ChainIDs</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;ChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]</span>
  703 
  704     <span class="n">InterfaceChainIDsList</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDsList&quot;</span><span class="p">]</span>
  705 
  706     <span class="k">for</span> <span class="n">Index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">InterfaceChainIDsList</span><span class="p">),</span> <span class="mi">2</span><span class="p">):</span>
  707         <span class="n">ChainIDs1</span> <span class="o">=</span> <span class="n">InterfaceChainIDsList</span><span class="p">[</span><span class="n">Index</span><span class="p">]</span>
  708         <span class="n">ChainIDs2</span> <span class="o">=</span> <span class="n">InterfaceChainIDsList</span><span class="p">[</span><span class="n">Index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
  709 
  710         <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">ChainIDs1</span><span class="p">:</span>
  711             <span class="k">if</span> <span class="ow">not</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">Infile1ChainIDs</span><span class="p">:</span>
  712                 <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The chain ID, </span><span class="si">%s</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="s2">-c, --chainIDs</span><span class="se">\&quot;</span><span class="s2"> for a chain IDs pairs, </span><span class="se">\&quot;</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">, must be present in first input file.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainID</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ChainIDs1</span><span class="p">),</span> <span class="s2">&quot;+&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ChainIDs2</span><span class="p">)))</span>
  713         
  714         <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">ChainIDs2</span><span class="p">:</span>
  715             <span class="k">if</span>  <span class="n">SingleInfileMode</span><span class="p">:</span>
  716                 <span class="k">if</span> <span class="ow">not</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">Infile1ChainIDs</span><span class="p">:</span>
  717                     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The chain ID, </span><span class="si">%s</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="s2">-c, --chainIDs</span><span class="se">\&quot;</span><span class="s2"> for a chain IDs pairs, </span><span class="se">\&quot;</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">, must be present in first input file.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainID</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ChainIDs1</span><span class="p">),</span> <span class="s2">&quot;+&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ChainIDs2</span><span class="p">)))</span>
  718             <span class="k">else</span><span class="p">:</span>
  719                 <span class="k">if</span> <span class="ow">not</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">Infile2ChainIDs</span><span class="p">:</span>
  720                     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The chain ID, </span><span class="si">%s</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="s2">-c, --chainIDs</span><span class="se">\&quot;</span><span class="s2"> for a chain IDs pairs, </span><span class="se">\&quot;</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">, must be present in second input file.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainID</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ChainIDs1</span><span class="p">),</span> <span class="s2">&quot;+&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ChainIDs2</span><span class="p">)))</span>
  721 
  722     <span class="c1"># Check for any duplicate interface chain IDs specifications...</span>
  723     <span class="n">CanonicalInterfaceIDsMap</span> <span class="o">=</span> <span class="p">{}</span>
  724     
  725     <span class="k">for</span> <span class="n">Index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">InterfaceChainIDsList</span><span class="p">),</span> <span class="mi">2</span><span class="p">):</span>
  726         <span class="n">ChainIDs1</span> <span class="o">=</span> <span class="n">InterfaceChainIDsList</span><span class="p">[</span><span class="n">Index</span><span class="p">]</span>
  727         <span class="n">ChainIDs2</span> <span class="o">=</span> <span class="n">InterfaceChainIDsList</span><span class="p">[</span><span class="n">Index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
  728         <span class="n">InterfaceID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s2">&quot;+&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ChainIDs1</span><span class="p">),</span> <span class="s2">&quot;+&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ChainIDs2</span><span class="p">))</span>
  729         
  730         <span class="n">SortedChainIDs1</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">ChainIDs1</span><span class="p">)</span>
  731         <span class="n">SortedChainIDs2</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">ChainIDs2</span><span class="p">)</span>
  732         <span class="n">CanonicalInterfaceID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s2">&quot;+&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">SortedChainIDs1</span><span class="p">),</span> <span class="s2">&quot;+&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">SortedChainIDs2</span><span class="p">))</span>
  733 
  734         <span class="k">if</span> <span class="n">CanonicalInterfaceID</span> <span class="ow">in</span> <span class="n">CanonicalInterfaceIDsMap</span><span class="p">:</span>
  735             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The chain ID pair, </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="s2">-c, --chainIDs</span><span class="se">\&quot;</span><span class="s2">, option has been specified multiple times, </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">CanonicalInterfaceIDsMap</span><span class="p">[</span><span class="n">CanonicalInterfaceID</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">]))</span>
  736         <span class="k">else</span><span class="p">:</span>
  737             <span class="n">CanonicalInterfaceIDsMap</span><span class="p">[</span><span class="n">CanonicalInterfaceID</span><span class="p">]</span> <span class="o">=</span>  <span class="n">InterfaceID</span>
  738 
  739     <span class="n">SetupInfilesInterfaceChainIDsLists</span><span class="p">()</span>
  740     
  741 <span class="k">def</span> <span class="nf">SetupInfilesInterfaceChainIDsLists</span><span class="p">():</span>
  742     <span class="sd">&quot;&quot;&quot;Setup interface chain IDs list for infiles. &quot;&quot;&quot;</span>
  743     
  744     <span class="n">Infie1InterfaceChainIDsList</span> <span class="o">=</span> <span class="p">[]</span>
  745     <span class="n">Infie2InterfaceChainIDsList</span> <span class="o">=</span> <span class="p">[]</span>
  746     
  747     <span class="n">SingleInfileMode</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SingleInfileMode&quot;</span><span class="p">]</span>
  748     <span class="n">InterfaceChainIDsList</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDsList&quot;</span><span class="p">]</span>
  749     
  750     <span class="k">for</span> <span class="n">Index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">InterfaceChainIDsList</span><span class="p">),</span> <span class="mi">2</span><span class="p">):</span>
  751         <span class="n">ChainIDs1</span> <span class="o">=</span> <span class="n">InterfaceChainIDsList</span><span class="p">[</span><span class="n">Index</span><span class="p">]</span>
  752         <span class="n">ChainIDs2</span> <span class="o">=</span> <span class="n">InterfaceChainIDsList</span><span class="p">[</span><span class="n">Index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
  753 
  754         <span class="n">Infie1InterfaceChainIDsList</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">ChainIDs1</span><span class="p">)</span>
  755         <span class="k">if</span> <span class="n">SingleInfileMode</span><span class="p">:</span>
  756             <span class="n">Infie1InterfaceChainIDsList</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">ChainIDs2</span><span class="p">)</span>
  757         <span class="k">else</span><span class="p">:</span>
  758             <span class="n">Infie2InterfaceChainIDsList</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">ChainIDs2</span><span class="p">)</span>
  759 
  760     <span class="n">Infie1InterfaceChainIDsList</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">Infie1InterfaceChainIDsList</span><span class="p">)</span>
  761     <span class="n">Infie2InterfaceChainIDsList</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">Infie2InterfaceChainIDsList</span><span class="p">)</span>
  762     
  763     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInterfaceChainIDsList&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">Infie1InterfaceChainIDsList</span><span class="p">,</span> <span class="n">Infie2InterfaceChainIDsList</span><span class="p">]</span>
  764 
  765 <span class="k">def</span> <span class="nf">AutoAssignInterfaceChainIDs</span><span class="p">():</span>
  766     <span class="sd">&quot;&quot;&quot;Handle automatic assignment of interface chain IDs. &quot;&quot;&quot;</span>
  767     
  768     <span class="n">Infile1ChainIDs</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;ChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]</span>
  769     <span class="n">Infile2ChainIDs</span> <span class="o">=</span> <span class="p">[]</span>
  770     <span class="k">if</span> <span class="ow">not</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SingleInfileMode&quot;</span><span class="p">]:</span>
  771         <span class="n">Infile2ChainIDs</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;ChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]</span>
  772     
  773     <span class="n">InterfaceChainIDsList</span> <span class="o">=</span> <span class="p">[]</span>
  774     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SingleInfileMode&quot;</span><span class="p">]:</span>
  775         <span class="c1"># Take first two chains from first input file...</span>
  776         <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">Infile1ChainIDs</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
  777             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;Failed to automatically set interface chain IDs. Number of chains, </span><span class="si">%s</span><span class="s2">, in input file specified using </span><span class="se">\&quot;</span><span class="s2">-i, --infiles</span><span class="se">\&quot;</span><span class="s2"> option must be &gt;= 2. &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Infile1ChainIDs</span><span class="p">)))</span>
  778         <span class="n">InterfaceChainIDsList</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">Infile1ChainIDs</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
  779         <span class="n">InterfaceChainIDsList</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">Infile1ChainIDs</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
  780     <span class="k">else</span><span class="p">:</span>
  781         <span class="c1"># Take first chain from each input file...</span>
  782         <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">Infile1ChainIDs</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
  783             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;Failed to automatically set interface chain IDs. Number of chains, </span><span class="si">%s</span><span class="s2">, in first input file specified using </span><span class="se">\&quot;</span><span class="s2">-i, --infiles</span><span class="se">\&quot;</span><span class="s2"> option must be &gt;= 1. &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Infile1ChainIDs</span><span class="p">)))</span>
  784         <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">Infile2ChainIDs</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
  785             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;Failed to automatically set interface chain IDs. Number of chains, </span><span class="si">%s</span><span class="s2">, in second input file specified using </span><span class="se">\&quot;</span><span class="s2">-i, --infiles</span><span class="se">\&quot;</span><span class="s2"> option must be &gt;= 1. &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Infile1ChainIDs</span><span class="p">)))</span>
  786         <span class="n">InterfaceChainIDsList</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">Infile1ChainIDs</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
  787         <span class="n">InterfaceChainIDsList</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">Infile2ChainIDs</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
  788     
  789     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDsList&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  790     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDsList&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">InterfaceChainIDsList</span><span class="p">)</span>
  791     
  792     <span class="k">return</span>
  793 
  794 <span class="k">def</span> <span class="nf">SetupChainsAndLigandsInfo</span><span class="p">():</span>
  795     <span class="sd">&quot;&quot;&quot;Setup chains and ligands info for input files to visualize macromolecules. &quot;&quot;&quot;</span>
  796 
  797     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  798     <span class="k">for</span> <span class="n">FileIndex</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">])):</span>
  799         <span class="n">Infile</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
  800         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Setting up chain and ligand information for input file </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">Infile</span><span class="p">)</span>
  801         
  802         <span class="n">ChainsAndLigandsInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;ChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
  803         <span class="n">InfilesInterfaceChainIDsList</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInterfaceChainIDsList&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
  804         
  805         <span class="n">SpecifiedChainsAndLigandsInfo</span> <span class="o">=</span> <span class="p">{}</span>
  806         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  807         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;InterfaceResNums&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  808         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  809 
  810         <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">InfilesInterfaceChainIDsList</span><span class="p">):</span>
  811             <span class="c1"># Add unique interface IDs to the chain IDs list for visualization. Interface chain IDs</span>
  812             <span class="c1"># may contain duplicate chain IDs due to the presence # of same chain in multiple</span>
  813             <span class="c1"># interfaces.</span>
  814             <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">InfilesInterfaceChainIDsList</span><span class="p">:</span>
  815                 <span class="k">if</span> <span class="ow">not</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]:</span>
  816                     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ChainID</span><span class="p">)</span>
  817 
  818             <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]:</span>
  819                 <span class="c1"># Initialize interface residue numbers to be assigned later...</span>
  820                 <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;InterfaceResNums&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  821                 
  822                 <span class="c1"># Setup ligand IDs...</span>
  823                 <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">SetupSpecifiedLigandIDs</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">ChainsAndLigandsInfo</span><span class="p">)</span>
  824         
  825         <span class="n">ProcessResidueTypesAndSurfaceOptions</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">)</span>
  826         
  827         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">)</span>
  828 
  829 <span class="k">def</span> <span class="nf">SetupSpecifiedLigandIDs</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">ChainsAndLigandsInfo</span><span class="p">):</span>
  830     <span class="sd">&quot;&quot;&quot;Setup specified ligand IDs for input file. &quot;&quot;&quot;</span>
  831 
  832     <span class="n">LigandIDs</span> <span class="o">=</span> <span class="p">[]</span>
  833     
  834     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^All$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  835         <span class="n">LigandIDs</span> <span class="o">=</span> <span class="n">ChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
  836         <span class="k">return</span> <span class="n">LigandIDs</span>
  837     <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Largest|Auto$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  838         <span class="n">LargestLigandID</span> <span class="o">=</span> <span class="n">ChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]))</span> <span class="k">else</span> <span class="bp">None</span>
  839         <span class="k">if</span> <span class="n">LargestLigandID</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
  840             <span class="n">LigandIDs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">LargestLigandID</span><span class="p">)</span>
  841         <span class="k">return</span> <span class="n">LigandIDs</span>
  842     <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^None$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  843         <span class="k">return</span> <span class="n">LigandIDs</span>
  844 
  845     <span class="n">Infile</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
  846     <span class="n">ValidLigandIDs</span> <span class="o">=</span> <span class="n">ChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
  847     
  848     <span class="n">SpecifiedLigandIDs</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">])</span>
  849     <span class="k">if</span> <span class="ow">not</span> <span class="n">SpecifiedLigandIDs</span><span class="p">:</span>
  850         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;No valid value specified using \-l, --ligandIDs</span><span class="se">\&quot;</span><span class="s2"> option.&quot;</span><span class="p">)</span>
  851 
  852     <span class="n">LigandIDsWords</span> <span class="o">=</span> <span class="n">SpecifiedLigandIDs</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
  853     <span class="k">for</span> <span class="n">LigandID</span> <span class="ow">in</span> <span class="n">LigandIDsWords</span><span class="p">:</span>
  854         <span class="k">if</span> <span class="ow">not</span> <span class="n">LigandID</span> <span class="ow">in</span> <span class="n">ValidLigandIDs</span><span class="p">:</span>
  855             <span class="n">LigandIDsListNames</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ValidLigandIDs</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ValidLigandIDs</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;None&quot;</span>
  856             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;The ligand ID, </span><span class="si">%s</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="s2">-l, --ligandiIDs</span><span class="se">\&quot;</span><span class="s2"> option is not valid for chain, </span><span class="si">%s</span><span class="s2">, in input file, </span><span class="si">%s</span><span class="s2">. It&#39;ll be ignored. Valid ligand IDs: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">LigandID</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">Infile</span><span class="p">,</span> <span class="n">LigandIDsListNames</span><span class="p">))</span>
  857             <span class="k">continue</span>
  858         
  859         <span class="k">if</span> <span class="n">LigandID</span> <span class="ow">in</span> <span class="n">LigandIDs</span><span class="p">:</span>
  860             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;The ligand ID, </span><span class="si">%s</span><span class="s2">, has already been specified using </span><span class="se">\&quot;</span><span class="s2">-l, --ligandIDs</span><span class="se">\&quot;</span><span class="s2"> option for chain, </span><span class="si">%s</span><span class="s2">, in input file, </span><span class="si">%s</span><span class="s2">. It&#39;ll be ignored.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">LigandID</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">Infile</span><span class="p">))</span>
  861             <span class="k">continue</span>
  862     
  863         <span class="n">LigandIDs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">LigandID</span><span class="p">)</span>
  864     
  865     <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">LigandIDs</span><span class="p">):</span>
  866             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;No valid ligand IDs </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> specified using </span><span class="se">\&quot;</span><span class="s2">-l, --ligandIDs</span><span class="se">\&quot;</span><span class="s2"> option for chain ID, </span><span class="si">%s</span><span class="s2">, in input file, </span><span class="si">%s</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">],</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">Infile</span><span class="p">))</span>
  867     
  868     <span class="k">return</span> <span class="n">LigandIDs</span>
  869         
  870 <span class="k">def</span> <span class="nf">SetupInterfaceChainPairsAndResiduesInfo</span><span class="p">():</span>
  871     <span class="sd">&quot;&quot;&quot;Setup chain and residue pairs corresponding to interfaces.&quot;&quot;&quot;</span>
  872 
  873     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Identifying interface residues...&quot;</span><span class="p">)</span>
  874     
  875     <span class="n">SingleInfileMode</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SingleInfileMode&quot;</span><span class="p">]</span>
  876     <span class="n">InterfaceChainIDsList</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDsList&quot;</span><span class="p">]</span>
  877 
  878     <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">InterfaceChainIDsList</span><span class="p">):</span>
  879         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;Failed to identify interface residues: No valid chain ID pairs available for interfaces&quot;</span><span class="p">)</span>
  880 
  881     <span class="c1"># Load infiles to identify interface residues...</span>
  882     <span class="n">Infile1</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
  883     <span class="n">MolName1</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InfilesRoots&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
  884     <span class="n">pymol</span><span class="o">.</span><span class="n">cmd</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">Infile1</span><span class="p">,</span> <span class="n">MolName1</span><span class="p">)</span>
  885     <span class="k">if</span> <span class="n">SingleInfileMode</span><span class="p">:</span>
  886         <span class="n">MolName2</span> <span class="o">=</span> <span class="n">MolName1</span>
  887     <span class="k">else</span><span class="p">:</span>
  888         <span class="n">Infile2</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
  889         <span class="n">MolName2</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InfilesRoots&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
  890         <span class="n">pymol</span><span class="o">.</span><span class="n">cmd</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">Infile2</span><span class="p">,</span> <span class="n">MolName2</span><span class="p">)</span>
  891 
  892     <span class="c1"># Initialize data...</span>
  893     <span class="n">InterfaceChainPairsAndResiduesInfo</span> <span class="o">=</span> <span class="p">{}</span>
  894     <span class="n">InterfaceChainPairsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;InterfaceIDs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  895     <span class="n">InterfaceChainPairsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDsPairs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  896     <span class="n">InterfaceChainPairsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDsResNumsPairs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  897     <span class="n">InterfaceChainPairsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;InfileIndicesPairs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  898     
  899     <span class="n">Method</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Method&quot;</span><span class="p">]</span>
  900     <span class="n">MethodCutoff</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MethodCutoff&quot;</span><span class="p">]</span>
  901     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Methodology: </span><span class="si">%s</span><span class="s2">; Cutoff: </span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Method</span><span class="p">,</span> <span class="n">MethodCutoff</span><span class="p">))</span>
  902 
  903     <span class="k">for</span> <span class="n">Index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">InterfaceChainIDsList</span><span class="p">),</span> <span class="mi">2</span><span class="p">):</span>
  904         <span class="n">ChainIDs1</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">InterfaceChainIDsList</span><span class="p">[</span><span class="n">Index</span><span class="p">])</span>
  905         <span class="n">ChainIDs2</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">InterfaceChainIDsList</span><span class="p">[</span><span class="n">Index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
  906 
  907         <span class="n">ChainIDs1Prefix</span> <span class="o">=</span> <span class="s2">&quot;Chains&quot;</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ChainIDs1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="s2">&quot;Chain&quot;</span>
  908         <span class="n">ChainIDs2Prefix</span> <span class="o">=</span> <span class="s2">&quot;Chains&quot;</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ChainIDs2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="s2">&quot;Chain&quot;</span>
  909         <span class="n">InterfaceID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">_</span><span class="si">%s%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainIDs1Prefix</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ChainIDs1</span><span class="p">),</span> <span class="n">ChainIDs2Prefix</span><span class="p">,</span> <span class="s2">&quot;+&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ChainIDs2</span><span class="p">))</span>
  910         
  911         <span class="n">ListInterfaceID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s2">&quot;+&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ChainIDs1</span><span class="p">),</span> <span class="s2">&quot;+&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ChainIDs2</span><span class="p">))</span>
  912 
  913         <span class="n">FileIndex1</span> <span class="o">=</span> <span class="mi">0</span>
  914         <span class="n">FileIndex2</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">SingleInfileMode</span> <span class="k">else</span> <span class="mi">1</span>
  915 
  916         <span class="k">if</span> <span class="n">InterfaceID</span> <span class="ow">in</span> <span class="n">InterfaceChainPairsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;InterfaceIDs&quot;</span><span class="p">]:</span>
  917             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Ignoring interface ID </span><span class="si">%s</span><span class="s2">: It has already been defined&quot;</span> <span class="o">%</span> <span class="n">InterfaceID</span><span class="p">)</span>
  918             <span class="k">continue</span>
  919 
  920         <span class="c1"># Identify and list interface chains and residues...</span>
  921         <span class="n">ChainsAndResiduesInfo1</span><span class="p">,</span> <span class="n">ChainsAndResiduesInfo2</span> <span class="o">=</span> <span class="n">GetInterfaceChainsAndResiduesInfo</span><span class="p">(</span><span class="n">MolName1</span><span class="p">,</span> <span class="n">ChainIDs1</span><span class="p">,</span> <span class="n">MolName2</span><span class="p">,</span> <span class="n">ChainIDs2</span><span class="p">,</span> <span class="n">Method</span><span class="p">,</span> <span class="n">MethodCutoff</span><span class="p">)</span>
  922         <span class="n">ListInterfaceChainsAndResidues</span><span class="p">(</span><span class="n">ListInterfaceID</span><span class="p">,</span> <span class="n">MolName1</span><span class="p">,</span> <span class="n">ChainIDs1</span><span class="p">,</span> <span class="n">ChainsAndResiduesInfo1</span><span class="p">,</span> <span class="n">MolName2</span><span class="p">,</span> <span class="n">ChainIDs2</span><span class="p">,</span> <span class="n">ChainsAndResiduesInfo2</span><span class="p">)</span>
  923 
  924         <span class="c1"># Check presence of interface residues...</span>
  925         <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ChainsAndResiduesInfo1</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">])</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">ChainsAndResiduesInfo2</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]))):</span>
  926             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;Ignoring interface ID </span><span class="si">%s</span><span class="s2">: Failed to identify any interface residues. PyMOL groups and objects won&#39;t be created.&quot;</span> <span class="o">%</span> <span class="n">InterfaceID</span><span class="p">)</span>
  927             <span class="k">continue</span>
  928         
  929         <span class="c1"># Collect residue numbers for set of interface residues in each chain...</span>
  930         <span class="n">InterfaceChainIDs1</span><span class="p">,</span> <span class="n">InterfaceChainResidueNums1</span> <span class="o">=</span> <span class="n">GetInterfaceChainsAndResidueNumbers</span><span class="p">(</span><span class="n">ChainIDs1</span><span class="p">,</span> <span class="n">ChainsAndResiduesInfo1</span><span class="p">)</span>
  931         <span class="n">InterfaceChainIDs2</span><span class="p">,</span> <span class="n">InterfaceChainResidueNums2</span> <span class="o">=</span> <span class="n">GetInterfaceChainsAndResidueNumbers</span><span class="p">(</span><span class="n">ChainIDs2</span><span class="p">,</span> <span class="n">ChainsAndResiduesInfo2</span><span class="p">)</span>
  932 
  933         <span class="n">InterfaceChainPairsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;InterfaceIDs&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">InterfaceID</span><span class="p">)</span>
  934         <span class="n">InterfaceChainPairsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDsPairs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">InterfaceChainIDs1</span><span class="p">,</span> <span class="n">InterfaceChainIDs2</span><span class="p">]</span>
  935         <span class="n">InterfaceChainPairsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDsResNumsPairs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">InterfaceChainResidueNums1</span><span class="p">,</span> <span class="n">InterfaceChainResidueNums2</span><span class="p">]</span>
  936         <span class="n">InterfaceChainPairsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;InfileIndicesPairs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">FileIndex1</span><span class="p">,</span> <span class="n">FileIndex2</span><span class="p">]</span>
  937 
  938     <span class="n">InterfaceChainPairsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;InterfaceIDs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">InterfaceChainPairsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;InterfaceIDs&quot;</span><span class="p">])</span>
  939     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InterfaceChainPairsAndResiduesInfo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">InterfaceChainPairsAndResiduesInfo</span>
  940 
  941     <span class="c1"># Delete loaded objects...</span>
  942     <span class="n">pymol</span><span class="o">.</span><span class="n">cmd</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">MolName1</span><span class="p">)</span>
  943     <span class="k">if</span> <span class="ow">not</span> <span class="n">SingleInfileMode</span><span class="p">:</span>
  944         <span class="n">pymol</span><span class="o">.</span><span class="n">cmd</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">MolName2</span><span class="p">)</span>
  945     
  946 <span class="k">def</span> <span class="nf">ProcessInterfaceChainPairsAndResiduesInfo</span><span class="p">():</span>
  947     <span class="sd">&quot;&quot;&quot;Process chain and residue pairs for visualizing interfaces.&quot;&quot;&quot;</span>
  948 
  949     <span class="n">InterfaceChainsAndResiduesInfo</span> <span class="o">=</span> <span class="p">{}</span>
  950     <span class="n">InterfaceChainsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;InterfaceIDs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  951     <span class="n">InterfaceChainsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  952     <span class="n">InterfaceChainsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  953     <span class="n">InterfaceChainsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDsResNums&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  954     <span class="n">InterfaceChainsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDsComplexNames&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  955     <span class="n">InterfaceChainsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDsInfileIndices&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  956     
  957     <span class="n">InterfaceChainPairsAndResiduesInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InterfaceChainPairsAndResiduesInfo&quot;</span><span class="p">]</span>
  958     
  959     <span class="k">for</span> <span class="n">InterfaceID</span> <span class="ow">in</span> <span class="n">InterfaceChainPairsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;InterfaceIDs&quot;</span><span class="p">]:</span>
  960         <span class="c1"># Flatten pairwise interface chain and residues info...</span>
  961         <span class="n">FlattenedInterfaceChainIDs</span><span class="p">,</span> <span class="n">FlattenedChainIDs</span><span class="p">,</span> <span class="n">FlattenedResNums</span><span class="p">,</span> <span class="n">FlattenedComplexNames</span><span class="p">,</span> <span class="n">FlattenedInfileIndices</span> <span class="o">=</span> <span class="n">FlattenIntferfaceChainPairsAndResiduesInfo</span><span class="p">(</span><span class="n">InterfaceChainPairsAndResiduesInfo</span><span class="p">,</span> <span class="n">InterfaceID</span><span class="p">)</span>
  962         
  963         <span class="k">if</span> <span class="ow">not</span> <span class="n">InterfaceID</span> <span class="ow">in</span> <span class="n">InterfaceChainsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;InterfaceIDs&quot;</span><span class="p">]:</span>
  964             <span class="n">InterfaceChainsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;InterfaceIDs&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">InterfaceID</span><span class="p">)</span>
  965             
  966             <span class="n">InterfaceChainsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  967             <span class="n">InterfaceChainsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  968             <span class="n">InterfaceChainsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDsResNums&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  969             <span class="n">InterfaceChainsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDsComplexNames&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  970             <span class="n">InterfaceChainsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDsInfileIndices&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  971 
  972         <span class="c1"># Track interface information for visualization...</span>
  973         <span class="k">for</span> <span class="n">Index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">FlattenedInterfaceChainIDs</span><span class="p">)):</span>
  974             <span class="n">InterfaceChainID</span> <span class="o">=</span> <span class="n">FlattenedInterfaceChainIDs</span><span class="p">[</span><span class="n">Index</span><span class="p">]</span>
  975             <span class="n">ChainID</span> <span class="o">=</span> <span class="n">FlattenedChainIDs</span><span class="p">[</span><span class="n">Index</span><span class="p">]</span>
  976             <span class="n">ResNums</span> <span class="o">=</span> <span class="n">FlattenedResNums</span><span class="p">[</span><span class="n">Index</span><span class="p">]</span>
  977             <span class="n">ComplexName</span> <span class="o">=</span> <span class="n">FlattenedComplexNames</span><span class="p">[</span><span class="n">Index</span><span class="p">]</span>
  978             <span class="n">FileIndex</span> <span class="o">=</span> <span class="n">FlattenedInfileIndices</span><span class="p">[</span><span class="n">Index</span><span class="p">]</span>
  979 
  980             <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">ResNums</span><span class="p">):</span>
  981                 <span class="k">continue</span>
  982 
  983             <span class="n">InterfaceChainsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">InterfaceChainID</span><span class="p">)</span>
  984             <span class="n">InterfaceChainsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">ChainID</span>
  985             <span class="n">InterfaceChainsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDsResNums&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">ResNums</span>
  986             <span class="n">InterfaceChainsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDsComplexNames&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">ComplexName</span>
  987             <span class="n">InterfaceChainsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDsInfileIndices&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">FileIndex</span>
  988 
  989             <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">][</span><span class="s2">&quot;InterfaceResNums&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">ResNums</span><span class="p">)</span>
  990 
  991     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InterfaceChainsAndResiduesInfo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">InterfaceChainsAndResiduesInfo</span>
  992 
  993 <span class="k">def</span> <span class="nf">FlattenIntferfaceChainPairsAndResiduesInfo</span><span class="p">(</span><span class="n">InterfaceChainPairsAndResiduesInfo</span><span class="p">,</span> <span class="n">InterfaceID</span><span class="p">):</span>
  994     <span class="sd">&quot;&quot;&quot;Flatten interface chain and residues info. &quot;&quot;&quot;</span>
  995 
  996     <span class="n">SingleInfileMode</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SingleInfileMode&quot;</span><span class="p">]</span>
  997     
  998     <span class="n">ChainIDs1</span><span class="p">,</span> <span class="n">ChainIDs2</span> <span class="o">=</span>  <span class="n">InterfaceChainPairsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDsPairs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">]</span>
  999     <span class="n">ResNums1</span><span class="p">,</span> <span class="n">ResNums2</span> <span class="o">=</span> <span class="n">InterfaceChainPairsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDsResNumsPairs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">]</span>
 1000     <span class="n">FileIndex1</span><span class="p">,</span> <span class="n">FileIndex2</span> <span class="o">=</span> <span class="n">InterfaceChainPairsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;InfileIndicesPairs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">]</span>
 1001 
 1002     <span class="c1"># Set complex names..</span>
 1003     <span class="n">PDBGroup1</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;PyMOLObjectNamesInfo&quot;</span><span class="p">][</span><span class="n">FileIndex1</span><span class="p">][</span><span class="s2">&quot;PDBGroup&quot;</span><span class="p">]</span>
 1004     <span class="n">ComplexName1</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;PyMOLObjectNamesInfo&quot;</span><span class="p">][</span><span class="n">FileIndex1</span><span class="p">][</span><span class="s2">&quot;Complex&quot;</span><span class="p">]</span>
 1005     
 1006     <span class="n">PDBGroup2</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;PyMOLObjectNamesInfo&quot;</span><span class="p">][</span><span class="n">FileIndex2</span><span class="p">][</span><span class="s2">&quot;PDBGroup&quot;</span><span class="p">]</span>
 1007     <span class="n">ComplexName2</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;PyMOLObjectNamesInfo&quot;</span><span class="p">][</span><span class="n">FileIndex2</span><span class="p">][</span><span class="s2">&quot;Complex&quot;</span><span class="p">]</span>
 1008     
 1009     <span class="n">ChainIDs</span> <span class="o">=</span> <span class="p">[]</span>
 1010     <span class="n">InterfaceChainIDs</span> <span class="o">=</span> <span class="p">[]</span>
 1011     <span class="n">ResNums</span> <span class="o">=</span> <span class="p">[]</span>
 1012     <span class="n">ComplexNames</span> <span class="o">=</span> <span class="p">[]</span>
 1013     <span class="n">FileIndices</span> <span class="o">=</span> <span class="p">[]</span>
 1014     
 1015     <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">ChainIDs1</span><span class="p">:</span>
 1016         <span class="n">ChainIDs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ChainID</span><span class="p">)</span>
 1017         <span class="n">InterfaceChainID</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Chain</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ChainID</span><span class="p">)</span> <span class="k">if</span> <span class="n">SingleInfileMode</span> <span class="k">else</span> <span class="p">(</span><span class="s2">&quot;Chain</span><span class="si">%s</span><span class="s2">_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainID</span><span class="p">,</span> <span class="n">PDBGroup1</span><span class="p">))</span>
 1018         <span class="n">InterfaceChainIDs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">InterfaceChainID</span><span class="p">)</span>
 1019         <span class="n">ResNums</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ResNums1</span><span class="p">[</span><span class="s2">&quot;ResNums&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">])</span>
 1020         <span class="n">ComplexNames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ComplexName1</span><span class="p">)</span>
 1021         <span class="n">FileIndices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">FileIndex1</span><span class="p">)</span>
 1022     
 1023     <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">ChainIDs2</span><span class="p">:</span>
 1024         <span class="n">ChainIDs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ChainID</span><span class="p">)</span>
 1025         <span class="n">InterfaceChainID</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Chain</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ChainID</span><span class="p">)</span> <span class="k">if</span> <span class="n">SingleInfileMode</span> <span class="k">else</span> <span class="p">(</span><span class="s2">&quot;Chain</span><span class="si">%s</span><span class="s2">_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainID</span><span class="p">,</span> <span class="n">PDBGroup2</span><span class="p">))</span>
 1026         <span class="n">InterfaceChainIDs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">InterfaceChainID</span><span class="p">)</span>
 1027         <span class="n">ResNums</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ResNums2</span><span class="p">[</span><span class="s2">&quot;ResNums&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">])</span>
 1028         <span class="n">ComplexNames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ComplexName2</span><span class="p">)</span>
 1029         <span class="n">FileIndices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">FileIndex2</span><span class="p">)</span>
 1030 
 1031     <span class="k">return</span> <span class="n">InterfaceChainIDs</span><span class="p">,</span> <span class="n">ChainIDs</span><span class="p">,</span> <span class="n">ResNums</span><span class="p">,</span> <span class="n">ComplexNames</span><span class="p">,</span> <span class="n">FileIndices</span>
 1032     
 1033 <span class="k">def</span> <span class="nf">GetInterfaceChainsAndResiduesInfo</span><span class="p">(</span><span class="n">MolName1</span><span class="p">,</span> <span class="n">ChainIDs1</span><span class="p">,</span> <span class="n">MolName2</span><span class="p">,</span> <span class="n">ChainIDs2</span><span class="p">,</span> <span class="n">Method</span><span class="p">,</span> <span class="n">Cutoff</span><span class="p">):</span>
 1034     <span class="sd">&quot;&quot;&quot;Get interface chains and residues info for chains using a specified methodology.&quot;&quot;&quot;</span>
 1035 
 1036     <span class="n">InterfaceChainsResiduesInfo1</span> <span class="o">=</span> <span class="bp">None</span>
 1037     <span class="n">InterfaceChainsResiduesInfo2</span> <span class="o">=</span> <span class="bp">None</span>
 1038 
 1039     <span class="n">ChainNames1</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ChainIDs1</span><span class="p">)</span>
 1040     <span class="n">ChainNames2</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ChainIDs2</span><span class="p">)</span>
 1041     
 1042     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^BySASAChange$&quot;</span><span class="p">,</span> <span class="n">Method</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1043         <span class="n">InterfaceChainsResiduesInfo1</span><span class="p">,</span> <span class="n">InterfaceChainsResiduesInfo2</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">GetInterfaceChainsResiduesBySASAChange</span><span class="p">(</span><span class="n">MolName1</span><span class="p">,</span> <span class="n">ChainNames1</span><span class="p">,</span> <span class="n">MolName2</span><span class="p">,</span> <span class="n">ChainNames2</span><span class="p">,</span> <span class="n">Cutoff</span><span class="p">)</span>
 1044     <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^ByHeavyAtomsDistance$&quot;</span><span class="p">,</span> <span class="n">Method</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1045         <span class="n">InterfaceChainsResiduesInfo1</span><span class="p">,</span> <span class="n">InterfaceChainsResiduesInfo2</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">GetnterfaceChainsResiduesByHeavyAtomsDistance</span><span class="p">(</span><span class="n">MolName1</span><span class="p">,</span> <span class="n">ChainNames1</span><span class="p">,</span> <span class="n">MolName2</span><span class="p">,</span> <span class="n">ChainNames2</span><span class="p">,</span> <span class="n">Cutoff</span><span class="p">)</span>
 1046     <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^ByCAlphaAtomsDistance$&quot;</span><span class="p">,</span> <span class="n">Method</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1047         <span class="n">InterfaceChainsResiduesInfo1</span><span class="p">,</span> <span class="n">InterfaceChainsResiduesInfo2</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">GetInterfaceChainsResiduesByCAlphaAtomsDistance</span><span class="p">(</span><span class="n">MolName1</span><span class="p">,</span> <span class="n">ChainNames1</span><span class="p">,</span> <span class="n">MolName2</span><span class="p">,</span> <span class="n">ChainNames2</span><span class="p">,</span> <span class="n">Cutoff</span><span class="p">)</span>
 1048     <span class="k">else</span><span class="p">:</span>
 1049         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;Failed to retrieve interface residues information: Method </span><span class="si">%s</span><span class="s2"> is not valid...&quot;</span> <span class="o">%</span> <span class="n">Method</span><span class="p">)</span>
 1050 
 1051     <span class="k">return</span> <span class="n">InterfaceChainsResiduesInfo1</span><span class="p">,</span> <span class="n">InterfaceChainsResiduesInfo2</span>
 1052 
 1053 <span class="k">def</span> <span class="nf">ListInterfaceChainsAndResidues</span><span class="p">(</span><span class="n">InterfaceID</span><span class="p">,</span> <span class="n">MolName1</span><span class="p">,</span> <span class="n">ChainIDs1</span><span class="p">,</span> <span class="n">ChainsAndResiduesInfo1</span><span class="p">,</span> <span class="n">MolName2</span><span class="p">,</span> <span class="n">ChainIDs2</span><span class="p">,</span> <span class="n">ChainsAndResiduesInfo2</span><span class="p">):</span>
 1054     <span class="sd">&quot;&quot;&quot;List interface chains and residues for an interface.&quot;&quot;&quot;</span>
 1055     
 1056     <span class="n">ChainNames1</span><span class="p">,</span> <span class="n">ResiduesInfo1</span> <span class="o">=</span> <span class="n">PrepareInterfaceChainsAndResiduesInfo</span><span class="p">(</span><span class="n">ChainsAndResiduesInfo1</span><span class="p">)</span>
 1057     <span class="n">ChainNames2</span><span class="p">,</span> <span class="n">ResiduesInfo2</span> <span class="o">=</span> <span class="n">PrepareInterfaceChainsAndResiduesInfo</span><span class="p">(</span><span class="n">ChainsAndResiduesInfo2</span><span class="p">)</span>
 1058     
 1059     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ChainNames1</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">ChainNames2</span><span class="p">):</span>
 1060         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Listing interface residues for interface chain IDs: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">InterfaceID</span><span class="p">))</span>
 1061         
 1062         <span class="n">ListInterfaceChainsAndResiduesInfo</span><span class="p">(</span><span class="n">InterfaceID</span><span class="p">,</span>  <span class="n">MolName1</span><span class="p">,</span> <span class="n">ChainIDs1</span><span class="p">,</span> <span class="n">ChainNames1</span><span class="p">,</span> <span class="n">ResiduesInfo1</span><span class="p">)</span>
 1063         <span class="n">ListInterfaceChainsAndResiduesInfo</span><span class="p">(</span><span class="n">InterfaceID</span><span class="p">,</span>  <span class="n">MolName2</span><span class="p">,</span> <span class="n">ChainIDs2</span><span class="p">,</span> <span class="n">ChainNames2</span><span class="p">,</span> <span class="n">ResiduesInfo2</span><span class="p">)</span>
 1064     <span class="k">else</span><span class="p">:</span>
 1065         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Listing interface residues for interface chain IDs: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">InterfaceID</span><span class="p">))</span>
 1066         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Interface chain IDs: None; ChainID: None; Number of interface residues: 0&quot;</span><span class="p">)</span>
 1067 
 1068 <span class="k">def</span> <span class="nf">PrepareInterfaceChainsAndResiduesInfo</span><span class="p">(</span><span class="n">ChainsAndResiduesInfo</span><span class="p">):</span>
 1069     <span class="sd">&quot;&quot;&quot;Prepare interface chains and residues info for listing.&quot;&quot;&quot;</span>
 1070 
 1071     <span class="n">ChainNames</span> <span class="o">=</span> <span class="p">[]</span>
 1072     <span class="n">ResiduesInfo</span> <span class="o">=</span> <span class="p">[]</span>
 1073 
 1074     <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">ChainsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]:</span>
 1075         <span class="n">ChainNames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ChainID</span><span class="p">)</span>
 1076         
 1077         <span class="c1"># Setup distribution of residues...</span>
 1078         <span class="n">LineWords</span> <span class="o">=</span> <span class="p">[]</span>
 1079         <span class="n">ResiduesCount</span> <span class="o">=</span> <span class="mi">0</span>
 1080         <span class="n">SortedResNames</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">ChainsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;ResNames&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">],</span> <span class="n">key</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">ResName</span><span class="p">:</span> <span class="n">ChainsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;ResCount&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResName</span><span class="p">],</span> <span class="n">reverse</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
 1081         <span class="k">for</span> <span class="n">ResName</span> <span class="ow">in</span> <span class="n">SortedResNames</span><span class="p">:</span>
 1082             <span class="n">ResCount</span> <span class="o">=</span> <span class="n">ChainsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;ResCount&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResName</span><span class="p">]</span>
 1083             <span class="n">LineWords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> - </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResName</span><span class="p">,</span> <span class="n">ResCount</span><span class="p">))</span>
 1084             <span class="n">ResiduesCount</span> <span class="o">+=</span> <span class="n">ResCount</span>
 1085         
 1086         <span class="n">ResiduesDistribution</span> <span class="o">=</span> <span class="s2">&quot;; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">LineWords</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">LineWords</span><span class="p">)</span> <span class="k">else</span> <span class="bp">None</span>
 1087         
 1088         <span class="c1"># Setup residue IDs sorted by residue numbers...</span>
 1089         <span class="n">ResNumMap</span> <span class="o">=</span> <span class="p">{}</span>
 1090         <span class="k">for</span> <span class="n">ResName</span> <span class="ow">in</span> <span class="n">ChainsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;ResNames&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]:</span>
 1091             <span class="k">for</span> <span class="n">ResNum</span> <span class="ow">in</span> <span class="n">ChainsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;ResNum&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResName</span><span class="p">]:</span>
 1092                 <span class="n">ResNumMap</span><span class="p">[</span><span class="n">ResNum</span><span class="p">]</span> <span class="o">=</span> <span class="n">ResName</span>
 1093         
 1094         <span class="n">LineWords</span> <span class="o">=</span> <span class="p">[]</span>
 1095         <span class="k">for</span> <span class="n">ResNum</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">ResNumMap</span><span class="p">,</span> <span class="n">key</span> <span class="o">=</span> <span class="nb">int</span><span class="p">):</span>
 1096             <span class="n">ResName</span> <span class="o">=</span> <span class="n">ResNumMap</span><span class="p">[</span><span class="n">ResNum</span><span class="p">]</span>
 1097             <span class="n">ResID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResName</span><span class="p">,</span> <span class="n">ResNum</span><span class="p">)</span>
 1098             <span class="n">LineWords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ResID</span><span class="p">)</span>
 1099         <span class="n">ResiduesIDs</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">LineWords</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">LineWords</span><span class="p">)</span> <span class="k">else</span> <span class="bp">None</span>
 1100 
 1101         <span class="n">ResiduesInfo</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">ResiduesCount</span><span class="p">,</span> <span class="n">ResiduesDistribution</span><span class="p">,</span> <span class="n">ResiduesIDs</span><span class="p">])</span>
 1102                 
 1103     <span class="k">return</span> <span class="n">ChainNames</span><span class="p">,</span> <span class="n">ResiduesInfo</span>
 1104 
 1105 <span class="k">def</span> <span class="nf">ListInterfaceChainsAndResiduesInfo</span><span class="p">(</span><span class="n">InterfaceID</span><span class="p">,</span> <span class="n">MolName</span><span class="p">,</span> <span class="n">InterfaceChainIDs</span><span class="p">,</span> <span class="n">ChainNames</span><span class="p">,</span> <span class="n">ResiduesInfo</span><span class="p">):</span>
 1106     <span class="sd">&quot;&quot;&quot;List interface chains and residues. &quot;&quot;&quot;</span>
 1107 
 1108     <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">InterfaceChainIDs</span><span class="p">:</span>
 1109         <span class="k">if</span> <span class="ow">not</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">ChainNames</span><span class="p">:</span>
 1110             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;Interface chain IDs: </span><span class="si">%s</span><span class="s2">; MoleculeID: </span><span class="si">%s</span><span class="s2">; ChainID: </span><span class="si">%s</span><span class="s2">; Number of interface residues: 0. PyMOL groups and objects related to chain won&#39;t be created.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">InterfaceID</span><span class="p">,</span> <span class="n">MolName</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">))</span>
 1111             <span class="k">continue</span>
 1112         
 1113         <span class="k">for</span> <span class="n">Index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ChainNames</span><span class="p">)):</span>
 1114             <span class="n">ChainName</span> <span class="o">=</span> <span class="n">ChainNames</span><span class="p">[</span><span class="n">Index</span><span class="p">]</span>
 1115             <span class="n">ChainResiduesInfo</span> <span class="o">=</span> <span class="n">ResiduesInfo</span><span class="p">[</span><span class="n">Index</span><span class="p">]</span>
 1116             <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">ChainID</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1117                 <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Interface chain IDs: </span><span class="si">%s</span><span class="s2">; MoleculeID: </span><span class="si">%s</span><span class="s2">; ChainID: </span><span class="si">%s</span><span class="s2">; Number of interface residues: </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">InterfaceID</span><span class="p">,</span> <span class="n">MolName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">ChainResiduesInfo</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
 1118                 <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Residue distribution: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">Residue IDs: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainResiduesInfo</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ChainResiduesInfo</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
 1119                 <span class="k">continue</span>
 1120 
 1121 <span class="k">def</span> <span class="nf">GetInterfaceChainsAndResidueNumbers</span><span class="p">(</span><span class="n">ChainIDs</span><span class="p">,</span> <span class="n">ChainsAndResiduesInfo</span><span class="p">):</span>
 1122     <span class="sd">&quot;&quot;&quot;Collect interface residue numbers for chains. &quot;&quot;&quot;</span>
 1123 
 1124     <span class="n">ChainResidueNums</span> <span class="o">=</span> <span class="p">{}</span>
 1125     <span class="n">ChainResidueNums</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1126     <span class="n">ChainResidueNums</span><span class="p">[</span><span class="s2">&quot;ResNums&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1127     
 1128     <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">ChainIDs</span><span class="p">:</span>
 1129         <span class="k">if</span> <span class="ow">not</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">ChainsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]:</span>
 1130             <span class="k">continue</span>
 1131         
 1132         <span class="n">ChainResidueNums</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ChainID</span><span class="p">)</span>
 1133         <span class="n">ChainResidueNums</span><span class="p">[</span><span class="s2">&quot;ResNums&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1134 
 1135         <span class="n">ResNums</span> <span class="o">=</span> <span class="p">[]</span>
 1136         <span class="k">for</span> <span class="n">ResName</span> <span class="ow">in</span> <span class="n">ChainsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;ResNames&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]:</span>
 1137             <span class="n">ResNums</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">ChainsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;ResNum&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResName</span><span class="p">])</span>
 1138         
 1139         <span class="n">ChainResidueNums</span><span class="p">[</span><span class="s2">&quot;ResNums&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">ResNums</span><span class="p">,</span> <span class="n">key</span> <span class="o">=</span> <span class="nb">int</span><span class="p">)</span>
 1140 
 1141     <span class="n">InterfaceChainIDs</span> <span class="o">=</span> <span class="n">ChainResidueNums</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]</span>
 1142     
 1143     <span class="k">return</span> <span class="n">InterfaceChainIDs</span><span class="p">,</span> <span class="n">ChainResidueNums</span>
 1144 
 1145 <span class="k">def</span> <span class="nf">SetupPyMOLObjectNamesInfo</span><span class="p">():</span>
 1146     <span class="sd">&quot;&quot;&quot;Setup PyMOL object names for displaying macromolecules. &quot;&quot;&quot;</span>
 1147 
 1148     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;PyMOLObjectNamesInfo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1149     
 1150     <span class="k">for</span> <span class="n">FileIndex</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">])):</span>
 1151         <span class="n">PyMOLObjectNamesInfo</span> <span class="o">=</span> <span class="n">SetupPyMOLObjectNames</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">)</span>
 1152         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;PyMOLObjectNamesInfo&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PyMOLObjectNamesInfo</span><span class="p">)</span>
 1153     
 1154 <span class="k">def</span> <span class="nf">SetupPyMOLObjectNames</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">):</span>
 1155     <span class="sd">&quot;&quot;&quot;Setup hierarchy of PyMOL groups and objects for ligand centric views of</span>
 1156 <span class="sd">    chains and ligands present in input file.</span>
 1157 <span class="sd">    &quot;&quot;&quot;</span>
 1158 
 1159     <span class="n">PyMOLObjectNames</span> <span class="o">=</span> <span class="p">{}</span>
 1160     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1161     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1162 
 1163     <span class="c1"># Setup groups and objects for complex...</span>
 1164     <span class="n">SetupPyMOLObjectNamesForComplex</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">)</span>
 1165     
 1166     <span class="c1"># Setup groups and objects for chain...</span>
 1167     <span class="n">SpecifiedChainsAndLigandsInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
 1168     <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]:</span>
 1169         <span class="n">SetupPyMOLObjectNamesForChain</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
 1170         
 1171         <span class="c1"># Setup groups and objects for ligand...</span>
 1172         <span class="k">for</span> <span class="n">LigandID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]:</span>
 1173             <span class="n">SetupPyMOLObjectNamesForLigand</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">)</span>
 1174 
 1175     <span class="k">return</span> <span class="n">PyMOLObjectNames</span>
 1176 
 1177 <span class="k">def</span> <span class="nf">SetupPyMOLObjectNamesForComplex</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">):</span>
 1178     <span class="sd">&quot;&quot;&quot;Setup groups and objects for complex. &quot;&quot;&quot;</span>
 1179     
 1180     <span class="n">PDBFileRoot</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InfilesRoots&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
 1181     
 1182     <span class="n">PDBGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PDBFileRoot</span>
 1183     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;PDBGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PDBGroupName</span>
 1184     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;PDBGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1185 
 1186     <span class="n">ComplexGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Complex&quot;</span> <span class="o">%</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;PDBGroup&quot;</span><span class="p">]</span>
 1187     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ComplexGroupName</span>
 1188     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;PDBGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ComplexGroupName</span><span class="p">)</span>
 1189     
 1190     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Complex&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Complex&quot;</span> <span class="o">%</span> <span class="n">ComplexGroupName</span>
 1191     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceComplex&quot;</span><span class="p">]:</span>
 1192         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexHydrophobicSurface&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Surface&quot;</span> <span class="o">%</span> <span class="n">ComplexGroupName</span>
 1193 
 1194     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1195     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Complex&quot;</span><span class="p">])</span>
 1196     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceComplex&quot;</span><span class="p">]:</span>
 1197         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexHydrophobicSurface&quot;</span><span class="p">])</span>
 1198 
 1199 <span class="k">def</span> <span class="nf">SetupPyMOLObjectNamesForChain</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
 1200     <span class="sd">&quot;&quot;&quot;Setup groups and objects for chain.&quot;&quot;&quot;</span>
 1201 
 1202     <span class="n">PDBGroupName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;PDBGroup&quot;</span><span class="p">]</span>
 1203     
 1204     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1205     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1206     
 1207     <span class="c1"># Set up chain group and chain objects...</span>
 1208     <span class="n">ChainGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Chain</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">PDBGroupName</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
 1209     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ChainGroupName</span>
 1210     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;PDBGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ChainGroupName</span><span class="p">)</span>
 1211     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1212     
 1213     <span class="c1"># Setup chain complex group and objects...</span>
 1214     <span class="n">ChainComplexGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Complex&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainGroupName</span><span class="p">)</span>
 1215     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ChainComplexGroupName</span>
 1216     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ChainComplexGroupName</span><span class="p">)</span>
 1217 
 1218     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1219     
 1220     <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Complex&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainComplexGroupName</span><span class="p">)</span>
 1221     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplex&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
 1222     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
 1223     
 1224     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChainComplex&quot;</span><span class="p">]:</span>
 1225         <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Surface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainComplexGroupName</span><span class="p">)</span>
 1226         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexHydrophobicSurface&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
 1227         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
 1228 
 1229     <span class="c1"># Setup up a group for individual chains...</span>
 1230     <span class="n">ChainAloneGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Chain&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainGroupName</span><span class="p">)</span>
 1231     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ChainAloneGroupName</span>
 1232     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ChainAloneGroupName</span><span class="p">)</span>
 1233         
 1234     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1235         
 1236     <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Chain&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainAloneGroupName</span><span class="p">)</span>
 1237     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAlone&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
 1238     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
 1239 
 1240     <span class="c1"># Setup a group for non-interface residues...</span>
 1241     <span class="n">NonInterfaceGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.NonInterface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainAloneGroupName</span><span class="p">)</span>
 1242     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneNonInterfaceGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">NonInterfaceGroupName</span>
 1243     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">NonInterfaceGroupName</span><span class="p">)</span>
 1244     
 1245     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneNonInterfaceGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1246 
 1247     <span class="c1"># Setup a chain for non-interface residues...</span>
 1248     <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Chain&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">NonInterfaceGroupName</span><span class="p">)</span>
 1249     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneNonInterface&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
 1250     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneNonInterfaceGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
 1251 
 1252     <span class="k">if</span> <span class="n">GetChainAloneContainsSurfacesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
 1253         <span class="c1"># Setup a surface group and add it to chain alone non-interface group...</span>
 1254         <span class="n">SurfaceGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Surface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">NonInterfaceGroupName</span><span class="p">)</span>
 1255         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSurfaceGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SurfaceGroupName</span>
 1256         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneNonInterfaceGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SurfaceGroupName</span><span class="p">)</span>
 1257         
 1258         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSurfaceGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1259 
 1260         <span class="c1"># Setup a generic colored surface...</span>
 1261         <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Surface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfaceGroupName</span><span class="p">)</span>
 1262         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSurface&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
 1263         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSurfaceGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
 1264         
 1265         <span class="k">if</span> <span class="n">GetChainAloneSurfaceChainStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
 1266             <span class="c1"># Setup hydrophobicity surface...</span>
 1267             <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Hydrophobicity&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfaceGroupName</span><span class="p">)</span>
 1268             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneHydrophobicSurface&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
 1269             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSurfaceGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
 1270             
 1271             <span class="c1"># Setup hydrophobicity and charge surface...</span>
 1272             <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Hydrophobicity_Charge&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfaceGroupName</span><span class="p">)</span>
 1273             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneHydrophobicChargeSurface&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
 1274             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSurfaceGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
 1275     
 1276         <span class="k">if</span> <span class="n">GetChainAloneSurfaceChainElectrostaticsStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
 1277             <span class="c1"># Setup electrostatics group...</span>
 1278             <span class="n">GroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Vacuum_Electrostatics&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfaceGroupName</span><span class="p">)</span>
 1279             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneElectrostaticsGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">GroupName</span>
 1280             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneSurfaceGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">GroupName</span><span class="p">)</span>
 1281             
 1282             <span class="c1"># Setup electrostatics group members...</span>
 1283             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneElectrostaticsGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1284             
 1285             <span class="k">for</span> <span class="n">MemberType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Chain&quot;</span><span class="p">,</span> <span class="s2">&quot;Contact_Potential&quot;</span><span class="p">,</span> <span class="s2">&quot;Map&quot;</span><span class="p">,</span> <span class="s2">&quot;Legend&quot;</span><span class="p">,</span> <span class="s2">&quot;Volume&quot;</span><span class="p">]:</span>
 1286                 <span class="n">MemberID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">MemberType</span><span class="p">)</span>
 1287                 
 1288                 <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupName</span><span class="p">,</span> <span class="n">MemberType</span><span class="p">)</span>
 1289                 <span class="n">NameID</span> <span class="o">=</span> <span class="s2">&quot;ChainAloneElectrostaticsSurface</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">MemberID</span>
 1290                 
 1291                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">NameID</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
 1292                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneElectrostaticsGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
 1293             
 1294     <span class="c1"># Setup solvent and inorganic objects for chain...</span>
 1295     <span class="k">for</span> <span class="n">NameID</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Solvent&quot;</span><span class="p">,</span> <span class="s2">&quot;Inorganic&quot;</span><span class="p">]:</span>
 1296         <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainGroupName</span><span class="p">,</span> <span class="n">NameID</span><span class="p">)</span>
 1297         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">NameID</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
 1298         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
 1299 
 1300 <span class="k">def</span> <span class="nf">SetupPyMOLObjectNamesForLigand</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">):</span>
 1301     <span class="sd">&quot;&quot;&quot;Stetup groups and objects for ligand.&quot;&quot;&quot;</span>
 1302 
 1303     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1304     
 1305     <span class="n">ChainGroupName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroup&quot;</span><span class="p">]</span>
 1306     
 1307     <span class="c1"># Setup a chain level ligand group...</span>
 1308     <span class="n">ChainLigandGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Ligand</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainGroupName</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">)</span>
 1309     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="s2">&quot;ChainLigandGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ChainLigandGroupName</span>
 1310     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ChainLigandGroupName</span><span class="p">)</span>
 1311     
 1312     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="s2">&quot;ChainLigandGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1313 
 1314     <span class="c1"># Set up ligand group and its members...</span>
 1315     <span class="n">GroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Ligand&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainLigandGroupName</span><span class="p">)</span>
 1316     <span class="n">GroupNameID</span> <span class="o">=</span> <span class="s2">&quot;LigandGroup&quot;</span>
 1317     <span class="n">GroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;LigandGroupMembers&quot;</span>
 1318     
 1319     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupNameID</span><span class="p">]</span> <span class="o">=</span> <span class="n">GroupName</span>
 1320     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="s2">&quot;ChainLigandGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">GroupName</span><span class="p">)</span>
 1321     
 1322     <span class="n">LigandName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Ligand&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupName</span><span class="p">)</span>
 1323     <span class="n">LigandNameID</span> <span class="o">=</span> <span class="s2">&quot;Ligand&quot;</span>
 1324     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">LigandNameID</span><span class="p">]</span> <span class="o">=</span> <span class="n">LigandName</span>
 1325     
 1326     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupMembersID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1327     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">LigandName</span><span class="p">)</span>
 1328     
 1329     <span class="c1"># Add ball and stick...</span>
 1330     <span class="n">BallAndStickName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.BallAndStick&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupName</span><span class="p">)</span>
 1331     <span class="n">BallAndStickID</span> <span class="o">=</span> <span class="s2">&quot;LigandBallAndStick&quot;</span>
 1332     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">BallAndStickID</span><span class="p">]</span> <span class="o">=</span> <span class="n">BallAndStickName</span>
 1333     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">BallAndStickName</span><span class="p">)</span>
 1334 
 1335 <span class="k">def</span> <span class="nf">SetupPyMOLInterfaceObjectNamesInfo</span><span class="p">():</span>
 1336     <span class="sd">&quot;&quot;&quot;Setup PyMOL object names for displaying macromolecular interfaces. &quot;&quot;&quot;</span>
 1337 
 1338     <span class="n">InterfaceChainsAndResiduesInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InterfaceChainsAndResiduesInfo&quot;</span><span class="p">]</span>
 1339     
 1340     <span class="n">PyMOLObjectNames</span> <span class="o">=</span> <span class="p">{}</span>
 1341     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceIDs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1342     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1343 
 1344     <span class="c1"># Setup top level interfaces group...</span>
 1345     <span class="n">InterfacesGroupName</span> <span class="o">=</span> <span class="s2">&quot;Interfaces&quot;</span>
 1346     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfacesGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">InterfacesGroupName</span>
 1347     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfacesGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1348 
 1349     <span class="k">for</span> <span class="n">InterfaceID</span> <span class="ow">in</span> <span class="n">InterfaceChainsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;InterfaceIDs&quot;</span><span class="p">]:</span>
 1350         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1351         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1352         
 1353         <span class="c1"># Setup an interface group...</span>
 1354         <span class="n">InterfaceIDGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">InterfacesGroupName</span><span class="p">,</span> <span class="n">InterfaceID</span><span class="p">)</span>
 1355         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="s2">&quot;InterfaceIDGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">InterfaceIDGroupName</span>
 1356         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfacesGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">InterfaceIDGroupName</span><span class="p">)</span>
 1357         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="s2">&quot;InterfaceIDGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1358 
 1359         <span class="c1"># Setup a polar contact group...</span>
 1360         <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InterfacePolarContacts&quot;</span><span class="p">]:</span>
 1361             <span class="n">PolarContactName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Polar_Contacts&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">InterfaceIDGroupName</span><span class="p">)</span>
 1362             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="s2">&quot;PolarContacts&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PolarContactName</span>
 1363             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="s2">&quot;InterfaceIDGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PolarContactName</span><span class="p">)</span>
 1364         
 1365         <span class="c1"># Setup a hydrophobic contact group...</span>
 1366         <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InterfaceHydrophobicContacts&quot;</span><span class="p">]:</span>
 1367             <span class="n">HydrophobicContactsName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Hydrophobic_Contacts&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">InterfaceIDGroupName</span><span class="p">)</span>
 1368             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="s2">&quot;HydrophobicContacts&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">HydrophobicContactsName</span>
 1369             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="s2">&quot;InterfaceIDGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">HydrophobicContactsName</span><span class="p">)</span>
 1370         
 1371         <span class="k">for</span> <span class="n">InterfaceChainID</span> <span class="ow">in</span> <span class="n">InterfaceChainsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">]:</span>
 1372             <span class="n">SetupPyMOLInterfaceObjectNamesForChain</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">InterfaceID</span><span class="p">,</span> <span class="n">InterfaceChainID</span><span class="p">)</span>
 1373             
 1374     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;PyMOLInterfaceObjectNamesInfo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span>
 1375 
 1376 <span class="k">def</span> <span class="nf">SetupPyMOLInterfaceObjectNamesForChain</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">InterfaceID</span><span class="p">,</span> <span class="n">InterfaceChainID</span><span class="p">):</span>
 1377     <span class="sd">&quot;&quot;&quot;Setup PyMOL interface object names for a chain. &quot;&quot;&quot;</span>
 1378     
 1379     <span class="n">InterfaceChainsAndResiduesInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InterfaceChainsAndResiduesInfo&quot;</span><span class="p">]</span>
 1380     <span class="n">FileIndex</span> <span class="o">=</span> <span class="n">InterfaceChainsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDsInfileIndices&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">]</span>
 1381     <span class="n">ChainID</span> <span class="o">=</span> <span class="n">InterfaceChainsAndResiduesInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">]</span>
 1382     
 1383     <span class="n">InterfaceIDGroupName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="s2">&quot;InterfaceIDGroup&quot;</span><span class="p">]</span>
 1384     
 1385     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1386     
 1387     <span class="c1"># Setup a chain group...</span>
 1388     <span class="n">ChainGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">InterfaceIDGroupName</span><span class="p">,</span> <span class="n">InterfaceChainID</span><span class="p">)</span>
 1389     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ChainGroupName</span>
 1390     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="s2">&quot;InterfaceIDGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ChainGroupName</span><span class="p">)</span>
 1391     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1392     
 1393     <span class="c1"># Setup chain...</span>
 1394     <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Chain&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainGroupName</span><span class="p">)</span>
 1395     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">][</span><span class="s2">&quot;Chain&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
 1396     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
 1397     
 1398     <span class="k">if</span> <span class="n">GetInterfaceResidueTypesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
 1399         <span class="c1"># Setup residue type group and its subgroups...</span>
 1400         <span class="n">ResiduesGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Residues&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainGroupName</span><span class="p">)</span>
 1401         
 1402         <span class="n">ResiduesGroupIDPrefix</span> <span class="o">=</span> <span class="s2">&quot;ChainResidues&quot;</span>
 1403         <span class="n">ResiduesGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="n">ResiduesGroupIDPrefix</span>
 1404         
 1405         <span class="c1"># Add residue group to chain group...</span>
 1406         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">][</span><span class="n">ResiduesGroupID</span><span class="p">]</span> <span class="o">=</span> <span class="n">ResiduesGroupName</span>
 1407         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ResiduesGroupName</span><span class="p">)</span>
 1408         
 1409         <span class="c1"># Initialize residue group members...</span>
 1410         <span class="n">ResiduesGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">GroupMembers&quot;</span> <span class="o">%</span> <span class="n">ResiduesGroupIDPrefix</span>
 1411         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">][</span><span class="n">ResiduesGroupMembersID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1412         
 1413         <span class="c1"># Setup residues sub groups and its members...</span>
 1414         <span class="k">for</span> <span class="n">SubGroupType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Aromatic&quot;</span><span class="p">,</span> <span class="s2">&quot;Hydrophobic&quot;</span><span class="p">,</span> <span class="s2">&quot;Polar&quot;</span><span class="p">,</span> <span class="s2">&quot;Positively_Charged&quot;</span><span class="p">,</span> <span class="s2">&quot;Negatively_Charged&quot;</span><span class="p">,</span> <span class="s2">&quot;Other&quot;</span><span class="p">]:</span>
 1415             <span class="n">SubGroupID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">SubGroupType</span><span class="p">)</span>
 1416 
 1417             <span class="n">ResiduesSubGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupName</span><span class="p">,</span> <span class="n">SubGroupType</span><span class="p">)</span>
 1418             <span class="n">ResiduesSubGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupIDPrefix</span><span class="p">,</span> <span class="n">SubGroupID</span><span class="p">)</span>
 1419 
 1420             <span class="c1"># Add sub group to residues group...</span>
 1421             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">][</span><span class="n">ResiduesSubGroupID</span><span class="p">]</span> <span class="o">=</span> <span class="n">ResiduesSubGroupName</span>
 1422             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">][</span><span class="n">ResiduesGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ResiduesSubGroupName</span><span class="p">)</span>
 1423             
 1424             <span class="c1"># Initialize sub group members...</span>
 1425             <span class="n">ResiduesSubGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">GroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupIDPrefix</span><span class="p">,</span> <span class="n">SubGroupID</span><span class="p">)</span>
 1426             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">][</span><span class="n">ResiduesSubGroupMembersID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1427             
 1428             <span class="c1"># Add sub group members to subgroup...</span>
 1429             <span class="k">for</span> <span class="n">MemberType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Residues&quot;</span><span class="p">,</span> <span class="s2">&quot;Surface&quot;</span><span class="p">]:</span>
 1430                 <span class="n">MemberID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">MemberType</span><span class="p">)</span>
 1431 
 1432                 <span class="n">SubGroupMemberName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesSubGroupName</span><span class="p">,</span> <span class="n">MemberType</span><span class="p">)</span>
 1433                 <span class="n">SubGroupMemberID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupIDPrefix</span><span class="p">,</span> <span class="n">SubGroupID</span><span class="p">,</span> <span class="n">MemberID</span><span class="p">)</span>
 1434                 
 1435                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">][</span><span class="n">SubGroupMemberID</span><span class="p">]</span> <span class="o">=</span> <span class="n">SubGroupMemberName</span>
 1436                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">][</span><span class="n">ResiduesSubGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SubGroupMemberName</span><span class="p">)</span>
 1437                 
 1438     <span class="k">if</span> <span class="n">GetInterfaceContainsSurfacesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
 1439         <span class="c1"># Setup a surface group and add it to chain group...</span>
 1440         <span class="n">SurfaceGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Surface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainGroupName</span><span class="p">)</span>
 1441         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">][</span><span class="s2">&quot;ChainSurfaceGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SurfaceGroupName</span>
 1442         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SurfaceGroupName</span><span class="p">)</span>
 1443         
 1444         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">][</span><span class="s2">&quot;ChainSurfaceGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1445 
 1446         <span class="c1"># Setup a generic colored surface...</span>
 1447         <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Surface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfaceGroupName</span><span class="p">)</span>
 1448         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">][</span><span class="s2">&quot;ChainSurface&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
 1449         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">][</span><span class="s2">&quot;ChainSurfaceGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
 1450         
 1451         <span class="k">if</span> <span class="n">GetInterfaceSurfaceChainStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
 1452             <span class="c1"># Setup hydrophobicity surface...</span>
 1453             <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Hydrophobicity&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfaceGroupName</span><span class="p">)</span>
 1454             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">][</span><span class="s2">&quot;ChainHydrophobicSurface&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
 1455             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">][</span><span class="s2">&quot;ChainSurfaceGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
 1456             
 1457             <span class="c1"># Setup hydrophobicity and charge surface...</span>
 1458             <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Hydrophobicity_Charge&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfaceGroupName</span><span class="p">)</span>
 1459             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">][</span><span class="s2">&quot;ChainHydrophobicChargeSurface&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
 1460             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">][</span><span class="s2">&quot;ChainSurfaceGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
 1461             
 1462         <span class="k">if</span> <span class="n">GetInterfaceSurfaceChainElectrostaticsStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
 1463             <span class="c1"># Setup electrostatics group...</span>
 1464             <span class="n">GroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Vacuum_Electrostatics&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfaceGroupName</span><span class="p">)</span>
 1465             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">][</span><span class="s2">&quot;ChainElectrostaticsGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">GroupName</span>
 1466             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">][</span><span class="s2">&quot;ChainSurfaceGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">GroupName</span><span class="p">)</span>
 1467             
 1468             <span class="c1"># Setup electrostatics group members...</span>
 1469             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">][</span><span class="s2">&quot;ChainElectrostaticsGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1470             
 1471             <span class="k">for</span> <span class="n">MemberType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Chain&quot;</span><span class="p">,</span> <span class="s2">&quot;Contact_Potential&quot;</span><span class="p">,</span> <span class="s2">&quot;Map&quot;</span><span class="p">,</span> <span class="s2">&quot;Legend&quot;</span><span class="p">,</span> <span class="s2">&quot;Volume&quot;</span><span class="p">]:</span>
 1472                 <span class="n">MemberID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">MemberType</span><span class="p">)</span>
 1473                 
 1474                 <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupName</span><span class="p">,</span> <span class="n">MemberType</span><span class="p">)</span>
 1475                 <span class="n">NameID</span> <span class="o">=</span> <span class="s2">&quot;ChainElectrostaticsSurface</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">MemberID</span>
 1476                 
 1477                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">][</span><span class="n">NameID</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
 1478                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">][</span><span class="n">InterfaceID</span><span class="p">][</span><span class="n">InterfaceChainID</span><span class="p">][</span><span class="s2">&quot;ChainElectrostaticsGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
 1479 
 1480 <span class="k">def</span> <span class="nf">ProcessResidueTypesAndSurfaceOptions</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">):</span>
 1481     <span class="sd">&quot;&quot;&quot;Process residue types and surface options for chains and interfaces.&quot;&quot;&quot;</span>
 1482 
 1483     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainSurfaces&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1484     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChain&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1485     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChainElectrostatics&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1486 
 1487     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;InterfaceSurfaces&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1488     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceInterface&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1489     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceInterfaceElectrostatics&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1490     
 1491     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesInterface&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1492 
 1493     <span class="c1"># Load infile...</span>
 1494     <span class="n">Infile</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
 1495     <span class="n">MolName</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InfilesRoots&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
 1496     <span class="n">pymol</span><span class="o">.</span><span class="n">cmd</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">Infile</span><span class="p">,</span> <span class="n">MolName</span><span class="p">)</span>
 1497     
 1498     <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]:</span>
 1499         <span class="n">AminoAcidsPresent</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">AreAminoAcidResiduesPresent</span><span class="p">(</span><span class="n">MolName</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
 1500 
 1501         <span class="c1"># Process surfaces for chains...</span>
 1502         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChain&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1503             <span class="n">SurfaceChain</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">AminoAcidsPresent</span> <span class="k">else</span> <span class="bp">False</span>
 1504         <span class="k">else</span><span class="p">:</span>
 1505             <span class="n">SurfaceChain</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^yes$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChain&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1506         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChain&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">SurfaceChain</span>
 1507 
 1508         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChainElectrostatics&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1509             <span class="n">SurfaceChainElectrostatics</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">AminoAcidsPresent</span> <span class="k">else</span> <span class="bp">False</span>
 1510         <span class="k">else</span><span class="p">:</span>
 1511             <span class="n">SurfaceChainElectrostatics</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^yes$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChainElectrostatics&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1512         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChainElectrostatics&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">SurfaceChainElectrostatics</span>
 1513 
 1514         <span class="c1"># A colored surface is always created by default...</span>
 1515         <span class="n">ChainSurfaces</span> <span class="o">=</span> <span class="bp">True</span>
 1516         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainSurfaces&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">ChainSurfaces</span>
 1517         
 1518         <span class="c1"># Process residue types and surfaces for interfaces...</span>
 1519         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InterfaceSurface&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1520             <span class="n">InterfaceSurface</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">AminoAcidsPresent</span> <span class="k">else</span> <span class="bp">False</span>
 1521         <span class="k">else</span><span class="p">:</span>
 1522             <span class="n">InterfaceSurface</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^yes$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InterfaceSurface&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1523         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceInterface&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">InterfaceSurface</span>
 1524         
 1525         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InterfaceSurfaceElectrostatics&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1526             <span class="n">InterfaceSurfaceElectrostatics</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">AminoAcidsPresent</span> <span class="k">else</span> <span class="bp">False</span>
 1527         <span class="k">else</span><span class="p">:</span>
 1528             <span class="n">InterfaceSurfaceElectrostatics</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^yes$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InterfaceSurfaceElectrostatics&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1529         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceInterfaceElectrostatics&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">InterfaceSurfaceElectrostatics</span>
 1530         
 1531         <span class="c1"># A colored surface is always created by default...</span>
 1532         <span class="n">InterfaceSurfaces</span> <span class="o">=</span> <span class="bp">True</span>
 1533         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;InterfaceSurfaces&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">InterfaceSurfaces</span>
 1534         
 1535         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InterfaceResidueTypes&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1536             <span class="n">InterfaceResidueTypes</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">AminoAcidsPresent</span> <span class="k">else</span> <span class="bp">False</span>
 1537         <span class="k">else</span><span class="p">:</span>
 1538             <span class="n">InterfaceResidueTypes</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^yes$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InterfaceResidueTypes&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1539         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesInterface&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">InterfaceResidueTypes</span>
 1540     
 1541     <span class="c1"># Delete loaded object...</span>
 1542     <span class="n">pymol</span><span class="o">.</span><span class="n">cmd</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">MolName</span><span class="p">)</span>
 1543 
 1544 <span class="k">def</span> <span class="nf">GetInterfaceResidueTypesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
 1545     <span class="sd">&quot;&quot;&quot;Get status of residue types for an interface.&quot;&quot;&quot;</span>
 1546 
 1547     <span class="k">return</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">][</span><span class="s2">&quot;ResidueTypesInterface&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
 1548 
 1549 <span class="k">def</span> <span class="nf">GetChainAloneContainsSurfacesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
 1550     <span class="sd">&quot;&quot;&quot;Get status of surfaces present in chain alone object.&quot;&quot;&quot;</span>
 1551 
 1552     <span class="k">return</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">][</span><span class="s2">&quot;ChainSurfaces&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
 1553 
 1554 <span class="k">def</span> <span class="nf">GetInterfaceContainsSurfacesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
 1555     <span class="sd">&quot;&quot;&quot;Get status of surfaces present in an interface.&quot;&quot;&quot;</span>
 1556 
 1557     <span class="k">return</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">][</span><span class="s2">&quot;InterfaceSurfaces&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
 1558 
 1559 <span class="k">def</span> <span class="nf">GetChainAloneSurfaceChainStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
 1560     <span class="sd">&quot;&quot;&quot;Get status of hydrophobic surfaces for chain alone object.&quot;&quot;&quot;</span>
 1561 
 1562     <span class="k">return</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">][</span><span class="s2">&quot;SurfaceChain&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
 1563 
 1564 <span class="k">def</span> <span class="nf">GetChainAloneSurfaceChainElectrostaticsStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
 1565     <span class="sd">&quot;&quot;&quot;Get status of electrostatics surfaces for chain alone object.&quot;&quot;&quot;</span>
 1566 
 1567     <span class="k">return</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">][</span><span class="s2">&quot;SurfaceChainElectrostatics&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
 1568 
 1569 <span class="k">def</span> <span class="nf">GetInterfaceSurfaceChainStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
 1570     <span class="sd">&quot;&quot;&quot;Get status of hydrophobic surfaces for an interface.&quot;&quot;&quot;</span>
 1571 
 1572     <span class="k">return</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">][</span><span class="s2">&quot;SurfaceInterface&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
 1573 
 1574 <span class="k">def</span> <span class="nf">GetInterfaceSurfaceChainElectrostaticsStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
 1575     <span class="sd">&quot;&quot;&quot;Get status of hydrophobic surfaces for an interface.&quot;&quot;&quot;</span>
 1576 
 1577     <span class="k">return</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">][</span><span class="s2">&quot;SurfaceInterfaceElectrostatics&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
 1578 
 1579 <span class="k">def</span> <span class="nf">CheckPresenceOfValidLigandIDs</span><span class="p">(</span><span class="n">ChainsAndLigandsInfo</span><span class="p">,</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">):</span>
 1580     <span class="sd">&quot;&quot;&quot;Check presence of valid ligand IDs.&quot;&quot;&quot;</span>
 1581 
 1582     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Specified chain IDs: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">])))</span>
 1583     
 1584     <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]:</span>
 1585         <span class="k">if</span> <span class="nb">len</span> <span class="p">(</span><span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]):</span>
 1586             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Chain ID: </span><span class="si">%s</span><span class="s2">; Specified LigandIDs: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainID</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">])))</span>
 1587         <span class="k">else</span><span class="p">:</span>
 1588             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Chain IDs: </span><span class="si">%s</span><span class="s2">; Specified LigandIDs: None&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainID</span><span class="p">))</span>
 1589             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;No valid ligand IDs found for chain ID, </span><span class="si">%s</span><span class="s2">. PyMOL groups and objects related to ligand and binding pockect won&#39;t be created.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainID</span><span class="p">))</span>
 1590 
 1591 <span class="k">def</span> <span class="nf">RetrieveFirstChainID</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">):</span>
 1592     <span class="sd">&quot;&quot;&quot;Get first chain ID.&quot;&quot;&quot;</span>
 1593     
 1594     <span class="n">ChainsAndLigandsInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;ChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
 1595     
 1596     <span class="n">FirstChainID</span> <span class="o">=</span> <span class="bp">None</span>
 1597     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]):</span>
 1598         <span class="n">FirstChainID</span> <span class="o">=</span> <span class="n">ChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
 1599     
 1600     <span class="k">return</span> <span class="n">FirstChainID</span>
 1601 
 1602 <span class="k">def</span> <span class="nf">ProcessResidueTypes</span><span class="p">():</span>
 1603     <span class="sd">&quot;&quot;&quot;Process residue types. &quot;&quot;&quot;</span>
 1604 
 1605     <span class="n">ResidueTypesNamesInfo</span><span class="p">,</span> <span class="n">ResidueTypesParamsInfo</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">ProcessResidueTypesOptionsInfo</span><span class="p">(</span><span class="s2">&quot;-r, --residueTypes&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypes&quot;</span><span class="p">])</span>
 1606     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesNames&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ResidueTypesNamesInfo</span>
 1607     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesParams&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ResidueTypesParamsInfo</span>
 1608     
 1609 <span class="k">def</span> <span class="nf">ProcessSurfaceAtomTypesColors</span><span class="p">():</span>
 1610     <span class="sd">&quot;&quot;&quot;Process surface atom types colors. &quot;&quot;&quot;</span>
 1611 
 1612     <span class="n">AtomTypesColorNamesInfo</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">ProcessSurfaceAtomTypesColorsOptionsInfo</span><span class="p">(</span><span class="s2">&quot;--surfaceAtomTypesColors&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceAtomTypesColors&quot;</span><span class="p">])</span>
 1613     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AtomTypesColorNames&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">AtomTypesColorNamesInfo</span>
 1614 
 1615 <span class="k">def</span> <span class="nf">ProcessOptions</span><span class="p">():</span>
 1616     <span class="sd">&quot;&quot;&quot;Process and validate command line arguments and options&quot;&quot;&quot;</span>
 1617 
 1618     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Processing options...&quot;</span><span class="p">)</span>
 1619     
 1620     <span class="c1"># Validate options...</span>
 1621     <span class="n">ValidateOptions</span><span class="p">()</span>
 1622     
 1623     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AllowEmptyObjects&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Yes$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--allowEmptyObjects&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1624 
 1625     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Infiles&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--infiles&quot;</span><span class="p">]</span>
 1626     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--infileNames&quot;</span><span class="p">]</span>
 1627 
 1628     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Overwrite&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--overwrite&quot;</span><span class="p">]</span>
 1629     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMLOut&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Yes$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--PMLOut&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1630     
 1631     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Outfile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--outfile&quot;</span><span class="p">]</span>
 1632     <span class="n">FileDir</span><span class="p">,</span> <span class="n">FileName</span><span class="p">,</span> <span class="n">FileExt</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ParseFileName</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Outfile&quot;</span><span class="p">])</span>
 1633     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PSEOut&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span> 
 1634     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^pml$&quot;</span><span class="p">,</span> <span class="n">FileExt</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1635         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMLOutfile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Outfile&quot;</span><span class="p">]</span> 
 1636         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMEOutfile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;.pml$&quot;</span><span class="p">,</span> <span class="s2">&quot;.pme&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Outfile&quot;</span><span class="p">])</span> 
 1637     <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^pse$&quot;</span><span class="p">,</span> <span class="n">FileExt</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1638         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PSEOut&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span> 
 1639         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PSEOutfile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Outfile&quot;</span><span class="p">]</span> 
 1640         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMLOutfile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;.pse$&quot;</span><span class="p">,</span> <span class="s2">&quot;.pml&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Outfile&quot;</span><span class="p">])</span> 
 1641         <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMLOutfile&quot;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Overwrite&quot;</span><span class="p">]):</span>
 1642             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The intermediate output file to be generated, </span><span class="si">%s</span><span class="s2">, already exist. Use option </span><span class="se">\&quot;</span><span class="s2">--ov</span><span class="se">\&quot;</span><span class="s2"> or </span><span class="se">\&quot;</span><span class="s2">--overwrite</span><span class="se">\&quot;</span><span class="s2"> and try again.&quot;</span> <span class="o">%</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMLOutfile&quot;</span><span class="p">]</span> <span class="p">)</span>
 1643 
 1644     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InterfaceLabelColor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--interfaceLabelColor&quot;</span><span class="p">]</span>
 1645     
 1646     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InterfaceContactsCutoff&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--interfaceContactsCutoff&quot;</span><span class="p">])</span>
 1647     
 1648     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InterfaceHydrophobicContactsColor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--interfaceHydrophobicContactsColor&quot;</span><span class="p">]</span>
 1649     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InterfaceHydrophobicContacts&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Yes$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--interfaceHydrophobicContacts&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1650     
 1651     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InterfacePolarContactsColor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--interfacePolarContactsColor&quot;</span><span class="p">]</span>
 1652     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InterfacePolarContacts&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Yes$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--interfacePolarContacts&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1653     
 1654     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InterfaceResidueTypes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--interfaceResidueTypes&quot;</span><span class="p">]</span>
 1655     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InterfaceSurface&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--interfaceSurface&quot;</span><span class="p">]</span>
 1656     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InterfaceSurfaceElectrostatics&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--interfaceSurfaceElectrostatics&quot;</span><span class="p">]</span>
 1657     
 1658     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;LabelFontID&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--labelFontID&quot;</span><span class="p">])</span>
 1659     
 1660     <span class="n">Method</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--method&quot;</span><span class="p">]</span>
 1661     <span class="n">MethodCutoff</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--methodCutoff&quot;</span><span class="p">]</span>
 1662     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">MethodCutoff</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1663         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;BySASAChange&quot;</span><span class="p">,</span> <span class="n">Method</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1664             <span class="n">MethodCutoff</span> <span class="o">=</span> <span class="mf">1.0</span>
 1665         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;ByHeavyAtomsDistance&quot;</span><span class="p">,</span> <span class="n">Method</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1666             <span class="n">MethodCutoff</span> <span class="o">=</span> <span class="mf">5.0</span>
 1667         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;ByCAlphaAtomsDistance&quot;</span><span class="p">,</span> <span class="n">Method</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1668             <span class="n">MethodCutoff</span> <span class="o">=</span> <span class="mf">8.0</span>
 1669         <span class="k">else</span><span class="p">:</span>
 1670             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The method, </span><span class="si">%s</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="s2">-m, --method</span><span class="se">\&quot;</span><span class="s2"> option  is  not a valid method.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Method</span><span class="p">))</span>
 1671     <span class="k">else</span><span class="p">:</span>
 1672         <span class="n">MethodCutoff</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--methodCutoff&quot;</span><span class="p">])</span>
 1673     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Method&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Method</span>
 1674     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MethodCutoff&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">MethodCutoff</span>
 1675     
 1676     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--residueTypes&quot;</span><span class="p">]</span>
 1677     <span class="n">ProcessResidueTypes</span><span class="p">()</span>
 1678     
 1679     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChain&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceChain&quot;</span><span class="p">]</span>
 1680     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChainElectrostatics&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceChainElectrostatics&quot;</span><span class="p">]</span>
 1681     
 1682     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChainComplex&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Yes$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceChainComplex&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1683     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceComplex&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Yes$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceComplex&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1684 
 1685     <span class="c1"># Retrieve surface colors...</span>
 1686     <span class="n">SurfaceColors</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceColors&quot;</span><span class="p">])</span>
 1687     <span class="n">SurfaceColorsWords</span> <span class="o">=</span> <span class="n">SurfaceColors</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
 1688     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">SurfaceColorsWords</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
 1689         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The number of comma delinited color names, </span><span class="si">%d</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="s2">--surfaceColors</span><span class="se">\&quot;</span><span class="s2"> option, </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">,  must be a 2.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">SurfaceColorsWords</span><span class="p">),</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceColors&quot;</span><span class="p">]))</span>
 1690     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceColors&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SurfaceColors</span>
 1691     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceInterfaceColor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SurfaceColorsWords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
 1692     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceNonInterfaceColor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SurfaceColorsWords</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
 1693     
 1694     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceColorPalette&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceColorPalette&quot;</span><span class="p">]</span>
 1695     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceAtomTypesColors&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceAtomTypesColors&quot;</span><span class="p">]</span>
 1696     <span class="n">ProcessSurfaceAtomTypesColors</span><span class="p">()</span>
 1697     
 1698     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceTransparency&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceTransparency&quot;</span><span class="p">])</span>
 1699     
 1700     <span class="n">RetrieveInfilesInfo</span><span class="p">()</span>
 1701 
 1702     <span class="c1"># Retrieve interface chain IDs...</span>
 1703     <span class="n">InterfaceChainIDs</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--chainIDs&quot;</span><span class="p">])</span>
 1704     <span class="n">InterfaceChainIDsList</span> <span class="o">=</span> <span class="p">[]</span>
 1705     <span class="n">CanonicalInterfaceChainIDsMap</span> <span class="o">=</span> <span class="p">{}</span>
 1706     <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">InterfaceChainIDs</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1707         <span class="n">InterfaceChainIDsWords</span> <span class="o">=</span> <span class="n">InterfaceChainIDs</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
 1708         <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">InterfaceChainIDsWords</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span><span class="p">:</span>
 1709             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The number of comma delimited chain IDs, </span><span class="si">%d</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="s2">-c, --chainIDs</span><span class="se">\&quot;</span><span class="s2"> option, </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">,  must be a multple of 2.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">InterfaceChainIDsWords</span><span class="p">),</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--chainIDs&quot;</span><span class="p">]))</span>
 1710         <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">InterfaceChainIDsWords</span><span class="p">:</span>
 1711             <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">ChainID</span><span class="p">):</span>
 1712                 <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;A chain ID specified, </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> using </span><span class="se">\&quot;</span><span class="s2">-c, --chainIDs</span><span class="se">\&quot;</span><span class="s2"> option is empty.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--chainIDs&quot;</span><span class="p">]))</span>
 1713             <span class="n">ChainIDWords</span> <span class="o">=</span> <span class="n">ChainID</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;+&quot;</span><span class="p">)</span>
 1714             <span class="n">InterfaceChainIDsList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ChainIDWords</span><span class="p">)</span>
 1715     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDs&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">InterfaceChainIDs</span>
 1716     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InterfaceChainIDsList&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">InterfaceChainIDsList</span>
 1717     
 1718     <span class="c1"># Process interface chain IDs...</span>
 1719     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--ligandIDs&quot;</span><span class="p">]</span>
 1720     <span class="n">ProcessInterfaceChainIDs</span><span class="p">()</span>
 1721     
 1722 <span class="k">def</span> <span class="nf">RetrieveOptions</span><span class="p">():</span> 
 1723     <span class="sd">&quot;&quot;&quot;Retrieve command line arguments and options&quot;&quot;&quot;</span>
 1724     
 1725     <span class="c1"># Get options...</span>
 1726     <span class="k">global</span> <span class="n">Options</span>
 1727     <span class="n">Options</span> <span class="o">=</span> <span class="n">docopt</span><span class="p">(</span><span class="n">_docoptUsage_</span><span class="p">)</span>
 1728 
 1729     <span class="c1"># Set current working directory to the specified directory...</span>
 1730     <span class="n">WorkingDir</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--workingdir&quot;</span><span class="p">]</span>
 1731     <span class="k">if</span> <span class="n">WorkingDir</span><span class="p">:</span>
 1732         <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">WorkingDir</span><span class="p">)</span>
 1733     
 1734     <span class="c1"># Handle examples option...</span>
 1735     <span class="k">if</span> <span class="s2">&quot;--examples&quot;</span> <span class="ow">in</span> <span class="n">Options</span> <span class="ow">and</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--examples&quot;</span><span class="p">]:</span>
 1736         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="n">MiscUtil</span><span class="o">.</span><span class="n">GetExamplesTextFromDocOptText</span><span class="p">(</span><span class="n">_docoptUsage_</span><span class="p">))</span>
 1737         <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
 1738 
 1739 <span class="k">def</span> <span class="nf">ValidateOptions</span><span class="p">():</span>
 1740     <span class="sd">&quot;&quot;&quot;Validate option values&quot;&quot;&quot;</span>
 1741     
 1742     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--allowEmptyObjects&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--allowEmptyObjects&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
 1743 
 1744     <span class="c1"># Expand infiles to handle presence of multiple input files...</span>
 1745     <span class="n">InfileNames</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ExpandFileNames</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--infiles&quot;</span><span class="p">],</span> <span class="s2">&quot;,&quot;</span><span class="p">)</span>
 1746     <span class="n">InfilesCount</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">InfileNames</span><span class="p">)</span>
 1747     <span class="k">if</span> <span class="ow">not</span> <span class="n">InfilesCount</span><span class="p">:</span>
 1748         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;No input files specified for </span><span class="se">\&quot;</span><span class="s2">-i, --infiles</span><span class="se">\&quot;</span><span class="s2"> option&quot;</span><span class="p">)</span>
 1749 
 1750     <span class="c1"># Validate file extensions...</span>
 1751     <span class="k">for</span> <span class="n">Infile</span> <span class="ow">in</span> <span class="n">InfileNames</span><span class="p">:</span>
 1752         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFilePath</span><span class="p">(</span><span class="s2">&quot;-i, --infiles&quot;</span><span class="p">,</span> <span class="n">Infile</span><span class="p">)</span>
 1753         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFileExt</span><span class="p">(</span><span class="s2">&quot;-i, --infiles&quot;</span><span class="p">,</span> <span class="n">Infile</span><span class="p">,</span> <span class="s2">&quot;pdb cif&quot;</span><span class="p">)</span>
 1754         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionsDistinctFileNames</span><span class="p">(</span><span class="s2">&quot;-i, --infiles&quot;</span><span class="p">,</span> <span class="n">Infile</span><span class="p">,</span> <span class="s2">&quot;-o, --outfile&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--outfile&quot;</span><span class="p">])</span>
 1755     
 1756     <span class="c1"># Validate file count...</span>
 1757     <span class="k">if</span> <span class="n">InfilesCount</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
 1758         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;Number of input files, </span><span class="si">%s</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="s2">-i, --infiles</span><span class="se">\&quot;</span><span class="s2"> option is not valid. Number of allowed files: 1 or 2&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">InfilesCount</span><span class="p">))</span>
 1759 
 1760     <span class="c1"># Validate distinct file names...</span>
 1761     <span class="k">if</span> <span class="n">InfilesCount</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
 1762         <span class="n">Infile1Name</span><span class="p">,</span> <span class="n">Infile2Name</span> <span class="o">=</span> <span class="n">InfileNames</span>
 1763         <span class="n">Infile1Pattern</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;^&quot;</span> <span class="o">+</span> <span class="n">re</span><span class="o">.</span><span class="n">escape</span><span class="p">(</span><span class="n">Infile1Name</span><span class="p">)</span> <span class="o">+</span> <span class="sa">r</span><span class="s2">&quot;$&quot;</span><span class="p">;</span>
 1764         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">Infile1Pattern</span><span class="p">,</span> <span class="n">Infile2Name</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1765             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The file names specified, </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">, for option </span><span class="se">\&quot;</span><span class="s2">-i, --infiles</span><span class="se">\&quot;</span><span class="s2"> must be different.</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--infiles&quot;</span><span class="p">]))</span>
 1766         
 1767     <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--infileNames&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">InfileNames</span>
 1768     
 1769     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFileExt</span><span class="p">(</span><span class="s2">&quot;-o, --outfile&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--outfile&quot;</span><span class="p">],</span> <span class="s2">&quot;pml pse&quot;</span><span class="p">)</span>
 1770     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionsOutputFileOverwrite</span><span class="p">(</span><span class="s2">&quot;-o, --outfile&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--outfile&quot;</span><span class="p">],</span> <span class="s2">&quot;--overwrite&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--overwrite&quot;</span><span class="p">])</span>
 1771 
 1772     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFloatValue</span><span class="p">(</span><span class="s2">&quot;--interfaceContactsCutoff&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--interfaceContactsCutoff&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s2">&quot;&gt;&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">})</span>
 1773     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--interfaceHydrophobicContacts&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--interfaceHydrophobicContacts&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
 1774     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--interfacePolarContacts&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--interfacePolarContacts&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
 1775     
 1776     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--interfaceResidueTypes&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--interfaceResidueTypes&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no auto&quot;</span><span class="p">)</span>
 1777     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--interfaceSurface&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--interfaceSurface&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no auto&quot;</span><span class="p">)</span>
 1778     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--interfaceSurfaceElectrostatics&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--interfaceSurfaceElectrostatics&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no auto&quot;</span><span class="p">)</span>
 1779                        
 1780     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionIntegerValue</span><span class="p">(</span><span class="s2">&quot;--labelFontID&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--labelFontID&quot;</span><span class="p">],</span> <span class="p">{})</span>
 1781     
 1782     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--method&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--method&quot;</span><span class="p">],</span> <span class="s2">&quot;BySASAChange ByHeavyAtomsDistance ByCAlphaAtomsDistance&quot;</span><span class="p">)</span>
 1783     <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--methodCutoff&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1784         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFloatValue</span><span class="p">(</span><span class="s2">&quot;--methodCutoff&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--methodCutoff&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s2">&quot;&gt;&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">})</span>
 1785     
 1786     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--PMLOut&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--PMLOut&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
 1787 
 1788     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--surfaceChain&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceChain&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no auto&quot;</span><span class="p">)</span>
 1789     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--surfaceChainElectrostatics&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceChainElectrostatics&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no auto&quot;</span><span class="p">)</span>
 1790     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--surfaceComplex&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceComplex&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
 1791     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--surfaceChainComplex&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceChainComplex&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
 1792     
 1793     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--surfaceColorPalette&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceColorPalette&quot;</span><span class="p">],</span> <span class="s2">&quot;RedToWhite WhiteToGreen&quot;</span><span class="p">)</span>
 1794     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFloatValue</span><span class="p">(</span><span class="s2">&quot;--surfaceTransparency&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceTransparency&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s2">&quot;&gt;=&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s2">&quot;&lt;=&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">})</span>
 1795     
 1796 <span class="c1"># Setup a usage string for docopt...</span>
 1797 <span class="n">_docoptUsage_</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
 1798 <span class="s2">PyMOLVisualizeInterfaces.py - Visualize macromolecular interfaces</span>
 1799 
 1800 <span class="s2">Usage:</span>
 1801 <span class="s2">    PyMOLVisualizeInterfaces.py [--allowEmptyObjects &lt;yes or no&gt;] [--chainIDs &lt;ChainID1 or ChainID1,ChainID2&gt;]</span>
 1802 <span class="s2">                                              [--interfaceLabelColor &lt;text&gt;] [ --interfaceContactsCutoff &lt;number&gt;]</span>
 1803 <span class="s2">                                              [--interfaceHydrophobicContacts &lt;yes or no&gt;] [--interfaceHydrophobicContactsColor &lt;text&gt;]</span>
 1804 <span class="s2">                                              [--interfacePolarContacts &lt;yes or no&gt;] [--interfacePolarContactsColor &lt;text&gt;]</span>
 1805 <span class="s2">                                              [--interfaceResidueTypes &lt;yes or no&gt;] [--interfaceSurface &lt;yes or no&gt;]</span>
 1806 <span class="s2">                                              [--interfaceSurfaceElectrostatics &lt;yes or no&gt;] [--labelFontID &lt;number&gt;]</span>
 1807 <span class="s2">                                              [--ligandIDs &lt;Largest, All, None or ID1,ID2...&gt;] [--method &lt;text&gt;] [--methodCutoff &lt;number&gt;]</span>
 1808 <span class="s2">                                              [--PMLOut &lt;yes or no&gt;] [--residueTypes &lt;Type,Color,ResNames,...&gt;] [--surfaceChain &lt;yes or no&gt;]</span>
 1809 <span class="s2">                                              [--surfaceChainElectrostatics &lt;yes or no&gt;] [--surfaceChainComplex &lt;yes or no&gt;]</span>
 1810 <span class="s2">                                              [--surfaceComplex &lt;yes or no&gt;] [--surfaceColors &lt;ColorName1,ColorName2&gt;]</span>
 1811 <span class="s2">                                              [--surfaceColorPalette &lt;RedToWhite or WhiteToGreen&gt;]</span>
 1812 <span class="s2">                                              [--surfaceAtomTypesColors &lt;ColorType,ColorSpec,...&gt;] [--surfaceTransparency &lt;number&gt;]</span>
 1813 <span class="s2">                                              [--overwrite] [-w &lt;dir&gt;] -i &lt;infile1,...&gt; -o &lt;outfile&gt;</span>
 1814 <span class="s2">    PyMOLVisualizeInterfaces.py -h | --help | -e | --examples</span>
 1815 
 1816 <span class="s2">Description:</span>
 1817 <span class="s2">    Generate PyMOL visualization files for viewing interfaces between macromolecules</span>
 1818 <span class="s2">    including proteins and nucleic acids. The interfaces may be generated between</span>
 1819 <span class="s2">    pairs of chains in a single file or across two different files.</span>
 1820 
 1821 <span class="s2">    The supported input file format are: PDB (.pdb), CIF (.cif)</span>
 1822 
 1823 <span class="s2">    The supported output file formats are: PyMOL script file (.pml), PyMOL session</span>
 1824 <span class="s2">    file (.pse)</span>
 1825 
 1826 <span class="s2">    A variety of PyMOL groups and objects may be  created for visualization of</span>
 1827 <span class="s2">    macromolecular interfaces. These groups and objects correspond to complexes,</span>
 1828 <span class="s2">    surfaces, chains, ligands, and interfaces. A complete hierarchy of all possible</span>
 1829 <span class="s2">    PyMOL groups and objects is shown below:</span>
 1830 
 1831 <span class="s2">        &lt;PDBFileRoot&gt;</span>
 1832 <span class="s2">            .Complex</span>
 1833 <span class="s2">                .Complex</span>
 1834 <span class="s2">                .Surface</span>
 1835 <span class="s2">            .Chain&lt;ID&gt;</span>
 1836 <span class="s2">                .Complex</span>
 1837 <span class="s2">                    .Complex</span>
 1838 <span class="s2">                    .Surface</span>
 1839 <span class="s2">                .Chain</span>
 1840 <span class="s2">                    .Chain</span>
 1841 <span class="s2">                    .NonInterface</span>
 1842 <span class="s2">                        .Chain</span>
 1843 <span class="s2">                        .Surface</span>
 1844 <span class="s2">                            .Surface</span>
 1845 <span class="s2">                            .Hydrophobicity</span>
 1846 <span class="s2">                            .Hydrophobicity_Charge</span>
 1847 <span class="s2">                            .Vacuum_Electrostatics</span>
 1848 <span class="s2">                                .Contact_Potentials</span>
 1849 <span class="s2">                                .Map</span>
 1850 <span class="s2">                                .Legend</span>
 1851 <span class="s2">                                .Volume</span>
 1852 <span class="s2">                .Solvent</span>
 1853 <span class="s2">                .Inorganic</span>
 1854 <span class="s2">                .Ligand&lt;ID&gt;</span>
 1855 <span class="s2">                    .Ligand</span>
 1856 <span class="s2">                        .Ligand</span>
 1857 <span class="s2">                        .BallAndStick</span>
 1858 <span class="s2">                .Ligand&lt;ID&gt;</span>
 1859 <span class="s2">                    .Ligand</span>
 1860 <span class="s2">                        ... ... ...</span>
 1861 <span class="s2">            .Chain&lt;ID&gt;</span>
 1862 <span class="s2">                ... ... ...</span>
 1863 <span class="s2">                .Ligand&lt;ID&gt;</span>
 1864 <span class="s2">                    ... ... ...</span>
 1865 <span class="s2">                .Ligand&lt;ID&gt;</span>
 1866 <span class="s2">                    ... ... ...</span>
 1867 <span class="s2">            .Chain&lt;ID&gt;</span>
 1868 <span class="s2">                ... ... ...</span>
 1869 <span class="s2">        &lt;PDBFileRoot&gt;</span>
 1870 <span class="s2">            .Complex</span>
 1871 <span class="s2">                ... ... ...</span>
 1872 <span class="s2">            .Chain&lt;ID&gt;</span>
 1873 <span class="s2">                ... ... ...</span>
 1874 <span class="s2">                .Ligand&lt;ID&gt;</span>
 1875 <span class="s2">                    ... ... ...</span>
 1876 <span class="s2">                .Ligand&lt;ID&gt;</span>
 1877 <span class="s2">                    ... ... ...</span>
 1878 <span class="s2">            .Chain&lt;ID&gt;</span>
 1879 <span class="s2">                ... ... ...</span>
 1880 <span class="s2">        &lt;Interfaces&gt;</span>
 1881 <span class="s2">            .Chain&lt;IDs1&gt;_Chain&lt;IDs2&gt;</span>
 1882 <span class="s2">                .Polar_Contacts</span>
 1883 <span class="s2">                .Hydrophobic_Contacts</span>
 1884 <span class="s2">                .Chain&lt;ID&gt; or Chain&lt;ID&gt;_&lt;PDBFileRoot&gt;</span>
 1885 <span class="s2">                    .Chain</span>
 1886 <span class="s2">                    .Residues</span>
 1887 <span class="s2">                        .Aromatic</span>
 1888 <span class="s2">                            .Residues</span>
 1889 <span class="s2">                            .Surface</span>
 1890 <span class="s2">                        .Hydrophobic</span>
 1891 <span class="s2">                            .Residues</span>
 1892 <span class="s2">                            .Surface</span>
 1893 <span class="s2">                        .Polar</span>
 1894 <span class="s2">                            .Residues</span>
 1895 <span class="s2">                            .Surface</span>
 1896 <span class="s2">                        .Positively_Charged</span>
 1897 <span class="s2">                            .Residues</span>
 1898 <span class="s2">                            .Surface</span>
 1899 <span class="s2">                        .Negatively_Charged</span>
 1900 <span class="s2">                            .Residues</span>
 1901 <span class="s2">                            .Surface</span>
 1902 <span class="s2">                        .Other</span>
 1903 <span class="s2">                            .Residues</span>
 1904 <span class="s2">                            .Surface</span>
 1905 <span class="s2">                    .Surface</span>
 1906 <span class="s2">                        .Surface</span>
 1907 <span class="s2">                        .Hydrophobicity</span>
 1908 <span class="s2">                        .Hydrophobicity_Charge</span>
 1909 <span class="s2">                        .Vacuum_Electrostatics</span>
 1910 <span class="s2">                            .Contact_Potentials</span>
 1911 <span class="s2">                            .Map</span>
 1912 <span class="s2">                            .Legend</span>
 1913 <span class="s2">                            .Volume</span>
 1914 <span class="s2">                .Chain&lt;ID&gt; or &lt;PDBFileRoot&gt;_Chain&lt;ID&gt;</span>
 1915 <span class="s2">                    .Chain</span>
 1916 <span class="s2">                    .Residues</span>
 1917 <span class="s2">                        ... ... ...</span>
 1918 <span class="s2">                    .Surface</span>
 1919 <span class="s2">                        ... ... ...</span>
 1920 <span class="s2">            .Chain&lt;IDs&gt;_Chain&lt;IDs&gt;</span>
 1921 <span class="s2">                .Polar_Contacts</span>
 1922 <span class="s2">                .Hydrophobic_Contacts</span>
 1923 <span class="s2">                .Chain&lt;ID&gt; or Chain&lt;ID&gt;_&lt;PDBFileRoot&gt;</span>
 1924 <span class="s2">                    .Chain</span>
 1925 <span class="s2">                    .Residues</span>
 1926 <span class="s2">                        ... ... ...</span>
 1927 <span class="s2">                    .Surface</span>
 1928 <span class="s2">                        ... ... ...</span>
 1929 <span class="s2">                .Chain&lt;ID&gt; or Chain&lt;ID&gt;_&lt;PDBFileRoot&gt;</span>
 1930 <span class="s2">                    .Chain</span>
 1931 <span class="s2">                    .Residues</span>
 1932 <span class="s2">                        ... ... ...</span>
 1933 <span class="s2">                    .Surface</span>
 1934 <span class="s2">                        ... ... ...</span>
 1935 <span class="s2">    </span>
 1936 <span class="s2">    The hydrophobic and electrostatic surfaces are not created for complete complex</span>
 1937 <span class="s2">    and chain complex in input file(s) by default. A word to the wise: The creation of</span>
 1938 <span class="s2">    surface objects may slow down loading of PML file and generation of PSE file, based</span>
 1939 <span class="s2">    on the size of input complexes. The generation of PSE file may also fail.</span>
 1940 
 1941 <span class="s2">Options:</span>
 1942 <span class="s2">    --allowEmptyObjects &lt;yes or no&gt;  [default: no]</span>
 1943 <span class="s2">        Allow creation of empty PyMOL objects corresponding to interface,</span>
 1944 <span class="s2">        solvent, and inorganic atom selections across chains and ligands in</span>
 1945 <span class="s2">        input file(s). By default, the empty objects are marked for deletion.</span>
 1946 <span class="s2">    -c, --chainIDs &lt;ChainID1,ChainD2,...&gt;  [default: Auto]</span>
 1947 <span class="s2">        Pairwise comma delimited list of chain IDs for the identification of</span>
 1948 <span class="s2">        macromolecular interfaces. All chain IDs must be present in the</span>
 1949 <span class="s2">        same file for a single input file. Otherwise, the first and second</span>
 1950 <span class="s2">        chain ID(s) in a pair belong to the first and second input file.</span>
 1951 <span class="s2">        </span>
 1952 <span class="s2">        The default values for interface chain IDs depend on the number</span>
 1953 <span class="s2">        of input files as shown below:</span>
 1954 <span class="s2">        </span>
 1955 <span class="s2">        One input file: First two chains</span>
 1956 <span class="s2">        Two input files: First chain in each input file</span>
 1957 <span class="s2">        </span>
 1958 <span class="s2">        Each chain may contain multiple chain IDs delimited by a plus sign. For</span>
 1959 <span class="s2">        example, A+B,C+D chain pair specifies interface between chain complexes</span>
 1960 <span class="s2">        A+B and C+D in first input file or across two input files.</span>
 1961 <span class="s2">    -e, --examples</span>
 1962 <span class="s2">        Print examples.</span>
 1963 <span class="s2">    -h, --help</span>
 1964 <span class="s2">        Print this help message.</span>
 1965 <span class="s2">    -i, --infiles &lt;infile or infile1,infile2&gt;</span>
 1966 <span class="s2">        Name of an input file or a comma delmited list of names for two input</span>
 1967 <span class="s2">        files.</span>
 1968 <span class="s2">    --interfaceLabelColor &lt;text&gt;  [default: magenta]</span>
 1969 <span class="s2">        Color for drawing residue or atom level labels for residues in an interface.</span>
 1970 <span class="s2">        The specified value must be valid color. No validation is performed.</span>
 1971 <span class="s2">    --interfaceContactsCutoff &lt;number&gt;  [default: 4.0]</span>
 1972 <span class="s2">        Distance in Angstroms for identifying polar and hyrdophobic contacts</span>
 1973 <span class="s2">        between atoms in interface reisudes.</span>
 1974 <span class="s2">    --interfaceHydrophobicContacts &lt;yes or no&gt;  [default: yes]</span>
 1975 <span class="s2">        Hydrophobic contacts between residues in an interface. The hydrophobic</span>
 1976 <span class="s2">        contacts are shown between pairs of carbon atoms not connected to</span>
 1977 <span class="s2">        hydrogen bond donor or acceptors atoms as identified by PyMOL.</span>
 1978 <span class="s2">    --interfaceHydrophobicContactsColor &lt;text&gt;  [default: purpleblue]</span>
 1979 <span class="s2">        Color for drawing hydrophobic contacts between residues in an interface.</span>
 1980 <span class="s2">        The specified value must be valid color. No validation is performed.</span>
 1981 <span class="s2">    --interfacePolarContacts &lt;yes or no&gt;  [default: yes]</span>
 1982 <span class="s2">        Polar contacts between residues in an interface.</span>
 1983 <span class="s2">    --interfacePolarContactsColor &lt;text&gt;  [default: orange]</span>
 1984 <span class="s2">        Color for drawing polar contacts between residues in an interface.</span>
 1985 <span class="s2">        The specified value must be valid color. No validation is performed.</span>
 1986 <span class="s2">    --interfaceResidueTypes &lt;yes or no&gt;  [default: auto]</span>
 1987 <span class="s2">        Interface residue types. The residue groups are generated using residue types,</span>
 1988 <span class="s2">        colors, and names specified by &#39;--residueTypes&#39; option. It is only valid for</span>
 1989 <span class="s2">        amino acids.  By default, the residue type groups are automatically created</span>
 1990 <span class="s2">        for interfaces containing amino acids and skipped for chains only containing</span>
 1991 <span class="s2">        nucleic acids.</span>
 1992 <span class="s2">    --interfaceSurface &lt;yes or no&gt;  [default: auto]</span>
 1993 <span class="s2">        Surfaces around interface residues colored by hydrophobicity alone and</span>
 1994 <span class="s2">        both hydrophobicity and charge. The hydrophobicity surface is colored</span>
 1995 <span class="s2">        at residue level using Eisenberg hydrophobicity scale for residues and color</span>
 1996 <span class="s2">        gradient specified by &#39;--surfaceColorPalette&#39; option. The  hydrophobicity and</span>
 1997 <span class="s2">        charge surface is colored [ Ref 140 ] at atom level using colors specified for</span>
 1998 <span class="s2">        groups of atoms by &#39;--surfaceAtomTypesColors&#39; option. This scheme allows</span>
 1999 <span class="s2">        simultaneous mapping of hyrophobicity and charge values on the surfaces.</span>
 2000 <span class="s2">        </span>
 2001 <span class="s2">        This option is only valid for amino acids. By default, both surfaces are</span>
 2002 <span class="s2">        automatically created for pockets containing amino acids and skipped for</span>
 2003 <span class="s2">        pockets containing only nucleic acids.</span>
 2004 <span class="s2">        </span>
 2005 <span class="s2">        In addition, generic surfaces colored by &#39;--surfaceColors&#39; are always created</span>
 2006 <span class="s2">        for interface residues containing amino acids and nucleic acids.</span>
 2007 <span class="s2">    --interfaceSurfaceElectrostatics &lt;yes or no&gt;  [default: no]</span>
 2008 <span class="s2">        Vacuum electrostatics contact potential surface around interface residues.</span>
 2009 <span class="s2">        A word to the wise from PyMOL documentation: The computed protein</span>
 2010 <span class="s2">        contact potentials are only qualitatively useful, due to short cutoffs,</span>
 2011 <span class="s2">        truncation, and lack of solvent &quot;screening&quot;.</span>
 2012 <span class="s2">        </span>
 2013 <span class="s2">        This option is only valid for amino acids. By default, the electrostatics surface</span>
 2014 <span class="s2">        is automatically created for chains containing amino acids and skipped for chains</span>
 2015 <span class="s2">        containing only nucleic acids.</span>
 2016 <span class="s2">    --labelFontID &lt;number&gt;  [default: 7]</span>
 2017 <span class="s2">        Font ID for drawing labels. Default: 7 (Sans Bold). Valid values: 5 to 16.</span>
 2018 <span class="s2">        The specified value must be a valid PyMOL font ID. No validation is</span>
 2019 <span class="s2">        performed. The complete lists of valid font IDs is available at:</span>
 2020 <span class="s2">        pymolwiki.org/index.php/Label_font_id. Examples: 5 - Sans;</span>
 2021 <span class="s2">        7 - Sans Bold; 9 - Serif; 10 - Serif Bold.</span>
 2022 <span class="s2">    -l, --ligandIDs &lt;Largest, All, None or ID1,ID2...&gt;  [default: All]</span>
 2023 <span class="s2">        List of ligand IDs to show in chains during visualization of interfaces. Possible</span>
 2024 <span class="s2">        values: Largest, All, None, or a comma delimited list of ligand IDs. The</span>
 2025 <span class="s2">        default is to show all ligands present in chains involved in interfaces.</span>
 2026 <span class="s2">        </span>
 2027 <span class="s2">        Ligands are identified using organic selection operator available in PyMOL.</span>
 2028 <span class="s2">        It&#39;ll also  identify buffer molecules as ligands. The largest ligand contains</span>
 2029 <span class="s2">        the highest number of heavy atoms.</span>
 2030 <span class="s2">    -m, --method &lt;text&gt;  [default: BySASAChange]</span>
 2031 <span class="s2">        Methodology for the identification of interface residues between a pair</span>
 2032 <span class="s2">        of chains in an input file. The interface residues may be identified by</span>
 2033 <span class="s2">        change in solvent accessible surface area (SASA) for a residue between</span>
 2034 <span class="s2">        a chain and chains complex, distance between heavy atoms</span>
 2035 <span class="s2">        in two chains, or distance between CAlpha atoms. Possible values:</span>
 2036 <span class="s2">        BySASAChange, ByHeavyAtomsDistance, or ByCAlphaAtomsDistance. </span>
 2037 <span class="s2">    --methodCutoff &lt;number&gt;  [default: auto]</span>
 2038 <span class="s2">        Cutoff value used by different methodologies during the identification of</span>
 2039 <span class="s2">        interface residues between a pair of chains. The default values are</span>
 2040 <span class="s2">        shown below:</span>
 2041 <span class="s2">        </span>
 2042 <span class="s2">            BySASAChange: 1.0; Units: Angstrom**2 [ Ref 141 ]</span>
 2043 <span class="s2">            ByHeavyAtomsDistance: 5.0; Units: Angstrom [ Ref 142 ]</span>
 2044 <span class="s2">            ByCAlphaAtomsDistance: 8.0; Units: Angstrom [ Ref 143 ]</span>
 2045 <span class="s2">        </span>
 2046 <span class="s2">    -o, --outfile &lt;outfile&gt;</span>
 2047 <span class="s2">        Output file name.</span>
 2048 <span class="s2">    -p, --PMLOut &lt;yes or no&gt;  [default: yes]</span>
 2049 <span class="s2">        Save PML file during generation of PSE file.</span>
 2050 <span class="s2">    -r, --residueTypes &lt;Type,Color,ResNames,...&gt;  [default: auto]</span>
 2051 <span class="s2">        Residue types, colors, and names to generate for residue groups during</span>
 2052 <span class="s2">        and &#39;--residueTypesChain&#39; option. It is only valid for amino acids.</span>
 2053 <span class="s2">        </span>
 2054 <span class="s2">        It is a triplet of comma delimited list of amino acid residues type, residues</span>
 2055 <span class="s2">        color, and a space delimited list three letter residue names. </span>
 2056 <span class="s2">        </span>
 2057 <span class="s2">        The default values for residue type, color, and name triplets  are shown</span>
 2058 <span class="s2">        below:</span>
 2059 <span class="s2">            </span>
 2060 <span class="s2">            Aromatic,brightorange,HIS PHE TRP TYR,</span>
 2061 <span class="s2">            Hydrophobic,orange,ALA GLY VAL LEU ILE PRO MET,</span>
 2062 <span class="s2">            Polar,palegreen,ASN GLN SER THR CYS,</span>
 2063 <span class="s2">            Positively_Charged,marine,ARG LYS,</span>
 2064 <span class="s2">            Negatively_Charged,red,ASP GLU</span>
 2065 <span class="s2">            </span>
 2066 <span class="s2">        The color name must be a valid PyMOL name. No validation is performed.</span>
 2067 <span class="s2">        An amino acid name may appear across multiple residue types. All other</span>
 2068 <span class="s2">        residues are grouped under &#39;Other&#39;.</span>
 2069 <span class="s2">    --surfaceChain &lt;yes or no&gt;  [default: auto]</span>
 2070 <span class="s2">        Surfaces around non-interface residues in individual  chain colored by</span>
 2071 <span class="s2">        hydrophobicity alone and both hydrophobicity and charge. The hydrophobicity</span>
 2072 <span class="s2">        surface is colored at residue level using Eisenberg hydrophobicity scale for residues</span>
 2073 <span class="s2">        and color gradient specified by &#39;--surfaceColorPalette&#39; option. The  hydrophobicity</span>
 2074 <span class="s2">        and charge surface is colored [ Ref 140 ] at atom level using colors specified for</span>
 2075 <span class="s2">        groups of atoms by &#39;--surfaceAtomTypesColors&#39; option. This scheme allows</span>
 2076 <span class="s2">        simultaneous mapping of hyrophobicity and charge values on the surfaces.</span>
 2077 <span class="s2">        </span>
 2078 <span class="s2">        This option is only valid for amino acids. By default, both surfaces are</span>
 2079 <span class="s2">        automatically created for chains containing amino acids and skipped for</span>
 2080 <span class="s2">        chains containing only nucleic acids.</span>
 2081 <span class="s2">        </span>
 2082 <span class="s2">        In addition, generic surfaces colored by &#39;--surfaceColors&#39; are always created</span>
 2083 <span class="s2">        for non-interface residues containing amino acids and nucleic acids.</span>
 2084 <span class="s2">    --surfaceChainElectrostatics &lt;yes or no&gt;  [default: no]</span>
 2085 <span class="s2">        Vacuum electrostatics contact potential surface and volume around non-interface</span>
 2086 <span class="s2">        residues in individual chain. A word to the wise from PyMOL documentation: The</span>
 2087 <span class="s2">        computed protein contact potentials are only qualitatively useful, due to short cutoffs,</span>
 2088 <span class="s2">        truncation, and lack of solvent &quot;screening&quot;.</span>
 2089 <span class="s2">        </span>
 2090 <span class="s2">        This option is only valid for amino acids. By default, the electrostatics surface</span>
 2091 <span class="s2">        and volume are automatically created for chains containing amino acids and</span>
 2092 <span class="s2">        skipped for chains containing only nucleic acids.</span>
 2093 <span class="s2">    --surfaceChainComplex &lt;yes or no&gt;  [default: no]</span>
 2094 <span class="s2">        Hydrophobic surface around chain complex. The  surface is colored by</span>
 2095 <span class="s2">        hydrophobicity. It is only valid for amino acids.</span>
 2096 <span class="s2">    --surfaceComplex &lt;yes or no&gt;  [default: no]</span>
 2097 <span class="s2">        Hydrophobic surface around complete complex. The  surface is colored by</span>
 2098 <span class="s2">        hydrophobicity. It is only valid for amino acids.</span>
 2099 <span class="s2">    --surfaceColors &lt;ColorName1,ColorName2&gt;  [default: salmon,lightblue]</span>
 2100 <span class="s2">        Color names for surfaces around interface residues and non-interface</span>
 2101 <span class="s2">        residues in chains. These colors are not used for surfaces colored by</span>
 2102 <span class="s2">        hydrophobicity and charge. The color names must be valid PyMOL names.</span>
 2103 <span class="s2">    --surfaceColorPalette &lt;RedToWhite or WhiteToGreen&gt;  [default: RedToWhite]</span>
 2104 <span class="s2">        Color palette for hydrophobic surfaces around chains and interface residues</span>
 2105 <span class="s2">        in proteins. Possible values: RedToWhite or WhiteToGreen from most</span>
 2106 <span class="s2">        hydrophobic amino acid to least hydrophobic. The colors values for amino</span>
 2107 <span class="s2">        acids are taken from color_h script available as part of the Script Library at</span>
 2108 <span class="s2">        PyMOL Wiki.</span>
 2109 <span class="s2">    --surfaceAtomTypesColors &lt;ColorType,ColorSpec,...&gt;  [default: auto]</span>
 2110 <span class="s2">        Atom colors for generating surfaces colored by hyrophobicity and charge</span>
 2111 <span class="s2">        around chains and interface residues in proteins. It&#39;s a pairwise comma</span>
 2112 <span class="s2">        delimited list of atom color type and color specification for goups of atoms.</span>
 2113 <span class="s2">        </span>
 2114 <span class="s2">        The default values for color types [ Ref 140 ] along wth color specifications</span>
 2115 <span class="s2">        are shown below: </span>
 2116 <span class="s2">            </span>
 2117 <span class="s2">            HydrophobicAtomsColor, yellow,</span>
 2118 <span class="s2">            NegativelyChargedAtomsColor, red,</span>
 2119 <span class="s2">            PositivelyChargedAtomsColor, blue,</span>
 2120 <span class="s2">            OtherAtomsColor, gray90</span>
 2121 <span class="s2">            </span>
 2122 <span class="s2">        The color names must be valid PyMOL names.</span>
 2123 <span class="s2">        </span>
 2124 <span class="s2">        The color values may also be specified as space delimited RGB triplets:</span>
 2125 <span class="s2">             </span>
 2126 <span class="s2">            HydrophobicAtomsColor, 0.95 0.78 0.0,</span>
 2127 <span class="s2">            NegativelyChargedAtomsColor, 1.0 0.4 0.4,</span>
 2128 <span class="s2">            PositivelyChargedAtomsColor, 0.2 0.5 0.8,</span>
 2129 <span class="s2">            OtherAtomsColor, 0.95 0.95 0.95</span>
 2130 <span class="s2">            </span>
 2131 <span class="s2">    --surfaceTransparency &lt;number&gt;  [default: 0.25]</span>
 2132 <span class="s2">        Surface transparency for molecular surfaces.</span>
 2133 <span class="s2">    --overwrite</span>
 2134 <span class="s2">        Overwrite existing files.</span>
 2135 <span class="s2">    -w, --workingdir &lt;dir&gt;</span>
 2136 <span class="s2">        Location of working directory which defaults to the current directory.</span>
 2137 
 2138 <span class="s2">Examples:</span>
 2139 <span class="s2">    To visualize interface residues between the first two chains in a PDB file,</span>
 2140 <span class="s2">    using default methodology to identify interfaces, and and generate a PML</span>
 2141 <span class="s2">    file, type: </span>
 2142 
 2143 <span class="s2">        % PyMOLVisualizeInterfaces.py -i Sample8.pdb -o Sample8.pml</span>
 2144 
 2145 <span class="s2">    To visualize interface residues between a pair of specific chains in a PDB</span>
 2146 <span class="s2">    file using a specific methodology and cutoff value to identify interfaces, and</span>
 2147 <span class="s2">    generate a PML file, type: </span>
 2148 
 2149 <span class="s2">        % PyMOLVisualizeInterfaces.py -m BySASAChange --methodCutoff 1.0</span>
 2150 <span class="s2">        -c &quot;A,B&quot; -i Sample8.pdb -o Sample8.pml</span>
 2151 
 2152 <span class="s2">    To visualize interface residues between multiple pairs of specified chains in</span>
 2153 <span class="s2">    a PDB file using a specific methodology and cutoff value to identify interfaces,</span>
 2154 <span class="s2">    and generate a PML file, type: </span>
 2155 
 2156 <span class="s2">        % PyMOLVisualizeInterfaces.py -m ByHeavyAtomsDistance</span>
 2157 <span class="s2">        --methodCutoff 5.0 -c &quot;A,B,B,D&quot; -i Sample8.pdb -o Sample8.pml</span>
 2158 
 2159 <span class="s2">    To visualize interface residues between a pair of specified chains, each member</span>
 2160 <span class="s2">    containing multiple chains, a PDB file using a specific methodology and cutoff</span>
 2161 <span class="s2">    value to identify interfaces, and generate a PML file, type: </span>
 2162 
 2163 <span class="s2">        % PyMOLVisualizeInterfaces.py -m ByCAlphaAtomsDistance</span>
 2164 <span class="s2">        --methodCutoff 8.0 -c &quot;A+C,B+D&quot; -i Sample8.pdb -o Sample8.pml</span>
 2165 
 2166 <span class="s2">    To visualize interface residues between a pair of specific chains across two PDB</span>
 2167 <span class="s2">    files using a specific methodology and cutoff value to identify interfaces, and</span>
 2168 <span class="s2">    generate a PML file, type: </span>
 2169 
 2170 <span class="s2">        % PyMOLVisualizeInterfaces.py -m BySASAChange --methodCutoff 1.0 </span>
 2171 <span class="s2">        -c &quot;A,B&quot; -i Sample8Part1.pdb,Sample8Part2.pdb</span>
 2172 <span class="s2">        -o Sample8.pml</span>
 2173 
 2174 <span class="s2">    To visualize interface residues between multiple pairs of specified chains across</span>
 2175 <span class="s2">    two PDB files using a specific methodology and cutoff value to identify interfaces,</span>
 2176 <span class="s2">    and generate a PML file, type: </span>
 2177 
 2178 <span class="s2">        % PyMOLVisualizeInterfaces.py -m ByHeavyAtomsDistance</span>
 2179 <span class="s2">        --methodCutoff 5.0  -c &quot;A,B,C,B&quot; -i Sample8Part1.pdb,Sample8Part2.pdb</span>
 2180 <span class="s2">        -o Sample8.pml</span>
 2181 
 2182 <span class="s2">    To visualize interface residues between a pair of specified chains, each member</span>
 2183 <span class="s2">    containing multiple chains, across two PDB files using a specific methodology</span>
 2184 <span class="s2">    and cutoff value to identify interfaces, and generate a PML file, type:</span>
 2185 
 2186 <span class="s2">        % PyMOLVisualizeInterfaces.py -m ByCAlphaAtomsDistance</span>
 2187 <span class="s2">        --methodCutoff 8.0  -c &quot;A+C,B+D&quot; -i &quot;Sample8Part1.pdb,Sample8Part2.pdb&quot;</span>
 2188 <span class="s2">        -o Sample8.pml</span>
 2189 
 2190 <span class="s2">Author:</span>
 2191 <span class="s2">    Manish Sud(msud@san.rr.com)</span>
 2192 
 2193 <span class="s2">See also:</span>
 2194 <span class="s2">    DownloadPDBFiles.pl,  PyMOLVisualizeCryoEMDensity.py,</span>
 2195 <span class="s2">    PyMOLVisualizeElectronDensity.py, PyMOLVisualizeMacromolecules.py,</span>
 2196 <span class="s2">    PyMOLVisualizeSurfaceAndBuriedResidues.py</span>
 2197 
 2198 <span class="s2">Copyright:</span>
 2199 <span class="s2">    Copyright (C) 2020 Manish Sud. All rights reserved.</span>
 2200 
 2201 <span class="s2">    The functionality available in this script is implemented using PyMOL, a</span>
 2202 <span class="s2">    molecular visualization system on an open source foundation originally</span>
 2203 <span class="s2">    developed by Warren DeLano.</span>
 2204 
 2205 <span class="s2">    This file is part of MayaChemTools.</span>
 2206 
 2207 <span class="s2">    MayaChemTools is free software; you can redistribute it and/or modify it under</span>
 2208 <span class="s2">    the terms of the GNU Lesser General Public License as published by the Free</span>
 2209 <span class="s2">    Software Foundation; either version 3 of the License, or (at your option) any</span>
 2210 <span class="s2">    later version.</span>
 2211 
 2212 <span class="s2">&quot;&quot;&quot;</span>
 2213 
 2214 <span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
 2215     <span class="n">main</span><span class="p">()</span>
</pre>
<br />
<center>
<img src="../../../images/h2o2.png">
</center>
</body>
</html>
