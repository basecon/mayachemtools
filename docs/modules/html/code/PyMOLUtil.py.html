<html>
<head>
<title>MayaChemTools:Code:Python/PyMOLUtil.py</title>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<link rel="stylesheet" type="text/css" href="../../../css/MayaChemToolsPythonCode.css">
</head>
<body leftmargin="20" rightmargin="20" topmargin="10" bottommargin="10">
<br/>
<center>
<a href="http://www.mayachemtools.org" title="MayaChemTools Home"><img src="../../../images/MayaChemToolsLogo.gif" border="0" alt="MayaChemTools"></a>
</center>
<br/>
<pre>
    1 <span class="ch">#!/bin/env python</span>
    2 <span class="c1"># File: PyMOLUtil.py</span>
    3 <span class="c1"># Author: Manish Sud &lt;msud@san.rr.com&gt;</span>
    4 <span class="c1">#</span>
    5 <span class="c1"># Copyright (C) 2020 Manish Sud. All rights reserved.</span>
    6 <span class="c1">#</span>
    7 <span class="c1"># The functionality available in this file is implemented using PyMOL, a</span>
    8 <span class="c1"># molecular visualization system on an open source foundation originally</span>
    9 <span class="c1"># developed by Warren DeLano.</span>
   10 <span class="c1">#</span>
   11 <span class="c1"># This file is part of MayaChemTools.</span>
   12 <span class="c1">#</span>
   13 <span class="c1"># MayaChemTools is free software; you can redistribute it and/or modify it under</span>
   14 <span class="c1"># the terms of the GNU Lesser General Public License as published by the Free</span>
   15 <span class="c1"># Software Foundation; either version 3 of the License, or (at your option) any</span>
   16 <span class="c1"># later version.</span>
   17 <span class="c1">#</span>
   18 <span class="c1"># MayaChemTools is distributed in the hope that it will be useful, but without</span>
   19 <span class="c1"># any warranty; without even the implied warranty of merchantability of fitness</span>
   20 <span class="c1"># for a particular purpose.  See the GNU Lesser General Public License for more</span>
   21 <span class="c1"># details.</span>
   22 <span class="c1">#</span>
   23 <span class="c1"># You should have received a copy of the GNU Lesser General Public License</span>
   24 <span class="c1"># along with MayaChemTools; if not, see &lt;http://www.gnu.org/licenses/&gt; or</span>
   25 <span class="c1"># write to the Free Software Foundation Inc., 59 Temple Place, Suite 330,</span>
   26 <span class="c1"># Boston, MA, 02111-1307, USA.</span>
   27 <span class="c1">#</span>
   28 
   29 <span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
   30 
   31 <span class="kn">import</span> <span class="nn">os</span>
   32 <span class="kn">import</span> <span class="nn">sys</span>
   33 <span class="kn">import</span> <span class="nn">re</span>
   34 
   35 <span class="kn">from</span> <span class="nn">pymol</span> <span class="kn">import</span> <span class="n">cmd</span><span class="p">,</span> <span class="n">stored</span><span class="p">,</span> <span class="n">CmdException</span>
   36 
   37 <span class="kn">import</span> <span class="nn">MiscUtil</span>
   38 
   39 <span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;AreAminoAcidResiduesPresent&quot;</span><span class="p">,</span> <span class="s2">&quot;AreNucleicAcidResiduesPresent&quot;</span><span class="p">,</span> <span class="s2">&quot;CalculateCenterOfMass&quot;</span><span class="p">,</span> <span class="s2">&quot;ConvertFileFormat&quot;</span><span class="p">,</span> <span class="s2">&quot;ConvertPMLFileToPSEFile&quot;</span><span class="p">,</span> <span class="s2">&quot;GetChains&quot;</span><span class="p">,</span> <span class="s2">&quot;GetChainsAndLigandsInfo&quot;</span><span class="p">,</span> <span class="s2">&quot;GetAminoAcidResiduesInfo&quot;</span><span class="p">,</span> <span class="s2">&quot;GetInorganicResiduesInfo&quot;</span><span class="p">,</span> <span class="s2">&quot;GetInterfaceChainsResiduesByCAlphaAtomsDistance&quot;</span><span class="p">,</span> <span class="s2">&quot;GetInterfaceChainsResiduesByHeavyAtomsDistance&quot;</span><span class="p">,</span> <span class="s2">&quot;GetInterfaceChainsResiduesBySASAChange&quot;</span><span class="p">,</span> <span class="s2">&quot;GetLargestLigand&quot;</span><span class="p">,</span> <span class="s2">&quot;GetLigandResiduesInfo&quot;</span><span class="p">,</span> <span class="s2">&quot;GetLigands&quot;</span><span class="p">,</span> <span class="s2">&quot;GetMolecules&quot;</span><span class="p">,</span> <span class="s2">&quot;GetNucleicAcidResiduesInfo&quot;</span><span class="p">,</span> <span class="s2">&quot;GetPocketInorganicResiduesInfo&quot;</span><span class="p">,</span> <span class="s2">&quot;GetPocketPolymerResiduesInfo&quot;</span><span class="p">,</span> <span class="s2">&quot;GetPocketSolventResiduesInfo&quot;</span><span class="p">,</span>  <span class="s2">&quot;GetPolymerResiduesInfo&quot;</span><span class="p">,</span> <span class="s2">&quot;GetPhiPsiResiduesInfo&quot;</span><span class="p">,</span> <span class="s2">&quot;GetPhiPsiChainsAndResiduesInfo&quot;</span><span class="p">,</span> <span class="s2">&quot;GetPhiPsiCategoriesResiduesInfo&quot;</span><span class="p">,</span> <span class="s2">&quot;GetSelectionResiduesInfo&quot;</span><span class="p">,</span> <span class="s2">&quot;GetSolventResiduesInfo&quot;</span><span class="p">,</span> <span class="s2">&quot;GetSurfaceResiduesInfo&quot;</span><span class="p">,</span> <span class="s2">&quot;ProcessChainsAndLigandsOptionsInfo&quot;</span><span class="p">,</span> <span class="s2">&quot;ProcessResidueTypesOptionsInfo&quot;</span><span class="p">,</span> <span class="s2">&quot;ProcessChainSelectionsOptionsInfo&quot;</span><span class="p">,</span> <span class="s2">&quot;ProcessSurfaceAtomTypesColorsOptionsInfo&quot;</span><span class="p">,</span> <span class="s2">&quot;SetupPMLForAlignment&quot;</span><span class="p">,</span> <span class="s2">&quot;SetupPMLForBFactorPuttyView&quot;</span><span class="p">,</span> <span class="s2">&quot;SetupPMLForBallAndStickView&quot;</span><span class="p">,</span> <span class="s2">&quot;SetupPMLForEnableDisable&quot;</span><span class="p">,</span> <span class="s2">&quot;SetupPMLForGroup&quot;</span><span class="p">,</span> <span class="s2">&quot;SetupPMLForHydrophobicSurfaceView&quot;</span><span class="p">,</span> <span class="s2">&quot;SetupPMLForHydrophobicAndChargeSurfaceView&quot;</span><span class="p">,</span> <span class="s2">&quot;SetupPMLForInorganicView&quot;</span><span class="p">,</span> <span class="s2">&quot;SetupPMLForLigandPocketInorganicView&quot;</span><span class="p">,</span> <span class="s2">&quot;SetupPMLForLigandPocketSolventView&quot;</span><span class="p">,</span> <span class="s2">&quot;SetupPMLForLigandPocketView&quot;</span><span class="p">,</span> <span class="s2">&quot;SetupPMLForLigandView&quot;</span><span class="p">,</span> <span class="s2">&quot;SetupPMLForPolarContactsView&quot;</span><span class="p">,</span> <span class="s2">&quot;SetupPMLForHydrophobicContactsView&quot;</span><span class="p">,</span> <span class="s2">&quot;SetupPMLForPolymerChainComplexView&quot;</span><span class="p">,</span> <span class="s2">&quot;SetupPMLForPolymerChainView&quot;</span><span class="p">,</span> <span class="s2">&quot;SetupPMLForPolymerComplexView&quot;</span><span class="p">,</span> <span class="s2">&quot;SetupPMLForSolventView&quot;</span><span class="p">,</span> <span class="s2">&quot;SetupPMLForSurfaceView&quot;</span><span class="p">,</span> <span class="s2">&quot;SetupPMLForSelectionDisplayView&quot;</span><span class="p">,</span> <span class="s2">&quot;SetupPMLHeaderInfo&quot;</span><span class="p">]</span>
   40 
   41 <span class="k">def</span> <span class="nf">GetMolecules</span><span class="p">(</span><span class="n">Selection</span> <span class="o">=</span> <span class="s2">&quot;all&quot;</span><span class="p">):</span>
   42     <span class="sd">&quot;&quot;&quot;Get names of molecule objects in a selection or all molecule objects.</span>
   43 
   44 <span class="sd">    Arguments:</span>
   45 <span class="sd">        Selection: (str): A PyMOL selection.</span>
   46 
   47 <span class="sd">    Returns:</span>
   48 <span class="sd">        list: Names of molecule objects.</span>
   49 
   50 <span class="sd">    &quot;&quot;&quot;</span>
   51     <span class="n">Names</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="n">get_object_list</span><span class="p">(</span><span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="n">Selection</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">)</span>
   52 
   53     <span class="k">return</span> <span class="n">Names</span>
   54 
   55 <span class="k">def</span> <span class="nf">GetChains</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">RemoveEmpty</span> <span class="o">=</span> <span class="bp">True</span><span class="p">):</span>
   56     <span class="sd">&quot;&quot;&quot;Get chain identifiers present in a molecule.</span>
   57 
   58 <span class="sd">    Arguments:</span>
   59 <span class="sd">        MoleculeName (str): Name of a PyMOL molecule object.</span>
   60 <span class="sd">        RemoveEmpty (bool): Remove empty chain ID from the list of chain IDs</span>
   61 <span class="sd">            returned by PyMOL.</span>
   62 
   63 <span class="sd">    Returns:</span>
   64 <span class="sd">        list: Names of chains present in a molecule, sorted alphabetically in a</span>
   65 <span class="sd">            ascending order.</span>
   66 
   67 <span class="sd">    &quot;&quot;&quot;</span>
   68     <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">):</span>
   69         <span class="k">return</span> <span class="bp">None</span>
   70 
   71     <span class="n">ChainIDs</span> <span class="o">=</span> <span class="p">[]</span>
   72     <span class="k">try</span><span class="p">:</span>
   73         <span class="n">ChainIDs</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="n">get_chains</span><span class="p">(</span><span class="s1">&#39;model </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">MoleculeName</span><span class="p">)</span>
   74     <span class="k">except</span> <span class="n">CmdException</span> <span class="k">as</span> <span class="n">ErrMsg</span><span class="p">:</span>
   75         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;PyMOLUtil.GetChains: Invalid molecule name: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">MoleculeName</span><span class="p">)</span>
   76 
   77     <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">ChainIDs</span><span class="p">):</span>
   78         <span class="k">return</span> <span class="bp">None</span>
   79 
   80     <span class="c1"># Remove empty Chain IDs from the list...</span>
   81     <span class="k">if</span> <span class="n">RemoveEmpty</span><span class="p">:</span>
   82         <span class="n">NonEmptyChainIDs</span> <span class="o">=</span> <span class="p">[]</span>
   83         <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">ChainIDs</span><span class="p">:</span>
   84             <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ChainID</span><span class="p">):</span>
   85                 <span class="n">NonEmptyChainIDs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ChainID</span><span class="p">)</span>
   86         <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">NonEmptyChainIDs</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ChainIDs</span><span class="p">):</span>
   87             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;PyMOLUtil.GetChains: Removing non-empty chain IDs from the list of chain IDs...&quot;</span><span class="p">)</span>
   88             
   89         <span class="n">ChainIDs</span> <span class="o">=</span> <span class="n">NonEmptyChainIDs</span>
   90         
   91     <span class="k">return</span> <span class="n">ChainIDs</span>
   92 
   93 <span class="k">def</span> <span class="nf">GetChainsAndLigandsInfo</span><span class="p">(</span><span class="n">Infile</span><span class="p">,</span> <span class="n">MolName</span><span class="p">,</span> <span class="n">Quite</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">LigandSortBy</span> <span class="o">=</span> <span class="s2">&quot;Size&quot;</span><span class="p">,</span> <span class="n">LigandSortOrder</span> <span class="o">=</span> <span class="s2">&quot;Auto&quot;</span><span class="p">,</span> <span class="n">LigandIgnoreHydrogens</span> <span class="o">=</span> <span class="s2">&quot;Yes&quot;</span><span class="p">):</span>
   94     <span class="sd">&quot;&quot;&quot;Get chain identifiers present in a molecule along with names of the</span>
   95 <span class="sd">    ligands present in chains. Ligands are identified using PyMOL &#39;organic&#39;</span>
   96 <span class="sd">    selection.</span>
   97 
   98 <span class="sd">    Arguments:</span>
   99 <span class="sd">        Infile (str) : Name of a file.</span>
  100 <span class="sd">        MolName (str) : Name to use for PyMOL molecule object.</span>
  101 <span class="sd">        Quite (bool) : Flag </span>
  102 <span class="sd">        LigandSortBy (str): Sort ligand names alphabetically or by size. Possible</span>
  103 <span class="sd">            values: Alphabetical or Size</span>
  104 <span class="sd">        LigandSortOrder (str): Sort order for sorting ligands. Possible values:</span>
  105 <span class="sd">            Ascending, Descending, Auto. The &#39;Auto&#39; value implies automatic</span>
  106 <span class="sd">            determination of sort order based on the value of &#39;SortBy&#39;.</span>
  107 <span class="sd">            Automatic defaults: Descending for SortBy value of Size; Ascending</span>
  108 <span class="sd">            for SortBy value of Alphabetical.</span>
  109 <span class="sd">        LigandIgnoreHydrogens (str): Ignore hydrogens during determination of ligand</span>
  110 <span class="sd">            size.</span>
  111 
  112 <span class="sd">    Returns:</span>
  113 <span class="sd">        dict: A dictionary containing list of chain identifiers and dictionaries</span>
  114 <span class="sd">            of chains containing lists of ligand names for each chain. Names of</span>
  115 <span class="sd">            ligands present in chain for a molecule sorted by size or</span>
  116 <span class="sd">            alphabetically.</span>
  117 
  118 <span class="sd">    Examples:</span>
  119 
  120 <span class="sd">        ChainsAndLigandsInfo = GetChainsAndLigandsInfo(Infile, MolName)</span>
  121 <span class="sd">        for ChainID in ChainsAndLigandsInfo[&quot;ChainIDs&quot;]:</span>
  122 <span class="sd">            for LigandID in ChainsAndLigandsInfo[&quot;LigandIDs&quot;][ChainID]:</span>
  123 <span class="sd">                MiscUtil.PrintInfo(&quot;ChainID: %s; LigandID: %s&quot; % (ChainID,</span>
  124 <span class="sd">                    LigandID))</span>
  125 
  126 <span class="sd">    &quot;&quot;&quot;</span>
  127     <span class="k">if</span> <span class="ow">not</span> <span class="n">Quite</span><span class="p">:</span>
  128         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Retrieving chain and ligand information from input file </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">Infile</span><span class="p">)</span>
  129     
  130     <span class="c1"># Collect chains and ligands information with ligands sorted by size to be used for</span>
  131     <span class="c1"># identification of largest ligand at the top...</span>
  132     <span class="n">cmd</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">Infile</span><span class="p">,</span> <span class="n">MolName</span><span class="p">)</span>
  133     <span class="n">ChainsAndLigandsInfo</span> <span class="o">=</span> <span class="n">_GetChainsAndLigands</span><span class="p">(</span><span class="n">MolName</span><span class="p">,</span> <span class="n">LigandSortBy</span> <span class="o">=</span> <span class="s2">&quot;size&quot;</span><span class="p">,</span> <span class="n">LigandSortOrder</span> <span class="o">=</span> <span class="s2">&quot;descending&quot;</span><span class="p">)</span>
  134     <span class="n">cmd</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">MolName</span><span class="p">)</span>
  135 
  136     <span class="c1"># Print out chain and ligand IDs...</span>
  137     <span class="k">if</span> <span class="ow">not</span> <span class="n">Quite</span><span class="p">:</span>
  138         <span class="n">ChainIDs</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">])</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">])</span> <span class="k">else</span> <span class="s2">&quot;None&quot;</span>
  139         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Chain IDs: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ChainIDs</span><span class="p">)</span>
  140         
  141         <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">ChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]:</span>
  142             <span class="n">LigandIDs</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">])</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">])</span> <span class="k">else</span> <span class="s2">&quot;None&quot;</span>
  143             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Chain ID: </span><span class="si">%s</span><span class="s2">; LigandIDs: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandIDs</span><span class="p">))</span>
  144     
  145     <span class="k">return</span> <span class="n">ChainsAndLigandsInfo</span>
  146 
  147 <span class="k">def</span> <span class="nf">GetLigands</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">SortBy</span> <span class="o">=</span> <span class="s2">&quot;Size&quot;</span><span class="p">,</span> <span class="n">SortOrder</span> <span class="o">=</span> <span class="s2">&quot;Auto&quot;</span><span class="p">,</span> <span class="n">IgnoreHydrogens</span> <span class="o">=</span> <span class="s2">&quot;Yes&quot;</span><span class="p">):</span>
  148     <span class="sd">&quot;&quot;&quot;Get names of ligands present in a chain of a  molecule. Ligands are</span>
  149 <span class="sd">    identified using PyMOL &#39;organic&#39; selection.</span>
  150 
  151 <span class="sd">    Arguments:</span>
  152 <span class="sd">        MoleculeName (str): Name of a PyMOL molecule object.</span>
  153 <span class="sd">        ChainName (str): Name of a chain in a molecule.</span>
  154 <span class="sd">        SortBy (str): Sort ligand names alphabetically or by size. Possible</span>
  155 <span class="sd">            values: Alphabetical or Size</span>
  156 <span class="sd">        SortOrder (str): Sort order for sorting ligands. Possible values:</span>
  157 <span class="sd">            Ascending, Descending, Auto. The &#39;Auto&#39; value implies automatic</span>
  158 <span class="sd">            determination of sort order based on the value of &#39;SortBy&#39;.</span>
  159 <span class="sd">            Automatic defaults: Descending for SortBy value of Size; Ascending</span>
  160 <span class="sd">            for SortBy value of Alphabetical.</span>
  161 <span class="sd">        IgnoreHydrogens (str): Ignore hydrogens during determination of ligand</span>
  162 <span class="sd">            size.</span>
  163 
  164 <span class="sd">    Returns:</span>
  165 <span class="sd">        list: Names of ligands present in chain for a molecule sorted by size</span>
  166 <span class="sd">            or alphabetically.</span>
  167 
  168 <span class="sd">    &quot;&quot;&quot;</span>
  169     <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">ChainName</span><span class="p">)):</span>
  170         <span class="k">return</span> <span class="bp">None</span>
  171 
  172     <span class="n">LigandsInfoMap</span> <span class="o">=</span> <span class="n">_GetLigandsInfo</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">SortBy</span><span class="p">,</span> <span class="n">SortOrder</span><span class="p">,</span> <span class="n">IgnoreHydrogens</span><span class="p">)</span>
  173     
  174     <span class="n">LigandIDs</span> <span class="o">=</span> <span class="n">LigandsInfoMap</span><span class="p">[</span><span class="s2">&quot;LigandResNames&quot;</span><span class="p">]</span>
  175     <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">LigandIDs</span><span class="p">):</span>
  176         <span class="n">LigandIDs</span> <span class="o">=</span> <span class="bp">None</span>
  177     
  178     <span class="k">return</span> <span class="n">LigandIDs</span>
  179 
  180 <span class="k">def</span> <span class="nf">GetLargestLigand</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">IgnoreHydrogens</span> <span class="o">=</span> <span class="s1">&#39;Yes&#39;</span><span class="p">):</span>
  181     <span class="sd">&quot;&quot;&quot;Get name of the largest ligand for a chain present in a molecule. Ligands</span>
  182 <span class="sd">    are identified using PyMOL &#39;organic&#39; selection.</span>
  183 
  184 <span class="sd">    Arguments:</span>
  185 <span class="sd">        IgnoreHydrogens (str): Ignore hydrogens during determination of ligand</span>
  186 <span class="sd">            size.</span>
  187 
  188 <span class="sd">    Returns:</span>
  189 <span class="sd">        str: Name of the largest ligand present in a chain. </span>
  190 
  191 <span class="sd">    &quot;&quot;&quot;</span>
  192     <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">ChainName</span><span class="p">)):</span>
  193         <span class="k">return</span> <span class="bp">None</span>
  194 
  195     <span class="n">SortBy</span> <span class="o">=</span> <span class="s2">&quot;Size&quot;</span>
  196     <span class="n">SortOrder</span> <span class="o">=</span> <span class="s2">&quot;Descending&quot;</span>
  197     <span class="n">LigandsInfoMap</span> <span class="o">=</span> <span class="n">_GetLigandsInfo</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">SortBy</span><span class="p">,</span> <span class="n">SortOrder</span><span class="p">,</span> <span class="n">IgnoreHydrogens</span><span class="p">)</span>
  198     <span class="n">LigandIDs</span> <span class="o">=</span> <span class="n">LigandsInfoMap</span><span class="p">[</span><span class="s2">&quot;LigandResNames&quot;</span><span class="p">]</span>
  199     
  200     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">LigandIDs</span><span class="p">):</span>
  201         <span class="n">LigandID</span> <span class="o">=</span> <span class="n">LigandIDs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
  202     <span class="k">else</span><span class="p">:</span>
  203         <span class="n">LigandID</span> <span class="o">=</span> <span class="bp">None</span>
  204 
  205     <span class="k">return</span> <span class="n">LigandID</span>
  206 
  207 <span class="k">def</span> <span class="nf">_GetChainsAndLigands</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">LigandSortBy</span> <span class="o">=</span> <span class="s2">&quot;Size&quot;</span><span class="p">,</span> <span class="n">LigandSortOrder</span> <span class="o">=</span> <span class="s2">&quot;Auto&quot;</span><span class="p">,</span> <span class="n">LigandIgnoreHydrogens</span> <span class="o">=</span> <span class="s2">&quot;Yes&quot;</span><span class="p">):</span>
  208     <span class="sd">&quot;&quot;&quot;Get chain identifiers in a molecule along with names of the ligands</span>
  209 <span class="sd">    present in chains. Ligands are identified using PyMOL &#39;organic&#39; selection.</span>
  210 <span class="sd">    &quot;&quot;&quot;</span>
  211     <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">):</span>
  212         <span class="k">return</span> <span class="bp">None</span>
  213 
  214     <span class="n">ChainIDs</span> <span class="o">=</span> <span class="n">GetChains</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">)</span>
  215     <span class="k">if</span> <span class="n">ChainIDs</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
  216         <span class="k">return</span> <span class="bp">None</span>
  217         
  218     <span class="n">ChainsAndLigandsMap</span> <span class="o">=</span> <span class="p">{}</span>
  219     <span class="n">ChainsAndLigandsMap</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  220     <span class="n">ChainsAndLigandsMap</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  221     
  222     <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">ChainIDs</span><span class="p">:</span>
  223         <span class="n">ChainsAndLigandsMap</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ChainID</span><span class="p">)</span>
  224         <span class="n">ChainsAndLigandsMap</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  225         
  226         <span class="n">LigandIDs</span> <span class="o">=</span> <span class="n">GetLigands</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">SortBy</span> <span class="o">=</span> <span class="n">LigandSortBy</span><span class="p">,</span> <span class="n">SortOrder</span> <span class="o">=</span> <span class="n">LigandSortOrder</span><span class="p">,</span> <span class="n">IgnoreHydrogens</span> <span class="o">=</span> <span class="n">LigandIgnoreHydrogens</span><span class="p">)</span>
  227         <span class="k">if</span> <span class="n">LigandIDs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
  228             <span class="n">ChainsAndLigandsMap</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">LigandIDs</span>
  229         
  230     <span class="k">return</span> <span class="n">ChainsAndLigandsMap</span>
  231 
  232 <span class="k">def</span> <span class="nf">_GetLigandsInfo</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">SortBy</span> <span class="o">=</span> <span class="s2">&quot;Size&quot;</span><span class="p">,</span> <span class="n">SortOrder</span> <span class="o">=</span> <span class="s2">&quot;Auto&quot;</span><span class="p">,</span> <span class="n">IgnoreHydrogens</span> <span class="o">=</span> <span class="s2">&quot;Yes&quot;</span><span class="p">):</span>
  233     <span class="sd">&quot;&quot;&quot;Retrieve information about ligands present in a chain of a molecule.&quot;&quot;&quot;</span>
  234 
  235     <span class="k">if</span> <span class="ow">not</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">CheckTextValue</span><span class="p">(</span><span class="n">SortBy</span><span class="p">,</span> <span class="s2">&quot;Size Alphabetical&quot;</span><span class="p">):</span>
  236         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;PyMOLUtil._GetLigandsInfo: The value specified, </span><span class="si">%s</span><span class="s2">, for parameter SortBy is not valid. SupportedValues: Size Alphabetical&quot;</span> <span class="o">%</span> <span class="n">SortBy</span><span class="p">)</span>
  237         
  238     <span class="k">if</span> <span class="ow">not</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">CheckTextValue</span><span class="p">(</span><span class="n">SortOrder</span><span class="p">,</span> <span class="s2">&quot;Ascending Descending Auto&quot;</span><span class="p">):</span>
  239         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;PyMOLUtil._GetLigandsInfo: The value specified, </span><span class="si">%s</span><span class="s2">, for parameter SortOrder is not valid. SupportedValues: Ascending Descending Auto&quot;</span> <span class="o">%</span> <span class="n">SortOrder</span><span class="p">)</span>
  240         
  241     <span class="k">if</span> <span class="ow">not</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">CheckTextValue</span><span class="p">(</span><span class="n">IgnoreHydrogens</span><span class="p">,</span> <span class="s2">&quot;Yes No&quot;</span><span class="p">):</span>
  242         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;PyMOLUtil._GetLigandsInfo: The value specified, </span><span class="si">%s</span><span class="s2">, for parameter IgnoreHydrogens is not valid. SupportedValues: Yes No&quot;</span> <span class="o">%</span> <span class="n">IgnoreHydrogens</span><span class="p">)</span>
  243         
  244     <span class="n">SortBySize</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Size$&quot;</span><span class="p">,</span> <span class="n">SortBy</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
  245     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Auto$&quot;</span><span class="p">,</span> <span class="n">SortOrder</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  246         <span class="n">SortOrderDescending</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Size$&quot;</span><span class="p">,</span> <span class="n">SortBy</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
  247     <span class="k">else</span><span class="p">:</span>
  248         <span class="n">SortOrderDescending</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Descending$&quot;</span><span class="p">,</span> <span class="n">SortOrder</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
  249     <span class="n">IgnoreHydrogenAtoms</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Yes$&quot;</span><span class="p">,</span> <span class="n">IgnoreHydrogens</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
  250 
  251     <span class="c1"># Set up a command to retrieve all appropriate ligand atoms in organic ligands...</span>
  252     <span class="n">SelectionCmd</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2"> and organic&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">)</span>
  253     <span class="k">if</span> <span class="n">IgnoreHydrogenAtoms</span><span class="p">:</span>
  254         <span class="n">SelectionCmd</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> and not hydro&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionCmd</span><span class="p">)</span>
  255 
  256     <span class="c1"># Retrieve atoms...</span>
  257     <span class="n">stored</span><span class="o">.</span><span class="n">LigandsInfo</span> <span class="o">=</span> <span class="p">[]</span>
  258     <span class="n">cmd</span><span class="o">.</span><span class="n">iterate</span><span class="p">(</span><span class="n">SelectionCmd</span><span class="p">,</span> <span class="s2">&quot;stored.LigandsInfo.append([resi, resn])&quot;</span><span class="p">)</span>
  259 
  260     <span class="c1"># Retrieve ligands...</span>
  261     <span class="n">LigandsInfoMap</span> <span class="o">=</span> <span class="p">{}</span>
  262     <span class="n">LigandsInfoMap</span><span class="p">[</span><span class="s2">&quot;LigandResNames&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  263     <span class="n">LigandsInfoMap</span><span class="p">[</span><span class="s2">&quot;LigandAtomCount&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  264     <span class="n">LigandsInfoMap</span><span class="p">[</span><span class="s2">&quot;LigandResNumber&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  265     
  266     <span class="k">for</span> <span class="n">LigandResNum</span><span class="p">,</span> <span class="n">LigandResName</span> <span class="ow">in</span> <span class="n">stored</span><span class="o">.</span><span class="n">LigandsInfo</span><span class="p">:</span>
  267         <span class="k">if</span> <span class="n">LigandResName</span> <span class="ow">in</span> <span class="n">LigandsInfoMap</span><span class="p">[</span><span class="s2">&quot;LigandResNames&quot;</span><span class="p">]:</span>
  268             <span class="n">LigandsInfoMap</span><span class="p">[</span><span class="s2">&quot;LigandAtomCount&quot;</span><span class="p">][</span><span class="n">LigandResName</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
  269         <span class="k">else</span><span class="p">:</span>
  270             <span class="n">LigandsInfoMap</span><span class="p">[</span><span class="s2">&quot;LigandResNames&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">LigandResName</span><span class="p">)</span>
  271             <span class="n">LigandsInfoMap</span><span class="p">[</span><span class="s2">&quot;LigandAtomCount&quot;</span><span class="p">][</span><span class="n">LigandResName</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
  272             <span class="n">LigandsInfoMap</span><span class="p">[</span><span class="s2">&quot;LigandResNumber&quot;</span><span class="p">][</span><span class="n">LigandResName</span><span class="p">]</span> <span class="o">=</span> <span class="n">LigandResNum</span>
  273 
  274     <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">LigandsInfoMap</span><span class="p">[</span><span class="s2">&quot;LigandResNames&quot;</span><span class="p">]):</span>
  275         <span class="k">return</span> <span class="n">LigandsInfoMap</span>
  276         
  277     <span class="c1"># Sort ligand names...</span>
  278     <span class="n">ReverseOrder</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">SortOrderDescending</span> <span class="k">else</span> <span class="bp">False</span>
  279     <span class="k">if</span> <span class="n">SortBySize</span><span class="p">:</span>
  280         <span class="n">SortedLigandResNames</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">LigandsInfoMap</span><span class="p">[</span><span class="s2">&quot;LigandResNames&quot;</span><span class="p">],</span> <span class="n">key</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">LigandResName</span><span class="p">:</span> <span class="n">LigandsInfoMap</span><span class="p">[</span><span class="s2">&quot;LigandAtomCount&quot;</span><span class="p">][</span><span class="n">LigandResName</span><span class="p">],</span> <span class="n">reverse</span> <span class="o">=</span> <span class="n">ReverseOrder</span><span class="p">)</span>
  281     <span class="k">else</span><span class="p">:</span>
  282         <span class="c1"># Sort alphabetically...</span>
  283         <span class="n">SortedLigandResNames</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">LigandsInfoMap</span><span class="p">[</span><span class="s2">&quot;LigandResNames&quot;</span><span class="p">],</span> <span class="n">reverse</span> <span class="o">=</span> <span class="n">ReverseOrder</span><span class="p">)</span>
  284 
  285     <span class="n">LigandsInfoMap</span><span class="p">[</span><span class="s2">&quot;LigandResNames&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SortedLigandResNames</span>
  286     
  287     <span class="k">return</span> <span class="n">LigandsInfoMap</span>
  288 
  289 <span class="k">def</span> <span class="nf">AreAminoAcidResiduesPresent</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">Type</span> <span class="o">=</span> <span class="s2">&quot;Any&quot;</span><span class="p">):</span>
  290     <span class="sd">&quot;&quot;&quot;Check for the presence of amino acid residues in a chain of a</span>
  291 <span class="sd">    molecule. Chains are identified using PyMOL &#39;polymer&#39; selection.</span>
  292 <span class="sd">    Nonstandard amino acid residues correspond to all residues other than</span>
  293 <span class="sd">    the standard amino acids and nucleic acids. Any amino acid residues cover</span>
  294 <span class="sd">    all residues other than the standard nucleic acids.</span>
  295 
  296 <span class="sd">    Arguments:</span>
  297 <span class="sd">        MoleculeName (str): Name of a PyMOL molecule object.</span>
  298 <span class="sd">        ChainName (str): Name of a chain in a molecule.</span>
  299 <span class="sd">        Type (str): Types of amino acids: Standard, NonStandard, Any</span>
  300 
  301 <span class="sd">    Returns:</span>
  302 <span class="sd">        boolean: True or False.</span>
  303 
  304 <span class="sd">    &quot;&quot;&quot;</span>
  305     
  306     <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">ChainName</span><span class="p">)):</span>
  307         <span class="k">return</span> <span class="bp">False</span>
  308 
  309     <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(Standard|NonStandard|Any)$&quot;</span><span class="p">,</span> <span class="n">Type</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  310         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;PyMOLUtil.AreAminoAcidResiduesPresent: Invalid amino acid type: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">Type</span><span class="p">)</span>
  311 
  312     <span class="n">SelectionCmd</span> <span class="o">=</span> <span class="n">_SetupAminoAcidResiduesSelectionCmd</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">Type</span><span class="p">)</span>
  313     
  314     <span class="n">Status</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">cmd</span><span class="o">.</span><span class="n">count_atoms</span><span class="p">(</span><span class="n">SelectionCmd</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
  315     
  316     <span class="k">return</span> <span class="n">Status</span>
  317     
  318 <span class="k">def</span> <span class="nf">AreNucleicAcidResiduesPresent</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">):</span>
  319     <span class="sd">&quot;&quot;&quot;Check for the presence of nucleic acid residues in a chain of a </span>
  320 <span class="sd">    molecule. Chains are identified using PyMOL &#39;polymer&#39; selection.</span>
  321 
  322 <span class="sd">    Arguments:</span>
  323 <span class="sd">        MoleculeName (str): Name of a PyMOL molecule object.</span>
  324 <span class="sd">        ChainName (str): Name of a chain in a molecule.</span>
  325 
  326 <span class="sd">    Returns:</span>
  327 <span class="sd">        boolean: True or False.</span>
  328 
  329 <span class="sd">    &quot;&quot;&quot;</span>
  330     
  331     <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">ChainName</span><span class="p">)):</span>
  332         <span class="k">return</span> <span class="bp">False</span>
  333     
  334     <span class="n">ResidueNames</span> <span class="o">=</span> <span class="n">_GetNucleicAcidResidueNames</span><span class="p">()</span>
  335     <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">ResidueNames</span><span class="p">):</span>
  336         <span class="k">return</span> <span class="bp">False</span>
  337     
  338     <span class="n">ResidueNamesSelection</span> <span class="o">=</span> <span class="s2">&quot;+&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ResidueNames</span><span class="p">)</span>
  339     <span class="n">SelectionCmd</span> <span class="o">=</span> <span class="s2">&quot;(</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2"> and polymer and (resn </span><span class="si">%s</span><span class="s2">))&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">ResidueNamesSelection</span><span class="p">)</span>
  340 
  341     <span class="n">Status</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">cmd</span><span class="o">.</span><span class="n">count_atoms</span><span class="p">(</span><span class="n">SelectionCmd</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
  342     
  343     <span class="k">return</span> <span class="n">Status</span>
  344     
  345 <span class="k">def</span> <span class="nf">_SetupAminoAcidResiduesSelectionCmd</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">Type</span><span class="p">):</span>
  346     <span class="sd">&quot;&quot;&quot;Set up amino acids selection command for PyMOL. &quot;&quot;&quot;</span>
  347     
  348     <span class="n">AminoAcidsSelection</span> <span class="o">=</span> <span class="s2">&quot;+&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">_GetAminoAcidResidueNames</span><span class="p">())</span>
  349     <span class="n">NucleicAcidsSelection</span> <span class="o">=</span> <span class="s2">&quot;+&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">_GetNucleicAcidResidueNames</span><span class="p">())</span>
  350     
  351     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Standard$&quot;</span><span class="p">,</span> <span class="n">Type</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  352         <span class="n">SelectionCmd</span> <span class="o">=</span> <span class="s2">&quot;(</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2"> and polymer and (resn </span><span class="si">%s</span><span class="s2">))&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">AminoAcidsSelection</span><span class="p">)</span>
  353     <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^NonStandard$&quot;</span><span class="p">,</span> <span class="n">Type</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  354         <span class="n">SelectionCmd</span> <span class="o">=</span> <span class="s2">&quot;(</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2"> and polymer and (not ((resn </span><span class="si">%s</span><span class="s2">) or (resn </span><span class="si">%s</span><span class="s2">))))&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">AminoAcidsSelection</span><span class="p">,</span> <span class="n">NucleicAcidsSelection</span><span class="p">)</span>
  355     <span class="k">else</span><span class="p">:</span>
  356         <span class="c1"># Any amino acid resiudes...</span>
  357         <span class="n">SelectionCmd</span> <span class="o">=</span> <span class="s2">&quot;(</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2"> and polymer and (not (resn </span><span class="si">%s</span><span class="s2">)))&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">NucleicAcidsSelection</span><span class="p">)</span>
  358 
  359     <span class="k">return</span> <span class="n">SelectionCmd</span>
  360 
  361 <span class="k">def</span> <span class="nf">_GetAminoAcidResidueNames</span><span class="p">():</span>
  362     <span class="sd">&quot;&quot;&quot;Get list of amino acid residue names.</span>
  363 <span class="sd">    &quot;&quot;&quot;</span>
  364     
  365     <span class="n">ResidueNames</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ALA&quot;</span><span class="p">,</span> <span class="s2">&quot;ARG&quot;</span><span class="p">,</span> <span class="s2">&quot;ASN&quot;</span><span class="p">,</span> <span class="s2">&quot;ASP&quot;</span><span class="p">,</span> <span class="s2">&quot;CYS&quot;</span><span class="p">,</span> <span class="s2">&quot;GLN&quot;</span><span class="p">,</span> <span class="s2">&quot;GLU&quot;</span><span class="p">,</span> <span class="s2">&quot;GLY&quot;</span><span class="p">,</span> <span class="s2">&quot;HIS&quot;</span><span class="p">,</span> <span class="s2">&quot;ILE&quot;</span><span class="p">,</span> <span class="s2">&quot;LEU&quot;</span><span class="p">,</span> <span class="s2">&quot;LYS&quot;</span><span class="p">,</span> <span class="s2">&quot;MET&quot;</span><span class="p">,</span> <span class="s2">&quot;PHE&quot;</span><span class="p">,</span> <span class="s2">&quot;PRO&quot;</span><span class="p">,</span> <span class="s2">&quot;SER&quot;</span><span class="p">,</span> <span class="s2">&quot;THR&quot;</span><span class="p">,</span> <span class="s2">&quot;TRP&quot;</span><span class="p">,</span> <span class="s2">&quot;TYR&quot;</span><span class="p">,</span> <span class="s2">&quot;VAL&quot;</span><span class="p">]</span>
  366     
  367     <span class="k">return</span> <span class="n">ResidueNames</span>
  368 
  369 <span class="k">def</span> <span class="nf">_GetNucleicAcidResidueNames</span><span class="p">():</span>
  370     <span class="sd">&quot;&quot;&quot;Get list of nucleic acid residue names.</span>
  371 <span class="sd">    &quot;&quot;&quot;</span>
  372     
  373     <span class="n">ResidueNames</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;G&quot;</span><span class="p">,</span> <span class="s2">&quot;T&quot;</span><span class="p">,</span> <span class="s2">&quot;U&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;DA&quot;</span><span class="p">,</span> <span class="s2">&quot;DG&quot;</span><span class="p">,</span> <span class="s2">&quot;DT&quot;</span><span class="p">,</span> <span class="s2">&quot;DU&quot;</span><span class="p">,</span> <span class="s2">&quot;DC&quot;</span><span class="p">]</span>
  374     
  375     <span class="k">return</span> <span class="n">ResidueNames</span>
  376 
  377 <span class="k">def</span> <span class="nf">GetPolymerResiduesInfo</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">):</span>
  378     <span class="sd">&quot;&quot;&quot;Get information for residues present in a chain of a  molecule.</span>
  379 <span class="sd">    Chains are identified using PyMOL &#39;polymer&#39; selection.</span>
  380 
  381 <span class="sd">    Arguments:</span>
  382 <span class="sd">        MoleculeName (str): Name of a PyMOL molecule object.</span>
  383 <span class="sd">        ChainName (str): Name of a chain in a molecule.</span>
  384 
  385 <span class="sd">    Returns:</span>
  386 <span class="sd">        dict: A dictionary containing list of residue names and dictionaries of</span>
  387 <span class="sd">            residue numbers and residue count for each residue. Names of </span>
  388 <span class="sd">            residues in the dictionary are not sorted.</span>
  389 
  390 <span class="sd">    Examples:</span>
  391 
  392 <span class="sd">        ResiduesInfo = GetPolymerResiduesInfo(MolName, ChainName)</span>
  393 <span class="sd">        for ResName in ResiduesInfo[&quot;ResNames&quot;]:</span>
  394 <span class="sd">            ResCount = ResiduesInfo[&quot;ResCount&quot;][ResName]</span>
  395 <span class="sd">            ResNums = ResiduesInfo[&quot;ResNum&quot;][ResName]</span>
  396 <span class="sd">            MiscUtil.PrintInfo(&quot;ResName: %s; ResCount: %s; ResNums: %s&quot; %</span>
  397 <span class="sd">                (ResName, ResCount, ResNums))</span>
  398 
  399 <span class="sd">    &quot;&quot;&quot;</span>
  400     <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">ChainName</span><span class="p">)):</span>
  401         <span class="k">return</span> <span class="bp">None</span>
  402 
  403     <span class="n">SelectionCmd</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2"> and polymer&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">)</span>
  404     <span class="n">ResiduesInfoMap</span> <span class="o">=</span> <span class="n">_GetSelectionResiduesInfo</span><span class="p">(</span><span class="n">SelectionCmd</span><span class="p">)</span>
  405 
  406     <span class="k">return</span> <span class="n">ResiduesInfoMap</span>
  407 
  408 <span class="k">def</span> <span class="nf">GetAminoAcidResiduesInfo</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">Type</span> <span class="o">=</span> <span class="s2">&quot;Standard&quot;</span><span class="p">):</span>
  409     <span class="sd">&quot;&quot;&quot;Get information for amino acid residues present in a chain of a</span>
  410 <span class="sd">    molecule. Chains are identified using PyMOL &#39;polymer&#39; selection.</span>
  411 <span class="sd">    Nonstandard amino acid residues correspond to all residues other than</span>
  412 <span class="sd">    the standard amino acids and nucleic acids. Any amino acid residues cover</span>
  413 <span class="sd">    all residues other than the standard nucleic acids.</span>
  414 
  415 <span class="sd">    Arguments:</span>
  416 <span class="sd">        MoleculeName (str): Name of a PyMOL molecule object.</span>
  417 <span class="sd">        ChainName (str): Name of a chain in a molecule.</span>
  418 <span class="sd">        Type (str): Types of amino acids: Standard, NonStandard, Any</span>
  419 
  420 <span class="sd">    Returns:</span>
  421 <span class="sd">        dict: A dictionary containing list of residue names and dictionaries of</span>
  422 <span class="sd">            residue numbers and residue count for each residue. Names of </span>
  423 <span class="sd">            residues in the dictionary are not sorted.</span>
  424 
  425 <span class="sd">    Examples:</span>
  426 
  427 <span class="sd">        ResiduesInfo = GetPolymerResiduesInfo(MolName, ChainName)</span>
  428 <span class="sd">        for ResName in ResiduesInfo[&quot;ResNames&quot;]:</span>
  429 <span class="sd">            ResCount = ResiduesInfo[&quot;ResCount&quot;][ResName]</span>
  430 <span class="sd">            ResNums = ResiduesInfo[&quot;ResNum&quot;][ResName]</span>
  431 <span class="sd">            MiscUtil.PrintInfo(&quot;ResName: %s; ResCount: %s; ResNums: %s&quot; %</span>
  432 <span class="sd">                (ResName, ResCount, ResNums))</span>
  433 
  434 <span class="sd">    &quot;&quot;&quot;</span>
  435     
  436     <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">ChainName</span><span class="p">)):</span>
  437         <span class="k">return</span> <span class="bp">None</span>
  438 
  439     <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(Standard|NonStandard|Any)$&quot;</span><span class="p">,</span> <span class="n">Type</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  440         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;PyMOLUtil.GetAminoAcidResiduesInfo: Invalid amino acid type: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">Type</span><span class="p">)</span>
  441     
  442     <span class="n">SelectionCmd</span> <span class="o">=</span> <span class="n">_SetupAminoAcidResiduesSelectionCmd</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">Type</span><span class="p">)</span>
  443     <span class="n">ResiduesInfoMap</span> <span class="o">=</span> <span class="n">_GetSelectionResiduesInfo</span><span class="p">(</span><span class="n">SelectionCmd</span><span class="p">)</span>
  444 
  445     <span class="k">return</span> <span class="n">ResiduesInfoMap</span>
  446 
  447 <span class="k">def</span> <span class="nf">GetNucleicAcidResiduesInfo</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">):</span>
  448     <span class="sd">&quot;&quot;&quot;Get information for nucleic acid residues present in a chain of</span>
  449 <span class="sd">    a  molecule. Chains are identified using PyMOL &#39;polymer&#39; selection.</span>
  450 
  451 <span class="sd">    Arguments:</span>
  452 <span class="sd">        MoleculeName (str): Name of a PyMOL molecule object.</span>
  453 <span class="sd">        ChainName (str): Name of a chain in a molecule.</span>
  454 
  455 <span class="sd">    Returns:</span>
  456 <span class="sd">        dict: A dictionary containing list of residue names and dictionaries of</span>
  457 <span class="sd">            residue numbers and residue count for each residue. Names of </span>
  458 <span class="sd">            residues in the dictionary are not sorted.</span>
  459 
  460 <span class="sd">    Examples:</span>
  461 
  462 <span class="sd">        ResiduesInfo = GetPolymerResiduesInfo(MolName, ChainName)</span>
  463 <span class="sd">        for ResName in ResiduesInfo[&quot;ResNames&quot;]:</span>
  464 <span class="sd">            ResCount = ResiduesInfo[&quot;ResCount&quot;][ResName]</span>
  465 <span class="sd">            ResNums = ResiduesInfo[&quot;ResNum&quot;][ResName]</span>
  466 <span class="sd">            MiscUtil.PrintInfo(&quot;ResName: %s; ResCount: %s; ResNums: %s&quot; %</span>
  467 <span class="sd">                (ResName, ResCount, ResNums))</span>
  468 
  469 <span class="sd">    &quot;&quot;&quot;</span>
  470     
  471     <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">ChainName</span><span class="p">)):</span>
  472         <span class="k">return</span> <span class="bp">None</span>
  473 
  474     <span class="n">ResidueNames</span> <span class="o">=</span> <span class="n">_GetNucleicAcidResidueNames</span><span class="p">()</span>
  475     
  476     <span class="n">ResidueNamesSelection</span> <span class="o">=</span> <span class="s2">&quot;+&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ResidueNames</span><span class="p">)</span>
  477     <span class="n">SelectionCmd</span> <span class="o">=</span> <span class="s2">&quot;(</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2"> and polymer and (resn </span><span class="si">%s</span><span class="s2">))&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">ResidueNamesSelection</span><span class="p">)</span>
  478     
  479     <span class="n">ResiduesInfoMap</span> <span class="o">=</span> <span class="n">_GetSelectionResiduesInfo</span><span class="p">(</span><span class="n">SelectionCmd</span><span class="p">)</span>
  480 
  481     <span class="k">return</span> <span class="n">ResiduesInfoMap</span>
  482 
  483 <span class="k">def</span> <span class="nf">GetSelectionResiduesInfo</span><span class="p">(</span><span class="n">SelectionCmd</span><span class="p">):</span>
  484     <span class="sd">&quot;&quot;&quot;Get information for residues in a chain specified by a selection command.</span>
  485 
  486 <span class="sd">    Arguments:</span>
  487 <span class="sd">        SelectionCmd (str): PyMOL selection command.</span>
  488 
  489 <span class="sd">    Returns:</span>
  490 <span class="sd">        dict: A dictionary containing list of residue names and dictionaries of</span>
  491 <span class="sd">            residue numbers and residue count for each residue. Names of </span>
  492 <span class="sd">            residues in the dictionary are not sorted.</span>
  493 
  494 <span class="sd">    Examples:</span>
  495 
  496 <span class="sd">        ResiduesInfo = GetSelectionResiduesInfo(SelectionCmd)</span>
  497 <span class="sd">        for ResName in ResiduesInfo[&quot;ResNames&quot;]:</span>
  498 <span class="sd">            ResCount = ResiduesInfo[&quot;ResCount&quot;][ResName]</span>
  499 <span class="sd">            ResNums = ResiduesInfo[&quot;ResNum&quot;][ResName]</span>
  500 <span class="sd">            MiscUtil.PrintInfo(&quot;ResName: %s; ResCount: %s; ResNums: %s&quot; %</span>
  501 <span class="sd">                (ResName, ResCount, ResNums))</span>
  502 
  503 <span class="sd">    &quot;&quot;&quot;</span>
  504     <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">SelectionCmd</span><span class="p">):</span>
  505         <span class="k">return</span> <span class="bp">None</span>
  506 
  507     <span class="n">ResiduesInfoMap</span> <span class="o">=</span> <span class="n">_GetSelectionResiduesInfo</span><span class="p">(</span><span class="n">SelectionCmd</span><span class="p">)</span>
  508 
  509     <span class="k">return</span> <span class="n">ResiduesInfoMap</span>
  510 
  511 <span class="k">def</span> <span class="nf">GetSolventResiduesInfo</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">):</span>
  512     <span class="sd">&quot;&quot;&quot;Get information for solvent residues present in a chain of a  molecule.</span>
  513 <span class="sd">    Solvents are identified using PyMOL &#39;solvent&#39; selection.</span>
  514 
  515 <span class="sd">    Arguments:</span>
  516 <span class="sd">        MoleculeName (str): Name of a PyMOL molecule object.</span>
  517 <span class="sd">        ChainName (str): Name of a chain in a molecule.</span>
  518 
  519 <span class="sd">    Returns:</span>
  520 <span class="sd">        dict: A dictionary containing list of residue names and dictionaries of</span>
  521 <span class="sd">            residue numbers and residue count for each residue. Names of </span>
  522 <span class="sd">            residues in the dictionary are not sorted.</span>
  523 
  524 <span class="sd">    Examples:</span>
  525 
  526 <span class="sd">        ResiduesInfo = GetSolventResiduesInfo(MolName, ChainName)</span>
  527 <span class="sd">        for ResName in ResiduesInfo[&quot;ResNames&quot;]:</span>
  528 <span class="sd">            ResCount = ResiduesInfo[&quot;ResCount&quot;][ResName]</span>
  529 <span class="sd">            ResNums = ResiduesInfo[&quot;ResNum&quot;][ResName]</span>
  530 <span class="sd">            MiscUtil.PrintInfo(&quot;ResName: %s; ResCount: %s; ResNums: %s&quot; %</span>
  531 <span class="sd">                (ResName, ResCount, ResNums))</span>
  532 
  533 <span class="sd">    &quot;&quot;&quot;</span>
  534     <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">ChainName</span><span class="p">)):</span>
  535         <span class="k">return</span> <span class="bp">None</span>
  536 
  537     <span class="n">SelectionCmd</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2"> and solvent&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">)</span>
  538     <span class="n">ResiduesInfoMap</span> <span class="o">=</span> <span class="n">_GetSelectionResiduesInfo</span><span class="p">(</span><span class="n">SelectionCmd</span><span class="p">)</span>
  539 
  540     <span class="k">return</span> <span class="n">ResiduesInfoMap</span>
  541 
  542 <span class="k">def</span> <span class="nf">GetInorganicResiduesInfo</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">):</span>
  543     <span class="sd">&quot;&quot;&quot;Get information for inorganic residues present in a chain of a  molecule.</span>
  544 <span class="sd">    Inorganic residues are identified using PyMOL &#39;inorganic&#39; selection.</span>
  545 
  546 <span class="sd">    Arguments:</span>
  547 <span class="sd">        MoleculeName (str): Name of a PyMOL molecule object.</span>
  548 <span class="sd">        ChainName (str): Name of a chain in a molecule.</span>
  549 
  550 <span class="sd">    Returns:</span>
  551 <span class="sd">        dict: A dictionary containing list of residue names and dictionaries of</span>
  552 <span class="sd">            residue numbers and residue count for each residue. Names of </span>
  553 <span class="sd">            residues in the dictionary are not sorted.</span>
  554 
  555 <span class="sd">    Examples:</span>
  556 
  557 <span class="sd">        ResiduesInfo = GetInorganicResiduesInfo(MolName, ChainName)</span>
  558 <span class="sd">        for ResName in ResiduesInfo[&quot;ResNames&quot;]:</span>
  559 <span class="sd">            ResCount = ResiduesInfo[&quot;ResCount&quot;][ResName]</span>
  560 <span class="sd">            ResNums = ResiduesInfo[&quot;ResNum&quot;][ResName]</span>
  561 <span class="sd">            MiscUtil.PrintInfo(&quot;ResName: %s; ResCount: %s; ResNums: %s&quot; %</span>
  562 <span class="sd">                (ResName, ResCount, ResNums))</span>
  563 
  564 <span class="sd">    &quot;&quot;&quot;</span>
  565     <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">ChainName</span><span class="p">)):</span>
  566         <span class="k">return</span> <span class="bp">None</span>
  567 
  568     <span class="n">SelectionCmd</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2"> and inorganic&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">)</span>
  569     <span class="n">ResiduesInfoMap</span> <span class="o">=</span> <span class="n">_GetSelectionResiduesInfo</span><span class="p">(</span><span class="n">SelectionCmd</span><span class="p">)</span>
  570 
  571     <span class="k">return</span> <span class="n">ResiduesInfoMap</span>
  572 
  573 <span class="k">def</span> <span class="nf">GetLigandResiduesInfo</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">):</span>
  574     <span class="sd">&quot;&quot;&quot;Get information for ligand residues present in a chain of a  molecule.</span>
  575 <span class="sd">    Ligands are identified using PyMOL &#39;organic&#39; selection.</span>
  576 
  577 <span class="sd">    Arguments:</span>
  578 <span class="sd">        MoleculeName (str): Name of a PyMOL molecule object.</span>
  579 <span class="sd">        ChainName (str): Name of a chain in a molecule.</span>
  580 
  581 <span class="sd">    Returns:</span>
  582 <span class="sd">        dict: A dictionary containing list of residue names and dictionaries of</span>
  583 <span class="sd">            residue numbers and residue count for each residue. Names of </span>
  584 <span class="sd">            residues in the dictionary are not sorted.</span>
  585 
  586 <span class="sd">    Examples:</span>
  587 
  588 <span class="sd">        ResiduesInfo = GetLigandResiduesInfo(MolName, ChainName)</span>
  589 <span class="sd">        for ResName in ResiduesInfo[&quot;ResNames&quot;]:</span>
  590 <span class="sd">            ResCount = ResiduesInfo[&quot;ResCount&quot;][ResName]</span>
  591 <span class="sd">            ResNums = ResiduesInfo[&quot;ResNum&quot;][ResName]</span>
  592 <span class="sd">            MiscUtil.PrintInfo(&quot;ResName: %s; ResCount: %s; ResNums: %s&quot; %</span>
  593 <span class="sd">                (ResName, ResCount, ResNums))</span>
  594 
  595 <span class="sd">    &quot;&quot;&quot;</span>
  596     <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">ChainName</span><span class="p">)):</span>
  597         <span class="k">return</span> <span class="bp">None</span>
  598 
  599     <span class="n">SelectionCmd</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2"> and organic&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">)</span>
  600     <span class="n">ResiduesInfoMap</span> <span class="o">=</span> <span class="n">_GetSelectionResiduesInfo</span><span class="p">(</span><span class="n">SelectionCmd</span><span class="p">)</span>
  601 
  602     <span class="k">return</span> <span class="n">ResiduesInfoMap</span>
  603 
  604 <span class="k">def</span> <span class="nf">GetPocketPolymerResiduesInfo</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">LigandResName</span><span class="p">,</span> <span class="n">LigandResNum</span><span class="p">,</span> <span class="n">PocketDistanceCutoff</span><span class="p">):</span>
  605     <span class="sd">&quot;&quot;&quot;Get information for chain residues present in a pocket around a ligand</span>
  606 <span class="sd">    in a molecule. Polymer residues are identified using negation of PyMOL</span>
  607 <span class="sd">    selection operators &#39;organic&#39;, &#39;solvent&#39;, and &#39;inorganic&#39;.</span>
  608 
  609 <span class="sd">    Arguments:</span>
  610 <span class="sd">        MoleculeName (str): Name of a PyMOL molecule object.</span>
  611 <span class="sd">        ChainName (str): Name of a chain in a molecule.</span>
  612 <span class="sd">        LigandResName (str): Residue name of a ligand in a chain.</span>
  613 <span class="sd">        LigandResNum (str): Residue number of a ligand in a chain.</span>
  614 <span class="sd">        PocketDistanceCutoff (float): Distance around ligand to identify pocket</span>
  615 <span class="sd">            residues.</span>
  616 
  617 <span class="sd">    Returns:</span>
  618 <span class="sd">        dict: A dictionary containing list of residue names and dictionaries of</span>
  619 <span class="sd">            residue numbers and residue count for each residue. Names of </span>
  620 <span class="sd">            residues in the dictionary are not sorted.</span>
  621 
  622 <span class="sd">    Examples:</span>
  623 
  624 <span class="sd">        ResiduesInfo = GetPocketPolymerResiduesInfo(MolName, ChainName)</span>
  625 <span class="sd">        for ResName in ResiduesInfo[&quot;ResNames&quot;]:</span>
  626 <span class="sd">            ResCount = ResiduesInfo[&quot;ResCount&quot;][ResName]</span>
  627 <span class="sd">            ResNums = ResiduesInfo[&quot;ResNum&quot;][ResName]</span>
  628 <span class="sd">            MiscUtil.PrintInfo(&quot;ResName: %s; ResCount: %s; ResNums: %s&quot; %</span>
  629 <span class="sd">                (ResName, ResCount, ResNums))</span>
  630 
  631 <span class="sd">    &quot;&quot;&quot;</span>
  632     <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">ChainName</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">LigandResName</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">LigandResNum</span><span class="p">)):</span>
  633         <span class="k">return</span> <span class="bp">None</span>
  634 
  635     <span class="n">LigandSelection</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2"> and organic and resn </span><span class="si">%s</span><span class="s2"> and resi </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">LigandResName</span><span class="p">,</span> <span class="n">LigandResNum</span><span class="p">)</span>
  636     <span class="n">MoleculeSelection</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">)</span>
  637     <span class="n">SelectionCmd</span> <span class="o">=</span> <span class="s2">&quot;((byresidue (</span><span class="si">%s</span><span class="s2">) within </span><span class="si">%.1f</span><span class="s2"> of (</span><span class="si">%s</span><span class="s2">))  and (not solvent) and (not inorganic) and (not organic))&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MoleculeSelection</span><span class="p">,</span> <span class="n">PocketDistanceCutoff</span><span class="p">,</span> <span class="n">LigandSelection</span><span class="p">)</span>
  638 
  639     <span class="n">ResiduesInfoMap</span> <span class="o">=</span> <span class="n">_GetSelectionResiduesInfo</span><span class="p">(</span><span class="n">SelectionCmd</span><span class="p">)</span>
  640 
  641     <span class="k">return</span> <span class="n">ResiduesInfoMap</span>
  642 
  643 <span class="k">def</span> <span class="nf">GetPocketSolventResiduesInfo</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">LigandResName</span><span class="p">,</span> <span class="n">LigandResNum</span><span class="p">,</span> <span class="n">PocketDistanceCutoff</span><span class="p">):</span>
  644     <span class="sd">&quot;&quot;&quot;Get information for solvent residues present in a pocket around a ligand</span>
  645 <span class="sd">    in a molecule. Solvent residues are identified using PyMOL &#39;solvent&#39;</span>
  646 <span class="sd">    selection.</span>
  647 
  648 <span class="sd">    Arguments:</span>
  649 <span class="sd">        MoleculeName (str): Name of a PyMOL molecule object.</span>
  650 <span class="sd">        ChainName (str): Name of a chain in a molecule.</span>
  651 <span class="sd">        LigandResName (str): Residue name of a ligand in a chain.</span>
  652 <span class="sd">        LigandResNum (str): Residue number of a ligand in a chain.</span>
  653 <span class="sd">        PocketDistanceCutoff (float): Distance around ligand to identify pocket</span>
  654 <span class="sd">            residues.</span>
  655 
  656 <span class="sd">    Returns:</span>
  657 <span class="sd">        dict: A dictionary containing list of residue names and dictionaries of</span>
  658 <span class="sd">            residue numbers and residue count for each residue. Names of </span>
  659 <span class="sd">            residues in the dictionary are not sorted.</span>
  660 
  661 <span class="sd">    Examples:</span>
  662 
  663 <span class="sd">        ResiduesInfo = GetPocketSolventResiduesInfo(MolName, ChainName)</span>
  664 <span class="sd">        for ResName in ResiduesInfo[&quot;ResNames&quot;]:</span>
  665 <span class="sd">            ResCount = ResiduesInfo[&quot;ResCount&quot;][ResName]</span>
  666 <span class="sd">            ResNums = ResiduesInfo[&quot;ResNum&quot;][ResName]</span>
  667 <span class="sd">            MiscUtil.PrintInfo(&quot;ResName: %s; ResCount: %s; ResNums: %s&quot; %</span>
  668 <span class="sd">                (ResName, ResCount, ResNums))</span>
  669 
  670 <span class="sd">    &quot;&quot;&quot;</span>
  671     <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">ChainName</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">LigandResName</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">LigandResNum</span><span class="p">)):</span>
  672         <span class="k">return</span> <span class="bp">None</span>
  673 
  674     <span class="n">LigandSelection</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2"> and organic and resn </span><span class="si">%s</span><span class="s2"> and resi </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">LigandResName</span><span class="p">,</span> <span class="n">LigandResNum</span><span class="p">)</span>
  675     <span class="n">MoleculeSelection</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">)</span>
  676     <span class="n">SelectionCmd</span> <span class="o">=</span> <span class="s2">&quot;((byresidue (</span><span class="si">%s</span><span class="s2">) within </span><span class="si">%.1f</span><span class="s2"> of (</span><span class="si">%s</span><span class="s2">))  and solvent)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MoleculeSelection</span><span class="p">,</span> <span class="n">PocketDistanceCutoff</span><span class="p">,</span> <span class="n">LigandSelection</span><span class="p">)</span>
  677 
  678     <span class="n">ResiduesInfoMap</span> <span class="o">=</span> <span class="n">_GetSelectionResiduesInfo</span><span class="p">(</span><span class="n">SelectionCmd</span><span class="p">)</span>
  679 
  680     <span class="k">return</span> <span class="n">ResiduesInfoMap</span>
  681 
  682 <span class="k">def</span> <span class="nf">GetPocketInorganicResiduesInfo</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">LigandResName</span><span class="p">,</span> <span class="n">LigandResNum</span><span class="p">,</span> <span class="n">PocketDistanceCutoff</span><span class="p">):</span>
  683     <span class="sd">&quot;&quot;&quot;Get information for inorganic residues present in a pocket around a</span>
  684 <span class="sd">    ligand in a molecule. Inorganic residues are identified using PyMOL</span>
  685 <span class="sd">    &#39;inorganic&#39; selection.</span>
  686 
  687 <span class="sd">    Arguments:</span>
  688 <span class="sd">        MoleculeName (str): Name of a PyMOL molecule object.</span>
  689 <span class="sd">        ChainName (str): Name of a chain in a molecule.</span>
  690 <span class="sd">        LigandResName (str): Residue name of a ligand in a chain.</span>
  691 <span class="sd">        LigandResNum (str): Residue number of a ligand in a chain.</span>
  692 <span class="sd">        PocketDistanceCutoff (float): Distance around a ligand to identify</span>
  693 <span class="sd">            pocket residues.</span>
  694 
  695 <span class="sd">    Returns:</span>
  696 <span class="sd">        dict: A dictionary containing list of residue names and dictionaries of</span>
  697 <span class="sd">            residue numbers and residue count for each residue. Names of </span>
  698 <span class="sd">            residues in the dictionary are not sorted.</span>
  699 
  700 <span class="sd">    Examples:</span>
  701 
  702 <span class="sd">        ResiduesInfo = GetPocketInorganicResiduesInfo(MolName, ChainName)</span>
  703 <span class="sd">        for ResName in ResiduesInfo[&quot;ResNames&quot;]:</span>
  704 <span class="sd">            ResCount = ResiduesInfo[&quot;ResCount&quot;][ResName]</span>
  705 <span class="sd">            ResNums = ResiduesInfo[&quot;ResNum&quot;][ResName]</span>
  706 <span class="sd">            MiscUtil.PrintInfo(&quot;ResName: %s; ResCount: %s; ResNums: %s&quot; %</span>
  707 <span class="sd">                (ResName, ResCount, ResNums))</span>
  708 
  709 <span class="sd">    &quot;&quot;&quot;</span>
  710     <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">ChainName</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">LigandResName</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">LigandResNum</span><span class="p">)):</span>
  711         <span class="k">return</span> <span class="bp">None</span>
  712 
  713     <span class="n">LigandSelection</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2"> and organic and resn </span><span class="si">%s</span><span class="s2"> and resi </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">LigandResName</span><span class="p">,</span> <span class="n">LigandResNum</span><span class="p">)</span>
  714     <span class="n">MoleculeSelection</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">)</span>
  715     <span class="n">SelectionCmd</span> <span class="o">=</span> <span class="s2">&quot;((byresidue (</span><span class="si">%s</span><span class="s2">) within </span><span class="si">%.1f</span><span class="s2"> of (</span><span class="si">%s</span><span class="s2">))  and inorganic)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MoleculeSelection</span><span class="p">,</span> <span class="n">PocketDistanceCutoff</span><span class="p">,</span> <span class="n">LigandSelection</span><span class="p">)</span>
  716 
  717     <span class="n">ResiduesInfoMap</span> <span class="o">=</span> <span class="n">_GetSelectionResiduesInfo</span><span class="p">(</span><span class="n">SelectionCmd</span><span class="p">)</span>
  718 
  719     <span class="k">return</span> <span class="n">ResiduesInfoMap</span>
  720 
  721 <span class="k">def</span> <span class="nf">GetPhiPsiResiduesInfo</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">Categorize</span> <span class="o">=</span> <span class="bp">True</span><span class="p">):</span>
  722     <span class="sd">&quot;&quot;&quot;Get phi and psi torsion angle information for residues in a chain of a</span>
  723 <span class="sd">    molecule containing amino acids.</span>
  724 <span class="sd">    </span>
  725 <span class="sd">    The phi and psi angles are optionally categorized into the following groups</span>
  726 <span class="sd">    corresponding to four types of  Ramachandran plots:</span>
  727 <span class="sd">    </span>
  728 <span class="sd">    General: All residues except glycine, proline, or pre-proline</span>
  729 <span class="sd">    Glycine: Only glycine residues</span>
  730 <span class="sd">    Proline: Only proline residues</span>
  731 <span class="sd">    Pre-Proline: Only residues before proline not including glycine or proline</span>
  732 <span class="sd">    </span>
  733 <span class="sd">    Arguments:</span>
  734 <span class="sd">        MoleculeName (str): Name of a PyMOL molecule object.</span>
  735 <span class="sd">        ChainName (str): Name of a chain in a molecule.</span>
  736 
  737 <span class="sd">    Returns:</span>
  738 <span class="sd">        dict: A dictionary containing sorted list of residue numbers and</span>
  739 <span class="sd">            dictionaries of residue names, phi and psi angles for each residue</span>
  740 <span class="sd">            number.</span>
  741 
  742 <span class="sd">    Examples:</span>
  743 
  744 <span class="sd">        PhiPsiInfoMap = GetPhiPsiResiduesInfo(MolName, ChainName, True)</span>
  745 <span class="sd">        for ResNum in PhiPsiInfoMap[&quot;ResNums&quot;]:</span>
  746 <span class="sd">            ResName = PhiPsiInfoMap[&quot;ResName&quot;][ResNum]</span>
  747 <span class="sd">            Phi = PhiPsiInfoMap[&quot;Phi&quot;][ResNum]</span>
  748 <span class="sd">            Psi = PhiPsiInfoMap[&quot;Psi&quot;][ResNum]</span>
  749 <span class="sd">            Category = PhiPsiInfoMap[&quot;Category&quot;][ResNum]</span>
  750 <span class="sd">            MiscUtil.PrintInfo(&quot;ResNum: %s; ResName: %s; Phi: %8.2f;</span>
  751 <span class="sd">                Psi: %8.2f; Category: %s&quot; % (ResNum, ResName, Phi, Psi,</span>
  752 <span class="sd">                Categorize))</span>
  753 
  754 <span class="sd">    &quot;&quot;&quot;</span>
  755     <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">ChainName</span><span class="p">)):</span>
  756         <span class="k">return</span> <span class="bp">None</span>
  757     
  758     <span class="n">SelectionCmd</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">)</span>
  759     <span class="n">PhiPsiResiduesInfoMap</span> <span class="o">=</span> <span class="n">_GetSelectionPhiPsiResiduesInfo</span><span class="p">(</span><span class="n">SelectionCmd</span><span class="p">,</span> <span class="n">Categorize</span><span class="p">)</span>
  760 
  761     <span class="k">return</span> <span class="n">PhiPsiResiduesInfoMap</span>
  762 
  763 <span class="k">def</span> <span class="nf">GetPhiPsiChainsAndResiduesInfo</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">Categorize</span> <span class="o">=</span> <span class="bp">True</span><span class="p">):</span>
  764     <span class="sd">&quot;&quot;&quot;Get phi and psi torsion angle information for residues across chains in</span>
  765 <span class="sd">    a molecule containing amino acids.</span>
  766 
  767 <span class="sd">    The phi and psi angles are optionally categorized into the following groups</span>
  768 <span class="sd">    corresponding to four types of  Ramachandran plots:</span>
  769 <span class="sd">    </span>
  770 <span class="sd">    General: All residues except glycine, proline, or pre-proline</span>
  771 <span class="sd">    Glycine: Only glycine residues</span>
  772 <span class="sd">    Proline: Only proline residues</span>
  773 <span class="sd">    Pre-Proline: Only residues before proline not including glycine or proline</span>
  774 <span class="sd">    </span>
  775 <span class="sd">    Arguments:</span>
  776 <span class="sd">        MoleculeName (str): Name of a PyMOL molecule object.</span>
  777 
  778 <span class="sd">    Returns:</span>
  779 <span class="sd">        dict: A dictionary containing sorted list of residue numbers for each</span>
  780 <span class="sd">            chain and dictionaries of residue names, phi and psi angles for each</span>
  781 <span class="sd">            residue number.</span>
  782 
  783 <span class="sd">    Examples:</span>
  784 
  785 <span class="sd">        PhiPsiInfoMap = GetPhiPsiChainsAndResiduesInfo(MolName)</span>
  786 <span class="sd">        for ChainID in PhiPsiInfoMap[&quot;ChainIDs&quot;]:</span>
  787 <span class="sd">            for ResNum in PhiPsiInfoMap[&quot;ResNums&quot;][ChainID]:</span>
  788 <span class="sd">                ResName = PhiPsiInfoMap[&quot;ResName&quot;][ChainID][ResNum]</span>
  789 <span class="sd">                Phi = PhiPsiInfoMap[&quot;Phi&quot;][ChainID][ResNum]</span>
  790 <span class="sd">                Psi = PhiPsiInfoMap[&quot;Psi&quot;][ChainID][ResNum]</span>
  791 <span class="sd">                Category = PhiPsiInfoMap[&quot;Category&quot;][ChainID][ResNum]</span>
  792 <span class="sd">                MiscUtil.PrintInfo(&quot;ChainID: %s; ResNum: %s; ResName: %s; Phi: %8.2f;</span>
  793 <span class="sd">                    Psi: %8.2f; Category: %s&quot; % (ChainID, ResNum, ResName, Phi,</span>
  794 <span class="sd">                    Psi, Category))</span>
  795 
  796 <span class="sd">    &quot;&quot;&quot;</span>
  797     <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">):</span>
  798         <span class="k">return</span> <span class="bp">None</span>
  799 
  800     <span class="n">SelectionCmd</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MoleculeName</span><span class="p">)</span>
  801     <span class="n">PhiPsiResiduesInfoMap</span> <span class="o">=</span> <span class="n">_GetSelectionPhiPsiChainsAndResiduesInfo</span><span class="p">(</span><span class="n">SelectionCmd</span><span class="p">,</span> <span class="n">Categorize</span><span class="p">)</span>
  802 
  803     <span class="k">return</span> <span class="n">PhiPsiResiduesInfoMap</span>
  804 
  805 <span class="k">def</span> <span class="nf">GetPhiPsiCategoriesResiduesInfo</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">):</span>
  806     <span class="sd">&quot;&quot;&quot;Get phi and psi torsion angle information for residues in a chain of a</span>
  807 <span class="sd">    molecule containing amino acids.</span>
  808 
  809 <span class="sd">    The phi and psi angles are optionally categorized into the following groups</span>
  810 <span class="sd">    corresponding to four types of  Ramachandran plots:</span>
  811 <span class="sd">    </span>
  812 <span class="sd">    General: All residues except glycine, proline, or pre-proline</span>
  813 <span class="sd">    Glycine: Only glycine residues</span>
  814 <span class="sd">    Proline: Only proline residues</span>
  815 <span class="sd">    Pre-Proline: Only residues before proline not including glycine or proline</span>
  816 <span class="sd">    </span>
  817 <span class="sd">    Arguments:</span>
  818 <span class="sd">        MoleculeName (str): Name of a PyMOL molecule object.</span>
  819 <span class="sd">        ChainName (str): Name of a chain in a molecule.</span>
  820 
  821 <span class="sd">    Returns:</span>
  822 <span class="sd">        dict1: Phi and psi angle information for residues in General category.</span>
  823 <span class="sd">            It&#39;s a dictionary containing sorted list of residue numbers and</span>
  824 <span class="sd">            dictionaries of residue names, phi and psi angles for each residue</span>
  825 <span class="sd">            number.</span>
  826 <span class="sd">        dict2: Phi and psi angle information for residues in Gly category.</span>
  827 <span class="sd">        dict3: Phi and psi angle information for residues in Pro category.</span>
  828 <span class="sd">        dict2: Phi and psi angle information for residues in Pre-Pro category.</span>
  829 
  830 <span class="sd">    Examples:</span>
  831 
  832 <span class="sd">        GeneralPhiPsiInfo, GlyPhiPsiInfo, ProPhiPsiInfo, PreProPhiPsiInfo =</span>
  833 <span class="sd">            GetPhiPsiCategoriesResiduesInfo(MolName, ChainID)</span>
  834 <span class="sd">        for ResNum in GeneralPhiPsiInfo[&quot;ResNums&quot;]:</span>
  835 <span class="sd">            ResName = GeneralPhiPsiInfo[&quot;ResName&quot;][ResNum]</span>
  836 <span class="sd">            Phi = GeneralPhiPsiInfo[&quot;Phi&quot;][ResNum]</span>
  837 <span class="sd">            Psi = GeneralPhiPsiInfo[&quot;Psi&quot;][ResNum]</span>
  838 <span class="sd">            MiscUtil.PrintInfo(&quot;ResNum: %s; ResName: %s;</span>
  839 <span class="sd">                Phi: %8.2f; Psi: %8.2f&quot; % (ResNum, ResName, Phi, Psi))</span>
  840 
  841 <span class="sd">    &quot;&quot;&quot;</span>
  842     <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">ChainName</span><span class="p">)):</span>
  843         <span class="k">return</span> <span class="bp">None</span>
  844 
  845     <span class="n">SelectionCmd</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">)</span>
  846     <span class="n">GeneralPhiPsiInfo</span><span class="p">,</span> <span class="n">GlyPhiPsiInfo</span><span class="p">,</span> <span class="n">ProPhiPsiInfo</span><span class="p">,</span> <span class="n">PreProPhiPsiInfo</span> <span class="o">=</span> <span class="n">_GetSelectionPhiPsiCategoriesResiduesInfo</span><span class="p">(</span><span class="n">SelectionCmd</span><span class="p">)</span>
  847 
  848     <span class="k">return</span> <span class="n">GeneralPhiPsiInfo</span><span class="p">,</span> <span class="n">GlyPhiPsiInfo</span><span class="p">,</span> <span class="n">ProPhiPsiInfo</span><span class="p">,</span> <span class="n">PreProPhiPsiInfo</span>
  849 
  850 <span class="k">def</span> <span class="nf">GetSurfaceAndBuriedResiduesInfo</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">SASACutoff</span> <span class="o">=</span> <span class="mf">2.5</span><span class="p">):</span>
  851     <span class="sd">&quot;&quot;&quot;Get information for surafce and buried residues present in a chain of a</span>
  852 <span class="sd">    molecule. The surface residues correspond to residues with Solvent Accessible</span>
  853 <span class="sd">    Surface Area (SASA) greater than or equal to the cutoff value. Otherwise, these</span>
  854 <span class="sd">    residues are considered as buried residues.</span>
  855 
  856 <span class="sd">    Arguments:</span>
  857 <span class="sd">        MoleculeName (str): Name of a PyMOL molecule object.</span>
  858 <span class="sd">        ChainName (str): Name of a chain in a molecule.</span>
  859 <span class="sd">        SASACutoff (float): SASA cutoff for heavy atoms corresponding to</span>
  860 <span class="sd">            surface residues in chain. Units: Angstroms ** 2</span>
  861 
  862 <span class="sd">    Returns:</span>
  863 <span class="sd">        dict: A dictionary containing list of residue names and dictionaries of</span>
  864 <span class="sd">            residue numbers and residue count for each residue. Names of </span>
  865 <span class="sd">            residues in the dictionary are not sorted.</span>
  866 <span class="sd">        dict2: Buried residues in a chain.</span>
  867 
  868 <span class="sd">    Examples:</span>
  869 
  870 <span class="sd">        SurfaceResiduesInfo, BurriedResiduesInfo =</span>
  871 <span class="sd">            GetSurfaceResiduesInfo(MolName, ChainName, 2.5)</span>
  872 <span class="sd">        for ResName in SurfaceResiduesInfo[&quot;ResNames&quot;]:</span>
  873 <span class="sd">            ResCount = ResiduesInfo[&quot;ResCount&quot;][ResName]</span>
  874 <span class="sd">            ResNums = ResiduesInfo[&quot;ResNum&quot;][ResName]</span>
  875 <span class="sd">            MiscUtil.PrintInfo(&quot;ResName: %s; ResCount: %s; ResNums: %s&quot; %</span>
  876 <span class="sd">                (ResName, ResCount, ResNums))</span>
  877 
  878 <span class="sd">    &quot;&quot;&quot;</span>
  879     <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">ChainName</span><span class="p">)):</span>
  880         <span class="k">return</span> <span class="bp">None</span>
  881     
  882     <span class="c1"># Get ready to calculate solvent accessible surface area..</span>
  883     <span class="n">CurrentDotSolvent</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;dot_solvent&quot;</span><span class="p">)</span>
  884     <span class="n">cmd</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;dot_solvent&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
  885 
  886     <span class="c1"># Setup tmp object name...</span>
  887     <span class="n">TmpChainName</span> <span class="o">=</span> <span class="s2">&quot;Tmp_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MoleculeName</span><span class="p">)</span>
  888     <span class="n">TmpChainSelection</span> <span class="o">=</span> <span class="s2">&quot;(</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2"> and polymer and not hydrogens)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">)</span>
  889     <span class="n">cmd</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">TmpChainName</span><span class="p">,</span> <span class="s2">&quot;(</span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">TmpChainSelection</span><span class="p">))</span>
  890 
  891     <span class="c1"># Calculate SASA for chain and load it into b...</span>
  892     <span class="n">cmd</span><span class="o">.</span><span class="n">get_area</span><span class="p">(</span><span class="n">TmpChainName</span><span class="p">,</span> <span class="n">load_b</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
  893     
  894     <span class="c1"># Retrieve SASA for residues as B values...</span>
  895     <span class="n">ResiduesBValuesInfoMap</span> <span class="o">=</span> <span class="n">_GetSelectionResiduesBValuesInfo</span><span class="p">(</span><span class="n">TmpChainName</span><span class="p">)</span>
  896 
  897     <span class="c1"># Retrieve information for surface and buried residues...</span>
  898     <span class="n">SurfaceResiduesInfoMap</span> <span class="o">=</span> <span class="n">_GetResiduesInfoFromResiduesBValues</span><span class="p">(</span><span class="n">ResiduesBValuesInfoMap</span><span class="p">,</span> <span class="s2">&quot;&gt;=&quot;</span><span class="p">,</span> <span class="n">SASACutoff</span><span class="p">)</span>
  899     <span class="n">BuriedResiduesInfoMap</span> <span class="o">=</span> <span class="n">_GetResiduesInfoFromResiduesBValues</span><span class="p">(</span><span class="n">ResiduesBValuesInfoMap</span><span class="p">,</span> <span class="s2">&quot;&lt;&quot;</span><span class="p">,</span> <span class="n">SASACutoff</span><span class="p">)</span>
  900     
  901     <span class="c1"># Delete tmp objects...</span>
  902     <span class="n">cmd</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">TmpChainName</span><span class="p">)</span>
  903     
  904     <span class="c1"># Restore current dot solvent...</span>
  905     <span class="n">cmd</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;dot_solvent&quot;</span><span class="p">,</span> <span class="n">CurrentDotSolvent</span><span class="p">)</span>
  906 
  907     <span class="k">return</span> <span class="n">SurfaceResiduesInfoMap</span><span class="p">,</span> <span class="n">BuriedResiduesInfoMap</span>
  908 
  909 <span class="k">def</span> <span class="nf">GetInterfaceChainsResiduesByCAlphaAtomsDistance</span><span class="p">(</span><span class="n">MoleculeName1</span><span class="p">,</span> <span class="n">ChainNames1</span><span class="p">,</span> <span class="n">MoleculeName2</span><span class="p">,</span> <span class="n">ChainNames2</span><span class="p">,</span> <span class="n">DistanceCutoff</span> <span class="o">=</span> <span class="mf">8.0</span><span class="p">):</span>
  910     <span class="sd">&quot;&quot;&quot;Get information for interface residues between chains in two</span>
  911 <span class="sd">    molecules based on the distance between CAlpha atoms. The chain</span>
  912 <span class="sd">    specification for molecules may contain multiple chain names delimited</span>
  913 <span class="sd">    by commas.</span>
  914 <span class="sd">    </span>
  915 <span class="sd">    The interface residues are identified using PyMOL &#39;bycalpha&#39; selection</span>
  916 <span class="sd">    operator with in a specified distance.</span>
  917 <span class="sd">    </span>
  918 <span class="sd">    Arguments:</span>
  919 <span class="sd">        MoleculeName1 (str): Name of a PyMOL molecule object.</span>
  920 <span class="sd">        ChainNames1 (str): A chain name or comma delimited list of chain</span>
  921 <span class="sd">            names in a molecule.</span>
  922 <span class="sd">        MoleculeName2 (str): Name of a PyMOL molecule object.</span>
  923 <span class="sd">        ChainNames2 (str): A chain name or comma delimited list of chain</span>
  924 <span class="sd">            names in a molecule.</span>
  925 <span class="sd">        DistanceCutoff (float): Distance cutoff for distance between</span>
  926 <span class="sd">            any two CAlpha atoms in interface residues in different chains.</span>
  927 
  928 <span class="sd">    Returns:</span>
  929 <span class="sd">        dict1: Interface residues in a chain for first molecule. It is a</span>
  930 <span class="sd">            dictionary containing list of residue names and dictionaries of</span>
  931 <span class="sd">            residue numbers and residue count for each residue. Names of </span>
  932 <span class="sd">            residues in the dictionary are not sorted.</span>
  933 <span class="sd">        dict2: Interface residues in the chain for second molecule.</span>
  934 
  935 <span class="sd">    Examples:</span>
  936 
  937 <span class="sd">        ResiduesInfo1, ResiduesInfo2 = </span>
  938 <span class="sd">            GetInterfaceResiduesByHeavyAtomsDistance(MolName1,</span>
  939 <span class="sd">            ChainName1, MolName2, ChainName2, DistanceCutoff)</span>
  940 <span class="sd">        for ChainID in ResiduesInfo1[&quot;ChainIDs&quot;]:</span>
  941 <span class="sd">            for ResName in ResiduesInfo1[&quot;ResNames&quot;][ChainID]:</span>
  942 <span class="sd">                ResCount = ResiduesInfo1[&quot;ResCount&quot;][ChainID][ResName]</span>
  943 <span class="sd">                ResNums = ResiduesInfo1[&quot;ResNum&quot;][ChainID][ResName]</span>
  944 <span class="sd">                MiscUtil.PrintInfo(&quot;ResName: %s; ResCount: %s; ResNums:</span>
  945 <span class="sd">                %s&quot; % (ResName, ResCount, ResNums))</span>
  946 
  947 <span class="sd">    &quot;&quot;&quot;</span>
  948     <span class="n">ChainNames1Selection</span><span class="p">,</span> <span class="n">ChainNames2Selection</span> <span class="o">=</span> <span class="n">_ValidateAndSetupChainSelectionsForInterfaceResidues</span><span class="p">(</span><span class="n">MoleculeName1</span><span class="p">,</span> <span class="n">ChainNames1</span><span class="p">,</span> <span class="n">MoleculeName2</span><span class="p">,</span> <span class="n">ChainNames2</span><span class="p">)</span>
  949     
  950     <span class="k">if</span> <span class="n">ChainNames1Selection</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">ChainNames2Selection</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
  951         <span class="k">return</span> <span class="bp">None</span>
  952 
  953     <span class="n">MoleculeSelection1</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MoleculeName1</span><span class="p">,</span> <span class="n">ChainNames1Selection</span><span class="p">)</span>
  954     <span class="n">MoleculeSelection2</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MoleculeName2</span><span class="p">,</span> <span class="n">ChainNames2Selection</span><span class="p">)</span>
  955 
  956     <span class="n">SelectionCmd1</span> <span class="o">=</span> <span class="s2">&quot;((bycalpha (</span><span class="si">%s</span><span class="s2">) within </span><span class="si">%.1f</span><span class="s2"> of  (</span><span class="si">%s</span><span class="s2">)) and polymer)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MoleculeSelection1</span><span class="p">,</span> <span class="n">DistanceCutoff</span><span class="p">,</span> <span class="n">MoleculeSelection2</span><span class="p">)</span>
  957     <span class="n">ResiduesInfoMap1</span><span class="o">=</span> <span class="n">_GetSelectionChainsAndResiduesInfo</span><span class="p">(</span><span class="n">SelectionCmd1</span><span class="p">)</span>
  958 
  959     <span class="n">SelectionCmd2</span> <span class="o">=</span> <span class="s2">&quot;((bycalpha (</span><span class="si">%s</span><span class="s2">) within </span><span class="si">%.1f</span><span class="s2"> of  (</span><span class="si">%s</span><span class="s2">)) and polymer)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MoleculeSelection2</span><span class="p">,</span> <span class="n">DistanceCutoff</span><span class="p">,</span> <span class="n">MoleculeSelection1</span><span class="p">)</span>
  960     <span class="n">ResiduesInfoMap2</span><span class="o">=</span> <span class="n">_GetSelectionChainsAndResiduesInfo</span><span class="p">(</span><span class="n">SelectionCmd2</span><span class="p">)</span>
  961 
  962     <span class="k">return</span> <span class="n">ResiduesInfoMap1</span><span class="p">,</span> <span class="n">ResiduesInfoMap2</span>
  963 
  964 <span class="k">def</span> <span class="nf">GetnterfaceChainsResiduesByHeavyAtomsDistance</span><span class="p">(</span><span class="n">MoleculeName1</span><span class="p">,</span> <span class="n">ChainNames1</span><span class="p">,</span> <span class="n">MoleculeName2</span><span class="p">,</span> <span class="n">ChainNames2</span><span class="p">,</span> <span class="n">DistanceCutoff</span> <span class="o">=</span> <span class="mf">5.0</span><span class="p">):</span>
  965     <span class="sd">&quot;&quot;&quot;Get information for interface residues between chains in two</span>
  966 <span class="sd">    molecules based on the distance between heavy atoms. The chain</span>
  967 <span class="sd">    specification for molecules may contain multiple chain names delimited</span>
  968 <span class="sd">    by commas.</span>
  969 <span class="sd">    </span>
  970 <span class="sd">    The interface residues are identified using PyMOL &#39;byresidue&#39; selection</span>
  971 <span class="sd">    operator with in a specified distance.</span>
  972 <span class="sd">    </span>
  973 <span class="sd">    Arguments:</span>
  974 <span class="sd">        MoleculeName1 (str): Name of a PyMOL molecule object.</span>
  975 <span class="sd">        ChainNames1 (str): A chain name or comma delimited list of chain</span>
  976 <span class="sd">            names in a molecule.</span>
  977 <span class="sd">        MoleculeName2 (str): Name of a PyMOL molecule object.</span>
  978 <span class="sd">        ChainNames2 (str): A chain name or comma delimited list of chain</span>
  979 <span class="sd">            names in a molecule.</span>
  980 <span class="sd">        DistanceCutoff (float): Distance cutoff for distance between</span>
  981 <span class="sd">            any two heavy atoms in interface residues in different chains.</span>
  982 
  983 <span class="sd">    Returns:</span>
  984 <span class="sd">        dict1: Interface residues in a chain for first molecule. It is a</span>
  985 <span class="sd">            dictionary containing list of residue names and dictionaries of</span>
  986 <span class="sd">            residue numbers and residue count for each residue. Names of </span>
  987 <span class="sd">            residues in the dictionary are not sorted.</span>
  988 <span class="sd">        dict2: Interface residues in the chain for second molecule.</span>
  989 
  990 <span class="sd">    Examples:</span>
  991 
  992 <span class="sd">        ResiduesInfo1, ResiduesInfo2 = </span>
  993 <span class="sd">            GetInterfaceResiduesByHeavyAtomsDistance(MolName1,</span>
  994 <span class="sd">            ChainName1, MolName2, ChainName2, DistanceCutoff)</span>
  995 <span class="sd">        for ChainID in ResiduesInfo1[&quot;ChainIDs&quot;]:</span>
  996 <span class="sd">            for ResName in ResiduesInfo1[&quot;ResNames&quot;][ChainID]:</span>
  997 <span class="sd">                ResCount = ResiduesInfo1[&quot;ResCount&quot;][ChainID][ResName]</span>
  998 <span class="sd">                ResNums = ResiduesInfo1[&quot;ResNum&quot;][ChainID][ResName]</span>
  999 <span class="sd">                MiscUtil.PrintInfo(&quot;ResName: %s; ResCount: %s; ResNums:</span>
 1000 <span class="sd">                %s&quot; % (ResName, ResCount, ResNums))</span>
 1001 
 1002 <span class="sd">    &quot;&quot;&quot;</span>
 1003     <span class="n">ChainNames1Selection</span><span class="p">,</span> <span class="n">ChainNames2Selection</span> <span class="o">=</span> <span class="n">_ValidateAndSetupChainSelectionsForInterfaceResidues</span><span class="p">(</span><span class="n">MoleculeName1</span><span class="p">,</span> <span class="n">ChainNames1</span><span class="p">,</span> <span class="n">MoleculeName2</span><span class="p">,</span> <span class="n">ChainNames2</span><span class="p">)</span>
 1004     
 1005     <span class="k">if</span> <span class="n">ChainNames1Selection</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">ChainNames2Selection</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
 1006         <span class="k">return</span> <span class="bp">None</span>
 1007 
 1008     <span class="n">MoleculeSelection1</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2"> and (not hydrogens)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MoleculeName1</span><span class="p">,</span> <span class="n">ChainNames1Selection</span><span class="p">)</span>
 1009     <span class="n">MoleculeSelection2</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2"> and (not hydrogens)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MoleculeName2</span><span class="p">,</span> <span class="n">ChainNames2Selection</span><span class="p">)</span>
 1010 
 1011     <span class="n">SelectionCmd1</span> <span class="o">=</span> <span class="s2">&quot;((byresidue (</span><span class="si">%s</span><span class="s2">) within </span><span class="si">%.1f</span><span class="s2"> of  (</span><span class="si">%s</span><span class="s2">)) and polymer)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MoleculeSelection1</span><span class="p">,</span> <span class="n">DistanceCutoff</span><span class="p">,</span> <span class="n">MoleculeSelection2</span><span class="p">)</span>
 1012     <span class="n">ResiduesInfoMap1</span><span class="o">=</span> <span class="n">_GetSelectionChainsAndResiduesInfo</span><span class="p">(</span><span class="n">SelectionCmd1</span><span class="p">)</span>
 1013 
 1014     <span class="n">SelectionCmd2</span> <span class="o">=</span> <span class="s2">&quot;((byresidue (</span><span class="si">%s</span><span class="s2">) within </span><span class="si">%.1f</span><span class="s2"> of  (</span><span class="si">%s</span><span class="s2">)) and polymer)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MoleculeSelection2</span><span class="p">,</span> <span class="n">DistanceCutoff</span><span class="p">,</span> <span class="n">MoleculeSelection1</span><span class="p">)</span>
 1015     <span class="n">ResiduesInfoMap2</span><span class="o">=</span> <span class="n">_GetSelectionChainsAndResiduesInfo</span><span class="p">(</span><span class="n">SelectionCmd2</span><span class="p">)</span>
 1016 
 1017     <span class="k">return</span> <span class="n">ResiduesInfoMap1</span><span class="p">,</span> <span class="n">ResiduesInfoMap2</span>
 1018 
 1019 <span class="k">def</span> <span class="nf">GetInterfaceChainsResiduesBySASAChange</span><span class="p">(</span><span class="n">MoleculeName1</span><span class="p">,</span> <span class="n">ChainNames1</span><span class="p">,</span> <span class="n">MoleculeName2</span><span class="p">,</span> <span class="n">ChainNames2</span><span class="p">,</span> <span class="n">ChangeCutoff</span> <span class="o">=</span> <span class="mf">0.75</span><span class="p">):</span>
 1020     <span class="sd">&quot;&quot;&quot;Get information for interface residues between chains in two</span>
 1021 <span class="sd">    molecules based on the change in solvent accessible surface area</span>
 1022 <span class="sd">    (SASA) of a residue in chains in a molecule and chain complex</span>
 1023 <span class="sd">    containing specified chains across both molecules. The chain </span>
 1024 <span class="sd">    specification for molecules may contain multiple chain names</span>
 1025 <span class="sd">    delimited by commas.</span>
 1026 
 1027 <span class="sd">    Arguments:</span>
 1028 <span class="sd">        MoleculeName1 (str): Name of a PyMOL molecule object.</span>
 1029 <span class="sd">        ChainNames1 (str): A chain name or comma delimited list of chain</span>
 1030 <span class="sd">            names in a molecule.</span>
 1031 <span class="sd">        MoleculeName2 (str): Name of a PyMOL molecule object.</span>
 1032 <span class="sd">        ChainNames2 (str): A chain name or comma delimited list of chain</span>
 1033 <span class="sd">            names in a molecule.</span>
 1034 <span class="sd">        ChangeCutoff (float): SASA change cutoff for heavy atoms in</span>
 1035 <span class="sd">            a interface residue between an individual chain and a complex</span>
 1036 <span class="sd">            containing both chains.  Units: Angstroms ** 2</span>
 1037 
 1038 <span class="sd">    Returns:</span>
 1039 <span class="sd">        dict1: Interface residues in the chain for first molecule. It is a</span>
 1040 <span class="sd">            dictionary containing list of residue names and dictionaries of</span>
 1041 <span class="sd">            residue numbers and residue count for each residue. Names of </span>
 1042 <span class="sd">            residues in the dictionary are not sorted.</span>
 1043 <span class="sd">        dict2: Interface residues in the chain for second molecule.</span>
 1044 
 1045 <span class="sd">    Examples:</span>
 1046 
 1047 <span class="sd">        ResiduesInfo1, ResiduesInfo2 = </span>
 1048 <span class="sd">            GetInterfaceResiduesBySASAChange(MolName1,</span>
 1049 <span class="sd">            ChainName1, MolName2, ChainName2, DistanceCutoff)</span>
 1050 <span class="sd">        for ResName in ResiduesInfo1[&quot;ResNames&quot;]:</span>
 1051 <span class="sd">            ResCount = ResiduesInfo1[&quot;ResCount&quot;][ResName]</span>
 1052 <span class="sd">            ResNums = ResiduesInfo1[&quot;ResNum&quot;][ResName]</span>
 1053 <span class="sd">            MiscUtil.PrintInfo(&quot;ResName: %s; ResCount: %s; ResNums: %s&quot; %</span>
 1054 <span class="sd">                (ResName, ResCount, ResNums))</span>
 1055 
 1056 <span class="sd">    &quot;&quot;&quot;</span>
 1057     <span class="n">ChainNames1Selection</span><span class="p">,</span> <span class="n">ChainNames2Selection</span> <span class="o">=</span> <span class="n">_ValidateAndSetupChainSelectionsForInterfaceResidues</span><span class="p">(</span><span class="n">MoleculeName1</span><span class="p">,</span> <span class="n">ChainNames1</span><span class="p">,</span> <span class="n">MoleculeName2</span><span class="p">,</span> <span class="n">ChainNames2</span><span class="p">)</span>
 1058     
 1059     <span class="k">if</span> <span class="n">ChainNames1Selection</span> <span class="ow">is</span> <span class="bp">None</span> <span class="ow">or</span> <span class="n">ChainNames2Selection</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
 1060         <span class="k">return</span> <span class="bp">None</span>
 1061 
 1062     <span class="c1"># Get ready to calculate solvent accessible surface area..</span>
 1063     <span class="n">CurrentDotSolvent</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;dot_solvent&quot;</span><span class="p">)</span>
 1064     <span class="n">cmd</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;dot_solvent&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
 1065 
 1066     <span class="c1"># Setup tmp object names...</span>
 1067     <span class="n">TmpComplexName</span> <span class="o">=</span> <span class="s2">&quot;Tmp1_</span><span class="si">%s</span><span class="s2">_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MoleculeName1</span><span class="p">,</span> <span class="n">MoleculeName2</span><span class="p">)</span>
 1068     <span class="n">TmpChainName1</span> <span class="o">=</span> <span class="s2">&quot;Tmp2_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MoleculeName1</span><span class="p">)</span>
 1069     <span class="n">TmpChainName2</span> <span class="o">=</span> <span class="s2">&quot;Tmp3_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MoleculeName2</span><span class="p">)</span>
 1070     
 1071     <span class="c1"># Setup complex...</span>
 1072     <span class="n">TmpComplexSelection</span> <span class="o">=</span> <span class="s2">&quot;(</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2"> and polymer and not hydrogens) or (</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2"> and polymer and not hydrogens)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MoleculeName1</span><span class="p">,</span> <span class="n">ChainNames1Selection</span><span class="p">,</span> <span class="n">MoleculeName2</span><span class="p">,</span> <span class="n">ChainNames2Selection</span><span class="p">)</span>
 1073     <span class="n">cmd</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">TmpComplexName</span><span class="p">,</span> <span class="s2">&quot;(</span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">TmpComplexSelection</span><span class="p">))</span>
 1074 
 1075     <span class="c1"># Calculate SASA for complex and load it into b...</span>
 1076     <span class="n">cmd</span><span class="o">.</span><span class="n">get_area</span><span class="p">(</span><span class="n">TmpComplexName</span><span class="p">,</span> <span class="n">load_b</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
 1077     <span class="n">cmd</span><span class="o">.</span><span class="n">alter</span><span class="p">(</span><span class="n">TmpComplexName</span><span class="p">,</span> <span class="s2">&quot;q=b&quot;</span><span class="p">)</span>
 1078     
 1079     <span class="c1"># Setup individual chains and calculate SASA...</span>
 1080     <span class="n">TmpChainNameSelection1</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> and (chain </span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">TmpComplexName</span><span class="p">,</span> <span class="n">ChainNames1Selection</span><span class="p">)</span>
 1081     <span class="n">cmd</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">TmpChainName1</span><span class="p">,</span> <span class="s2">&quot;(</span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="n">TmpChainNameSelection1</span><span class="p">)</span>
 1082     <span class="n">cmd</span><span class="o">.</span><span class="n">get_area</span><span class="p">(</span><span class="n">TmpChainName1</span><span class="p">,</span> <span class="n">load_b</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
 1083 
 1084     <span class="n">TmpChainNameSelection2</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> and (chain </span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">TmpComplexName</span><span class="p">,</span> <span class="n">ChainNames2Selection</span><span class="p">)</span>
 1085     <span class="n">cmd</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">TmpChainName2</span><span class="p">,</span> <span class="s2">&quot;(</span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="n">TmpChainNameSelection2</span><span class="p">)</span>
 1086     <span class="n">cmd</span><span class="o">.</span><span class="n">get_area</span><span class="p">(</span><span class="n">TmpChainName2</span><span class="p">,</span> <span class="n">load_b</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
 1087 
 1088     <span class="c1"># Calculate SASA difference for individual chains...</span>
 1089     <span class="n">TmpChainNamesSelection</span> <span class="o">=</span> <span class="s2">&quot;(</span><span class="si">%s</span><span class="s2"> or </span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">TmpChainName1</span><span class="p">,</span> <span class="n">TmpChainName2</span><span class="p">)</span>
 1090     <span class="n">cmd</span><span class="o">.</span><span class="n">alter</span><span class="p">(</span><span class="n">TmpChainNamesSelection</span><span class="p">,</span> <span class="s2">&quot;b=b-q&quot;</span><span class="p">)</span>
 1091 
 1092     <span class="n">ResiduesInfoMap1</span> <span class="o">=</span> <span class="n">_GetChainsResiduesInfoForSASAChange</span><span class="p">(</span><span class="n">TmpChainNamesSelection</span><span class="p">,</span> <span class="n">TmpChainName1</span><span class="p">,</span> <span class="n">ChangeCutoff</span><span class="p">)</span>
 1093     <span class="n">ResiduesInfoMap2</span> <span class="o">=</span> <span class="n">_GetChainsResiduesInfoForSASAChange</span><span class="p">(</span><span class="n">TmpChainNamesSelection</span><span class="p">,</span> <span class="n">TmpChainName2</span><span class="p">,</span> <span class="n">ChangeCutoff</span><span class="p">)</span>
 1094 
 1095     <span class="c1"># Delete tmp objects...</span>
 1096     <span class="n">cmd</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">TmpComplexName</span><span class="p">)</span>
 1097     <span class="n">cmd</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">TmpChainName1</span><span class="p">)</span>
 1098     <span class="n">cmd</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">TmpChainName2</span><span class="p">)</span>
 1099     
 1100     <span class="c1"># Restore current dot solvent...</span>
 1101     <span class="n">cmd</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s2">&quot;dot_solvent&quot;</span><span class="p">,</span> <span class="n">CurrentDotSolvent</span><span class="p">)</span>
 1102     
 1103     <span class="k">return</span> <span class="n">ResiduesInfoMap1</span><span class="p">,</span> <span class="n">ResiduesInfoMap2</span>
 1104 
 1105 <span class="k">def</span> <span class="nf">_GetChainsResiduesInfoForSASAChange</span><span class="p">(</span><span class="n">SelectionCmd</span><span class="p">,</span> <span class="n">MoleculeName</span><span class="p">,</span> <span class="n">ChangeCutoff</span><span class="p">):</span>
 1106     <span class="sd">&quot;&quot;&quot;Get residue info for SASA change. &quot;&quot;&quot;</span>
 1107 
 1108     <span class="c1"># Retrieve data...</span>
 1109     <span class="n">stored</span><span class="o">.</span><span class="n">ResiduesInfo</span> <span class="o">=</span> <span class="p">[]</span>
 1110     <span class="n">cmd</span><span class="o">.</span><span class="n">iterate</span><span class="p">(</span><span class="n">SelectionCmd</span><span class="p">,</span> <span class="s2">&quot;stored.ResiduesInfo.append([model, chain, resi, resn, b])&quot;</span><span class="p">)</span>
 1111 
 1112     <span class="c1"># Calculate SASA change for each residue...</span>
 1113     <span class="n">SASAChangeMap</span> <span class="o">=</span> <span class="p">{}</span>
 1114     <span class="n">SASAChangeMap</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1115     <span class="n">SASAChangeMap</span><span class="p">[</span><span class="s2">&quot;ResIDs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1116     <span class="n">SASAChangeMap</span><span class="p">[</span><span class="s2">&quot;ResSASAChange&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1117     
 1118     <span class="k">for</span> <span class="n">Model</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">ResNum</span><span class="p">,</span> <span class="n">ResName</span><span class="p">,</span> <span class="n">AtomSASAChange</span> <span class="ow">in</span> <span class="n">stored</span><span class="o">.</span><span class="n">ResiduesInfo</span><span class="p">:</span>
 1119         <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">Model</span><span class="p">,</span> <span class="n">MoleculeName</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1120             <span class="k">continue</span>
 1121         <span class="n">ResID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResName</span><span class="p">,</span> <span class="n">ResNum</span><span class="p">)</span>
 1122         
 1123         <span class="k">if</span> <span class="ow">not</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">SASAChangeMap</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]:</span>
 1124             <span class="c1"># Track new chain ID and intialize SASA change information...</span>
 1125             <span class="n">SASAChangeMap</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ChainID</span><span class="p">)</span>
 1126             <span class="n">SASAChangeMap</span><span class="p">[</span><span class="s2">&quot;ResIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1127             <span class="n">SASAChangeMap</span><span class="p">[</span><span class="s2">&quot;ResSASAChange&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span><span class="o">=</span> <span class="p">{}</span>
 1128 
 1129         <span class="k">if</span> <span class="n">ResID</span> <span class="ow">in</span> <span class="n">SASAChangeMap</span><span class="p">[</span><span class="s2">&quot;ResSASAChange&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]:</span>
 1130             <span class="n">SASAChangeMap</span><span class="p">[</span><span class="s2">&quot;ResSASAChange&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResID</span><span class="p">]</span> <span class="o">+=</span> <span class="n">AtomSASAChange</span>
 1131         <span class="k">else</span><span class="p">:</span>
 1132             <span class="c1"># Track new residue ID...</span>
 1133             <span class="n">SASAChangeMap</span><span class="p">[</span><span class="s2">&quot;ResIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ResID</span><span class="p">)</span>
 1134             <span class="n">SASAChangeMap</span><span class="p">[</span><span class="s2">&quot;ResSASAChange&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResID</span><span class="p">]</span> <span class="o">=</span> <span class="n">AtomSASAChange</span>
 1135 
 1136     <span class="c1"># Identify residues with SASA change greater than the specified cutoff value...</span>
 1137     <span class="n">SelectionInfoMap</span> <span class="o">=</span> <span class="p">{}</span>
 1138     <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1139     
 1140     <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResNames&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1141     <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResNum&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1142     <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResCount&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1143 
 1144     <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">SASAChangeMap</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]:</span>
 1145         <span class="k">for</span> <span class="n">ResID</span> <span class="ow">in</span> <span class="n">SASAChangeMap</span><span class="p">[</span><span class="s2">&quot;ResIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]:</span>
 1146             <span class="n">ResSASAChange</span> <span class="o">=</span> <span class="n">SASAChangeMap</span><span class="p">[</span><span class="s2">&quot;ResSASAChange&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResID</span><span class="p">]</span>
 1147             <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">ResSASAChange</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">ChangeCutoff</span><span class="p">:</span>
 1148                 <span class="k">continue</span>
 1149             <span class="n">ResName</span><span class="p">,</span> <span class="n">ResNum</span> <span class="o">=</span> <span class="n">ResID</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span>
 1150             
 1151             <span class="k">if</span> <span class="ow">not</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]:</span>
 1152                 <span class="c1"># Track new chain ID and intialize residues information...</span>
 1153                 <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ChainID</span><span class="p">)</span>
 1154                 <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResNames&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1155                 <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResNum&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span><span class="o">=</span> <span class="p">{}</span>
 1156                 <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResCount&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1157             
 1158             <span class="k">if</span> <span class="n">ResName</span> <span class="ow">in</span> <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResNames&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]:</span>
 1159                 <span class="k">if</span> <span class="ow">not</span> <span class="n">ResNum</span> <span class="ow">in</span> <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResNum&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResName</span><span class="p">]:</span>
 1160                     <span class="c1"># Same residue name but different residue number</span>
 1161                     <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResNum&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResName</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ResNum</span><span class="p">)</span>
 1162                     <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResCount&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResName</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
 1163             <span class="k">else</span><span class="p">:</span>
 1164                 <span class="c1"># Track new residue information...</span>
 1165                 <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResNames&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ResName</span><span class="p">)</span>
 1166                 
 1167                 <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResNum&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResName</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1168                 <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResNum&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResName</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ResNum</span><span class="p">)</span>
 1169                 
 1170                 <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResCount&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResName</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
 1171     
 1172     <span class="k">return</span> <span class="n">SelectionInfoMap</span>
 1173 
 1174 <span class="k">def</span> <span class="nf">_ValidateAndSetupChainSelectionsForInterfaceResidues</span><span class="p">(</span><span class="n">MoleculeName1</span><span class="p">,</span> <span class="n">ChainNames1</span><span class="p">,</span> <span class="n">MoleculeName2</span><span class="p">,</span> <span class="n">ChainNames2</span><span class="p">):</span>
 1175     <span class="sd">&quot;&quot;&quot;Validate and setup chains name selectons for idenfitying interface residues.&quot;&quot;&quot;</span>
 1176     
 1177     <span class="n">ChainNames1</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">ChainNames1</span><span class="p">)</span>
 1178     <span class="n">ChainNames2</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">ChainNames2</span><span class="p">)</span>
 1179     
 1180     <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">MoleculeName1</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">ChainNames1</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">MoleculeName2</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">ChainNames2</span><span class="p">)):</span>
 1181         <span class="k">return</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span>
 1182 
 1183     <span class="c1"># Setup chain names for PyMOL selections...</span>
 1184     <span class="n">ChainNames1Selection</span> <span class="o">=</span> <span class="s2">&quot;+&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ChainNames1</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">))</span>
 1185     <span class="n">ChainNames2Selection</span> <span class="o">=</span> <span class="s2">&quot;+&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ChainNames2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">))</span>
 1186     
 1187     <span class="k">return</span> <span class="n">ChainNames1Selection</span><span class="p">,</span> <span class="n">ChainNames2Selection</span>
 1188     
 1189 <span class="k">def</span> <span class="nf">_GetSelectionChainsAndResiduesInfo</span><span class="p">(</span><span class="n">SelectionCmd</span><span class="p">):</span>
 1190     <span class="sd">&quot;&quot;&quot;Get chain names, residue names and count information for a selection. &quot;&quot;&quot;</span>
 1191     
 1192     <span class="c1"># Retrieve atoms...</span>
 1193     <span class="n">stored</span><span class="o">.</span><span class="n">SelectionInfo</span> <span class="o">=</span> <span class="p">[]</span>
 1194     <span class="n">cmd</span><span class="o">.</span><span class="n">iterate</span><span class="p">(</span><span class="n">SelectionCmd</span><span class="p">,</span> <span class="s2">&quot;stored.SelectionInfo.append([chain, resi, resn])&quot;</span><span class="p">)</span>
 1195 
 1196     <span class="c1"># Retrieve chains and residues...</span>
 1197     <span class="n">SelectionInfoMap</span> <span class="o">=</span> <span class="p">{}</span>
 1198     <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1199     
 1200     <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResNames&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1201     <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResNum&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1202     <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResCount&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1203 
 1204     <span class="k">for</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">ResNum</span><span class="p">,</span> <span class="n">ResName</span> <span class="ow">in</span> <span class="n">stored</span><span class="o">.</span><span class="n">SelectionInfo</span><span class="p">:</span>
 1205         <span class="k">if</span> <span class="ow">not</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]:</span>
 1206             <span class="c1"># Track new chain ID and intialize residues information...</span>
 1207             <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ChainID</span><span class="p">)</span>
 1208             <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResNames&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1209             <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResNum&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span><span class="o">=</span> <span class="p">{}</span>
 1210             <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResCount&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1211             
 1212         <span class="k">if</span> <span class="n">ResName</span> <span class="ow">in</span> <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResNames&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]:</span>
 1213             <span class="k">if</span> <span class="ow">not</span> <span class="n">ResNum</span> <span class="ow">in</span> <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResNum&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResName</span><span class="p">]:</span>
 1214                 <span class="c1"># Same residue name but different residue number</span>
 1215                 <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResNum&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResName</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ResNum</span><span class="p">)</span>
 1216                 <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResCount&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResName</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
 1217         <span class="k">else</span><span class="p">:</span>
 1218             <span class="c1"># Track new residue information...</span>
 1219             <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResNames&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ResName</span><span class="p">)</span>
 1220             
 1221             <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResNum&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResName</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1222             <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResNum&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResName</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ResNum</span><span class="p">)</span>
 1223             
 1224             <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResCount&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResName</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
 1225                 
 1226     <span class="k">return</span> <span class="n">SelectionInfoMap</span>
 1227 
 1228 <span class="k">def</span> <span class="nf">_GetSelectionResiduesInfo</span><span class="p">(</span><span class="n">SelectionCmd</span><span class="p">):</span>
 1229     <span class="sd">&quot;&quot;&quot;Get residue names and count information for a selection. &quot;&quot;&quot;</span>
 1230     
 1231     <span class="c1"># Retrieve atoms...</span>
 1232     <span class="n">stored</span><span class="o">.</span><span class="n">SelectionInfo</span> <span class="o">=</span> <span class="p">[]</span>
 1233     <span class="n">cmd</span><span class="o">.</span><span class="n">iterate</span><span class="p">(</span><span class="n">SelectionCmd</span><span class="p">,</span> <span class="s2">&quot;stored.SelectionInfo.append([resi, resn])&quot;</span><span class="p">)</span>
 1234 
 1235     <span class="c1"># Retrieve residues...</span>
 1236     <span class="n">SelectionInfoMap</span> <span class="o">=</span> <span class="p">{}</span>
 1237     <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResNames&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1238     <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResNum&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1239     <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResCount&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1240 
 1241     <span class="k">for</span> <span class="n">ResNum</span><span class="p">,</span> <span class="n">ResName</span> <span class="ow">in</span> <span class="n">stored</span><span class="o">.</span><span class="n">SelectionInfo</span><span class="p">:</span>
 1242         <span class="k">if</span> <span class="n">ResName</span> <span class="ow">in</span> <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResNames&quot;</span><span class="p">]:</span>
 1243             <span class="k">if</span> <span class="ow">not</span> <span class="n">ResNum</span> <span class="ow">in</span> <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResNum&quot;</span><span class="p">][</span><span class="n">ResName</span><span class="p">]:</span>
 1244                 <span class="c1"># Same residue name but different residue number</span>
 1245                 <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResNum&quot;</span><span class="p">][</span><span class="n">ResName</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ResNum</span><span class="p">)</span>
 1246                 <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResCount&quot;</span><span class="p">][</span><span class="n">ResName</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
 1247         <span class="k">else</span><span class="p">:</span>
 1248             <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResNames&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ResName</span><span class="p">)</span>
 1249             
 1250             <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResNum&quot;</span><span class="p">][</span><span class="n">ResName</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1251             <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResNum&quot;</span><span class="p">][</span><span class="n">ResName</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ResNum</span><span class="p">)</span>
 1252             
 1253             <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResCount&quot;</span><span class="p">][</span><span class="n">ResName</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
 1254                 
 1255     <span class="k">return</span> <span class="n">SelectionInfoMap</span>
 1256 
 1257 <span class="k">def</span> <span class="nf">_GetSelectionPhiPsiResiduesInfo</span><span class="p">(</span><span class="n">SelectionCmd</span><span class="p">,</span> <span class="n">Categorize</span><span class="p">):</span>
 1258     <span class="sd">&quot;&quot;&quot;Get phi and psi torsion angle information for residues in a  selection</span>
 1259 <span class="sd">    with in a chain.</span>
 1260 <span class="sd">     </span>
 1261 <span class="sd">    The phi and psi angles are optionally categorized into the following groups</span>
 1262 <span class="sd">    corresponding to four types of  Ramachandran plots:</span>
 1263 <span class="sd">    </span>
 1264 <span class="sd">    General: All residues except glycine, proline, or pre-proline</span>
 1265 <span class="sd">    Glycine: Only glycine residues</span>
 1266 <span class="sd">    Proline: Only proline residues</span>
 1267 <span class="sd">    Pre-Proline: Only residues before proline not including glycine or proline</span>
 1268 <span class="sd">    </span>
 1269 <span class="sd">    &quot;&quot;&quot;</span>
 1270 
 1271     <span class="c1"># Initialize...</span>
 1272     <span class="n">SelectionInfoMap</span> <span class="o">=</span> <span class="p">{}</span>
 1273     <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResNums&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1274     <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1275     <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;Phi&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1276     <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;Psi&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1277     <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;Category&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1278 
 1279     <span class="c1"># Retrieve phi and psi info...</span>
 1280     <span class="n">PhiPsiInfo</span> <span class="o">=</span> <span class="n">_GetSelectionPhiPsiInfo</span><span class="p">(</span><span class="n">SelectionCmd</span><span class="p">,</span> <span class="n">Categorize</span><span class="p">)</span>
 1281     <span class="k">if</span> <span class="n">PhiPsiInfo</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
 1282         <span class="k">return</span> <span class="n">SelectionInfoMap</span>
 1283 
 1284     <span class="c1"># Track...</span>
 1285     <span class="k">for</span> <span class="n">Model</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">ResNum</span><span class="p">,</span> <span class="n">ResName</span><span class="p">,</span> <span class="n">Phi</span><span class="p">,</span> <span class="n">Psi</span><span class="p">,</span> <span class="n">Category</span> <span class="ow">in</span> <span class="n">PhiPsiInfo</span><span class="p">:</span>
 1286         <span class="k">if</span> <span class="n">ResNum</span> <span class="ow">in</span> <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResName&quot;</span><span class="p">]:</span>
 1287             <span class="k">continue</span>
 1288         
 1289         <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResNums&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ResNum</span><span class="p">)</span>
 1290         <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResName&quot;</span><span class="p">][</span><span class="n">ResNum</span><span class="p">]</span> <span class="o">=</span> <span class="n">ResName</span>
 1291         <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;Phi&quot;</span><span class="p">][</span><span class="n">ResNum</span><span class="p">]</span> <span class="o">=</span> <span class="n">Phi</span>
 1292         <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;Psi&quot;</span><span class="p">][</span><span class="n">ResNum</span><span class="p">]</span> <span class="o">=</span> <span class="n">Psi</span>
 1293         <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;Category&quot;</span><span class="p">][</span><span class="n">ResNum</span><span class="p">]</span> <span class="o">=</span> <span class="n">Category</span>
 1294     
 1295     <span class="k">return</span> <span class="n">SelectionInfoMap</span>
 1296 
 1297 <span class="k">def</span> <span class="nf">_GetSelectionPhiPsiChainsAndResiduesInfo</span><span class="p">(</span><span class="n">SelectionCmd</span><span class="p">,</span> <span class="n">Categorize</span><span class="p">):</span>
 1298     <span class="sd">&quot;&quot;&quot;Get phi and psi torsion angle information for residues in a  selection</span>
 1299 <span class="sd">    across chains in a molecule.</span>
 1300 <span class="sd">    </span>
 1301 <span class="sd">    The phi and psi angles are optionally categorized into the following groups</span>
 1302 <span class="sd">    corresponding to four types of  Ramachandran plots:</span>
 1303 <span class="sd">    </span>
 1304 <span class="sd">    General: All residues except glycine, proline, or pre-proline</span>
 1305 <span class="sd">    Glycine: Only glycine residues</span>
 1306 <span class="sd">    Proline: Only proline residues</span>
 1307 <span class="sd">    Pre-Proline: Only residues before proline not including glycine or proline</span>
 1308 <span class="sd">    </span>
 1309 <span class="sd">    &quot;&quot;&quot;</span>
 1310 
 1311     <span class="c1"># Initialize...</span>
 1312     <span class="n">SelectionInfoMap</span> <span class="o">=</span> <span class="p">{}</span>
 1313     <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1314     <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResNums&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1315     <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1316     <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;Phi&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1317     <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;Psi&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1318     <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;Category&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1319 
 1320     <span class="c1"># Retrieve phi and psi info...</span>
 1321     <span class="n">PhiPsiInfo</span> <span class="o">=</span> <span class="n">_GetSelectionPhiPsiInfo</span><span class="p">(</span><span class="n">SelectionCmd</span><span class="p">,</span> <span class="n">Categorize</span><span class="p">)</span>
 1322     <span class="k">if</span> <span class="n">PhiPsiInfo</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
 1323         <span class="k">return</span> <span class="n">SelectionInfoMap</span>
 1324 
 1325     <span class="c1"># Track...</span>
 1326     <span class="k">for</span> <span class="n">Model</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">ResNum</span><span class="p">,</span> <span class="n">ResName</span><span class="p">,</span> <span class="n">Phi</span><span class="p">,</span> <span class="n">Psi</span><span class="p">,</span> <span class="n">Category</span> <span class="ow">in</span> <span class="n">PhiPsiInfo</span><span class="p">:</span>
 1327         <span class="k">if</span> <span class="ow">not</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResNums&quot;</span><span class="p">]:</span>
 1328             <span class="c1"># Track new chain ID and initialize residues information...</span>
 1329             <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ChainID</span><span class="p">)</span>
 1330             
 1331             <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResNums&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1332             <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResName&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1333             <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;Phi&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1334             <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;Psi&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1335             <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;Category&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1336             
 1337         <span class="c1"># Check for duplicates...</span>
 1338         <span class="k">if</span> <span class="n">ResNum</span> <span class="ow">in</span> <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResName&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]:</span>
 1339             <span class="k">continue</span>
 1340 
 1341         <span class="c1"># Track new residues information...</span>
 1342         <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResNums&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ResNum</span><span class="p">)</span>
 1343         <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;ResName&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResNum</span><span class="p">]</span> <span class="o">=</span> <span class="n">ResName</span>
 1344         <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;Phi&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResNum</span><span class="p">]</span> <span class="o">=</span> <span class="n">Phi</span>
 1345         <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;Psi&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResNum</span><span class="p">]</span> <span class="o">=</span> <span class="n">Psi</span>
 1346         <span class="n">SelectionInfoMap</span><span class="p">[</span><span class="s2">&quot;Category&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResNum</span><span class="p">]</span> <span class="o">=</span> <span class="n">Category</span>
 1347     
 1348     <span class="k">return</span> <span class="n">SelectionInfoMap</span>
 1349 
 1350 <span class="k">def</span> <span class="nf">_GetSelectionPhiPsiCategoriesResiduesInfo</span><span class="p">(</span><span class="n">SelectionCmd</span><span class="p">):</span>
 1351     <span class="sd">&quot;&quot;&quot;Get phi and psi torsion angle information for residues in a  selection</span>
 1352 <span class="sd">    with in a chain.</span>
 1353 
 1354 <span class="sd">    The phi and psi angles are optionally categorized into the following groups</span>
 1355 <span class="sd">    corresponding to four types of  Ramachandran plots:</span>
 1356 <span class="sd">    </span>
 1357 <span class="sd">    General: All residues except glycine, proline, or pre-proline</span>
 1358 <span class="sd">    Glycine: Only glycine residues</span>
 1359 <span class="sd">    Proline: Only proline residues</span>
 1360 <span class="sd">    Pre-Proline: Only residues before proline not including glycine or proline</span>
 1361 <span class="sd">    </span>
 1362 <span class="sd">    &quot;&quot;&quot;</span>
 1363     
 1364     <span class="c1"># Initialize...</span>
 1365     <span class="n">PhiPsiInfoMaps</span> <span class="o">=</span> <span class="p">{}</span>
 1366     <span class="n">PhiPsiInfoMaps</span><span class="p">[</span><span class="s2">&quot;Maps&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1367     <span class="k">for</span> <span class="n">Category</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;General&quot;</span><span class="p">,</span> <span class="s2">&quot;Glycine&quot;</span><span class="p">,</span> <span class="s2">&quot;Proline&quot;</span><span class="p">,</span> <span class="s2">&quot;Pre-Proline&quot;</span><span class="p">]:</span>
 1368         <span class="n">PhiPsiInfoMap</span> <span class="o">=</span> <span class="p">{}</span>
 1369         <span class="n">PhiPsiInfoMap</span><span class="p">[</span><span class="s2">&quot;ResNums&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1370         <span class="n">PhiPsiInfoMap</span><span class="p">[</span><span class="s2">&quot;ResName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1371         <span class="n">PhiPsiInfoMap</span><span class="p">[</span><span class="s2">&quot;Phi&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1372         <span class="n">PhiPsiInfoMap</span><span class="p">[</span><span class="s2">&quot;Psi&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1373         <span class="n">PhiPsiInfoMap</span><span class="p">[</span><span class="s2">&quot;Category&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1374         
 1375         <span class="n">PhiPsiInfoMaps</span><span class="p">[</span><span class="n">Category</span><span class="p">]</span> <span class="o">=</span> <span class="n">PhiPsiInfoMap</span>
 1376         <span class="n">PhiPsiInfoMaps</span><span class="p">[</span><span class="s2">&quot;Maps&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PhiPsiInfoMap</span><span class="p">)</span>
 1377         
 1378     <span class="c1"># Retrieve phi and psi info...</span>
 1379     <span class="n">PhiPsiInfo</span> <span class="o">=</span> <span class="n">_GetSelectionPhiPsiInfo</span><span class="p">(</span><span class="n">SelectionCmd</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
 1380     <span class="k">if</span> <span class="n">PhiPsiInfo</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
 1381         <span class="k">return</span>  <span class="n">PhiPsiInfoMaps</span><span class="p">[</span><span class="s2">&quot;Maps&quot;</span><span class="p">]</span>
 1382     
 1383     <span class="n">Index</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
 1384     <span class="k">for</span> <span class="n">Model</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">ResNum</span><span class="p">,</span> <span class="n">ResName</span><span class="p">,</span> <span class="n">Phi</span><span class="p">,</span> <span class="n">Psi</span><span class="p">,</span> <span class="n">Category</span> <span class="ow">in</span> <span class="n">PhiPsiInfo</span><span class="p">:</span>
 1385         <span class="n">Index</span> <span class="o">+=</span> <span class="mi">1</span>
 1386         
 1387         <span class="k">if</span> <span class="n">ResNum</span> <span class="ow">in</span> <span class="n">PhiPsiInfoMaps</span><span class="p">[</span><span class="n">Category</span><span class="p">][</span><span class="s2">&quot;ResName&quot;</span><span class="p">]:</span>
 1388             <span class="k">continue</span>
 1389         
 1390         <span class="c1"># Track...</span>
 1391         <span class="n">PhiPsiInfoMaps</span><span class="p">[</span><span class="n">Category</span><span class="p">][</span><span class="s2">&quot;ResNums&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ResNum</span><span class="p">)</span>
 1392         <span class="n">PhiPsiInfoMaps</span><span class="p">[</span><span class="n">Category</span><span class="p">][</span><span class="s2">&quot;ResName&quot;</span><span class="p">][</span><span class="n">ResNum</span><span class="p">]</span> <span class="o">=</span> <span class="n">ResName</span>
 1393         <span class="n">PhiPsiInfoMaps</span><span class="p">[</span><span class="n">Category</span><span class="p">][</span><span class="s2">&quot;Phi&quot;</span><span class="p">][</span><span class="n">ResNum</span><span class="p">]</span> <span class="o">=</span> <span class="n">Phi</span>
 1394         <span class="n">PhiPsiInfoMaps</span><span class="p">[</span><span class="n">Category</span><span class="p">][</span><span class="s2">&quot;Psi&quot;</span><span class="p">][</span><span class="n">ResNum</span><span class="p">]</span> <span class="o">=</span> <span class="n">Psi</span>
 1395         <span class="n">PhiPsiInfoMaps</span><span class="p">[</span><span class="n">Category</span><span class="p">][</span><span class="s2">&quot;Category&quot;</span><span class="p">][</span><span class="n">ResNum</span><span class="p">]</span> <span class="o">=</span> <span class="n">Category</span>
 1396     
 1397     <span class="k">return</span>  <span class="n">PhiPsiInfoMaps</span><span class="p">[</span><span class="s2">&quot;Maps&quot;</span><span class="p">]</span>
 1398 
 1399 <span class="k">def</span> <span class="nf">_GetSelectionPhiPsiInfo</span><span class="p">(</span><span class="n">SelectionCmd</span><span class="p">,</span> <span class="n">Categorize</span> <span class="o">=</span> <span class="bp">False</span><span class="p">):</span>
 1400     <span class="sd">&quot;&quot;&quot;Get phi and psi angles for a selection along with information regarding</span>
 1401 <span class="sd">    model, chain, residue number, and residue name.</span>
 1402 <span class="sd">    </span>
 1403 <span class="sd">    The phi and psi angles are optionally categorized into the following groups</span>
 1404 <span class="sd">    corresponding to four types of  Ramachandran plots:</span>
 1405 <span class="sd">    </span>
 1406 <span class="sd">    General: All residues except glycine, proline, or pre-proline</span>
 1407 <span class="sd">    Glycine: Only glycine residues</span>
 1408 <span class="sd">    Proline: Only proline residues</span>
 1409 <span class="sd">    Pre-Proline: Only residues before proline not including glycine or proline</span>
 1410 <span class="sd">    </span>
 1411 <span class="sd">    &quot;&quot;&quot;</span>
 1412 
 1413     <span class="c1"># Retrieve phi and psi values...</span>
 1414     <span class="n">PhiPsiInfoMap</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="n">get_phipsi</span><span class="p">(</span><span class="s2">&quot;(</span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="n">SelectionCmd</span><span class="p">)</span>
 1415     <span class="k">if</span> <span class="n">PhiPsiInfoMap</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
 1416         <span class="k">return</span> <span class="bp">None</span>
 1417 
 1418     <span class="c1"># Sort keys corresponding to model name and residue numbers...</span>
 1419     <span class="n">PhiPsiKeys</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">PhiPsiInfoMap</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
 1420     
 1421     <span class="c1"># Retrieve related information...</span>
 1422     <span class="n">PhiPsiInfoList</span> <span class="o">=</span> <span class="p">[]</span>
 1423 
 1424     <span class="n">Category</span> <span class="o">=</span> <span class="bp">None</span>
 1425     <span class="k">for</span> <span class="n">Key</span> <span class="ow">in</span> <span class="n">PhiPsiKeys</span><span class="p">:</span>
 1426         <span class="n">Model</span><span class="p">,</span> <span class="n">Index</span> <span class="o">=</span> <span class="n">Key</span>
 1427         <span class="n">Phi</span><span class="p">,</span> <span class="n">Psi</span> <span class="o">=</span> <span class="n">PhiPsiInfoMap</span><span class="p">[</span><span class="n">Key</span><span class="p">]</span>
 1428         
 1429         <span class="n">stored</span><span class="o">.</span><span class="n">PhiPsiInfoList</span> <span class="o">=</span> <span class="p">[]</span>
 1430         <span class="n">cmd</span><span class="o">.</span><span class="n">iterate</span><span class="p">(</span><span class="s2">&quot;(</span><span class="si">%s</span><span class="s2">`</span><span class="si">%d</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Model</span><span class="p">,</span> <span class="n">Index</span><span class="p">),</span> <span class="s2">&quot;stored.PhiPsiInfoList.append([model, chain, resi, resn])&quot;</span><span class="p">)</span>
 1431         <span class="k">for</span> <span class="n">Model</span><span class="p">,</span> <span class="n">Chain</span><span class="p">,</span> <span class="n">ResNum</span><span class="p">,</span> <span class="n">ResName</span> <span class="ow">in</span> <span class="n">stored</span><span class="o">.</span><span class="n">PhiPsiInfoList</span><span class="p">:</span>
 1432             <span class="n">PhiPsiInfoList</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">Model</span><span class="p">,</span> <span class="n">Chain</span><span class="p">,</span> <span class="n">ResNum</span><span class="p">,</span> <span class="n">ResName</span><span class="p">,</span> <span class="n">Phi</span><span class="p">,</span> <span class="n">Psi</span><span class="p">,</span> <span class="n">Category</span><span class="p">])</span>
 1433 
 1434     <span class="k">if</span> <span class="n">Categorize</span><span class="p">:</span>
 1435         <span class="n">_CategorizePhiPsiAnglesInfo</span><span class="p">(</span><span class="n">PhiPsiInfoList</span><span class="p">)</span>
 1436     
 1437     <span class="k">return</span> <span class="n">PhiPsiInfoList</span>
 1438 
 1439 <span class="k">def</span> <span class="nf">_CategorizePhiPsiAnglesInfo</span><span class="p">(</span><span class="n">PhiPsiInfo</span><span class="p">):</span>
 1440     <span class="sd">&quot;&quot;&quot;The phi and psi angles are optionally categorized into the following groups</span>
 1441 <span class="sd">    corresponding to four types of  Ramachandran plots:</span>
 1442 <span class="sd">    </span>
 1443 <span class="sd">    General: All residues except glycine, proline, or pre-proline</span>
 1444 <span class="sd">    Glycine: Only glycine residues</span>
 1445 <span class="sd">    Proline: Only proline residues</span>
 1446 <span class="sd">    Pre-Proline: Only residues before proline not including glycine or proline</span>
 1447 <span class="sd">    </span>
 1448 <span class="sd">    &quot;&quot;&quot;</span>
 1449     
 1450     <span class="n">Index</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
 1451     <span class="n">LastIndex</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">PhiPsiInfo</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
 1452     <span class="n">PhiPsiCategories</span> <span class="o">=</span> <span class="p">[]</span>
 1453     <span class="k">for</span> <span class="n">Model</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">ResNum</span><span class="p">,</span> <span class="n">ResName</span><span class="p">,</span> <span class="n">Phi</span><span class="p">,</span> <span class="n">Psi</span><span class="p">,</span> <span class="n">CategoryPlaceHolder</span> <span class="ow">in</span> <span class="n">PhiPsiInfo</span><span class="p">:</span>
 1454         <span class="n">Index</span> <span class="o">+=</span> <span class="mi">1</span>
 1455         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Gly$&quot;</span><span class="p">,</span> <span class="n">ResName</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1456             <span class="c1"># Gly: Only glycine residues</span>
 1457             <span class="n">Category</span> <span class="o">=</span> <span class="s2">&quot;Glycine&quot;</span>
 1458         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Pro$&quot;</span><span class="p">,</span> <span class="n">ResName</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1459             <span class="c1"># Pro: Only proline residues</span>
 1460             <span class="n">Category</span> <span class="o">=</span> <span class="s2">&quot;Proline&quot;</span>
 1461         <span class="k">elif</span> <span class="n">_IsPreProlinePhiPsiAngle</span><span class="p">(</span><span class="n">PhiPsiInfo</span><span class="p">,</span> <span class="n">Index</span><span class="p">,</span> <span class="n">LastIndex</span><span class="p">):</span>
 1462             <span class="c1">#  Pre-Proline: Only residues before proline not including glycine or proline</span>
 1463             <span class="n">Category</span> <span class="o">=</span> <span class="s2">&quot;Pre-Proline&quot;</span>
 1464         <span class="k">else</span><span class="p">:</span>
 1465             <span class="c1"># General: All residues except Gly, Pro, or pre-Pro</span>
 1466             <span class="n">Category</span> <span class="o">=</span> <span class="s2">&quot;General&quot;</span>
 1467         <span class="c1"># Track categories...</span>
 1468         <span class="n">PhiPsiCategories</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Category</span><span class="p">)</span>
 1469 
 1470     <span class="c1"># Update category in PhiPsiInfo...</span>
 1471     <span class="n">CategoryIndex</span> <span class="o">=</span> <span class="mi">6</span>
 1472     <span class="k">for</span> <span class="n">Index</span><span class="p">,</span> <span class="n">Category</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">PhiPsiCategories</span><span class="p">):</span>
 1473          <span class="n">PhiPsiInfo</span><span class="p">[</span><span class="n">Index</span><span class="p">][</span><span class="n">CategoryIndex</span><span class="p">]</span> <span class="o">=</span> <span class="n">Category</span>
 1474 
 1475 <span class="k">def</span> <span class="nf">_IsPreProlinePhiPsiAngle</span><span class="p">(</span><span class="n">PhiPsiInfo</span><span class="p">,</span> <span class="n">Index</span><span class="p">,</span> <span class="n">LastIndex</span><span class="p">):</span>
 1476     <span class="sd">&quot;&quot;&quot;Check for Pre-Proline phi and psi angles.&quot;&quot;&quot;</span>
 1477     
 1478     <span class="c1">#  Pre-Proline: Only residues before proline not including glycine or proline</span>
 1479 
 1480     <span class="c1"># Not a last residue...</span>
 1481     <span class="n">NextIndex</span> <span class="o">=</span> <span class="n">Index</span> <span class="o">+</span> <span class="mi">1</span>
 1482     <span class="k">if</span> <span class="n">NextIndex</span>  <span class="o">&gt;=</span> <span class="n">LastIndex</span><span class="p">:</span>
 1483         <span class="k">return</span> <span class="bp">False</span>
 1484 
 1485     <span class="c1"># Next residue is proline...</span>
 1486     <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Pro$&quot;</span><span class="p">,</span> <span class="n">PhiPsiInfo</span><span class="p">[</span><span class="n">NextIndex</span><span class="p">][</span><span class="mi">3</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1487         <span class="k">return</span> <span class="bp">False</span>
 1488 
 1489     <span class="c1"># Current residue is not Gly or Pro...</span>
 1490     <span class="n">NextResName</span> <span class="o">=</span> <span class="n">PhiPsiInfo</span><span class="p">[</span><span class="n">Index</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
 1491     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(Gly|Pro)$&quot;</span><span class="p">,</span> <span class="n">NextResName</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1492         <span class="k">return</span> <span class="bp">False</span>
 1493 
 1494     <span class="c1"># Next chain ID is same as current chain ID...</span>
 1495     <span class="n">CurrentChainID</span> <span class="o">=</span>  <span class="n">PhiPsiInfo</span><span class="p">[</span><span class="n">Index</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
 1496     <span class="n">NextChainID</span> <span class="o">=</span> <span class="n">PhiPsiInfo</span><span class="p">[</span><span class="n">NextIndex</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
 1497     <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^</span><span class="si">%s</span><span class="s2">$&quot;</span> <span class="o">%</span> <span class="n">CurrentChainID</span><span class="p">,</span> <span class="n">NextChainID</span><span class="p">):</span>
 1498         <span class="k">return</span> <span class="bp">False</span>
 1499 
 1500     <span class="c1"># Current and next residue numbers are sequential...</span>
 1501     <span class="n">CurrentResNum</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">PhiPsiInfo</span><span class="p">[</span><span class="n">Index</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
 1502     <span class="n">NextResNum</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">PhiPsiInfo</span><span class="p">[</span><span class="n">NextIndex</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
 1503     <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">NextResNum</span> <span class="o">-</span> <span class="n">CurrentResNum</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
 1504         <span class="k">return</span> <span class="bp">False</span>
 1505     
 1506     <span class="k">return</span> <span class="bp">True</span>
 1507     
 1508 <span class="k">def</span> <span class="nf">_GetSelectionResiduesBValuesInfo</span><span class="p">(</span><span class="n">SelectionCmd</span><span class="p">):</span>
 1509     <span class="sd">&quot;&quot;&quot;Get B values info for residues in a chain. &quot;&quot;&quot;</span>
 1510 
 1511     <span class="c1"># Retrieve data...</span>
 1512     <span class="n">stored</span><span class="o">.</span><span class="n">ResiduesInfo</span> <span class="o">=</span> <span class="p">[]</span>
 1513     <span class="n">cmd</span><span class="o">.</span><span class="n">iterate</span><span class="p">(</span><span class="n">SelectionCmd</span><span class="p">,</span> <span class="s2">&quot;stored.ResiduesInfo.append([resi, resn, b])&quot;</span><span class="p">)</span>
 1514 
 1515     <span class="c1"># Setup B-values for each residue...</span>
 1516     <span class="n">BValuesInfoMap</span> <span class="o">=</span> <span class="p">{}</span>
 1517     <span class="n">BValuesInfoMap</span><span class="p">[</span><span class="s2">&quot;ResIDs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1518     <span class="n">BValuesInfoMap</span><span class="p">[</span><span class="s2">&quot;BValue&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1519     
 1520     <span class="k">for</span> <span class="n">ResNum</span><span class="p">,</span> <span class="n">ResName</span><span class="p">,</span> <span class="n">AtomBValue</span> <span class="ow">in</span> <span class="n">stored</span><span class="o">.</span><span class="n">ResiduesInfo</span><span class="p">:</span>
 1521         <span class="n">ResID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResName</span><span class="p">,</span> <span class="n">ResNum</span><span class="p">)</span>
 1522         
 1523         <span class="k">if</span> <span class="n">ResID</span> <span class="ow">in</span> <span class="n">BValuesInfoMap</span><span class="p">[</span><span class="s2">&quot;BValue&quot;</span><span class="p">]:</span>
 1524             <span class="n">BValuesInfoMap</span><span class="p">[</span><span class="s2">&quot;BValue&quot;</span><span class="p">][</span><span class="n">ResID</span><span class="p">]</span> <span class="o">+=</span> <span class="n">AtomBValue</span>
 1525         <span class="k">else</span><span class="p">:</span>
 1526             <span class="c1"># Track new residue ID...</span>
 1527             <span class="n">BValuesInfoMap</span><span class="p">[</span><span class="s2">&quot;ResIDs&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ResID</span><span class="p">)</span>
 1528             <span class="n">BValuesInfoMap</span><span class="p">[</span><span class="s2">&quot;BValue&quot;</span><span class="p">][</span><span class="n">ResID</span><span class="p">]</span> <span class="o">=</span> <span class="n">AtomBValue</span>
 1529 
 1530     <span class="k">return</span> <span class="n">BValuesInfoMap</span>
 1531 
 1532 <span class="k">def</span> <span class="nf">_GetResiduesInfoFromResiduesBValues</span><span class="p">(</span><span class="n">ResiduesBValuesInfoMap</span><span class="p">,</span> <span class="n">Mode</span><span class="p">,</span> <span class="n">Cutoff</span><span class="p">):</span>
 1533     <span class="sd">&quot;&quot;&quot;Get residues info map using residues B values. &quot;&quot;&quot;</span>
 1534 
 1535     <span class="n">GreaterThanEquals</span><span class="p">,</span> <span class="n">GreaterThan</span><span class="p">,</span> <span class="n">LessThanEquals</span><span class="p">,</span> <span class="n">LessThan</span><span class="p">,</span> <span class="n">Equals</span> <span class="o">=</span> <span class="p">[</span><span class="bp">False</span><span class="p">]</span> <span class="o">*</span> <span class="mi">5</span>
 1536     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^&gt;=$&quot;</span><span class="p">,</span> <span class="n">Mode</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1537         <span class="n">GreaterThanEquals</span> <span class="o">=</span> <span class="bp">True</span>
 1538     <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^&gt;$&quot;</span><span class="p">,</span> <span class="n">Mode</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1539         <span class="n">GreaterThan</span> <span class="o">=</span> <span class="bp">True</span>
 1540     <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^&lt;=$&quot;</span><span class="p">,</span> <span class="n">Mode</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1541         <span class="n">LessThanEquals</span> <span class="o">=</span> <span class="bp">True</span>
 1542     <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^&lt;$&quot;</span><span class="p">,</span> <span class="n">Mode</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1543         <span class="n">LessThan</span> <span class="o">=</span> <span class="bp">True</span>
 1544     <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^=$&quot;</span><span class="p">,</span> <span class="n">Mode</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1545         <span class="n">Equals</span> <span class="o">=</span> <span class="bp">True</span>
 1546     <span class="k">else</span><span class="p">:</span>
 1547         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;PyMOLUtil._GetResiduesInfoFromResiduesBValues: The value, </span><span class="si">%s</span><span class="s2">, specified for Mode is not valid. Supported values: &gt;=, &gt;, &lt;=, &lt;, =&quot;</span><span class="p">)</span>
 1548     
 1549     <span class="c1"># Setup residues info map...</span>
 1550     <span class="n">ResiduesInfoMap</span> <span class="o">=</span> <span class="p">{}</span>
 1551     <span class="n">ResiduesInfoMap</span><span class="p">[</span><span class="s2">&quot;ResNames&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1552     <span class="n">ResiduesInfoMap</span><span class="p">[</span><span class="s2">&quot;ResNum&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1553     <span class="n">ResiduesInfoMap</span><span class="p">[</span><span class="s2">&quot;ResCount&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1554 
 1555     <span class="k">for</span> <span class="n">ResID</span> <span class="ow">in</span> <span class="n">ResiduesBValuesInfoMap</span><span class="p">[</span><span class="s2">&quot;ResIDs&quot;</span><span class="p">]:</span>
 1556         <span class="n">ResName</span><span class="p">,</span> <span class="n">ResNum</span> <span class="o">=</span> <span class="n">ResID</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)</span>
 1557         <span class="n">ResBValue</span> <span class="o">=</span> <span class="n">ResiduesBValuesInfoMap</span><span class="p">[</span><span class="s2">&quot;BValue&quot;</span><span class="p">][</span><span class="n">ResID</span><span class="p">]</span>
 1558 
 1559         <span class="k">if</span> <span class="n">GreaterThanEquals</span><span class="p">:</span>
 1560             <span class="k">if</span> <span class="n">ResBValue</span> <span class="o">&lt;</span> <span class="n">Cutoff</span><span class="p">:</span>
 1561                 <span class="k">continue</span>
 1562         <span class="k">elif</span> <span class="n">GreaterThan</span><span class="p">:</span>
 1563             <span class="k">if</span> <span class="n">ResBValue</span> <span class="o">&lt;=</span> <span class="n">Cutoff</span><span class="p">:</span>
 1564                 <span class="k">continue</span>
 1565         <span class="k">elif</span> <span class="n">LessThanEquals</span><span class="p">:</span>
 1566             <span class="k">if</span> <span class="n">ResBValue</span> <span class="o">&gt;</span> <span class="n">Cutoff</span><span class="p">:</span>
 1567                 <span class="k">continue</span>
 1568         <span class="k">elif</span> <span class="n">LessThan</span><span class="p">:</span>
 1569             <span class="k">if</span> <span class="n">ResBValue</span> <span class="o">&gt;=</span> <span class="n">Cutoff</span><span class="p">:</span>
 1570                 <span class="k">continue</span>
 1571         <span class="k">elif</span> <span class="n">Equals</span><span class="p">:</span>
 1572             <span class="k">if</span> <span class="n">ResBValue</span> <span class="o">!=</span> <span class="n">Cutoff</span><span class="p">:</span>
 1573                 <span class="k">continue</span>
 1574         
 1575         <span class="k">if</span> <span class="n">ResName</span> <span class="ow">in</span> <span class="n">ResiduesInfoMap</span><span class="p">[</span><span class="s2">&quot;ResNames&quot;</span><span class="p">]:</span>
 1576             <span class="k">if</span> <span class="ow">not</span> <span class="n">ResNum</span> <span class="ow">in</span> <span class="n">ResiduesInfoMap</span><span class="p">[</span><span class="s2">&quot;ResNum&quot;</span><span class="p">][</span><span class="n">ResName</span><span class="p">]:</span>
 1577                 <span class="c1"># Same residue name but different residue number</span>
 1578                 <span class="n">ResiduesInfoMap</span><span class="p">[</span><span class="s2">&quot;ResNum&quot;</span><span class="p">][</span><span class="n">ResName</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ResNum</span><span class="p">)</span>
 1579                 <span class="n">ResiduesInfoMap</span><span class="p">[</span><span class="s2">&quot;ResCount&quot;</span><span class="p">][</span><span class="n">ResName</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
 1580         <span class="k">else</span><span class="p">:</span>
 1581             <span class="n">ResiduesInfoMap</span><span class="p">[</span><span class="s2">&quot;ResNames&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ResName</span><span class="p">)</span>
 1582             
 1583             <span class="n">ResiduesInfoMap</span><span class="p">[</span><span class="s2">&quot;ResNum&quot;</span><span class="p">][</span><span class="n">ResName</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1584             <span class="n">ResiduesInfoMap</span><span class="p">[</span><span class="s2">&quot;ResNum&quot;</span><span class="p">][</span><span class="n">ResName</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ResNum</span><span class="p">)</span>
 1585             
 1586             <span class="n">ResiduesInfoMap</span><span class="p">[</span><span class="s2">&quot;ResCount&quot;</span><span class="p">][</span><span class="n">ResName</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
 1587     
 1588     <span class="k">return</span> <span class="n">ResiduesInfoMap</span>
 1589 
 1590 <span class="k">def</span> <span class="nf">ProcessChainsAndLigandsOptionsInfo</span><span class="p">(</span><span class="n">ChainsAndLigandsInfo</span><span class="p">,</span> <span class="n">ChainsOptionName</span><span class="p">,</span> <span class="n">ChainsOptionValue</span><span class="p">,</span> <span class="n">LigandsOptionName</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">LigandsOptionValue</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
 1591     <span class="sd">&quot;&quot;&quot;Process specified chain and ligand IDs using command line options.</span>
 1592 
 1593 <span class="sd">    Arguments:</span>
 1594 <span class="sd">        ChainsAndLigandsInfo (dict): A dictionary containing information</span>
 1595 <span class="sd">            existing chains and ligands. </span>
 1596 <span class="sd">        ChainsOptionName (str): Name of command line chains option.</span>
 1597 <span class="sd">        ChainsOptionValue (str): Value for command line chains option.</span>
 1598 <span class="sd">        LigandsOptionName (str): Name of command line ligands option.</span>
 1599 <span class="sd">        LigandsOptionValue (str): Value for command line ligands option.</span>
 1600 
 1601 <span class="sd">    Returns:</span>
 1602 <span class="sd">        dict: A dictionary containing list of chain identifiers and dictionaries</span>
 1603 <span class="sd">            of chains containing lists of ligand names for each chain.</span>
 1604 
 1605 <span class="sd">    Examples:</span>
 1606 
 1607 <span class="sd">        ChainsAndLigandsInfo = ProcessChainsAndLigandsOptionsInfo(</span>
 1608 <span class="sd">            ChainsAndLigandsInfo, &quot;-c, --chainIDs&quot;, OptionsInfo[&quot;ChainIDs&quot;],</span>
 1609 <span class="sd">            &quot;-l, --ligandIDs&quot;, OptionsInfo[&quot;LigandIDs&quot;])</span>
 1610 <span class="sd">        for ChainID in ChainsAndLigandsInfo[&quot;ChainIDs&quot;]:</span>
 1611 <span class="sd">            for LigandID in ChainsAndLigandsInfo[&quot;LigandIDs&quot;][ChainID]:</span>
 1612 <span class="sd">                MiscUtil.PrintInfo(&quot;ChainID: %s; LigandID: %s&quot; % (ChainID,</span>
 1613 <span class="sd">                    LigandID))</span>
 1614 
 1615 <span class="sd">    &quot;&quot;&quot;</span>
 1616     <span class="n">SpecifiedChainsAndLigandsInfo</span> <span class="o">=</span> <span class="p">{}</span>
 1617     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1618     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1619 
 1620     <span class="k">if</span> <span class="n">ChainsOptionValue</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
 1621         <span class="k">return</span> <span class="n">SpecifiedChainsAndLigandsInfo</span>
 1622         
 1623     <span class="n">_ProcessChainIDs</span><span class="p">(</span><span class="n">ChainsAndLigandsInfo</span><span class="p">,</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">,</span> <span class="n">ChainsOptionName</span><span class="p">,</span> <span class="n">ChainsOptionValue</span><span class="p">)</span>
 1624 
 1625     <span class="k">if</span> <span class="n">LigandsOptionValue</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
 1626         <span class="k">return</span> <span class="n">SpecifiedChainsAndLigandsInfo</span>
 1627     
 1628     <span class="n">_ProcessLigandIDs</span><span class="p">(</span><span class="n">ChainsAndLigandsInfo</span><span class="p">,</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">,</span> <span class="n">LigandsOptionName</span><span class="p">,</span> <span class="n">LigandsOptionValue</span><span class="p">)</span>
 1629     
 1630     <span class="k">return</span> <span class="n">SpecifiedChainsAndLigandsInfo</span>
 1631 
 1632 <span class="k">def</span> <span class="nf">_ProcessChainIDs</span><span class="p">(</span><span class="n">ChainsAndLigandsInfo</span><span class="p">,</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">,</span> <span class="n">ChainsOptionName</span><span class="p">,</span> <span class="n">ChainsOptionValue</span><span class="p">):</span>
 1633     <span class="sd">&quot;&quot;&quot;Process chain IDs&quot;&quot;&quot;</span>
 1634 
 1635     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Processing chain IDs...&quot;</span><span class="p">)</span>
 1636     
 1637     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^All$&quot;</span><span class="p">,</span> <span class="n">ChainsOptionValue</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1638         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]</span>
 1639         <span class="k">return</span>
 1640     <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(First|Auto)$&quot;</span><span class="p">,</span> <span class="n">ChainsOptionValue</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1641         <span class="n">FirstChainID</span> <span class="o">=</span> <span class="n">ChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]))</span> <span class="k">else</span> <span class="bp">None</span>
 1642         <span class="k">if</span> <span class="n">FirstChainID</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
 1643             <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">FirstChainID</span><span class="p">)</span>
 1644         <span class="k">return</span>
 1645     
 1646     <span class="n">ChainIDs</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">ChainsOptionValue</span><span class="p">)</span>
 1647     <span class="k">if</span> <span class="ow">not</span> <span class="n">ChainIDs</span><span class="p">:</span>
 1648         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;No valid value specified using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option.&quot;</span> <span class="o">%</span> <span class="n">ChainsOptionName</span><span class="p">)</span>
 1649 
 1650     <span class="n">ChainIDsList</span> <span class="o">=</span> <span class="n">ChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]</span>
 1651     <span class="n">SpecifiedChainIDsList</span> <span class="o">=</span> <span class="p">[]</span>
 1652     
 1653     <span class="n">ChainIDsWords</span> <span class="o">=</span> <span class="n">ChainIDs</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
 1654     <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">ChainIDsWords</span><span class="p">:</span>
 1655         <span class="k">if</span> <span class="ow">not</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">ChainIDsList</span><span class="p">:</span>
 1656             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;The chain ID, </span><span class="si">%s</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option is not valid. It&#39;ll be ignored. Valid chain IDs: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainID</span><span class="p">,</span> <span class="n">ChainsOptionName</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ChainIDsList</span><span class="p">)))</span>
 1657             <span class="k">continue</span>
 1658         <span class="k">if</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">SpecifiedChainIDsList</span><span class="p">:</span>
 1659             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;The chain ID, </span><span class="si">%s</span><span class="s2">, has already been specified using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option. It&#39;ll be ignored.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainID</span><span class="p">,</span> <span class="n">ChainsOptionName</span><span class="p">))</span>
 1660             <span class="k">continue</span>
 1661         <span class="n">SpecifiedChainIDsList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ChainID</span><span class="p">)</span>
 1662     
 1663     <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">SpecifiedChainIDsList</span><span class="p">):</span>
 1664         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;No valid chain IDs </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">  specified using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainsOptionValue</span><span class="p">,</span> <span class="n">ChainsOptionName</span><span class="p">))</span>
 1665     
 1666     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SpecifiedChainIDsList</span>
 1667     
 1668 <span class="k">def</span> <span class="nf">_ProcessLigandIDs</span><span class="p">(</span><span class="n">ChainsAndLigandsInfo</span><span class="p">,</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">,</span> <span class="n">LigandsOptionName</span><span class="p">,</span> <span class="n">LigandsOptionValue</span><span class="p">):</span>
 1669     <span class="sd">&quot;&quot;&quot;Process ligand IDs&quot;&quot;&quot;</span>
 1670 
 1671     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Processing ligand IDs...&quot;</span><span class="p">)</span>
 1672     
 1673     <span class="c1"># Intialize ligand IDs...</span>
 1674     <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]:</span>
 1675         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1676         
 1677     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^All$&quot;</span><span class="p">,</span> <span class="n">LigandsOptionValue</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1678         <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]</span> <span class="p">:</span>
 1679             <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">ChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
 1680         <span class="k">return</span>
 1681     <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(Largest|Auto)$&quot;</span><span class="p">,</span> <span class="n">LigandsOptionValue</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1682         <span class="c1"># Setup largest ligand ID for each chain...</span>
 1683         <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]</span> <span class="p">:</span>
 1684             <span class="n">LargestLigandID</span> <span class="o">=</span> <span class="n">ChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]))</span> <span class="k">else</span> <span class="bp">None</span>
 1685             <span class="k">if</span> <span class="n">LargestLigandID</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
 1686                 <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">LargestLigandID</span><span class="p">)</span>
 1687         <span class="k">return</span>
 1688     
 1689     <span class="n">LigandIDs</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">LigandsOptionValue</span><span class="p">)</span>
 1690     <span class="k">if</span> <span class="ow">not</span> <span class="n">LigandIDs</span><span class="p">:</span>
 1691         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;No valid value specified using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option.&quot;</span> <span class="o">%</span> <span class="n">LigandsOptionName</span><span class="p">)</span>
 1692     
 1693     <span class="n">LigandIDsWords</span> <span class="o">=</span> <span class="n">LigandIDs</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
 1694     
 1695     <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]:</span>
 1696         <span class="n">LigandIDsList</span> <span class="o">=</span> <span class="n">ChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
 1697         <span class="n">SpecifiedLigandIDsList</span> <span class="o">=</span> <span class="p">[]</span>
 1698 
 1699         <span class="k">for</span> <span class="n">LigandID</span> <span class="ow">in</span> <span class="n">LigandIDsWords</span><span class="p">:</span>
 1700             <span class="k">if</span> <span class="ow">not</span> <span class="n">LigandID</span> <span class="ow">in</span> <span class="n">LigandIDsList</span><span class="p">:</span>
 1701                 <span class="n">LigandIDsListNames</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">LigandIDsList</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">LigandIDsList</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;None&quot;</span>
 1702                 <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;The ligand ID, </span><span class="si">%s</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option is not valid for chain, </span><span class="si">%s</span><span class="s2">. It&#39;ll be ignored. Valid ligand IDs: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">LigandID</span><span class="p">,</span> <span class="n">LigandsOptionName</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandIDsListNames</span><span class="p">))</span>
 1703                 <span class="k">continue</span>
 1704             <span class="k">if</span> <span class="n">LigandID</span> <span class="ow">in</span> <span class="n">SpecifiedLigandIDsList</span><span class="p">:</span>
 1705                 <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;The ligand ID, </span><span class="si">%s</span><span class="s2">, has already been specified using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option. It&#39;ll be ignored.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">LigandID</span><span class="p">,</span> <span class="n">LigandsOptionName</span><span class="p">))</span>
 1706                 <span class="k">continue</span>
 1707             <span class="n">SpecifiedLigandIDsList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">LigandID</span><span class="p">)</span>
 1708             
 1709         <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">SpecifiedLigandIDsList</span><span class="p">):</span>
 1710             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;No valid ligand IDs </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> specified using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option for chain ID, </span><span class="si">%s</span><span class="s2">.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">LigandsOptionValue</span><span class="p">,</span> <span class="n">LigandsOptionName</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">))</span>
 1711         
 1712         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">SpecifiedLigandIDsList</span>
 1713 
 1714 <span class="k">def</span> <span class="nf">ProcessResidueTypesOptionsInfo</span><span class="p">(</span><span class="n">ResidueTypesOptionName</span><span class="p">,</span> <span class="n">ResidueTypesOptionValue</span><span class="p">):</span>
 1715     <span class="sd">&quot;&quot;&quot;Process specified residue types using command line option.</span>
 1716 
 1717 <span class="sd">    Arguments:</span>
 1718 <span class="sd">        ResidueTypesOptionName (str): Name of command line  option.</span>
 1719 <span class="sd">        ResidueTypesOptionValue (str): Value for command line option.</span>
 1720 
 1721 <span class="sd">    Returns:</span>
 1722 <span class="sd">        list: A list containing names of valid residue types.</span>
 1723 <span class="sd">        dict: A dictionary containing residue types pointing to dictionaries of</span>
 1724 <span class="sd">            color names and list of residues for a residue type.</span>
 1725 
 1726 <span class="sd">    Examples:</span>
 1727 
 1728 <span class="sd">        ResidueTypesNamesInfo, ResidueTypesParamsInfo =</span>
 1729 <span class="sd">            ProcessChainsAndLigandsOptionsInfo(&quot;-r, --residueTypes&quot;,</span>
 1730 <span class="sd">            OptionsInfo[&quot;ResidueTypes&quot;])</span>
 1731 <span class="sd">        for ResidueTypeName in ResidueTypesNamesInfo:</span>
 1732 <span class="sd">            MiscUtil.PrintInfo(&quot;ResidueType: %s; Color: %s; Residues: %s&quot; %</span>
 1733 <span class="sd">            (ResidueTypeName, ResidueTypeName[ResidueTypeName][&quot;Color&quot;],</span>
 1734 <span class="sd">            &quot; &quot;.join(ResidueTypeName[ResidueTypeName][&quot;Residues&quot;]))</span>
 1735 
 1736 <span class="sd">    &quot;&quot;&quot;</span>
 1737     
 1738     <span class="c1"># Set up  default values for residue types, colors, and names.</span>
 1739     <span class="n">ResidueTypesNamesInfo</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Aromatic&quot;</span><span class="p">,</span> <span class="s2">&quot;Hydrophobic&quot;</span><span class="p">,</span> <span class="s2">&quot;Polar&quot;</span><span class="p">,</span> <span class="s2">&quot;Positively_Charged&quot;</span><span class="p">,</span> <span class="s2">&quot;Negatively_Charged&quot;</span><span class="p">]</span>
 1740     
 1741     <span class="n">ResidueTypesParamsInfo</span> <span class="o">=</span> <span class="p">{}</span>
 1742     <span class="n">ResidueTypesParamsInfo</span><span class="p">[</span><span class="s2">&quot;Aromatic&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Color&quot;</span><span class="p">:</span> <span class="s2">&quot;brightorange&quot;</span><span class="p">,</span> <span class="s2">&quot;Residues&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;HIS&quot;</span><span class="p">,</span> <span class="s2">&quot;PHE&quot;</span><span class="p">,</span> <span class="s2">&quot;TRP&quot;</span><span class="p">,</span> <span class="s2">&quot;TYR&quot;</span><span class="p">]}</span>
 1743     <span class="n">ResidueTypesParamsInfo</span><span class="p">[</span><span class="s2">&quot;Hydrophobic&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Color&quot;</span><span class="p">:</span> <span class="s2">&quot;orange&quot;</span><span class="p">,</span> <span class="s2">&quot;Residues&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;ALA&quot;</span><span class="p">,</span> <span class="s2">&quot;GLY&quot;</span><span class="p">,</span> <span class="s2">&quot;VAL&quot;</span><span class="p">,</span> <span class="s2">&quot;LEU&quot;</span><span class="p">,</span> <span class="s2">&quot;ILE&quot;</span><span class="p">,</span> <span class="s2">&quot;PRO&quot;</span><span class="p">,</span> <span class="s2">&quot;MET&quot;</span><span class="p">]}</span>
 1744     <span class="n">ResidueTypesParamsInfo</span><span class="p">[</span><span class="s2">&quot;Polar&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Color&quot;</span><span class="p">:</span> <span class="s2">&quot;palegreen&quot;</span><span class="p">,</span> <span class="s2">&quot;Residues&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;ASN&quot;</span><span class="p">,</span> <span class="s2">&quot;GLN&quot;</span><span class="p">,</span> <span class="s2">&quot;SER&quot;</span><span class="p">,</span> <span class="s2">&quot;THR&quot;</span><span class="p">,</span> <span class="s2">&quot;CYS&quot;</span><span class="p">]}</span>
 1745     <span class="n">ResidueTypesParamsInfo</span><span class="p">[</span><span class="s2">&quot;Positively_Charged&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Color&quot;</span><span class="p">:</span> <span class="s2">&quot;marine&quot;</span><span class="p">,</span> <span class="s2">&quot;Residues&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;ARG&quot;</span><span class="p">,</span> <span class="s2">&quot;LYS&quot;</span><span class="p">]}</span>
 1746     <span class="n">ResidueTypesParamsInfo</span><span class="p">[</span><span class="s2">&quot;Negatively_Charged&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Color&quot;</span><span class="p">:</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="s2">&quot;Residues&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&quot;ASP&quot;</span><span class="p">,</span> <span class="s2">&quot;GLU&quot;</span><span class="p">]}</span>
 1747     
 1748     <span class="n">ResidueTypes</span> <span class="o">=</span> <span class="n">ResidueTypesOptionValue</span>
 1749     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">ResidueTypesOptionValue</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1750         <span class="n">_SetupOtherResidueTypes</span><span class="p">(</span><span class="n">ResidueTypesParamsInfo</span><span class="p">)</span>
 1751         <span class="k">return</span> <span class="n">ResidueTypesNamesInfo</span><span class="p">,</span> <span class="n">ResidueTypesParamsInfo</span>
 1752     
 1753     <span class="c1"># Parse specified residue types...</span>
 1754     <span class="n">ResidueTypesWords</span> <span class="o">=</span> <span class="n">ResidueTypes</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
 1755     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ResidueTypesWords</span><span class="p">)</span> <span class="o">%</span> <span class="mi">3</span><span class="p">:</span>
 1756         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The number of comma delimited residue type, color, and name triplets, </span><span class="si">%d</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option must be a multple of 3.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ResidueTypesWords</span><span class="p">),</span> <span class="n">ResidueTypesOptionName</span><span class="p">))</span>
 1757 
 1758     <span class="c1"># Set up canonical residue type names...</span>
 1759     <span class="n">ValidResidueTypeNames</span> <span class="o">=</span> <span class="p">[]</span>
 1760     <span class="n">CanonicalResidueTypeNamesMap</span> <span class="o">=</span> <span class="p">{}</span>
 1761     <span class="k">for</span> <span class="n">Name</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">ResidueTypesNamesInfo</span><span class="p">):</span>
 1762         <span class="n">ValidResidueTypeNames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
 1763         <span class="n">CanonicalResidueTypeNamesMap</span><span class="p">[</span><span class="n">Name</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="o">=</span> <span class="n">Name</span>
 1764 
 1765     <span class="c1"># Validate and set residue types, colors, and names..</span>
 1766     <span class="k">for</span> <span class="n">Index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ResidueTypesWords</span><span class="p">),</span> <span class="mi">3</span><span class="p">):</span>
 1767         <span class="n">TypeName</span> <span class="o">=</span> <span class="n">ResidueTypesWords</span><span class="p">[</span><span class="n">Index</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
 1768         <span class="n">ResidueTypeColor</span> <span class="o">=</span> <span class="n">ResidueTypesWords</span><span class="p">[</span><span class="n">Index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
 1769         <span class="n">ResidueNames</span> <span class="o">=</span> <span class="n">ResidueTypesWords</span><span class="p">[</span><span class="n">Index</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
 1770         
 1771         <span class="n">ResidueNames</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;[ ]+&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">ResidueNames</span><span class="p">)</span>
 1772         <span class="n">ResidueNamesWords</span> <span class="o">=</span> <span class="n">ResidueNames</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
 1773 
 1774         <span class="n">CanonicalTypeName</span> <span class="o">=</span> <span class="n">TypeName</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
 1775         <span class="k">if</span> <span class="ow">not</span> <span class="n">CanonicalTypeName</span> <span class="ow">in</span> <span class="n">CanonicalResidueTypeNamesMap</span><span class="p">:</span>
 1776             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The residue type, </span><span class="si">%s</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option is not a valid type. Supported residue types: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">TypeName</span><span class="p">,</span> <span class="n">ResidueTypesOptionName</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ValidResidueTypeNames</span><span class="p">)))</span>
 1777         <span class="n">ResidueTypeName</span> <span class="o">=</span> <span class="n">CanonicalResidueTypeNamesMap</span><span class="p">[</span><span class="n">CanonicalTypeName</span><span class="p">]</span>
 1778 
 1779         <span class="k">if</span> <span class="ow">not</span> <span class="n">ResidueTypeColor</span><span class="p">:</span>
 1780             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;No color name specified for residue type, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option, </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">TypeName</span><span class="p">,</span> <span class="n">ResidueTypesOptionName</span><span class="p">,</span> <span class="n">ResidueTypes</span><span class="p">))</span>
 1781         
 1782         <span class="k">if</span> <span class="ow">not</span> <span class="n">ResidueNames</span><span class="p">:</span>
 1783             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;No residue names specified for residue type, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option, </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">TypeName</span><span class="p">,</span> <span class="n">ResidueTypesOptionName</span><span class="p">,</span> <span class="n">ResidueTypes</span><span class="p">))</span>
 1784             
 1785         <span class="n">ResidueTypesParamsInfo</span><span class="p">[</span><span class="n">ResidueTypeName</span><span class="p">][</span><span class="s2">&quot;Color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ResidueTypeColor</span>
 1786         <span class="n">ResidueTypesParamsInfo</span><span class="p">[</span><span class="n">ResidueTypeName</span><span class="p">][</span><span class="s2">&quot;Residues&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ResidueNamesWords</span>
 1787         
 1788         <span class="n">SetupOtherResidueTypes</span><span class="p">()</span>
 1789         <span class="k">return</span> <span class="n">ResidueTypesNamesInfo</span><span class="p">,</span> <span class="n">ResidueTypesParamsInfo</span>
 1790 
 1791 <span class="k">def</span> <span class="nf">_SetupOtherResidueTypes</span><span class="p">(</span><span class="n">ResidueTypesParamsInfo</span><span class="p">):</span>
 1792     <span class="sd">&quot;&quot;&quot;Setup other residue types.&quot;&quot;&quot;</span>
 1793 
 1794     <span class="c1"># Set other residues to all specified residues. The other residues are selected by</span>
 1795     <span class="c1"># performing a negation operation on this list during the creation of PyMOL objects.</span>
 1796     
 1797     <span class="n">ResidueNames</span> <span class="o">=</span> <span class="p">[]</span>
 1798     <span class="k">for</span> <span class="n">ResiduesType</span> <span class="ow">in</span> <span class="n">ResidueTypesParamsInfo</span><span class="p">:</span>
 1799         <span class="n">ResidueNames</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">ResidueTypesParamsInfo</span><span class="p">[</span><span class="n">ResiduesType</span><span class="p">][</span><span class="s2">&quot;Residues&quot;</span><span class="p">]</span> <span class="p">)</span>
 1800     
 1801     <span class="n">ResidueTypesParamsInfo</span><span class="p">[</span><span class="s2">&quot;Other&quot;</span><span class="p">]</span><span class="o">=</span> <span class="p">{}</span>
 1802     <span class="n">ResidueTypesParamsInfo</span><span class="p">[</span><span class="s2">&quot;Other&quot;</span><span class="p">][</span><span class="s2">&quot;Color&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
 1803     <span class="n">ResidueTypesParamsInfo</span><span class="p">[</span><span class="s2">&quot;Other&quot;</span><span class="p">][</span><span class="s2">&quot;Residues&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ResidueNames</span>
 1804     
 1805 <span class="k">def</span> <span class="nf">ProcessSurfaceAtomTypesColorsOptionsInfo</span><span class="p">(</span><span class="n">ColorOptionName</span><span class="p">,</span> <span class="n">ColorOptionValue</span><span class="p">):</span>
 1806     <span class="sd">&quot;&quot;&quot;Process specified surafce atom types colors using command line option.</span>
 1807 
 1808 <span class="sd">    Arguments:</span>
 1809 <span class="sd">        ColorOptionName (str): Name of command line  option.</span>
 1810 <span class="sd">        ColorOptionValue (str): Value for command line option.</span>
 1811 
 1812 <span class="sd">    Returns:</span>
 1813 <span class="sd">        dict: A dictionary containing atom types and colors.</span>
 1814 
 1815 <span class="sd">    Examples:</span>
 1816 
 1817 <span class="sd">        AtomTypesColorNamesInfo =</span>
 1818 <span class="sd">            PyMOLUtil.ProcessSurfaceAtomTypesColorsOptionsInfo(</span>
 1819 <span class="sd">            &quot;--surfaceAtomTypesColors&quot;, OptionsInfo[&quot;SurfaceAtomTypesColors&quot;])</span>
 1820 
 1821 <span class="sd">    &quot;&quot;&quot;</span>
 1822     
 1823     <span class="c1"># Set up  default values for atom type colors...</span>
 1824     <span class="n">AtomTypesColorNamesInfo</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;HydrophobicAtomsColor&quot;</span><span class="p">:</span> <span class="s2">&quot;yellow&quot;</span><span class="p">,</span> <span class="s2">&quot;NegativelyChargedAtomsColor&quot;</span><span class="p">:</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="s2">&quot;PositivelyChargedAtomsColor&quot;</span><span class="p">:</span> <span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="s2">&quot;OtherAtomsColor&quot;</span><span class="p">:</span> <span class="s2">&quot;gray90&quot;</span><span class="p">}</span>
 1825     
 1826     <span class="n">AtomTypesColors</span> <span class="o">=</span> <span class="n">ColorOptionValue</span>
 1827     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">AtomTypesColors</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1828         <span class="k">return</span> <span class="n">AtomTypesColorNamesInfo</span>
 1829     
 1830     <span class="c1"># Parse atom type colors and values...</span>
 1831     <span class="n">AtomTypesColorsWords</span> <span class="o">=</span> <span class="n">AtomTypesColors</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
 1832     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">AtomTypesColorsWords</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span><span class="p">:</span>
 1833         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The number of comma delimited surface atom color types and values, </span><span class="si">%d</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option must be a multple of 2.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">AtomTypesColorsWords</span><span class="p">),</span> <span class="n">ColorOptionName</span><span class="p">))</span>
 1834 
 1835     <span class="c1"># Set up canonical atom type colors...</span>
 1836     <span class="n">ValidAtomTypesColors</span> <span class="o">=</span> <span class="p">[]</span>
 1837     <span class="n">CanonicalAtomTypesColorsMap</span> <span class="o">=</span> <span class="p">{}</span>
 1838     <span class="k">for</span> <span class="n">Type</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">AtomTypesColorNamesInfo</span><span class="p">):</span>
 1839         <span class="n">ValidAtomTypesColors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Type</span><span class="p">)</span>
 1840         <span class="n">CanonicalAtomTypesColorsMap</span><span class="p">[</span><span class="n">Type</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="o">=</span> <span class="n">Type</span>
 1841     
 1842     <span class="c1"># Validate and process specified values...</span>
 1843     <span class="k">for</span> <span class="n">Index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">AtomTypesColorsWords</span><span class="p">),</span> <span class="mi">2</span><span class="p">):</span>
 1844         <span class="n">Type</span> <span class="o">=</span> <span class="n">AtomTypesColorsWords</span><span class="p">[</span><span class="n">Index</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
 1845         <span class="n">Color</span> <span class="o">=</span> <span class="n">AtomTypesColorsWords</span><span class="p">[</span><span class="n">Index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
 1846         
 1847         <span class="n">Color</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;[ ]+&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">Color</span><span class="p">)</span>
 1848         <span class="n">ColorWords</span> <span class="o">=</span> <span class="n">Color</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>
 1849     
 1850         <span class="n">CanonicalType</span> <span class="o">=</span> <span class="n">Type</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
 1851         <span class="k">if</span> <span class="ow">not</span> <span class="n">CanonicalType</span> <span class="ow">in</span> <span class="n">CanonicalAtomTypesColorsMap</span><span class="p">:</span>
 1852             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The surface atom color type, </span><span class="si">%s</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option  is not a valid type: Supported atom color types: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Type</span><span class="p">,</span> <span class="n">ColorOptionName</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ValidAtomTypesColors</span><span class="p">)))</span>
 1853         <span class="n">Type</span> <span class="o">=</span> <span class="n">CanonicalAtomTypesColorsMap</span><span class="p">[</span><span class="n">CanonicalType</span><span class="p">]</span>
 1854 
 1855         <span class="k">if</span> <span class="ow">not</span> <span class="n">Color</span><span class="p">:</span>
 1856             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;No color type specified for atom color type, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Type</span><span class="p">,</span> <span class="n">ColorOptionName</span><span class="p">))</span>
 1857 
 1858         <span class="n">ColorWordsLen</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ColorWords</span><span class="p">)</span>
 1859         <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">ColorWordsLen</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">ColorWordsLen</span> <span class="o">==</span> <span class="mi">3</span><span class="p">):</span>
 1860             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The number, </span><span class="si">%s</span><span class="s2">, of color name or space delimited RGB values, </span><span class="si">%s</span><span class="s2">, specified for atom color type, </span><span class="si">%s</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option must be 1 or 3.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ColorWordsLen</span><span class="p">,</span> <span class="n">Color</span><span class="p">,</span> <span class="n">ColorOptionName</span><span class="p">,</span> <span class="n">Type</span><span class="p">))</span>
 1861 
 1862         <span class="n">AtomTypesColorNamesInfo</span><span class="p">[</span><span class="n">Type</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ColorWords</span><span class="p">)</span>
 1863 
 1864         <span class="k">return</span> <span class="n">AtomTypesColorNamesInfo</span>
 1865 
 1866 <span class="k">def</span> <span class="nf">ProcessChainSelectionsOptionsInfo</span><span class="p">(</span><span class="n">SelectionOptionName</span><span class="p">,</span> <span class="n">SelectionOptionValue</span><span class="p">):</span>
 1867     <span class="sd">&quot;&quot;&quot;Process names and selections specified  using command line option. It</span>
 1868 <span class="sd">    is a pairwise list comma delimited values corresponding to PyMOL object</span>
 1869 <span class="sd">    names and selection specification</span>
 1870 
 1871 <span class="sd">    Arguments:</span>
 1872 <span class="sd">        SelectionOptionName (str): Name of command line  option.</span>
 1873 <span class="sd">        SelectionOptionValue (str): Value for command line option.</span>
 1874 
 1875 <span class="sd">    Returns:</span>
 1876 <span class="sd">        dict: A dictionary containing lists f names and selection commands.</span>
 1877 
 1878 <span class="sd">    Examples:</span>
 1879 
 1880 <span class="sd">        ChainSelectionsInfo =</span>
 1881 <span class="sd">            PyMOLUtil.ProcessChainSelectionsOptionsInfo(&quot;--selectionsChain&quot;,</span>
 1882 <span class="sd">            OptionsInfo[&quot;SelectionChains&quot;])</span>
 1883 
 1884 <span class="sd">    &quot;&quot;&quot;</span>
 1885     
 1886     <span class="c1"># Initialize...</span>
 1887     <span class="n">ChainSelectionsInfo</span> <span class="o">=</span> <span class="p">{}</span>
 1888     <span class="n">ChainSelectionsInfo</span><span class="p">[</span><span class="s2">&quot;Names&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1889     <span class="n">ChainSelectionsInfo</span><span class="p">[</span><span class="s2">&quot;Selections&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1890 
 1891     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^None$&quot;</span><span class="p">,</span> <span class="n">SelectionOptionValue</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1892         <span class="k">return</span> <span class="n">ChainSelectionsInfo</span>
 1893     
 1894     <span class="c1"># Parse selection chains names and selections...</span>
 1895     <span class="n">ChainSelectionsWords</span> <span class="o">=</span> <span class="n">SelectionOptionValue</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
 1896     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ChainSelectionsWords</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span><span class="p">:</span>
 1897         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The number of comma delimited selection chains names and selections, </span><span class="si">%d</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option must be a multple of 2.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ChainSelectionsWords</span><span class="p">),</span> <span class="n">SelectionOptionName</span><span class="p">))</span>
 1898 
 1899     <span class="n">CanonicalNamesMap</span> <span class="o">=</span> <span class="p">{}</span>
 1900     <span class="k">for</span> <span class="n">Index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ChainSelectionsWords</span><span class="p">),</span> <span class="mi">2</span><span class="p">):</span>
 1901         <span class="n">Name</span> <span class="o">=</span> <span class="n">ChainSelectionsWords</span><span class="p">[</span><span class="n">Index</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
 1902         <span class="n">Selection</span> <span class="o">=</span> <span class="n">ChainSelectionsWords</span><span class="p">[</span><span class="n">Index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
 1903 
 1904         <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">Name</span><span class="p">):</span>
 1905             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;A name specified, </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">,  using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option is empty.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionOptionValue</span><span class="p">,</span> <span class="n">SelectionOptionName</span><span class="p">))</span>
 1906         <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">Selection</span><span class="p">):</span>
 1907             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;A selection specified, </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">, using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option is empty.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionOptionValue</span><span class="p">,</span> <span class="n">SelectionOptionName</span><span class="p">))</span>
 1908 
 1909         <span class="n">CanonicalName</span> <span class="o">=</span> <span class="n">Name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
 1910         <span class="k">if</span> <span class="n">CanonicalName</span> <span class="ow">in</span> <span class="n">CanonicalNamesMap</span><span class="p">:</span>
 1911             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The name </span><span class="si">%s</span><span class="s2">  specified using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option is a duplicate name.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">SelectionOptionName</span><span class="p">))</span>
 1912         <span class="n">CanonicalNamesMap</span><span class="p">[</span><span class="n">CanonicalName</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
 1913 
 1914         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">&quot;[^a-zA-Z0-9 _\-]&quot;</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1915             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The name </span><span class="si">%s</span><span class="s2">  specified using </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> option contains invalid charactors. Supportted characters: alphanumeric,  space, hyphen and underscore..&quot;</span> <span class="p">)</span>
 1916         
 1917         <span class="n">ChainSelectionsInfo</span><span class="p">[</span><span class="s2">&quot;Names&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
 1918         <span class="n">ChainSelectionsInfo</span><span class="p">[</span><span class="s2">&quot;Selections&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Selection</span><span class="p">)</span>
 1919     
 1920     <span class="k">return</span> <span class="n">ChainSelectionsInfo</span>
 1921 
 1922 <span class="k">def</span> <span class="nf">CalculateCenterOfMass</span><span class="p">(</span><span class="n">Selection</span> <span class="o">=</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="n">Quiet</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
 1923     <span class="sd">&quot;&quot;&quot;Calculate center of mass for a selection.</span>
 1924 
 1925 <span class="sd">    Arguments:</span>
 1926 <span class="sd">        Selection (str): A PyMOL selection.</span>
 1927 <span class="sd">        Quiet (int): Print information.</span>
 1928 
 1929 <span class="sd">    Returns:</span>
 1930 <span class="sd">        list: X, Y, Z coordinates for center of mass.</span>
 1931 
 1932 <span class="sd">    &quot;&quot;&quot;</span>
 1933     <span class="n">MassTotal</span> <span class="o">=</span> <span class="mf">0.0</span>
 1934     <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>
 1935     
 1936     <span class="n">Atoms</span> <span class="o">=</span> <span class="n">cmd</span><span class="o">.</span><span class="n">get_model</span><span class="p">(</span><span class="n">Selection</span><span class="p">)</span>
 1937     <span class="k">for</span> <span class="n">Atom</span> <span class="ow">in</span> <span class="n">Atoms</span><span class="o">.</span><span class="n">atom</span><span class="p">:</span>
 1938         <span class="n">Mass</span> <span class="o">=</span> <span class="n">Atom</span><span class="o">.</span><span class="n">get_mass</span><span class="p">()</span>
 1939         <span class="n">MassTotal</span> <span class="o">+=</span> <span class="n">Mass</span>
 1940 
 1941         <span class="n">X</span> <span class="o">+=</span> <span class="n">Atom</span><span class="o">.</span><span class="n">coord</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">Mass</span>
 1942         <span class="n">Y</span> <span class="o">+=</span> <span class="n">Atom</span><span class="o">.</span><span class="n">coord</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">Mass</span>
 1943         <span class="n">Z</span> <span class="o">+=</span> <span class="n">Atom</span><span class="o">.</span><span class="n">coord</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">Mass</span>
 1944 
 1945     <span class="n">XCOM</span> <span class="o">=</span> <span class="n">X</span><span class="o">/</span><span class="n">MassTotal</span>
 1946     <span class="n">YCOM</span> <span class="o">=</span> <span class="n">Y</span><span class="o">/</span><span class="n">MassTotal</span>
 1947     <span class="n">ZCOM</span> <span class="o">=</span> <span class="n">Z</span><span class="o">/</span><span class="n">MassTotal</span>
 1948 
 1949     <span class="k">if</span> <span class="ow">not</span> <span class="n">Quiet</span><span class="p">:</span>
 1950         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;PyMOLUtil.CalculateCenterOfMass: </span><span class="si">%f</span><span class="s2">, </span><span class="si">%f</span><span class="s2">, </span><span class="si">%f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">XCOM</span><span class="p">,</span> <span class="n">YCOM</span><span class="p">,</span> <span class="n">ZCOM</span><span class="p">))</span>
 1951     
 1952     <span class="k">return</span> <span class="p">[</span><span class="n">XCOM</span><span class="p">,</span> <span class="n">YCOM</span><span class="p">,</span> <span class="n">ZCOM</span><span class="p">]</span>
 1953 
 1954 <span class="k">def</span> <span class="nf">ConvertFileFormat</span><span class="p">(</span><span class="n">Infile</span><span class="p">,</span> <span class="n">Outfile</span><span class="p">,</span> <span class="n">Reinitialize</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">OutputFeedback</span> <span class="o">=</span> <span class="bp">True</span><span class="p">):</span>
 1955     <span class="sd">&quot;&quot;&quot;Convert infile to outfile by automatically detecting their formats</span>
 1956 <span class="sd">    from the file extensions.</span>
 1957 
 1958 <span class="sd">    The formats of both input and output files must be a valid format supported</span>
 1959 <span class="sd">    by PyMOL.</span>
 1960 
 1961 <span class="sd">    Arguments:</span>
 1962 <span class="sd">        Infile (str): Name of input file.</span>
 1963 <span class="sd">        Outfile (str): Name of outfile file.</span>
 1964 <span class="sd">        Reinitialize (bool): Reinitialize PyMOL before loading input file.</span>
 1965 <span class="sd">        OutputFeedback (bool): Control output feedback.</span>
 1966 
 1967 <span class="sd">    &quot;&quot;&quot;</span>
 1968     
 1969     <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">Infile</span><span class="p">):</span>
 1970         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;The input file, </span><span class="si">%s</span><span class="s2">, doesn&#39;t exists.</span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Infile</span><span class="p">))</span>
 1971 
 1972     <span class="k">if</span> <span class="n">Reinitialize</span><span class="p">:</span>
 1973         <span class="n">cmd</span><span class="o">.</span><span class="n">reinitialize</span><span class="p">()</span>
 1974 
 1975     <span class="k">if</span> <span class="ow">not</span> <span class="n">OutputFeedback</span><span class="p">:</span>
 1976         <span class="c1"># Turn off output feedback...</span>
 1977         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Disabling output feedback for PyMOL...&quot;</span><span class="p">)</span>
 1978         <span class="n">cmd</span><span class="o">.</span><span class="n">feedback</span><span class="p">(</span><span class="s2">&quot;disable&quot;</span><span class="p">,</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="s2">&quot;output&quot;</span><span class="p">)</span>
 1979 
 1980     <span class="n">FileDir</span><span class="p">,</span> <span class="n">FileName</span><span class="p">,</span> <span class="n">FileExt</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ParseFileName</span><span class="p">(</span><span class="n">Infile</span><span class="p">)</span>
 1981     <span class="n">MolName</span> <span class="o">=</span> <span class="n">FileName</span>
 1982     
 1983     <span class="n">cmd</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">Infile</span><span class="p">,</span> <span class="n">MolName</span><span class="p">)</span>
 1984     <span class="n">cmd</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">Outfile</span><span class="p">,</span> <span class="n">MolName</span><span class="p">)</span>
 1985     <span class="n">cmd</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">MolName</span><span class="p">)</span>
 1986     
 1987     <span class="k">if</span> <span class="ow">not</span> <span class="n">OutputFeedback</span><span class="p">:</span>
 1988         <span class="c1"># Turn it back on...</span>
 1989         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Enabling output feedback for PyMOL...&quot;</span><span class="p">)</span>
 1990         <span class="n">cmd</span><span class="o">.</span><span class="n">feedback</span><span class="p">(</span><span class="s2">&quot;enable&quot;</span><span class="p">,</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="s2">&quot;output&quot;</span><span class="p">)</span>
 1991 
 1992 <span class="k">def</span> <span class="nf">ConvertPMLFileToPSEFile</span><span class="p">(</span><span class="n">PMLFile</span><span class="p">,</span> <span class="n">PSEFile</span><span class="p">,</span> <span class="n">Reinitialize</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">OutputFeedback</span> <span class="o">=</span> <span class="bp">True</span><span class="p">):</span>
 1993     <span class="sd">&quot;&quot;&quot;Convert PML file to PME file.</span>
 1994 
 1995 <span class="sd">    Arguments:</span>
 1996 <span class="sd">        PMLFile (str): Name of PML file.</span>
 1997 <span class="sd">        PSEFile (str): Name of PSE file.</span>
 1998 <span class="sd">        Reinitialize (bool): Reinitialize PyMOL before loading PML file.</span>
 1999 <span class="sd">        OutputFeedback (bool): Control output feedback.</span>
 2000 
 2001 <span class="sd">    &quot;&quot;&quot;</span>
 2002     
 2003     <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">PMLFile</span><span class="p">):</span>
 2004         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;The PML file, </span><span class="si">%s</span><span class="s2">, doesn&#39;t exists.</span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">PMLFile</span><span class="p">))</span>
 2005 
 2006     <span class="k">if</span> <span class="n">Reinitialize</span><span class="p">:</span>
 2007         <span class="n">cmd</span><span class="o">.</span><span class="n">reinitialize</span><span class="p">()</span>
 2008 
 2009     <span class="k">if</span> <span class="ow">not</span> <span class="n">OutputFeedback</span><span class="p">:</span>
 2010         <span class="c1"># Turn off output feedback...</span>
 2011         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Disabling output feedback for PyMOL...&quot;</span><span class="p">)</span>
 2012         <span class="n">cmd</span><span class="o">.</span><span class="n">feedback</span><span class="p">(</span><span class="s2">&quot;disable&quot;</span><span class="p">,</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="s2">&quot;output&quot;</span><span class="p">)</span>
 2013 
 2014     <span class="n">cmd</span><span class="o">.</span><span class="n">do</span><span class="p">(</span><span class="s2">&quot;@</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PMLFile</span><span class="p">)</span>
 2015     <span class="n">cmd</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">PSEFile</span><span class="p">)</span>
 2016     
 2017     <span class="k">if</span> <span class="ow">not</span> <span class="n">OutputFeedback</span><span class="p">:</span>
 2018         <span class="c1"># Turn it back on...</span>
 2019         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Enabling output feedback for PyMOL...&quot;</span><span class="p">)</span>
 2020         <span class="n">cmd</span><span class="o">.</span><span class="n">feedback</span><span class="p">(</span><span class="s2">&quot;enable&quot;</span><span class="p">,</span> <span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="s2">&quot;output&quot;</span><span class="p">)</span>
 2021 
 2022 <span class="k">def</span> <span class="nf">SetupPMLHeaderInfo</span><span class="p">(</span><span class="n">ScriptName</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">IncludeLocalPython</span> <span class="o">=</span> <span class="bp">True</span><span class="p">):</span>
 2023     <span class="sd">&quot;&quot;&quot;Setup header information for generating PML files. The local Python</span>
 2024 <span class="sd">    functions are optionally embedded in the header information for their</span>
 2025 <span class="sd">    use in PML files.</span>
 2026 <span class="sd"> </span>
 2027 <span class="sd">    Arguments:</span>
 2028 <span class="sd">        ScriptName (str): Name of script calling the function.</span>
 2029 <span class="sd">        IncludeLocalPython (bool): Include local Python functions.</span>
 2030 
 2031 <span class="sd">    Returns:</span>
 2032 <span class="sd">        str: Text containing header information for generating PML files.</span>
 2033 
 2034 <span class="sd">    &quot;&quot;&quot;</span>
 2035     <span class="k">if</span> <span class="n">ScriptName</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
 2036         <span class="n">HeaderInfo</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
 2037 <span class="s2">#</span>
 2038 <span class="s2"># This file is automatically generated by a script available in MayaChemTools.</span>
 2039 <span class="s2">#</span>
 2040 <span class="s2">cmd.reinitialize()&quot;&quot;&quot;</span>
 2041     <span class="k">else</span><span class="p">:</span>
 2042         <span class="n">HeaderInfo</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
 2043 <span class="s2">#</span>
 2044 <span class="s2"># This file is automatically generated by the following PyMOL script available in</span>
 2045 <span class="s2"># MayaChemTools: </span><span class="si">%s</span><span class="s2"></span>
 2046 <span class="s2">#</span>
 2047 <span class="s2">cmd.reinitialize() &quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ScriptName</span><span class="p">)</span>
 2048 
 2049     <span class="k">if</span> <span class="n">IncludeLocalPython</span><span class="p">:</span>
 2050         <span class="n">PMLForLocalPython</span> <span class="o">=</span> <span class="n">_SetupPMLForLocalPython</span><span class="p">()</span>
 2051         <span class="n">HeaderInfo</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n\n</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">HeaderInfo</span><span class="p">,</span> <span class="n">PMLForLocalPython</span><span class="p">)</span>
 2052     
 2053     <span class="k">return</span> <span class="n">HeaderInfo</span>
 2054 
 2055 <span class="k">def</span> <span class="nf">_SetupPMLForLocalPython</span><span class="p">():</span>
 2056     <span class="sd">&quot;&quot;&quot;Setup local Python functions for PML file.</span>
 2057 <span class="sd">    &quot;&quot;&quot;</span>
 2058     
 2059     <span class="n">PMLForPython</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
 2060 <span class="s2">&quot;&quot;</span>
 2061 <span class="s2">&quot;Setting up local Python functions  for PML script...&quot;</span>
 2062 <span class="s2">&quot;&quot;</span>
 2063 <span class="s2">python</span>
 2064 
 2065 <span class="s2">from __future__ import print_function</span>
 2066 <span class="s2">import re</span>
 2067 
 2068 <span class="s2">def ColorByHydrophobicity(Selection, ColorPalette = &quot;RedToWhite&quot;):</span>
 2069 <span class="s2">    </span><span class="se">\&quot;</span><span class="s2">&quot;&quot;Color by hydrophobicity using hydrophobic values for amino acid</span>
 2070 <span class="s2">    residues corresponding to the Eisenberg hydrophobicity scale.</span>
 2071 <span class="s2">    </span>
 2072 <span class="s2">    Possible values for ColorPalette: RedToWhite or WhiteToGreen from most</span>
 2073 <span class="s2">    hydrophobic amino acid to least hydrophobic.</span>
 2074 <span class="s2">    </span>
 2075 <span class="s2">    The colors values for amino acids are taken from color_h script avaiable</span>
 2076 <span class="s2">    as part of the Script Library at PyMOL Wiki. </span>
 2077 <span class="s2">        </span>
 2078 <span class="s2">    </span><span class="se">\&quot;</span><span class="s2">&quot;&quot;</span>
 2079 <span class="s2">        </span>
 2080 <span class="s2">    if not re.match(&quot;^(RedToWhite|WhiteToGreen)$&quot;, ColorPalette, re.I):</span>
 2081 <span class="s2">        print(&quot;Invalid ColorPalette value: </span><span class="si">%s</span><span class="s2">. Valid values: RedToWhite, WhiteToGreen&quot; % ColorPalette)</span>
 2082 <span class="s2">    </span>
 2083 <span class="s2">    ResColors = {}</span>
 2084 <span class="s2">    ColorType = &quot;&quot;</span>
 2085 <span class="s2">    </span>
 2086 <span class="s2">    if re.match(&quot;^WhiteToGreen$&quot;, ColorPalette, re.I):</span>
 2087 <span class="s2">        ColorType = &quot;H2&quot;</span>
 2088 <span class="s2">        ResColors = {&quot;ile&quot; : [0.938,1,0.938], &quot;phe&quot; : [0.891,1,0.891], &quot;val&quot; : [0.844,1,0.844], &quot;leu&quot; : [0.793,1,0.793], &quot;trp&quot; : [0.746,1,0.746], &quot;met&quot; : [0.699,1,0.699], &quot;ala&quot; : [0.652,1,0.652], &quot;gly&quot; : [0.606,1,0.606], &quot;cys&quot; : [0.555,1,0.555], &quot;tyr&quot; : [0.508,1,0.508], &quot;pro&quot; : [0.461,1,0.461], &quot;thr&quot; : [0.414,1,0.414], &quot;ser&quot; : [0.363,1,0.363], &quot;his&quot; : [0.316,1,0.316], &quot;glu&quot; : [0.27,1,0.27], &quot;asn&quot; : [0.223,1,0.223], &quot;gln&quot; : [0.176,1,0.176], &quot;asp&quot; : [0.125,1,0.125], &quot;lys&quot; : [0.078,1,0.078], &quot;arg&quot; : [0.031,1,0.031]}</span>
 2089 <span class="s2">    else:</span>
 2090 <span class="s2">        ColorType = &quot;H1&quot;</span>
 2091 <span class="s2">        ResColors = {&quot;ile&quot; : [0.996,0.062,0.062], &quot;phe&quot; : [0.996,0.109,0.109], &quot;val&quot; : [0.992,0.156,0.156], &quot;leu&quot; : [0.992,0.207,0.207], &quot;trp&quot; : [0.992,0.254,0.254], &quot;met&quot; : [0.988,0.301,0.301], &quot;ala&quot; : [0.988,0.348,0.348], &quot;gly&quot; : [0.984,0.394,0.394], &quot;cys&quot; : [0.984,0.445,0.445], &quot;tyr&quot; : [0.984,0.492,0.492], &quot;pro&quot; : [0.980,0.539,0.539], &quot;thr&quot; : [0.980,0.586,0.586], &quot;ser&quot; : [0.980,0.637,0.637], &quot;his&quot; : [0.977,0.684,0.684], &quot;glu&quot; : [0.977,0.730,0.730], &quot;asn&quot; : [0.973,0.777,0.777], &quot;gln&quot; : [0.973,0.824,0.824], &quot;asp&quot; : [0.973,0.875,0.875], &quot;lys&quot; : [0.899,0.922,0.922], &quot;arg&quot; : [0.899,0.969,0.969]}</span>
 2092 <span class="s2">        </span>
 2093 <span class="s2">    # Set up colors...</span>
 2094 <span class="s2">    for ResName in ResColors:</span>
 2095 <span class="s2">        ColorName = &quot;color_</span><span class="si">%s</span><span class="s2">_</span><span class="si">%s</span><span class="s2">&quot; % (ResName, ColorType)</span>
 2096 <span class="s2">        cmd.set_color(ColorName, ResColors[ResName])</span>
 2097 <span class="s2">        </span>
 2098 <span class="s2">        ResSelection = &quot;(</span><span class="si">%s</span><span class="s2"> and resn </span><span class="si">%s</span><span class="s2">*)&quot; % (Selection, ResName)</span>
 2099 <span class="s2">        cmd.color(ColorName, ResSelection)</span>
 2100 <span class="s2">    </span>
 2101 <span class="s2">cmd.extend(&quot;ColorByHydrophobicity&quot;, ColorByHydrophobicity)</span>
 2102 
 2103 <span class="s2">def ColorAtomsByHydrophobicityAndCharge(Selection, HydrophobicAtomsColor = &quot;yellow&quot;, NegativelyChargedAtomsColor = &quot;red&quot;, PositivelyChargedAtomsColor = &quot;blue&quot;, OtherAtomsColor = &quot;gray90&quot;):</span>
 2104 <span class="s2">    </span><span class="se">\&quot;</span><span class="s2">&quot;&quot;Color atoms in amino acids by their propensity to make hydrophobic and</span>
 2105 <span class="s2">    charge interactions [REF 140].  The atom names in standard amino acid</span>
 2106 <span class="s2">    residues are used to identify atom types as shown below:</span>
 2107 <span class="s2">    </span>
 2108 <span class="s2">        Hydrophobic: C atoms not bound to N or O atoms</span>
 2109 <span class="s2">        NegativelyCharged: Side chain O atoms in ASP and GLU</span>
 2110 <span class="s2">        PositivelyCharged: Side chain N atoms in ARG and LYS</span>
 2111 <span class="s2">        Others: Remaining atoms in polar and other residues</span>
 2112 <span class="s2">         </span>
 2113 <span class="s2">    The following color scheme is used by default:</span>
 2114 
 2115 <span class="s2">        Hydrophobic: yellow</span>
 2116 <span class="s2">        NegativelyCharged: red</span>
 2117 <span class="s2">        PositivelyCharged: blue</span>
 2118 <span class="s2">        Others: gray90</span>
 2119 <span class="s2">    </span>
 2120 <span class="s2">    The  amino acid atom names to color specific atoms  are taken from YRB.py</span>
 2121 <span class="s2">    script [ REF 140]. The color values may also be specified as comma delimited</span>
 2122 <span class="s2">    RGB triplets. For example: HydrophobicAtomsColor = &quot;0.950 0.78 0.0&quot;,</span>
 2123 <span class="s2">    NegativelyChargedAtomsColor = &quot;1.0 0.4 0.4&quot;, PositivelyChargedAtomsColor</span>
 2124 <span class="s2">    = &quot;0.2 0.5 0.8&quot;, OtherAtomsColor = &quot;0.95 0.95 0.95&quot;</span>
 2125 <span class="s2">    </span>
 2126 <span class="s2">    </span><span class="se">\&quot;</span><span class="s2">&quot;&quot;</span>
 2127 
 2128 <span class="s2">    # Process colors...</span>
 2129 <span class="s2">    Colors = {&quot;HydrophobicAtomsColor&quot;: HydrophobicAtomsColor, &quot;NegativelyChargedAtomsColor&quot;: NegativelyChargedAtomsColor, &quot;PositivelyChargedAtomsColor&quot;: PositivelyChargedAtomsColor, &quot;OtherAtomsColor&quot;: OtherAtomsColor}</span>
 2130 <span class="s2">    ColorsRGB = {}</span>
 2131 <span class="s2">    for ColorKey, ColorValue in Colors.items():</span>
 2132 <span class="s2">        if re.search(&quot; &quot;, ColorValue):</span>
 2133 <span class="s2">            ColorRGB = ColorValue.split(&quot; &quot;)</span>
 2134 <span class="s2">        else:</span>
 2135 <span class="s2">            ColorRGB = cmd.get_color_tuple(cmd.get_color_index(ColorValue))</span>
 2136 <span class="s2">        ColorsRGB[ColorKey] = ColorRGB</span>
 2137 <span class="s2">    </span>
 2138 <span class="s2">    # Set up colors...</span>
 2139 <span class="s2">    for ColorKey, ColorValue in ColorsRGB.items():</span>
 2140 <span class="s2">        cmd.set_color(ColorKey, ColorValue)</span>
 2141 
 2142 <span class="s2">    #  Set up colors for atom names across all resiudes...</span>
 2143 <span class="s2">    AtomColors = {&quot;OtherAtomsColor&quot;: &quot;N,C,CA,O&quot;, &quot;HydrophobicAtomsColor&quot;: &quot;CB&quot;}</span>
 2144 <span class="s2">    </span>
 2145 <span class="s2">    #  Set up colors for atom names across specific resiudes...</span>
 2146 <span class="s2">    ResAtomColors = {&quot;arg&quot; : {&quot;HydrophobicAtomsColor&quot;: &quot;CG&quot;, &quot;PositivelyChargedAtomsColor&quot;: &quot;NE,NH2,NH1&quot;, &quot;OtherAtomsColor&quot;: &quot;CD,CZ&quot;}, &quot;asn&quot; : {&quot;OtherAtomsColor&quot;: &quot;CG,OD1,ND2&quot;}, &quot;asp&quot; : {&quot;NegativelyChargedAtomsColor&quot;: &quot;OD2,OD1&quot;, &quot;OtherAtomsColor&quot;: &quot;CG&quot;}, &quot;cys&quot; : {&quot;OtherAtomsColor&quot;: &quot;SG&quot;}, &quot;gln&quot; : {&quot;HydrophobicAtomsColor&quot;: &quot;CG&quot;, &quot;OtherAtomsColor&quot;: &quot;CD,OE1,NE2&quot;}, &quot;glu&quot; : {&quot;HydrophobicAtomsColor&quot;: &quot;CG&quot;, &quot;NegativelyChargedAtomsColor&quot;: &quot;OE1,OE2&quot;, &quot;OtherAtomsColor&quot;: &quot;CD&quot;}, &quot;his&quot; : {&quot;OtherAtomsColor&quot;: &quot;CG,CD2,ND1,NE2,CE1&quot;}, &quot;ile&quot; : {&quot;HydrophobicAtomsColor&quot;: &quot;CG1,CG2,CD1&quot;}, &quot;leu&quot; : {&quot;HydrophobicAtomsColor&quot;: &quot;CG,CD1,CD2&quot;}, &quot;lys&quot; : {&quot;HydrophobicAtomsColor&quot;: &quot;CG,CD&quot;, &quot;PositivelyChargedAtomsColor&quot;: &quot;NZ&quot;, &quot;OtherAtomsColor&quot;: &quot;CE&quot;}, &quot;met&quot; : {&quot;HydrophobicAtomsColor&quot;: &quot;CG,CE&quot;, &quot;OtherAtomsColor&quot;: &quot;SD&quot;}, &quot;phe&quot; : {&quot;HydrophobicAtomsColor&quot;: &quot;CG,CD1,CE1,CZ,CE2,CD2&quot;}, &quot;pro&quot; : {&quot;HydrophobicAtomsColor&quot;: &quot;CG&quot;, &quot;OtherAtomsColor&quot;: &quot;CD&quot;}, &quot;ser&quot; : {&quot;OtherAtomsColor&quot;: &quot;CB,OG&quot;}, &quot;thr&quot; : {&quot;HydrophobicAtomsColor&quot;: &quot;CG2&quot;, &quot;OtherAtomsColor&quot;: &quot;CB,OG1&quot;}, &quot;trp&quot; : {&quot;HydrophobicAtomsColor&quot;: &quot;CG,CD2,CZ2,CH2,CZ3,CE3&quot;, &quot;OtherAtomsColor&quot;: &quot;CD1,NE1,CE2&quot;}, &quot;tyr&quot; : {&quot;HydrophobicAtomsColor&quot;: &quot;CG,CE1,CD1,CE2,CD2&quot;, &quot;OtherAtomsColor&quot;: &quot;CZ,OH&quot;}, &quot;val&quot; : {&quot;HydrophobicAtomsColor&quot;: &quot;CG1,CG2&quot;}}</span>
 2147 <span class="s2">    </span>
 2148 <span class="s2">    #  Color atom names across all resiudes...</span>
 2149 <span class="s2">    for ColorName in AtomColors:</span>
 2150 <span class="s2">        AtomNames = AtomColors[ColorName]</span>
 2151 <span class="s2">        AtomsSelection = &quot;(</span><span class="si">%s</span><span class="s2"> and name </span><span class="si">%s</span><span class="s2">)&quot; % (Selection, AtomNames)</span>
 2152 <span class="s2">        cmd.color(ColorName, AtomsSelection)</span>
 2153 <span class="s2">    </span>
 2154 <span class="s2">    #  Color hydrogen atoms across all residues to other color...</span>
 2155 <span class="s2">    AtomsSelection = &quot;(</span><span class="si">%s</span><span class="s2"> and hydro)&quot; % (Selection)</span>
 2156 <span class="s2">    cmd.color(&quot;OtherAtomsColor&quot;, AtomsSelection)</span>
 2157 <span class="s2">    </span>
 2158 <span class="s2">    #  Color atom names across specific resiudes...</span>
 2159 <span class="s2">    for ResName in ResAtomColors:</span>
 2160 <span class="s2">        for ColorName in ResAtomColors[ResName]:</span>
 2161 <span class="s2">            AtomNames = ResAtomColors[ResName][ColorName]</span>
 2162 <span class="s2">            AtomsSelection = &quot;(</span><span class="si">%s</span><span class="s2"> and resn </span><span class="si">%s</span><span class="s2"> and name </span><span class="si">%s</span><span class="s2">)&quot; % (Selection, ResName, AtomNames)</span>
 2163 <span class="s2">            cmd.color(ColorName, AtomsSelection)</span>
 2164 <span class="s2">    </span>
 2165 <span class="s2">cmd.extend(&quot;ColorAtomsByHydrophobicityAndCharge&quot;, ColorAtomsByHydrophobicityAndCharge)</span>
 2166 
 2167 <span class="s2">def CheckAndDeleteEmptyObjects(ObjectNames, ParentObjectName = None):</span>
 2168 <span class="s2">    </span><span class="se">\&quot;</span><span class="s2">&quot;&quot;Delete an empty objects along with optionally deleting their parent.</span>
 2169 <span class="s2">        </span>
 2170 <span class="s2">    </span><span class="se">\&quot;</span><span class="s2">&quot;&quot;</span>
 2171 <span class="s2">    </span>
 2172 <span class="s2">    ObjectNamesList = ObjectNames.split(&quot;,&quot;)</span>
 2173 
 2174 <span class="s2">    AllObjectsEmpty = True</span>
 2175 <span class="s2">    for ObjectName in ObjectNamesList:</span>
 2176 <span class="s2">        ObjectName = ObjectName.strip()</span>
 2177 <span class="s2">        if  cmd.count_atoms(&quot;(</span><span class="si">%s</span><span class="s2">)&quot; % ObjectName):</span>
 2178 <span class="s2">            AllObjectsEmpty = False</span>
 2179 <span class="s2">        else:</span>
 2180 <span class="s2">            cmd.delete(&quot;</span><span class="si">%s</span><span class="s2">&quot; % ObjectName)</span>
 2181 <span class="s2">    </span>
 2182 <span class="s2">    if AllObjectsEmpty and ParentObjectName is not None:</span>
 2183 <span class="s2">        cmd.delete(&quot;</span><span class="si">%s</span><span class="s2">&quot; % ParentObjectName)</span>
 2184 <span class="s2">    </span>
 2185 <span class="s2">cmd.extend(&quot;CheckAndDeleteEmptyObjects&quot;, CheckAndDeleteEmptyObjects)</span>
 2186 
 2187 <span class="s2">python end&quot;&quot;&quot;</span>
 2188     
 2189     <span class="k">return</span> <span class="n">PMLForPython</span>
 2190 
 2191 <span class="k">def</span> <span class="nf">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">):</span>
 2192     <span class="sd">&quot;&quot;&quot;Setup PML command for enabling or disabling display of a PyMOL object.</span>
 2193 
 2194 <span class="sd">    Arguments:</span>
 2195 <span class="sd">        Name (str): Name of a PyMOL object.</span>
 2196 <span class="sd">        Enable (bool): Display status.</span>
 2197 
 2198 <span class="sd">    Returns:</span>
 2199 <span class="sd">        str: PML command for enabling or disabling display of an object.</span>
 2200 
 2201 <span class="sd">    &quot;&quot;&quot;</span>
 2202     
 2203     <span class="k">if</span> <span class="n">Enable</span><span class="p">:</span>
 2204         <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;cmd.enable(&quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">Name</span>
 2205     <span class="k">else</span><span class="p">:</span>
 2206         <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;cmd.disable(&quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">Name</span>
 2207         
 2208     <span class="k">return</span> <span class="n">PML</span>
 2209 
 2210 <span class="k">def</span> <span class="nf">SetupPMLForGroup</span><span class="p">(</span><span class="n">GroupName</span><span class="p">,</span> <span class="n">GroupMembersList</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Action</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
 2211     <span class="sd">&quot;&quot;&quot;Setup PML commands for creating a group from a list of group members. The</span>
 2212 <span class="sd">    display and open status of the group may be optionally set. The &#39;None&#39; values</span>
 2213 <span class="sd">    for Enable and Action imply usage of PyMOL defaults for the creation of group.</span>
 2214 
 2215 <span class="sd">    Arguments:</span>
 2216 <span class="sd">        GroupName (str): Name of a PyMOL group.</span>
 2217 <span class="sd">        GroupMembersList (list): List of group member names.</span>
 2218 <span class="sd">        Enable (bool): Display status of group.</span>
 2219 <span class="sd">        Action (str): Open or close status of group object.</span>
 2220 
 2221 <span class="sd">    Returns:</span>
 2222 <span class="sd">        str: PML commands for creating a group object.</span>
 2223 
 2224 <span class="sd">    &quot;&quot;&quot;</span>
 2225 
 2226     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
 2227     
 2228     <span class="n">GroupMembers</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">GroupMembersList</span><span class="p">)</span>
 2229     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.group(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupName</span><span class="p">,</span> <span class="n">GroupMembers</span><span class="p">))</span>
 2230     
 2231     <span class="k">if</span> <span class="n">Enable</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
 2232         <span class="k">if</span> <span class="n">Enable</span><span class="p">:</span>
 2233             <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.enable(&quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">GroupName</span><span class="p">)</span>
 2234         <span class="k">else</span><span class="p">:</span>
 2235             <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.disable(&quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">GroupName</span><span class="p">)</span>
 2236     
 2237     <span class="k">if</span> <span class="n">Action</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
 2238         <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.group(&quot;</span><span class="si">%s</span><span class="s2">&quot;, action=&quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupName</span><span class="p">,</span> <span class="n">Action</span><span class="p">))</span>
 2239 
 2240     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
 2241     
 2242     <span class="k">return</span> <span class="n">PML</span>
 2243 
 2244 <span class="k">def</span> <span class="nf">SetupPMLForLigandView</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="n">LigandResName</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">):</span>
 2245     <span class="sd">&quot;&quot;&quot;Setup PML commands for creating a ligand view corresponding to a ligand </span>
 2246 <span class="sd">    present in a selection. The ligand is identified using organic selection</span>
 2247 <span class="sd">    operator available in PyMOL in conjunction with the specified ligand ID.</span>
 2248 <span class="sd">    The ligand is colored by atom types and displayed as &#39;sticks&#39;.</span>
 2249 
 2250 <span class="sd">    Arguments:</span>
 2251 <span class="sd">        Name (str): Name of a new PyMOL ligand object.</span>
 2252 <span class="sd">        Selection (str): PyMOL selection containing ligand.</span>
 2253 <span class="sd">        LigandResName (str): Ligand ID.</span>
 2254 <span class="sd">        Enable (bool): Display status of ligand object.</span>
 2255 
 2256 <span class="sd">    Returns:</span>
 2257 <span class="sd">        str: PML commands for a ligand view.</span>
 2258 
 2259 <span class="sd">    &quot;&quot;&quot;</span>
 2260 
 2261     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
 2262     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.create(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;((</span><span class="si">%s</span><span class="s2">) and organic and (resn </span><span class="si">%s</span><span class="s2">))&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="n">LigandResName</span><span class="p">))</span>
 2263     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.hide(&quot;everything&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 2264     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;util.cbag(&quot;</span><span class="si">%s</span><span class="s2">&quot;, _self = cmd)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 2265     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.show(&quot;sticks&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 2266     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Enable</span><span class="p">))</span>
 2267     
 2268     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
 2269     
 2270     <span class="k">return</span> <span class="n">PML</span>
 2271 
 2272 <span class="k">def</span> <span class="nf">SetupPMLForLigandPocketView</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="n">LigandSelection</span><span class="p">,</span> <span class="n">DistanceCutoff</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">):</span>
 2273     <span class="sd">&quot;&quot;&quot;Setup PML commands for creating a ligand binding pocket view</span>
 2274 <span class="sd">    corresponding all residues present in a selection within a specified</span>
 2275 <span class="sd">    distance from a ligand selection. The solvent and inorganic portions of</span>
 2276 <span class="sd">    the selection are not included in the binding pocket. The pocket residues</span>
 2277 <span class="sd">    are shown as &#39;lines&#39;. The hydrogen atoms are not displayed.</span>
 2278 
 2279 <span class="sd">    Arguments:</span>
 2280 <span class="sd">        Name (str): Name of a new PyMOL binding pocket object.</span>
 2281 <span class="sd">        Selection (str): PyMOL selection containing binding pocket residues.</span>
 2282 <span class="sd">        LigandSelection (str): PyMOL selection containing ligand.</span>
 2283 <span class="sd">        DistanceCutoff (float): Distance cutoff from ligand for selecting</span>
 2284 <span class="sd">            binding pockect residues.</span>
 2285 <span class="sd">        Enable (bool): Display status of binding pocket object.</span>
 2286 
 2287 <span class="sd">    Returns:</span>
 2288 <span class="sd">        str: PML commands for a ligand binding pocket view.</span>
 2289 
 2290 <span class="sd">    &quot;&quot;&quot;</span>
 2291 
 2292     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
 2293     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.create(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;((byresidue (</span><span class="si">%s</span><span class="s2">) within </span><span class="si">%.1f</span><span class="s2"> of (</span><span class="si">%s</span><span class="s2">)) and (not solvent) and (not inorganic) and (not organic))&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="n">DistanceCutoff</span><span class="p">,</span> <span class="n">LigandSelection</span><span class="p">))</span>
 2294     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.hide(&quot;everything&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 2295     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.show(&quot;lines&quot;, &quot;(</span><span class="si">%s</span><span class="s2">)&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 2296     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.hide(&quot;(</span><span class="si">%s</span><span class="s2"> and hydro)&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 2297     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Enable</span><span class="p">))</span>
 2298     
 2299     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
 2300     
 2301     <span class="k">return</span> <span class="n">PML</span>
 2302 
 2303 <span class="k">def</span> <span class="nf">SetupPMLForLigandPocketSolventView</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="n">LigandSelection</span><span class="p">,</span> <span class="n">DistanceCutoff</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">):</span>
 2304     <span class="sd">&quot;&quot;&quot;Setup PML commands for creating a ligand binding pocket view</span>
 2305 <span class="sd">    corresponding to only solvent residues present in a selection within a</span>
 2306 <span class="sd">    specified distance from a ligand selection. The solvent pocket residues</span>
 2307 <span class="sd">    are shown as &#39;lines&#39; and &#39;nonbonded&#39;.</span>
 2308 
 2309 <span class="sd">    Arguments:</span>
 2310 <span class="sd">        Name (str): Name of a new PyMOL solvent binding pocket object.</span>
 2311 <span class="sd">        Selection (str): PyMOL selection containing binding pocket residues.</span>
 2312 <span class="sd">        LigandSelection (str): PyMOL selection containing ligand.</span>
 2313 <span class="sd">        DistanceCutoff (float): Distance cutoff from ligand for selecting</span>
 2314 <span class="sd">            binding pocket solvent residues.</span>
 2315 <span class="sd">        Enable (bool): Display status of binding pocket object.</span>
 2316 
 2317 <span class="sd">    Returns:</span>
 2318 <span class="sd">        str: PML commands for a ligand binding pocket view only showing solvent</span>
 2319 <span class="sd">            residues.</span>
 2320 
 2321 <span class="sd">    &quot;&quot;&quot;</span>
 2322 
 2323     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
 2324     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.create(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;((byresidue (</span><span class="si">%s</span><span class="s2">) within </span><span class="si">%.1f</span><span class="s2"> of (</span><span class="si">%s</span><span class="s2">)) and solvent)&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="n">DistanceCutoff</span><span class="p">,</span> <span class="n">LigandSelection</span><span class="p">))</span>
 2325     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.hide(&quot;everything&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 2326     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.show(&quot;nonbonded&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 2327     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.show(&quot;lines&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 2328     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Enable</span><span class="p">))</span>
 2329     
 2330     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
 2331     
 2332     <span class="k">return</span> <span class="n">PML</span>
 2333 
 2334 <span class="k">def</span> <span class="nf">SetupPMLForLigandPocketInorganicView</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="n">LigandSelection</span><span class="p">,</span> <span class="n">DistanceCutoff</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">):</span>
 2335     <span class="sd">&quot;&quot;&quot;Setup PML commands for creating a ligand binding pocket view</span>
 2336 <span class="sd">    corresponding to only inorganic residues present in a selection within a</span>
 2337 <span class="sd">    specified distance from a ligand selection. The inorganic pocket residues</span>
 2338 <span class="sd">    are shown as &#39;lines&#39; and &#39;nonbonded&#39;.</span>
 2339 
 2340 <span class="sd">    Arguments:</span>
 2341 <span class="sd">        Name (str): Name of a new PyMOL solvent binding pocket object.</span>
 2342 <span class="sd">        Selection (str): PyMOL selection containing binding pocket residues.</span>
 2343 <span class="sd">        LigandSelection (str): PyMOL selection containing ligand.</span>
 2344 <span class="sd">        DistanceCutoff (float): Distance cutoff from ligand for selecting</span>
 2345 <span class="sd">            binding pocket inorganic residues.</span>
 2346 <span class="sd">        Enable (bool): Display status of binding pocket object.</span>
 2347 
 2348 <span class="sd">    Returns:</span>
 2349 <span class="sd">        str: PML commands for a ligand binding pocket view only showing inorganic</span>
 2350 <span class="sd">            residues.</span>
 2351 
 2352 <span class="sd">    &quot;&quot;&quot;</span>
 2353 
 2354     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
 2355     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.create(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;((byresidue (</span><span class="si">%s</span><span class="s2">) within </span><span class="si">%.1f</span><span class="s2"> of (</span><span class="si">%s</span><span class="s2">)) and inorganic)&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="n">DistanceCutoff</span><span class="p">,</span> <span class="n">LigandSelection</span><span class="p">))</span>
 2356     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.hide(&quot;everything&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 2357     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.show(&quot;nonbonded&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 2358     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.show(&quot;lines&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 2359     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Enable</span><span class="p">))</span>
 2360     
 2361     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
 2362     
 2363     <span class="k">return</span> <span class="n">PML</span>
 2364 
 2365 <span class="k">def</span> <span class="nf">SetupPMLForPolarContactsView</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection1</span><span class="p">,</span> <span class="n">Selection2</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">Color</span> <span class="o">=</span> <span class="s2">&quot;yellow&quot;</span><span class="p">,</span> <span class="n">Cutoff</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
 2366     <span class="sd">&quot;&quot;&quot;Setup PML commands for creating polar contacts view between a pair of</span>
 2367 <span class="sd">    selections. The polar contact view is generated using &#39;util.dist&#39; command. The</span>
 2368 <span class="sd">    distance labels are shown by default.</span>
 2369 
 2370 <span class="sd">    Arguments:</span>
 2371 <span class="sd">        Name (str): Name of a new PyMOL polar contacts object.</span>
 2372 <span class="sd">        Selection1 (str): First PyMOL selection.</span>
 2373 <span class="sd">        Selection2 (str): Second PyMOL selection.</span>
 2374 <span class="sd">        Enable (bool): Display status of polar contacts object.</span>
 2375 <span class="sd">        Color (str): Color for polar contact lines and labels.</span>
 2376 <span class="sd">        DistanceCutoff (float): None or distance cutoff for polar contacts.</span>
 2377 
 2378 <span class="sd">    Returns:</span>
 2379 <span class="sd">        str: PML commands for polar contacts view between a pair of selections.</span>
 2380 
 2381 <span class="sd">    &quot;&quot;&quot;</span>
 2382     
 2383     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
 2384     <span class="k">if</span> <span class="n">Cutoff</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
 2385         <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.dist(&quot;</span><span class="si">%s</span><span class="s2">&quot;,&quot;(</span><span class="si">%s</span><span class="s2">)&quot;,&quot;(</span><span class="si">%s</span><span class="s2">)&quot;, quiet = 1, mode = 2, label = 1, reset = 1)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection1</span><span class="p">,</span> <span class="n">Selection2</span><span class="p">))</span>
 2386     <span class="k">else</span><span class="p">:</span>
 2387         <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.dist(&quot;</span><span class="si">%s</span><span class="s2">&quot;,&quot;(</span><span class="si">%s</span><span class="s2">)&quot;,&quot;(</span><span class="si">%s</span><span class="s2">)&quot;, cutoff = </span><span class="si">%.1f</span><span class="s2">, quiet = 1, mode = 2, label = 1, reset = 1)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection1</span><span class="p">,</span> <span class="n">Selection2</span><span class="p">,</span> <span class="n">Cutoff</span><span class="p">))</span>
 2388         
 2389     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;util.color_deep(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Color</span><span class="p">,</span> <span class="n">Name</span><span class="p">))</span>
 2390     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Enable</span><span class="p">))</span>
 2391     
 2392     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
 2393     
 2394     <span class="k">return</span> <span class="n">PML</span>
 2395 
 2396 <span class="k">def</span> <span class="nf">SetupPMLForHydrophobicContactsView</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection1</span><span class="p">,</span> <span class="n">Selection2</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">Color</span> <span class="o">=</span> <span class="s2">&quot;yellow&quot;</span><span class="p">,</span> <span class="n">Cutoff</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
 2397     <span class="sd">&quot;&quot;&quot;Setup PML commands for creating hydrophobic contacts view between a pair of</span>
 2398 <span class="sd">    selections. The hydrophobic contacts are shown between pairs of carbon atoms not</span>
 2399 <span class="sd">    connected to hydrogen bond donor or acceptors atoms as identified by PyMOL. The</span>
 2400 <span class="sd">    distance labels are shown by default.</span>
 2401 
 2402 <span class="sd">    Arguments:</span>
 2403 <span class="sd">        Name (str): Name of a new PyMOL polar contacts object.</span>
 2404 <span class="sd">        Selection1 (str): First PyMOL selection.</span>
 2405 <span class="sd">        Selection2 (str): Second PyMOL selection.</span>
 2406 <span class="sd">        Enable (bool): Display status of polar contacts object.</span>
 2407 <span class="sd">        Color (str): Color for polar contact lines and labels.</span>
 2408 <span class="sd">        Cutoff (float): None or distance cutoff for hydrophobic contacts.</span>
 2409 
 2410 <span class="sd">    Returns:</span>
 2411 <span class="sd">        str: PML commands for polar contacts view between a pair of selections.</span>
 2412 
 2413 <span class="sd">    &quot;&quot;&quot;</span>
 2414 
 2415     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
 2416     
 2417     <span class="n">HydrophobicSelectionAtoms1</span> <span class="o">=</span> <span class="s2">&quot;((</span><span class="si">%s</span><span class="s2">) and (elem C) and (not bound_to (donors or acceptors)))&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Selection1</span><span class="p">)</span>
 2418     <span class="n">HydrophobicSelectionAtoms2</span> <span class="o">=</span> <span class="s2">&quot;((</span><span class="si">%s</span><span class="s2">) and (elem C) and (not bound_to (donors or acceptors)))&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Selection2</span><span class="p">)</span>
 2419     
 2420     <span class="k">if</span> <span class="n">Cutoff</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
 2421         <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.dist(&quot;</span><span class="si">%s</span><span class="s2">&quot;,&quot;(</span><span class="si">%s</span><span class="s2">)&quot;,&quot;(</span><span class="si">%s</span><span class="s2">)&quot;, quiet = 1, label = 1, reset = 1)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">HydrophobicSelectionAtoms1</span><span class="p">,</span> <span class="n">HydrophobicSelectionAtoms2</span><span class="p">))</span>
 2422     <span class="k">else</span><span class="p">:</span>
 2423         <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.dist(&quot;</span><span class="si">%s</span><span class="s2">&quot;,&quot;(</span><span class="si">%s</span><span class="s2">)&quot;,&quot;(</span><span class="si">%s</span><span class="s2">)&quot;, cutoff = </span><span class="si">%.1f</span><span class="s2">, quiet = 1,  label = 1, reset = 1)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">HydrophobicSelectionAtoms1</span><span class="p">,</span> <span class="n">HydrophobicSelectionAtoms2</span><span class="p">,</span> <span class="n">Cutoff</span><span class="p">))</span>
 2424         
 2425     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;util.color_deep(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Color</span><span class="p">,</span> <span class="n">Name</span><span class="p">))</span>
 2426     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Enable</span><span class="p">))</span>
 2427     
 2428     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
 2429     
 2430     <span class="k">return</span> <span class="n">PML</span>
 2431 
 2432 <span class="k">def</span> <span class="nf">SetupPMLForAlignment</span><span class="p">(</span><span class="n">Method</span><span class="p">,</span> <span class="n">RefSelection</span><span class="p">,</span> <span class="n">FitSelection</span><span class="p">):</span>
 2433     <span class="sd">&quot;&quot;&quot;Setup PML commands for aligning a pair of selection using  a specified</span>
 2434 <span class="sd">    alignment method.</span>
 2435 
 2436 <span class="sd">    Arguments:</span>
 2437 <span class="sd">        Method (str): Alignment method. Possible values: align, cealign, super.</span>
 2438 <span class="sd">        RefSelection (str): Name of reference selection which stays stationary.</span>
 2439 <span class="sd">        FitSelection (str): Name of selection to align to reference selection.</span>
 2440 
 2441 <span class="sd">    Returns:</span>
 2442 <span class="sd">        str: PML commands for aligning  a pair of selections.</span>
 2443 
 2444 <span class="sd">    &quot;&quot;&quot;</span>
 2445 
 2446     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
 2447     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^align$&quot;</span><span class="p">,</span> <span class="n">Method</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 2448         <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.align(&quot;(</span><span class="si">%s</span><span class="s2">)&quot;, &quot;(</span><span class="si">%s</span><span class="s2">)&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">FitSelection</span><span class="p">,</span> <span class="n">RefSelection</span><span class="p">))</span>
 2449     <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^cealign$&quot;</span><span class="p">,</span> <span class="n">Method</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 2450         <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.cealign(&quot;(</span><span class="si">%s</span><span class="s2">)&quot;, &quot;(</span><span class="si">%s</span><span class="s2">)&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">RefSelection</span><span class="p">,</span> <span class="n">FitSelection</span><span class="p">))</span>
 2451     <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^super$&quot;</span><span class="p">,</span> <span class="n">Method</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 2452         <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.super(&quot;(</span><span class="si">%s</span><span class="s2">)&quot;, &quot;(</span><span class="si">%s</span><span class="s2">)&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">FitSelection</span><span class="p">,</span> <span class="n">RefSelection</span><span class="p">))</span>
 2453     <span class="k">else</span><span class="p">:</span>
 2454         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;PyMOLUtil.SetupPMLForAlignment: Invalid method name: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">Method</span><span class="p">)</span>
 2455 
 2456     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
 2457     
 2458     <span class="k">return</span> <span class="n">PML</span>
 2459 
 2460 <span class="k">def</span> <span class="nf">SetupPMLForBFactorPuttyView</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="n">ColorPalette</span> <span class="o">=</span> <span class="s2">&quot;blue_white_red&quot;</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">):</span>
 2461     <span class="sd">&quot;&quot;&quot;Setup PML commands for creating a B factor putty view for a specified</span>
 2462 <span class="sd">    selection. The B factor values must be available for the atoms. The atoms</span>
 2463 <span class="sd">    are colored using a color spectrum corresponding to a specified color</span>
 2464 <span class="sd">    palette. Any valid PyMOL color palette name may be used.</span>
 2465 
 2466 <span class="sd">    Arguments:</span>
 2467 <span class="sd">        Name (str): Name of a new PyMOL B factor putty object.</span>
 2468 <span class="sd">        Selection (str): Name of PyMOL selection.</span>
 2469 <span class="sd">        ColorPalette (str): Name of color palette to use for color spectrum.</span>
 2470 <span class="sd">        Enable (bool): Display status of B factor putty object.</span>
 2471 
 2472 <span class="sd">    Returns:</span>
 2473 <span class="sd">        str: PML commands for B factor putty view.</span>
 2474 
 2475 <span class="sd">    &quot;&quot;&quot;</span>
 2476     
 2477     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
 2478     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.create(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;(</span><span class="si">%s</span><span class="s2">)&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">))</span>
 2479     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.hide(&quot;everything&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 2480     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.spectrum(&quot;b&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;(</span><span class="si">%s</span><span class="s2">)&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ColorPalette</span><span class="p">,</span> <span class="n">Name</span><span class="p">))</span>
 2481     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.show(&quot;cartoon&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 2482     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.cartoon(&quot;putty&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 2483     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Enable</span><span class="p">))</span>
 2484     
 2485     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
 2486     
 2487     <span class="k">return</span> <span class="n">PML</span>
 2488 
 2489 <span class="k">def</span> <span class="nf">SetupPMLForHydrophobicSurfaceView</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="n">ColorPalette</span> <span class="o">=</span> <span class="s2">&quot;RedToWhite&quot;</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">DisplayAs</span> <span class="o">=</span> <span class="s2">&quot;cartoon&quot;</span><span class="p">):</span>
 2490     <span class="sd">&quot;&quot;&quot;Setup PML commands for creating a hydrophobic surface view for a specified</span>
 2491 <span class="sd">    selection. The surfaces are colored using a specified color palette. This is only valid</span>
 2492 <span class="sd">    for amino acids.</span>
 2493 
 2494 <span class="sd">    Arguments:</span>
 2495 <span class="sd">        Name (str): Name of a new PyMOL hydrophobic surface object.</span>
 2496 <span class="sd">        Selection (str): Name of PyMOL selection.</span>
 2497 <span class="sd">        ColorPalette (str): Name of color palette to use for coloring surfaces.</span>
 2498 <span class="sd">            Possible values: RedToWhite or WhiteToGreen for most hydrophobic</span>
 2499 <span class="sd">            to least hydrophobic amino acids.</span>
 2500 <span class="sd">        Enable (bool): Display status of surface object.</span>
 2501 <span class="sd">        DisplayAs (str): Any additional valid display type such as lines,</span>
 2502 <span class="sd">            sticks, ribbon, cartoon, or None. </span>
 2503 
 2504 <span class="sd">    Returns:</span>
 2505 <span class="sd">        str: PML commands for hydrophobic surface view.</span>
 2506 
 2507 <span class="sd">    &quot;&quot;&quot;</span>
 2508 
 2509     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="n">_GetPMLCmdsForSurfaceView</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="n">DisplayAs</span><span class="p">)</span>
 2510     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;ColorByHydrophobicity(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">ColorPalette</span><span class="p">))</span>
 2511     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Enable</span><span class="p">))</span>
 2512     
 2513     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
 2514     
 2515     <span class="k">return</span> <span class="n">PML</span>
 2516 
 2517 <span class="k">def</span> <span class="nf">SetupPMLForHydrophobicAndChargeSurfaceView</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="n">HydrophobicAtomsColor</span> <span class="o">=</span> <span class="s2">&quot;yellow&quot;</span><span class="p">,</span> <span class="n">NegativelyChargedAtomsColor</span> <span class="o">=</span> <span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">PositivelyChargedAtomsColor</span> <span class="o">=</span> <span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">OtherAtomsColor</span> <span class="o">=</span> <span class="s2">&quot;gray90&quot;</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">DisplayAs</span> <span class="o">=</span> <span class="s2">&quot;cartoon&quot;</span><span class="p">):</span>
 2518     <span class="sd">&quot;&quot;&quot;Setup PML commands for creating a surface colored by hydrophobic and</span>
 2519 <span class="sd">    charge [ REF 140] properties of atoms in amino acids. The atom names in</span>
 2520 <span class="sd">    standard amino acid residues are used to identify atom types as shown below:</span>
 2521 
 2522 <span class="sd">    Hydrophobic: C atoms not bound to N or O atoms; NegativelyCharged: Side</span>
 2523 <span class="sd">    chain O atoms in ASP and GLU; PositivelyCharged: Side chain N atoms in</span>
 2524 <span class="sd">    ARG and LYS; Others: Remaining atoms in polar and other residues</span>
 2525 
 2526 <span class="sd">    The  amino acid atom names to color specific atoms  are taken from YRB.py</span>
 2527 <span class="sd">    script [ REF 140]. The color values may also be specified as comma delimited</span>
 2528 <span class="sd">    RGB triplets. For example: HydrophobicAtomsColor = &quot;0.950 0.78 0.0&quot;,</span>
 2529 <span class="sd">    NegativelyChargedAtomsColor = &quot;1.0 0.4 0.4&quot;, PositivelyChargedAtomsColor</span>
 2530 <span class="sd">    = &quot;0.2 0.5 0.8&quot;, OtherAtomsColor = &quot;0.95 0.95 0.95&quot;</span>
 2531 
 2532 <span class="sd">    Arguments:</span>
 2533 <span class="sd">        Name (str): Name of a new PyMOL hydrophobic surface object.</span>
 2534 <span class="sd">        Selection (str): Name of PyMOL selection.</span>
 2535 <span class="sd">        HydrophobicAtomsColor (str): Color name or space delimited RGB values</span>
 2536 <span class="sd">        NegativelyChargedAtomsColor (str): Color name or space delimited RGB values</span>
 2537 <span class="sd">        PositivelyChargedAtomsColor (str): Color name or space delimited RGB values</span>
 2538 <span class="sd">        OtherAtomsColor (str): Color name or space delimited RGB values</span>
 2539 <span class="sd">        Enable (bool): Display status of surface object.</span>
 2540 <span class="sd">        DisplayAs (str): Any additional valid display type such as lines,</span>
 2541 <span class="sd">            sticks, ribbon, cartoon, or None. </span>
 2542 
 2543 <span class="sd">    Returns:</span>
 2544 <span class="sd">        str: PML commands for hydrophobic and charge surface view.</span>
 2545 
 2546 <span class="sd">    &quot;&quot;&quot;</span>
 2547 
 2548     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="n">_GetPMLCmdsForSurfaceView</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="n">DisplayAs</span><span class="p">)</span>
 2549     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;ColorAtomsByHydrophobicityAndCharge(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">HydrophobicAtomsColor</span><span class="p">,</span> <span class="n">NegativelyChargedAtomsColor</span><span class="p">,</span> <span class="n">PositivelyChargedAtomsColor</span><span class="p">,</span> <span class="n">OtherAtomsColor</span><span class="p">))</span>
 2550     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Enable</span><span class="p">))</span>
 2551     
 2552     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
 2553     
 2554     <span class="k">return</span> <span class="n">PML</span>
 2555 
 2556 <span class="k">def</span> <span class="nf">SetupPMLForSurfaceView</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">DisplayAs</span> <span class="o">=</span> <span class="s2">&quot;cartoon&quot;</span><span class="p">,</span> <span class="n">Color</span> <span class="o">=</span> <span class="s2">&quot;None&quot;</span><span class="p">):</span>
 2557     <span class="sd">&quot;&quot;&quot;Setup PML commands for creating a molecular surface view for a specified</span>
 2558 <span class="sd">    selection.</span>
 2559 
 2560 <span class="sd">    Arguments:</span>
 2561 <span class="sd">        Name (str): Name of a new PyMOL molecular surface object.</span>
 2562 <span class="sd">        Selection (str): Name of PyMOL selection.</span>
 2563 <span class="sd">        Enable (bool): Display status of surface object.</span>
 2564 <span class="sd">        DisplayAs (str): Any additional valid display type such as lines,</span>
 2565 <span class="sd">            sticks, ribbon, cartoon, or None. </span>
 2566 <span class="sd">        Color (str): Surafce color.</span>
 2567 
 2568 <span class="sd">    Returns:</span>
 2569 <span class="sd">        str: PML commands for molecular surface view.</span>
 2570 
 2571 <span class="sd">    &quot;&quot;&quot;</span>
 2572 
 2573     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="n">_GetPMLCmdsForSurfaceView</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="n">DisplayAs</span><span class="p">)</span>
 2574     <span class="k">if</span> <span class="n">Color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
 2575         <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;util.color_deep(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Color</span><span class="p">,</span> <span class="n">Name</span><span class="p">))</span>
 2576     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Enable</span><span class="p">))</span>
 2577     
 2578     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
 2579     
 2580     <span class="k">return</span> <span class="n">PML</span>
 2581 
 2582 <span class="k">def</span> <span class="nf">_GetPMLCmdsForSurfaceView</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="n">DisplayAs</span> <span class="o">=</span> <span class="s2">&quot;cartoon&quot;</span><span class="p">):</span>
 2583     <span class="sd">&quot;&quot;&quot;Setup PML command for surface view.&quot;&quot;&quot;</span>
 2584 
 2585     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
 2586     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.create(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;(</span><span class="si">%s</span><span class="s2">)&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">))</span>
 2587     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.hide(&quot;everything&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 2588     <span class="k">if</span> <span class="n">DisplayAs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
 2589         <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.show(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">DisplayAs</span><span class="p">,</span> <span class="n">Name</span><span class="p">))</span>
 2590     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.show(&quot;surface&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 2591 
 2592     <span class="k">return</span> <span class="n">PMLCmds</span>
 2593     
 2594 <span class="k">def</span> <span class="nf">SetupPMLForSelectionDisplayView</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="n">DisplayAs</span><span class="p">,</span> <span class="n">Color</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">):</span>
 2595     <span class="sd">&quot;&quot;&quot;Setup PML commands for creating a specific molecular display view for a</span>
 2596 <span class="sd">     selection.</span>
 2597 
 2598 <span class="sd">    Arguments:</span>
 2599 <span class="sd">        Name (str): Name of a new PyMOL object.</span>
 2600 <span class="sd">        Selection (str): Name of PyMOL selection.</span>
 2601 <span class="sd">        DisplayAs (str): Any valid display type such as lines, sticks, ribbon,</span>
 2602 <span class="sd">            cartoon, or surface</span>
 2603 <span class="sd">        Color (str): Color name or use default color.</span>
 2604 <span class="sd">        Enable (bool): Display status of object.</span>
 2605 
 2606 <span class="sd">    Returns:</span>
 2607 <span class="sd">        str: PML commands for molecular selection view.</span>
 2608 
 2609 <span class="sd">    &quot;&quot;&quot;</span>
 2610 
 2611     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
 2612     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.create(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;(</span><span class="si">%s</span><span class="s2">)&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">))</span>
 2613     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.hide(&quot;everything&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 2614     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.show(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">DisplayAs</span><span class="p">,</span> <span class="n">Name</span><span class="p">))</span>
 2615     <span class="k">if</span> <span class="n">Color</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
 2616         <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;util.color_deep(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Color</span><span class="p">,</span> <span class="n">Name</span><span class="p">))</span>
 2617     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Enable</span><span class="p">))</span>
 2618     
 2619     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
 2620     
 2621     <span class="k">return</span> <span class="n">PML</span>
 2622 
 2623 <span class="k">def</span> <span class="nf">SetupPMLForBallAndStickView</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">SphereScale</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">StickRadius</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">):</span>
 2624     <span class="sd">&quot;&quot;&quot;Setup PML commands for creating a ball and stick view for a specified</span>
 2625 <span class="sd">    selection.</span>
 2626 
 2627 <span class="sd">    Arguments:</span>
 2628 <span class="sd">        Name (str): Name of a new PyMOL ball and stick object.</span>
 2629 <span class="sd">        Selection (str): Name of PyMOL selection.</span>
 2630 <span class="sd">        Enable (bool): Display status of ball and stick object.</span>
 2631 <span class="sd">        SphereScale (float): Scaling factor for sphere radii.</span>
 2632 <span class="sd">        StickScale (float): Scaling factor for stick radii.</span>
 2633 
 2634 <span class="sd">    Returns:</span>
 2635 <span class="sd">        str: PML commands for ball and stick view.</span>
 2636 
 2637 <span class="sd">    &quot;&quot;&quot;</span>
 2638 
 2639     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
 2640     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.create(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;(</span><span class="si">%s</span><span class="s2">)&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">))</span>
 2641     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.hide(&quot;everything&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 2642     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.show(&quot;sphere&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 2643     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.show(&quot;sticks&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 2644     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;sphere_scale&quot;, </span><span class="si">%.1f</span><span class="s2">, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SphereScale</span><span class="p">,</span> <span class="n">Name</span><span class="p">))</span>
 2645     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;stick_radius&quot;, </span><span class="si">%.1f</span><span class="s2">, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">StickRadius</span><span class="p">,</span> <span class="n">Name</span><span class="p">))</span>
 2646     
 2647     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Enable</span><span class="p">))</span>
 2648     
 2649     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
 2650     
 2651     <span class="k">return</span> <span class="n">PML</span>
 2652 
 2653 <span class="k">def</span> <span class="nf">SetupPMLForInorganicView</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">):</span>
 2654     <span class="sd">&quot;&quot;&quot;Setup PML commands for creating a inorganic view corresponding to</span>
 2655 <span class="sd">    inorganic residues present in a selection. The inorganic residues are</span>
 2656 <span class="sd">    identified using inorganic selection operator available in PyMOL. The</span>
 2657 <span class="sd">    inorganic residues are displayed as &#39;lines&#39; and &#39;nonbonded&#39;.</span>
 2658 
 2659 <span class="sd">    Arguments:</span>
 2660 <span class="sd">        Name (str): Name of a new PyMOL inorganic object.</span>
 2661 <span class="sd">        Selection (str): Name of PyMOL selection.</span>
 2662 <span class="sd">        Enable (bool): Display status of inorganic object.</span>
 2663 
 2664 <span class="sd">    Returns:</span>
 2665 <span class="sd">        str: PML commands for inorganic view.</span>
 2666 
 2667 <span class="sd">    &quot;&quot;&quot;</span>
 2668 
 2669     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
 2670     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.create(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;((</span><span class="si">%s</span><span class="s2">) and inorganic)&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">))</span>
 2671     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.show(&quot;nonbonded&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 2672     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.show(&quot;lines&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 2673     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Enable</span><span class="p">))</span>
 2674     
 2675     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
 2676     
 2677     <span class="k">return</span> <span class="n">PML</span>
 2678 
 2679 <span class="k">def</span> <span class="nf">SetupPMLForSolventView</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">):</span>
 2680     <span class="sd">&quot;&quot;&quot;Setup PML commands for creating a solvent view corresponding to</span>
 2681 <span class="sd">    solvent residues present in a selection. The solvent residues are</span>
 2682 <span class="sd">    identified using solvent selection operator available in PyMOL. The</span>
 2683 <span class="sd">    solvent residues are displayed as &#39;nonbonded&#39;.</span>
 2684 
 2685 <span class="sd">    Arguments:</span>
 2686 <span class="sd">        Name (str): Name of a new PyMOL solvent object.</span>
 2687 <span class="sd">        Selection (str): Name of PyMOL selection.</span>
 2688 <span class="sd">        Enable (bool): Display status of inorganic object.</span>
 2689 
 2690 <span class="sd">    Returns:</span>
 2691 <span class="sd">        str: PML commands for solvent view.</span>
 2692 
 2693 <span class="sd">    &quot;&quot;&quot;</span>
 2694 
 2695     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
 2696     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.create(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;((</span><span class="si">%s</span><span class="s2">) and solvent)&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">))</span>
 2697     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.show(&quot;nonbonded&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 2698     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Enable</span><span class="p">))</span>
 2699     
 2700     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
 2701     
 2702     <span class="k">return</span> <span class="n">PML</span>
 2703 
 2704 <span class="k">def</span> <span class="nf">SetupPMLForPolymerChainView</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">):</span>
 2705     <span class="sd">&quot;&quot;&quot;Setup PML commands for creating a polymer chain view corresponding</span>
 2706 <span class="sd">    to backbone and sidechain residues in a selection. The polymer chain is</span>
 2707 <span class="sd">    displayed as &#39;cartoon&#39;.</span>
 2708 
 2709 <span class="sd">    Arguments:</span>
 2710 <span class="sd">        Name (str): Name of a new PyMOL polymer chain object.</span>
 2711 <span class="sd">        Selection (str): Name of PyMOL selection.</span>
 2712 <span class="sd">        Enable (bool): Display status of chain object.</span>
 2713 
 2714 <span class="sd">    Returns:</span>
 2715 <span class="sd">        str: PML commands for polymer chain view.</span>
 2716 
 2717 <span class="sd">    &quot;&quot;&quot;</span>
 2718 
 2719     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
 2720     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.create(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;((</span><span class="si">%s</span><span class="s2">) and (backbone or sidechain))&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">))</span>
 2721     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.hide(&quot;everything&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 2722     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;util.cbag(&quot;</span><span class="si">%s</span><span class="s2">&quot;, _self = cmd)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 2723     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.show(&quot;cartoon&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 2724     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Enable</span><span class="p">))</span>
 2725     
 2726     
 2727     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
 2728     
 2729     <span class="k">return</span> <span class="n">PML</span>
 2730 
 2731 
 2732 <span class="k">def</span> <span class="nf">SetupPMLForPolymerComplexView</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">PDBFile</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">ShowSolvent</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">ShowInorganic</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">ShowLines</span> <span class="o">=</span> <span class="bp">True</span><span class="p">):</span>
 2733     <span class="sd">&quot;&quot;&quot;Setup PML commands for creating a polymer complex view for all chains</span>
 2734 <span class="sd">    in a PDB file. The solvent and inorganic residues are also shown by default.</span>
 2735 <span class="sd">     The polymer chains are displayed as &#39;cartoon&#39;. The &#39;line&#39; display for the</span>
 2736 <span class="sd">    polymer chains is also shown and may be turned off. The organic residues are</span>
 2737 <span class="sd">    displayed as &#39;sticks&#39;. The solvent and inorganic residues are displayed as</span>
 2738 <span class="sd">    &#39;nonbonded&#39; and &#39;lines&#39;.</span>
 2739 <span class="sd">    </span>
 2740 <span class="sd">    Arguments:</span>
 2741 <span class="sd">        MoleculeName (str): Name of a new PyMOL molecule object.</span>
 2742 <span class="sd">        PDBFile (str): Name of PDB file.</span>
 2743 <span class="sd">        Enable (bool): Display status of chain object.</span>
 2744 <span class="sd">        ShowSolvent (bool): Display solvent residues.</span>
 2745 <span class="sd">        ShowInorganic (bool): Display inorganic residues.</span>
 2746 <span class="sd">        ShowLines (bool): Display lines for polymer chains.</span>
 2747 
 2748 <span class="sd">    Returns:</span>
 2749 <span class="sd">        str: PML commands for polymer complex view.</span>
 2750 
 2751 <span class="sd">    &quot;&quot;&quot;</span>
 2752 
 2753     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
 2754     
 2755     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.load(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">PDBFile</span><span class="p">,</span> <span class="n">MoleculeName</span><span class="p">))</span>
 2756     <span class="n">PML</span> <span class="o">=</span> <span class="n">_SetupPMLForPolymerComplexView</span><span class="p">(</span><span class="n">MoleculeName</span><span class="p">,</span> <span class="n">Enable</span><span class="p">,</span> <span class="n">ShowSolvent</span><span class="p">,</span> <span class="n">ShowInorganic</span><span class="p">,</span> <span class="n">ShowLines</span><span class="p">)</span>
 2757     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PML</span><span class="p">)</span>
 2758     
 2759     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
 2760     
 2761     <span class="k">return</span> <span class="n">PML</span>
 2762 
 2763 <span class="k">def</span> <span class="nf">SetupPMLForPolymerChainComplexView</span><span class="p">(</span><span class="n">ChainComplexName</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">ShowSolvent</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">ShowInorganic</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">ShowLines</span> <span class="o">=</span> <span class="bp">True</span><span class="p">):</span>
 2764     <span class="sd">&quot;&quot;&quot;Setup PML commands for creating a polymer chain complex view for a specified</span>
 2765 <span class="sd">    chain in a selection. The solvent and inorganic residues are also shown by</span>
 2766 <span class="sd">    default. The polymer chain is displayed as &#39;cartoon&#39;. The &#39;line&#39; display for the</span>
 2767 <span class="sd">    polymer chain is also shown and may be turned off. The organic residues are</span>
 2768 <span class="sd">    displayed as &#39;sticks&#39;. The solvent and inorganic residues are displayed as</span>
 2769 <span class="sd">    &#39;nonbonded&#39; and &#39;lines&#39;.</span>
 2770 
 2771 <span class="sd">    Arguments:</span>
 2772 <span class="sd">        ChainComplexName (str): Name of a new PyMOL polymer chain complex.</span>
 2773 <span class="sd">        Selection (str): Name of PyMOL selection.</span>
 2774 <span class="sd">        ChainName (str): Name of a chain.</span>
 2775 <span class="sd">        Enable (bool): Display status of chain object.</span>
 2776 <span class="sd">        ShowSolvent (bool): Display solvent residues.</span>
 2777 <span class="sd">        ShowInorganic (bool): Display inorganic residues.</span>
 2778 <span class="sd">        ShowLines (bool): Display lines for polymer chain.</span>
 2779 
 2780 <span class="sd">    Returns:</span>
 2781 <span class="sd">        str: PML commands for polymer chain complex view.</span>
 2782 
 2783 <span class="sd">    &quot;&quot;&quot;</span>
 2784 
 2785     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
 2786     
 2787     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.create(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;(</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2">)&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainComplexName</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">))</span>
 2788     <span class="n">PML</span> <span class="o">=</span> <span class="n">_SetupPMLForPolymerComplexView</span><span class="p">(</span><span class="n">ChainComplexName</span><span class="p">,</span> <span class="n">Enable</span><span class="p">,</span> <span class="n">ShowSolvent</span><span class="p">,</span> <span class="n">ShowInorganic</span><span class="p">,</span> <span class="n">ShowLines</span><span class="p">)</span>
 2789     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PML</span><span class="p">)</span>
 2790 
 2791     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
 2792     
 2793     <span class="k">return</span> <span class="n">PML</span>
 2794 
 2795 <span class="k">def</span> <span class="nf">_SetupPMLForPolymerComplexView</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">ShowSolvent</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">ShowInorganic</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span>  <span class="n">ShowLines</span> <span class="o">=</span> <span class="bp">False</span><span class="p">):</span>
 2796     <span class="sd">&quot;&quot;&quot;Setup PML for creating a polymer complex view.&quot;&quot;&quot;</span>
 2797 
 2798     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
 2799     
 2800     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.hide(&quot;everything&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 2801     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.show(&quot;cartoon&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 2802     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;util.cba(33, &quot;</span><span class="si">%s</span><span class="s2">&quot;, _self = cmd)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 2803     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.show(&quot;sticks&quot;, &quot;(organic and (</span><span class="si">%s</span><span class="s2">))&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 2804     <span class="k">if</span> <span class="n">ShowSolvent</span><span class="p">:</span>
 2805         <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.show(&quot;nonbonded&quot;, &quot;(solvent and (</span><span class="si">%s</span><span class="s2">))&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 2806     <span class="k">if</span> <span class="n">ShowInorganic</span><span class="p">:</span>
 2807         <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.show(&quot;nonbonded&quot;, &quot;(inorganic and (</span><span class="si">%s</span><span class="s2">))&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 2808     
 2809     <span class="k">if</span> <span class="n">ShowLines</span><span class="p">:</span>
 2810         <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.show(&quot;lines&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 2811     <span class="k">else</span><span class="p">:</span>
 2812         <span class="k">if</span> <span class="n">ShowInorganic</span><span class="p">:</span>
 2813             <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.show(&quot;lines&quot;, &quot;(inorganic and (</span><span class="si">%s</span><span class="s2">))&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 2814     
 2815     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set_bond(&quot;valence&quot;, &quot;1&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, quiet = 1)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 2816     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Enable</span><span class="p">))</span>
 2817 
 2818     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
 2819     
 2820     <span class="k">return</span> <span class="n">PML</span>
</pre>
<br />
<center>
<img src="../../../images/h2o2.png">
</center>
</body>
</html>
