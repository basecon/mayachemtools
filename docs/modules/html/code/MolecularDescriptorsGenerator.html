<html>
<head>
<title>MayaChemTools:Code:MolecularDescriptors/MolecularDescriptorsGenerator.pm</title>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<link rel="stylesheet" type="text/css" href="../../../css/MayaChemToolsCode.css">
</head>
<body leftmargin="20" rightmargin="20" topmargin="10" bottommargin="10">
<br/>
<center>
<a href="http://www.mayachemtools.org" title="MayaChemTools Home"><img src="../../../images/MayaChemToolsLogo.gif" border="0" alt="MayaChemTools"></a>
</center>
<br/>
<pre>
<a name="package-MolecularDescriptors::MolecularDescriptorsGenerator-"></a>   1 <span class="k">package </span><span class="i">MolecularDescriptors::MolecularDescriptorsGenerator</span><span class="sc">;</span>
   2 <span class="c">#</span>
   3 <span class="c"># File: MolecularDescriptorsGenerator.pm</span>
   4 <span class="c"># Author: Manish Sud &lt;msud@san.rr.com&gt;</span>
   5 <span class="c">#</span>
   6 <span class="c"># Copyright (C) 2020 Manish Sud. All rights reserved.</span>
   7 <span class="c">#</span>
   8 <span class="c"># This file is part of MayaChemTools.</span>
   9 <span class="c">#</span>
  10 <span class="c"># MayaChemTools is free software; you can redistribute it and/or modify it under</span>
  11 <span class="c"># the terms of the GNU Lesser General Public License as published by the Free</span>
  12 <span class="c"># Software Foundation; either version 3 of the License, or (at your option) any</span>
  13 <span class="c"># later version.</span>
  14 <span class="c">#</span>
  15 <span class="c"># MayaChemTools is distributed in the hope that it will be useful, but without</span>
  16 <span class="c"># any warranty; without even the implied warranty of merchantability of fitness</span>
  17 <span class="c"># for a particular purpose.  See the GNU Lesser General Public License for more</span>
  18 <span class="c"># details.</span>
  19 <span class="c">#</span>
  20 <span class="c"># You should have received a copy of the GNU Lesser General Public License</span>
  21 <span class="c"># along with MayaChemTools; if not, see &lt;http://www.gnu.org/licenses/&gt; or</span>
  22 <span class="c"># write to the Free Software Foundation Inc., 59 Temple Place, Suite 330,</span>
  23 <span class="c"># Boston, MA, 02111-1307, USA.</span>
  24 <span class="c">#</span>
  25 
  26 <span class="k">use</span> <span class="w">strict</span><span class="sc">;</span>
  27 <span class="k">use</span> <span class="w">Carp</span><span class="sc">;</span>
  28 <span class="k">use</span> <span class="w">Exporter</span><span class="sc">;</span>
  29 <span class="k">use</span> <span class="w">Scalar::Util</span> <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
  30 <span class="k">use</span> <span class="w">ObjectProperty</span><span class="sc">;</span>
  31 <span class="k">use</span> <span class="w">TextUtil</span> <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
  32 <span class="k">use</span> <span class="w">FileUtil</span> <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
  33 <span class="k">use</span> <span class="w">Molecule</span><span class="sc">;</span>
  34 <span class="k">use</span> <span class="w">MolecularDescriptors::MolecularDescriptors</span><span class="sc">;</span>
  35 
  36 <span class="k">use</span> <span class="w">vars</span> <span class="q">qw(@ISA @EXPORT @EXPORT_OK %EXPORT_TAGS)</span><span class="sc">;</span>
  37 
  38 <span class="i">@ISA</span> = <span class="q">qw(ObjectProperty Exporter)</span><span class="sc">;</span>
  39 <span class="i">@EXPORT</span> = <span class="q">qw()</span><span class="sc">;</span>
  40 <span class="i">@EXPORT_OK</span> = <span class="q">qw(GetAvailableDescriptorClassNames GetAvailableClassAndDescriptorNames GetAvailableDescriptorNames GetAvailableDescriptorNamesForDescriptorClass GetAvailableClassNameForDescriptorName GetRuleOf5DescriptorNames GetRuleOf3DescriptorNames IsDescriptorClassNameAvailable IsDescriptorNameAvailable)</span><span class="sc">;</span>
  41 
  42 <span class="i">%EXPORT_TAGS</span> = <span class="s">(</span><span class="w">all</span>  <span class="cm">=&gt;</span> <span class="s">[</span><span class="i">@EXPORT</span><span class="cm">,</span> <span class="i">@EXPORT_OK</span><span class="s">]</span><span class="s">)</span><span class="sc">;</span>
  43 
  44 <span class="c"># Setup class variables...</span>
  45 <span class="k">my</span><span class="s">(</span><span class="i">$ClassName</span><span class="cm">,</span> <span class="i">%DescriptorsDataMap</span><span class="s">)</span><span class="sc">;</span>
  46 <span class="i">_InitializeClass</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
  47 
  48 <span class="c"># Overload Perl functions...</span>
  49 <span class="k">use</span> <span class="w">overload</span> <span class="q">&#39;&quot;&quot;&#39;</span> <span class="cm">=&gt;</span> <span class="q">&#39;StringifyMolecularDescriptorsGenerator&#39;</span><span class="sc">;</span>
  50 
  51 <span class="c"># Class constructor...</span>
<a name="new-"></a>  52 <span class="k">sub </span><span class="m">new</span> <span class="s">{</span>
  53   <span class="k">my</span><span class="s">(</span><span class="i">$Class</span><span class="cm">,</span> <span class="i">%NamesAndValues</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
  54 
  55   <span class="c"># Initialize object...</span>
  56   <span class="k">my</span> <span class="i">$This</span> = <span class="s">{</span><span class="s">}</span><span class="sc">;</span>
  57   <span class="k">bless</span> <span class="i">$This</span><span class="cm">,</span> <span class="k">ref</span><span class="s">(</span><span class="i">$Class</span><span class="s">)</span> || <span class="i">$Class</span><span class="sc">;</span>
  58   <span class="i">$This</span><span class="i">-&gt;_InitializeMolecularDescriptorsGenerator</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
  59 
  60   <span class="i">$This</span><span class="i">-&gt;_InitializeMolecularDescriptorsGeneratorProperties</span><span class="s">(</span><span class="i">%NamesAndValues</span><span class="s">)</span><span class="sc">;</span>
  61 
  62   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
  63 <span class="s">}</span>
  64 
  65 <span class="c"># Initialize class ...</span>
<a name="_InitializeClass-"></a>  66 <span class="k">sub </span><span class="m">_InitializeClass</span> <span class="s">{</span>
  67   <span class="c">#Class name...</span>
  68   <span class="i">$ClassName</span> = <span class="w">__PACKAGE__</span><span class="sc">;</span>
  69 
  70   <span class="c"># Load available molecular descriptor classes...</span>
  71   <span class="i">_LoadMolecularDescriptorsData</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
  72 
  73 <span class="s">}</span>
  74 
  75 <span class="c"># Initialize object data...</span>
  76 <span class="c">#</span>
<a name="_InitializeMolecularDescriptorsGenerator-"></a>  77 <span class="k">sub </span><span class="m">_InitializeMolecularDescriptorsGenerator</span> <span class="s">{</span>
  78   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
  79 
  80   <span class="c"># Type of desciptors to generate...</span>
  81   <span class="c">#</span>
  82   <span class="c"># The current release of MayaChemTools supports generation of four sets of</span>
  83   <span class="c"># descriptors: All available descriptors, rule of 5 or 3 descriptors or a specified</span>
  84   <span class="c"># set of descriptors.</span>
  85   <span class="c">#</span>
  86   <span class="c"># Possible values: All, RuleOf5, RuleOf3 or Specify</span>
  87   <span class="c">#</span>
  88   <span class="c"># RuleOf5 [ Ref 91 ] descriptor names: MolecularWeight, HydrogenBondDonors, HydrogenBondAcceptors,</span>
  89   <span class="c"># SLogP. RuleOf5 states: MolecularWeight &lt;= 500, HydrogenBondDonors &lt;= 5, HydrogenBondAcceptors &lt;= 10,</span>
  90   <span class="c"># and logP &lt;= 5.</span>
  91   <span class="c">#</span>
  92   <span class="c"># RuleOf3 [ Ref 92 ] descriptor names: MolecularWeight, RotatableBonds, HydrogenBondDonors,</span>
  93   <span class="c"># HydrogenBondAcceptors, SLogP, TPSA. RuleOf3 states: MolecularWeight &lt;= 300, RotatableBonds &lt;= 3,</span>
  94   <span class="c"># HydrogenBondDonors &lt;= 3, HydrogenBondAcceptors &lt;= 3, logP &lt;= 3, and TPSA &lt;= 60.</span>
  95   <span class="c">#</span>
  96   <span class="c"># For Specify value of Mode, a set of descritor names must be specified using</span>
  97   <span class="c"># DescriptorNames parameter.</span>
  98   <span class="c">#</span>
  99   <span class="c"># Default: All</span>
 100   <span class="c">#</span>
 101   <span class="i">$This</span>-&gt;{<span class="w">Mode</span>} = <span class="q">&#39;&#39;</span><span class="sc">;</span>
 102 
 103   <span class="c"># Descriptor names used to generate descriptor values during a specified descriptor</span>
 104   <span class="c"># generation mode...</span>
 105   <span class="c">#</span>
 106   <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">DescriptorNames</span>}} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 107 
 108   <span class="c"># Descriptor calculation control parameters for specified descriptor class names...</span>
 109   <span class="c">#</span>
 110   <span class="c"># These parameters are passed on to appropriate descriptor classes during</span>
 111   <span class="c"># instantiations of descriptor class objects.</span>
 112   <span class="c">#</span>
 113   <span class="i">%</span>{<span class="i">$This</span>-&gt;{<span class="w">DescriptorClassParameters</span>}} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 114 
 115   <span class="i">$This</span>-&gt;{<span class="w">DescriptorClassesInstantiated</span>} = <span class="n">0</span><span class="sc">;</span>
 116 
 117   <span class="c"># Descriptor class names and objects corresponding to specified descriptor names...</span>
 118   <span class="c">#</span>
 119   <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">DescriptorClassNames</span>}} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 120   <span class="i">%</span>{<span class="i">$This</span>-&gt;{<span class="w">DescriptorClassObjects</span>}} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 121 
 122   <span class="c"># Descriptor values generated for specified descriptor names...</span>
 123   <span class="c">#</span>
 124   <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">DescriptorValues</span>}} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 125 
 126   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 127 <span class="s">}</span>
 128 
 129 <span class="c"># Initialize object properties...</span>
 130 <span class="c">#</span>
<a name="_InitializeMolecularDescriptorsGeneratorProperties-"></a> 131 <span class="k">sub </span><span class="m">_InitializeMolecularDescriptorsGeneratorProperties</span> <span class="s">{</span>
 132   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">%NamesAndValues</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 133 
 134   <span class="k">my</span><span class="s">(</span><span class="i">$Name</span><span class="cm">,</span> <span class="i">$Value</span><span class="cm">,</span> <span class="i">$MethodName</span><span class="s">)</span><span class="sc">;</span>
 135   <span class="k">while</span> <span class="s">(</span><span class="s">(</span><span class="i">$Name</span><span class="cm">,</span> <span class="i">$Value</span><span class="s">)</span> = <span class="k">each</span>  <span class="i">%NamesAndValues</span><span class="s">)</span> <span class="s">{</span>
 136     <span class="i">$MethodName</span> = <span class="q">&quot;Set${Name}&quot;</span><span class="sc">;</span>
 137     <span class="i">$This</span><span class="i">-&gt;$MethodName</span><span class="s">(</span><span class="i">$Value</span><span class="s">)</span><span class="sc">;</span>
 138   <span class="s">}</span>
 139 
 140   <span class="c"># Set default value for Mode...</span>
 141   <span class="k">if</span> <span class="s">(</span>!<span class="i">$This</span>-&gt;{<span class="w">Mode</span>}<span class="s">)</span> <span class="s">{</span>
 142     <span class="i">$This</span>-&gt;{<span class="w">Mode</span>} = <span class="q">&#39;All&#39;</span><span class="sc">;</span>
 143   <span class="s">}</span>
 144 
 145   <span class="i">$This</span><span class="i">-&gt;_CheckAndInitializeDescriptorNames</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 146 
 147   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 148 <span class="s">}</span>
 149 
 150 <span class="c"># Set descriptors generation mode......</span>
 151 <span class="c">#</span>
<a name="SetMode-"></a> 152 <span class="k">sub </span><span class="m">SetMode</span> <span class="s">{</span>
 153   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Value</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 154 
 155   <span class="c"># All - all available descriptors</span>
 156   <span class="c"># Specify - Specified set of descriptors</span>
 157 
 158   <span class="k">if</span> <span class="s">(</span><span class="i">$Value</span> !~ <span class="q">/^(All|RuleOf5|RuleOf3|Specify)$/i</span><span class="s">)</span> <span class="s">{</span>
 159     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;SetMode: Mode value, $Value, is not valid; Supported values: All, RuleOf5, RuleOf3 or Specify...&quot;</span><span class="sc">;</span>
 160   <span class="s">}</span>
 161 
 162   <span class="i">$This</span>-&gt;{<span class="w">Mode</span>} = <span class="i">$Value</span><span class="sc">;</span>
 163 
 164   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 165 <span class="s">}</span>
 166 
 167 <span class="c"># Set descriptor names to use for generating descriptor values using an array</span>
 168 <span class="c"># or reference to an array...</span>
 169 <span class="c">#</span>
<a name="SetDescriptorNames-"></a> 170 <span class="k">sub </span><span class="m">SetDescriptorNames</span> <span class="s">{</span>
 171   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">@Values</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 172 
 173   <span class="k">if</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">Mode</span>} =~ <span class="q">/^All$/i</span><span class="s">)</span> <span class="s">{</span>
 174     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;SetDescriptorNames: Descriptor names cann&#39;t be specified during \&quot;All\&quot; value of descsriptors generation \&quot;Mode\&quot;...&quot;</span><span class="sc">;</span>
 175   <span class="s">}</span>
 176 
 177   <span class="k">if</span> <span class="s">(</span>!<span class="i">@Values</span><span class="s">)</span> <span class="s">{</span>
 178     <span class="k">return</span><span class="sc">;</span>
 179   <span class="s">}</span>
 180 
 181   <span class="k">my</span><span class="s">(</span><span class="i">$FirstValue</span><span class="cm">,</span> <span class="i">$TypeOfFirstValue</span><span class="s">)</span><span class="sc">;</span>
 182 
 183   <span class="i">$FirstValue</span> = <span class="i">$Values</span>[<span class="n">0</span>]<span class="sc">;</span>
 184   <span class="i">$TypeOfFirstValue</span> = <span class="k">ref</span> <span class="i">$FirstValue</span><span class="sc">;</span>
 185 
 186   <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">DescriptorNames</span>}} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 187 
 188   <span class="k">if</span> <span class="s">(</span><span class="i">$TypeOfFirstValue</span> =~ <span class="q">/^ARRAY/</span><span class="s">)</span> <span class="s">{</span>
 189     <span class="c"># Initialize using array refernce...</span>
 190     <span class="k">push</span> <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">DescriptorNames</span>}}<span class="cm">,</span> <span class="i">@</span>{<span class="i">$FirstValue</span>}<span class="sc">;</span>
 191   <span class="s">}</span>
 192   <span class="k">else</span> <span class="s">{</span>
 193     <span class="c"># It&#39;s a list of values...</span>
 194     <span class="k">push</span> <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">DescriptorNames</span>}}<span class="cm">,</span> <span class="i">@Values</span><span class="sc">;</span>
 195   <span class="s">}</span>
 196 
 197   <span class="c"># Make sure specified descriptor names are valid...</span>
 198   <span class="i">$This</span><span class="i">-&gt;_ValidateDescriptorNames</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 199 
 200   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 201 <span class="s">}</span>
 202 
 203 <span class="c"># Get descriptor names as an array...</span>
 204 <span class="c">#</span>
<a name="GetDescriptorNames-"></a> 205 <span class="k">sub </span><span class="m">GetDescriptorNames</span> <span class="s">{</span>
 206   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 207 
 208   <span class="k">return</span> <span class="k">wantarray</span> ? <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">DescriptorNames</span>}} <span class="co">:</span> <span class="k">scalar</span> <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">DescriptorNames</span>}}<span class="sc">;</span>
 209 <span class="s">}</span>
 210 
 211 <span class="c"># Get all descriptor values as an array...</span>
 212 <span class="c">#</span>
<a name="GetDescriptorValues-"></a> 213 <span class="k">sub </span><span class="m">GetDescriptorValues</span> <span class="s">{</span>
 214   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 215 
 216   <span class="k">if</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">DescriptorsGenerated</span>}<span class="s">)</span> <span class="s">{</span>
 217     <span class="k">return</span> <span class="k">wantarray</span> ? <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">DescriptorValues</span>}} <span class="co">:</span> <span class="k">scalar</span> <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">DescriptorValues</span>}}<span class="sc">;</span>
 218   <span class="s">}</span>
 219   <span class="k">else</span> <span class="s">{</span>
 220     <span class="k">my</span><span class="s">(</span><span class="i">@DescriptorValues</span><span class="s">)</span><span class="sc">;</span>
 221 
 222     <span class="i">@DescriptorValues</span> = <span class="s">(</span><span class="q">&#39;None&#39;</span><span class="s">)</span> x <span class="k">scalar</span> <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">DescriptorNames</span>}}<span class="sc">;</span>
 223 
 224     <span class="k">return</span> <span class="k">wantarray</span> ? <span class="i">@DescriptorValues</span> <span class="co">:</span> <span class="k">scalar</span> <span class="i">@DescriptorValues</span><span class="sc">;</span>
 225   <span class="s">}</span>
 226 <span class="s">}</span>
 227 
 228 <span class="c"># Get descriptor value for a specified descriptor name...</span>
 229 <span class="c">#</span>
<a name="GetDescriptorValueByName-"></a> 230 <span class="k">sub </span><span class="m">GetDescriptorValueByName</span> <span class="s">{</span>
 231   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Name</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 232   <span class="k">my</span><span class="s">(</span><span class="i">%NamesAndValues</span><span class="s">)</span><span class="sc">;</span>
 233 
 234   <span class="i">%NamesAndValues</span> = <span class="i">$This</span><span class="i">-&gt;GetDescriptorNamesAndValues</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 235 
 236   <span class="k">return</span> <span class="k">exists</span> <span class="i">$NamesAndValues</span>{<span class="i">$Name</span>} ? <span class="i">$NamesAndValues</span>{<span class="i">$Name</span>} <span class="co">:</span> <span class="q">&#39;None&#39;</span><span class="sc">;</span>
 237 
 238 <span class="s">}</span>
 239 
 240 <span class="c"># Get calculated molecular descriptor names sand values as a  hash with names</span>
 241 <span class="c"># and values as key/value pairs...</span>
 242 <span class="c">#</span>
<a name="GetDescriptorNamesAndValues-"></a> 243 <span class="k">sub </span><span class="m">GetDescriptorNamesAndValues</span> <span class="s">{</span>
 244   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 245   <span class="k">my</span><span class="s">(</span><span class="i">%NamesAndValues</span><span class="s">)</span><span class="sc">;</span>
 246 
 247   <span class="i">%NamesAndValues</span> = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 248   <span class="i">@NamesAndValues</span>{ <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">DescriptorNames</span>}} } = <span class="i">$This</span><span class="i">-&gt;GetDescriptorValues</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 249 
 250   <span class="k">return</span> <span class="i">%NamesAndValues</span><span class="sc">;</span>
 251 <span class="s">}</span>
 252 
 253 <span class="c"># Set up descriptor calculation control parameters for a specified descriptor class name...</span>
 254 <span class="c">#</span>
 255 <span class="c"># The specified parameter names and values are simply passed on to specified descriptor</span>
 256 <span class="c"># class during instantiation of descriptor class object without any performing any validation</span>
 257 <span class="c"># of parameter names and associated values. It&#39;s up to the appropriate descriptor class methods</span>
 258 <span class="c"># to validate these parameters and values.</span>
 259 <span class="c">#</span>
 260 <span class="c"># In addition to specified parameter names and values, the parameter hash must also contain</span>
 261 <span class="c"># descriptor class name as key and value pair with DescriptorClassName as key with class</span>
 262 <span class="c"># name as value.</span>
 263 <span class="c">#</span>
<a name="SetDescriptorClassParameters-"></a> 264 <span class="k">sub </span><span class="m">SetDescriptorClassParameters</span> <span class="s">{</span>
 265   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">%NamesAndValues</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 266   <span class="k">my</span><span class="s">(</span><span class="i">$DescriptorClassName</span><span class="cm">,</span> <span class="i">$Name</span><span class="cm">,</span> <span class="i">$Value</span><span class="s">)</span><span class="sc">;</span>
 267 
 268   <span class="k">if</span> <span class="s">(</span>!<span class="k">exists</span> <span class="i">$NamesAndValues</span>{<span class="w">DescriptorClassName</span>}<span class="s">)</span> <span class="s">{</span>
 269     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;_SetDescriptorNameParameters: Can&#39;t set descriptor class name paramaters: DescriptorClassName is not specified...&quot;</span><span class="sc">;</span>
 270   <span class="s">}</span>
 271 
 272   <span class="i">$DescriptorClassName</span> = <span class="i">$NamesAndValues</span>{<span class="w">DescriptorClassName</span>}<span class="sc">;</span>
 273   <span class="k">if</span> <span class="s">(</span>!<span class="i">IsDescriptorClassNameAvailable</span><span class="s">(</span><span class="i">$DescriptorClassName</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 274     <span class="w">carp</span> <span class="q">&quot;Warning: ${ClassName}-&gt;_SetDescriptorClassParameters: Can&#39;t set descriptor class name paramaters: Specified descriptor class name, $DescriptorClassName, is not available...&quot;</span><span class="sc">;</span>
 275     <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 276   <span class="s">}</span>
 277 
 278   <span class="k">if</span> <span class="s">(</span><span class="k">exists</span> <span class="i">$This</span>-&gt;{<span class="w">DescriptorClassParameters</span>}{<span class="i">$DescriptorClassName</span>}<span class="s">)</span> <span class="s">{</span>
 279     <span class="w">carp</span> <span class="q">&quot;Warning: ${ClassName}-&gt;SetDescriptorClassParameters: Class name parameters for $DescriptorClassName have already been specified: Replacing previous values...&quot;</span><span class="sc">;</span>
 280   <span class="s">}</span>
 281 
 282   <span class="i">%</span>{<span class="i">$This</span>-&gt;{<span class="w">DescriptorClassParameters</span>}{<span class="i">$DescriptorClassName</span>}} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 283   <span class="j">NAME:</span> <span class="k">while</span> <span class="s">(</span><span class="s">(</span><span class="i">$Name</span><span class="cm">,</span> <span class="i">$Value</span><span class="s">)</span> = <span class="k">each</span>  <span class="i">%NamesAndValues</span><span class="s">)</span> <span class="s">{</span>
 284     <span class="k">if</span> <span class="s">(</span><span class="i">$Name</span> =~ <span class="q">/^DescriptorClassName$/</span><span class="s">)</span> <span class="s">{</span>
 285       <span class="k">next</span> <span class="j">NAME</span><span class="sc">;</span>
 286     <span class="s">}</span>
 287     <span class="i">$This</span>-&gt;{<span class="w">DescriptorClassParameters</span>}{<span class="i">$DescriptorClassName</span>}{<span class="i">$Name</span>} = <span class="i">$Value</span><span class="sc">;</span>
 288   <span class="s">}</span>
 289 
 290   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 291 <span class="s">}</span>
 292 
 293 <span class="c"># Get descriptor name parameters as a reference to hash of hashes with hash</span>
 294 <span class="c"># keys corresponding to class name and class parameter name with hash value</span>
 295 <span class="c"># as class parameter value...</span>
 296 <span class="c">#</span>
<a name="GetDescriptorClassParameters-"></a> 297 <span class="k">sub </span><span class="m">GetDescriptorClassParameters</span> <span class="s">{</span>
 298   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 299 
 300   <span class="k">return</span> \<span class="i">%</span>{<span class="i">$This</span>-&gt;{<span class="w">DescriptorClassParameters</span>}}<span class="sc">;</span>
 301 <span class="s">}</span>
 302 
 303 <span class="c"># Get available descriptor class names as an array.</span>
 304 <span class="c">#</span>
 305 <span class="c"># This functionality can be either invoked as a class function or an</span>
 306 <span class="c"># object method.</span>
 307 <span class="c">#</span>
<a name="GetAvailableDescriptorClassNames-"></a> 308 <span class="k">sub </span><span class="m">GetAvailableDescriptorClassNames</span> <span class="s">{</span>
 309 
 310   <span class="k">return</span> <span class="k">wantarray</span> ? <span class="i">@</span>{<span class="i">$DescriptorsDataMap</span>{<span class="w">ClassNames</span>}} <span class="co">:</span> <span class="k">scalar</span> <span class="i">@</span>{<span class="i">$DescriptorsDataMap</span>{<span class="w">ClassNames</span>}}<span class="sc">;</span>
 311 <span class="s">}</span>
 312 
 313 <span class="c"># Get available descriptors class and descriptors names as a hash containing key/value</span>
 314 <span class="c"># pairs corresponding to class name and an array of descriptor names available for the</span>
 315 <span class="c"># class.</span>
 316 <span class="c">#</span>
 317 <span class="c"># This functionality can be either invoked as a class function or an</span>
 318 <span class="c"># object method.</span>
 319 <span class="c">#</span>
<a name="GetAvailableClassAndDescriptorNames-"></a> 320 <span class="k">sub </span><span class="m">GetAvailableClassAndDescriptorNames</span> <span class="s">{</span>
 321   <span class="k">my</span><span class="s">(</span><span class="i">$DescriptorClassName</span><span class="cm">,</span> <span class="i">@DescriptorNames</span><span class="cm">,</span> <span class="i">%ClassAndDescriptorNames</span><span class="s">)</span><span class="sc">;</span>
 322 
 323   <span class="i">%ClassAndDescriptorNames</span> = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 324   <span class="k">for</span> <span class="i">$DescriptorClassName</span> <span class="s">(</span><span class="i">@</span>{<span class="i">$DescriptorsDataMap</span>{<span class="w">ClassNames</span>}}<span class="s">)</span> <span class="s">{</span>
 325     <span class="i">@</span>{<span class="i">$ClassAndDescriptorNames</span>{<span class="i">$DescriptorClassName</span>}} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 326     <span class="k">push</span> <span class="i">@</span>{<span class="i">$ClassAndDescriptorNames</span>{<span class="i">$DescriptorClassName</span>}}<span class="cm">,</span> <span class="i">@</span>{<span class="i">$DescriptorsDataMap</span>{<span class="w">ClassToDescriptorNames</span>}{<span class="i">$DescriptorClassName</span>}}<span class="sc">;</span>
 327   <span class="s">}</span>
 328 
 329   <span class="k">return</span> <span class="i">%ClassAndDescriptorNames</span><span class="sc">;</span>
 330 <span class="s">}</span>
 331 
 332 <span class="c"># Get available descriptor names as an array.</span>
 333 <span class="c">#</span>
 334 <span class="c"># This functionality can be either invoked as a class function or an</span>
 335 <span class="c"># object method.</span>
 336 <span class="c">#</span>
<a name="GetAvailableDescriptorNames-"></a> 337 <span class="k">sub </span><span class="m">GetAvailableDescriptorNames</span> <span class="s">{</span>
 338   <span class="k">my</span><span class="s">(</span><span class="i">@DescriptorNames</span><span class="s">)</span><span class="sc">;</span>
 339 
 340   <span class="i">@DescriptorNames</span> = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 341   <span class="k">push</span> <span class="i">@DescriptorNames</span><span class="cm">,</span> <span class="k">map</span> <span class="s">{</span> <span class="i">@</span>{<span class="i">$DescriptorsDataMap</span>{<span class="w">ClassToDescriptorNames</span>}{<span class="i">$_</span>}} <span class="s">}</span> <span class="i">@</span>{<span class="i">$DescriptorsDataMap</span>{<span class="w">ClassNames</span>}}<span class="sc">;</span>
 342 
 343   <span class="k">return</span> <span class="k">wantarray</span> ? <span class="i">@DescriptorNames</span> <span class="co">:</span> <span class="k">scalar</span> <span class="i">@DescriptorNames</span><span class="sc">;</span>
 344 <span class="s">}</span>
 345 
 346 <span class="c"># Is it a valid descriptors class name?</span>
 347 <span class="c">#</span>
 348 <span class="c"># This functionality can be either invoked as a class function or an</span>
 349 <span class="c"># object method.</span>
 350 <span class="c">#</span>
<a name="IsDescriptorClassNameAvailable-"></a> 351 <span class="k">sub </span><span class="m">IsDescriptorClassNameAvailable</span> <span class="s">{</span>
 352   <span class="k">my</span><span class="s">(</span><span class="i">$FirstParameter</span><span class="cm">,</span> <span class="i">$SecondParameter</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 353   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$DescriptorClassName</span><span class="s">)</span><span class="sc">;</span>
 354 
 355   <span class="k">if</span> <span class="s">(</span><span class="s">(</span><span class="i">@_</span> == <span class="n">2</span><span class="s">)</span> &amp;&amp; <span class="s">(</span><span class="i">_IsMolecularDescriptorsGenerator</span><span class="s">(</span><span class="i">$FirstParameter</span><span class="s">)</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 356     <span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$DescriptorClassName</span><span class="s">)</span> = <span class="s">(</span><span class="i">$FirstParameter</span><span class="cm">,</span> <span class="i">$SecondParameter</span><span class="s">)</span><span class="sc">;</span>
 357   <span class="s">}</span>
 358   <span class="k">else</span> <span class="s">{</span>
 359     <span class="s">(</span><span class="i">$DescriptorClassName</span><span class="s">)</span> = <span class="s">(</span><span class="i">$FirstParameter</span><span class="s">)</span><span class="sc">;</span>
 360   <span class="s">}</span>
 361 
 362   <span class="k">return</span> <span class="s">(</span><span class="k">exists</span> <span class="i">$DescriptorsDataMap</span>{<span class="w">ClassToDescriptorNames</span>}{<span class="i">$DescriptorClassName</span>}<span class="s">)</span> ? <span class="n">1</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 363 <span class="s">}</span>
 364 
 365 <span class="c"># Is it a valid descriptor name?</span>
 366 <span class="c">#</span>
 367 <span class="c"># This functionality can be either invoked as a class function or an</span>
 368 <span class="c"># object method.</span>
 369 <span class="c">#</span>
<a name="IsDescriptorNameAvailable-"></a> 370 <span class="k">sub </span><span class="m">IsDescriptorNameAvailable</span> <span class="s">{</span>
 371   <span class="k">my</span><span class="s">(</span><span class="i">$FirstParameter</span><span class="cm">,</span> <span class="i">$SecondParameter</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 372   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$DescriptorName</span><span class="s">)</span><span class="sc">;</span>
 373 
 374   <span class="k">if</span> <span class="s">(</span><span class="s">(</span><span class="i">@_</span> == <span class="n">2</span><span class="s">)</span> &amp;&amp; <span class="s">(</span><span class="i">_IsMolecularDescriptorsGenerator</span><span class="s">(</span><span class="i">$FirstParameter</span><span class="s">)</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 375     <span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$DescriptorName</span><span class="s">)</span> = <span class="s">(</span><span class="i">$FirstParameter</span><span class="cm">,</span> <span class="i">$SecondParameter</span><span class="s">)</span><span class="sc">;</span>
 376   <span class="s">}</span>
 377   <span class="k">else</span> <span class="s">{</span>
 378     <span class="s">(</span><span class="i">$DescriptorName</span><span class="s">)</span> = <span class="s">(</span><span class="i">$FirstParameter</span><span class="s">)</span><span class="sc">;</span>
 379   <span class="s">}</span>
 380 
 381   <span class="k">return</span> <span class="s">(</span><span class="k">exists</span> <span class="i">$DescriptorsDataMap</span>{<span class="w">DescriptorToClassName</span>}{<span class="i">$DescriptorName</span>}<span class="s">)</span> ? <span class="n">1</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 382 <span class="s">}</span>
 383 
 384 <span class="c"># Get available descriptors names for a descriptor class as an array.</span>
 385 <span class="c">#</span>
 386 <span class="c"># This functionality can be either invoked as a class function or an</span>
 387 <span class="c"># object method.</span>
 388 <span class="c">#</span>
<a name="GetAvailableDescriptorNamesForDescriptorClass-"></a> 389 <span class="k">sub </span><span class="m">GetAvailableDescriptorNamesForDescriptorClass</span> <span class="s">{</span>
 390   <span class="k">my</span><span class="s">(</span><span class="i">$FirstParameter</span><span class="cm">,</span> <span class="i">$SecondParameter</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 391   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$DescriptorClassName</span><span class="cm">,</span> <span class="i">@DescriptorNames</span><span class="s">)</span><span class="sc">;</span>
 392 
 393   <span class="k">if</span> <span class="s">(</span><span class="s">(</span><span class="i">@_</span> == <span class="n">2</span><span class="s">)</span> &amp;&amp; <span class="s">(</span><span class="i">_IsMolecularDescriptorsGenerator</span><span class="s">(</span><span class="i">$FirstParameter</span><span class="s">)</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 394     <span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$DescriptorClassName</span><span class="s">)</span> = <span class="s">(</span><span class="i">$FirstParameter</span><span class="cm">,</span> <span class="i">$SecondParameter</span><span class="s">)</span><span class="sc">;</span>
 395   <span class="s">}</span>
 396   <span class="k">else</span> <span class="s">{</span>
 397     <span class="s">(</span><span class="i">$DescriptorClassName</span><span class="s">)</span> = <span class="s">(</span><span class="i">$FirstParameter</span><span class="s">)</span><span class="sc">;</span>
 398   <span class="s">}</span>
 399 
 400   <span class="i">@DescriptorNames</span> = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 401   <span class="k">if</span> <span class="s">(</span><span class="k">exists</span> <span class="i">$DescriptorsDataMap</span>{<span class="w">ClassToDescriptorNames</span>}{<span class="i">$DescriptorClassName</span>}<span class="s">)</span> <span class="s">{</span>
 402     <span class="k">push</span> <span class="i">@DescriptorNames</span><span class="cm">,</span> <span class="i">@</span>{<span class="i">$DescriptorsDataMap</span>{<span class="w">ClassToDescriptorNames</span>}{<span class="i">$DescriptorClassName</span>}}<span class="sc">;</span>
 403   <span class="s">}</span>
 404 
 405   <span class="k">return</span> <span class="k">wantarray</span> ? <span class="i">@DescriptorNames</span> <span class="co">:</span> <span class="k">scalar</span> <span class="i">@DescriptorNames</span><span class="sc">;</span>
 406 <span class="s">}</span>
 407 
 408 <span class="c"># Get available descriptors class name for a descriptor name.</span>
 409 <span class="c">#</span>
 410 <span class="c"># This functionality can be either invoked as a class function or an</span>
 411 <span class="c"># object method.</span>
 412 <span class="c">#</span>
<a name="GetAvailableClassNameForDescriptorName-"></a> 413 <span class="k">sub </span><span class="m">GetAvailableClassNameForDescriptorName</span> <span class="s">{</span>
 414   <span class="k">my</span><span class="s">(</span><span class="i">$FirstParameter</span><span class="cm">,</span> <span class="i">$SecondParameter</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 415   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$DescriptorClassName</span><span class="cm">,</span> <span class="i">$DescriptorName</span><span class="s">)</span><span class="sc">;</span>
 416 
 417   <span class="k">if</span> <span class="s">(</span><span class="s">(</span><span class="i">@_</span> == <span class="n">2</span><span class="s">)</span> &amp;&amp; <span class="s">(</span><span class="i">_IsMolecularDescriptorsGenerator</span><span class="s">(</span><span class="i">$FirstParameter</span><span class="s">)</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 418     <span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$DescriptorName</span><span class="s">)</span> = <span class="s">(</span><span class="i">$FirstParameter</span><span class="cm">,</span> <span class="i">$SecondParameter</span><span class="s">)</span><span class="sc">;</span>
 419   <span class="s">}</span>
 420   <span class="k">else</span> <span class="s">{</span>
 421     <span class="s">(</span><span class="i">$DescriptorName</span><span class="s">)</span> = <span class="s">(</span><span class="i">$FirstParameter</span><span class="s">)</span><span class="sc">;</span>
 422   <span class="s">}</span>
 423 
 424   <span class="i">$DescriptorClassName</span> = <span class="q">&#39;&#39;</span><span class="sc">;</span>
 425   <span class="k">if</span> <span class="s">(</span><span class="k">exists</span> <span class="i">$DescriptorsDataMap</span>{<span class="w">DescriptorToClassName</span>}{<span class="i">$DescriptorName</span>}<span class="s">)</span> <span class="s">{</span>
 426     <span class="i">$DescriptorClassName</span> = <span class="i">$DescriptorsDataMap</span>{<span class="w">DescriptorToClassName</span>}{<span class="i">$DescriptorName</span>}<span class="sc">;</span>
 427   <span class="s">}</span>
 428 
 429   <span class="k">return</span> <span class="i">$DescriptorClassName</span><span class="sc">;</span>
 430 <span class="s">}</span>
 431 
 432 <span class="c"># Get RuleOf5 descriptor names as an array.</span>
 433 <span class="c">#</span>
 434 <span class="c"># This functionality can be either invoked as a class function or an</span>
 435 <span class="c"># object method.</span>
 436 <span class="c">#</span>
<a name="GetRuleOf5DescriptorNames-"></a> 437 <span class="k">sub </span><span class="m">GetRuleOf5DescriptorNames</span> <span class="s">{</span>
 438   <span class="k">my</span><span class="s">(</span><span class="i">@DescriptorNames</span><span class="s">)</span><span class="sc">;</span>
 439 
 440   <span class="i">@DescriptorNames</span> = <span class="q">qw(MolecularWeight HydrogenBondDonors HydrogenBondAcceptors SLogP)</span><span class="sc">;</span>
 441 
 442   <span class="k">return</span> <span class="k">wantarray</span> ? <span class="i">@DescriptorNames</span> <span class="co">:</span> <span class="k">scalar</span> <span class="i">@DescriptorNames</span><span class="sc">;</span>
 443 <span class="s">}</span>
 444 
 445 <span class="c"># Get RuleOf3 descriptor names as an array.</span>
 446 <span class="c">#</span>
 447 <span class="c"># This functionality can be either invoked as a class function or an</span>
 448 <span class="c"># object method.</span>
 449 <span class="c">#</span>
<a name="GetRuleOf3DescriptorNames-"></a> 450 <span class="k">sub </span><span class="m">GetRuleOf3DescriptorNames</span> <span class="s">{</span>
 451   <span class="k">my</span><span class="s">(</span><span class="i">@DescriptorNames</span><span class="s">)</span><span class="sc">;</span>
 452 
 453   <span class="i">@DescriptorNames</span> = <span class="q">qw(MolecularWeight RotatableBonds HydrogenBondDonors HydrogenBondAcceptors SLogP TPSA)</span><span class="sc">;</span>
 454 
 455   <span class="k">return</span> <span class="k">wantarray</span> ? <span class="i">@DescriptorNames</span> <span class="co">:</span> <span class="k">scalar</span> <span class="i">@DescriptorNames</span><span class="sc">;</span>
 456 <span class="s">}</span>
 457 
 458 
 459 <span class="c"># Set molecule object...</span>
 460 <span class="c">#</span>
<a name="SetMolecule-"></a> 461 <span class="k">sub </span><span class="m">SetMolecule</span> <span class="s">{</span>
 462   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Molecule</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 463 
 464   <span class="i">$This</span>-&gt;{<span class="w">Molecule</span>} = <span class="i">$Molecule</span><span class="sc">;</span>
 465 
 466   <span class="c"># Weaken the reference to disable increment of reference count...</span>
 467   <span class="i">Scalar::Util::weaken</span><span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">Molecule</span>}<span class="s">)</span><span class="sc">;</span>
 468 
 469   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 470 <span class="s">}</span>
 471 
 472 <span class="c"># Generate specified molecular descriptors...</span>
 473 <span class="c">#</span>
 474 <span class="c"># After instantiating descriptor class objects at first invocation and  initialializing</span>
 475 <span class="c"># descriptor values during subsequent invocations, GenerateDescriptors method</span>
 476 <span class="c"># provided by each descriptor class is used to calculate descriptor values for</span>
 477 <span class="c"># specified descriptors.</span>
 478 <span class="c">#</span>
<a name="GenerateDescriptors-"></a> 479 <span class="k">sub </span><span class="m">GenerateDescriptors</span> <span class="s">{</span>
 480   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 481   <span class="k">my</span><span class="s">(</span><span class="i">$DescriptorClassName</span><span class="cm">,</span> <span class="i">$DescriptorClassObject</span><span class="s">)</span><span class="sc">;</span>
 482 
 483   <span class="c"># Initialize descriptor values...</span>
 484   <span class="i">$This</span><span class="i">-&gt;_InitializeDescriptorValues</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 485 
 486   <span class="c"># Instantiate decriptor classed corresponding to specified descriptors...</span>
 487   <span class="k">if</span> <span class="s">(</span>!<span class="i">$This</span>-&gt;{<span class="w">DescriptorClassesInstantiated</span>}<span class="s">)</span> <span class="s">{</span>
 488     <span class="i">$This</span><span class="i">-&gt;_InstantiateDescriptorClasses</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 489   <span class="s">}</span>
 490 
 491   <span class="c"># Check availability of molecule...</span>
 492   <span class="k">if</span> <span class="s">(</span>!<span class="i">$This</span>-&gt;{<span class="w">Molecule</span>}<span class="s">)</span> <span class="s">{</span>
 493     <span class="w">carp</span> <span class="q">&quot;Warning: ${ClassName}-&gt;GenerateDescriptors: $This-&gt;{Type} molecular descriptors generation didn&#39;t succeed: Molecule data is not available: Molecule object hasn&#39;t been set...&quot;</span><span class="sc">;</span>
 494     <span class="k">return</span> <span class="k">undef</span><span class="sc">;</span>
 495   <span class="s">}</span>
 496 
 497   <span class="c"># Calculate descriptor values...</span>
 498   <span class="k">for</span> <span class="i">$DescriptorClassName</span> <span class="s">(</span><span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">DescriptorClassNames</span>}}<span class="s">)</span> <span class="s">{</span>
 499     <span class="i">$DescriptorClassObject</span> = <span class="i">$This</span>-&gt;{<span class="w">DescriptorClassObjects</span>}{<span class="i">$DescriptorClassName</span>}<span class="sc">;</span>
 500 
 501     <span class="i">$DescriptorClassObject</span><span class="i">-&gt;SetMolecule</span><span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">Molecule</span>}<span class="s">)</span><span class="sc">;</span>
 502     <span class="i">$DescriptorClassObject</span><span class="i">-&gt;GenerateDescriptors</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 503 
 504     <span class="k">if</span> <span class="s">(</span>!<span class="i">$DescriptorClassObject</span><span class="i">-&gt;IsDescriptorsGenerationSuccessful</span><span class="s">(</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 505       <span class="k">return</span> <span class="k">undef</span><span class="sc">;</span>
 506     <span class="s">}</span>
 507   <span class="s">}</span>
 508 
 509   <span class="c"># Set final descriptor values...</span>
 510   <span class="i">$This</span><span class="i">-&gt;_SetFinalDescriptorValues</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 511 
 512   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 513 <span class="s">}</span>
 514 
 515 <span class="c"># Initialize descriptor values...</span>
 516 <span class="c">#</span>
<a name="_InitializeDescriptorValues-"></a> 517 <span class="k">sub </span><span class="m">_InitializeDescriptorValues</span> <span class="s">{</span>
 518   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 519 
 520   <span class="i">$This</span>-&gt;{<span class="w">DescriptorsGenerated</span>} = <span class="n">0</span><span class="sc">;</span>
 521 
 522   <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">DescriptorValues</span>}} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 523 
 524   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 525 <span class="s">}</span>
 526 
 527 <span class="c"># Setup final descriptor values...</span>
 528 <span class="c">#</span>
<a name="_SetFinalDescriptorValues-"></a> 529 <span class="k">sub </span><span class="m">_SetFinalDescriptorValues</span> <span class="s">{</span>
 530   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 531   <span class="k">my</span><span class="s">(</span><span class="i">$DescriptorName</span><span class="cm">,</span> <span class="i">$DescriptorClassName</span><span class="cm">,</span> <span class="i">$DescriptorClassObject</span><span class="s">)</span><span class="sc">;</span>
 532 
 533   <span class="i">$This</span>-&gt;{<span class="w">DescriptorsGenerated</span>} = <span class="n">1</span><span class="sc">;</span>
 534 
 535   <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">DescriptorValues</span>}} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 536 
 537   <span class="k">if</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">Mode</span>} =~ <span class="q">/^All$/i</span><span class="s">)</span> <span class="s">{</span>
 538     <span class="c"># Set descriptor values for all available descriptors...</span>
 539     <span class="k">for</span> <span class="i">$DescriptorClassName</span> <span class="s">(</span><span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">DescriptorClassNames</span>}}<span class="s">)</span> <span class="s">{</span>
 540       <span class="i">$DescriptorClassObject</span> = <span class="i">$This</span>-&gt;{<span class="w">DescriptorClassObjects</span>}{<span class="i">$DescriptorClassName</span>}<span class="sc">;</span>
 541 
 542       <span class="k">push</span> <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">DescriptorValues</span>}}<span class="cm">,</span> <span class="i">$DescriptorClassObject</span><span class="i">-&gt;GetDescriptorValues</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 543     <span class="s">}</span>
 544   <span class="s">}</span>
 545   <span class="k">else</span> <span class="s">{</span>
 546     <span class="c"># Set descriptor values for a subset of available descriptors...</span>
 547     <span class="k">for</span> <span class="i">$DescriptorName</span> <span class="s">(</span><span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">DescriptorNames</span>}}<span class="s">)</span> <span class="s">{</span>
 548       <span class="i">$DescriptorClassName</span> = <span class="i">$DescriptorsDataMap</span>{<span class="w">DescriptorToClassName</span>}{<span class="i">$DescriptorName</span>}<span class="sc">;</span>
 549       <span class="i">$DescriptorClassObject</span> = <span class="i">$This</span>-&gt;{<span class="w">DescriptorClassObjects</span>}{<span class="i">$DescriptorClassName</span>}<span class="sc">;</span>
 550 
 551       <span class="k">push</span> <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">DescriptorValues</span>}}<span class="cm">,</span> <span class="i">$DescriptorClassObject</span><span class="i">-&gt;GetDescriptorValueByName</span><span class="s">(</span><span class="i">$DescriptorName</span><span class="s">)</span><span class="sc">;</span>
 552     <span class="s">}</span>
 553   <span class="s">}</span>
 554 
 555   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 556 <span class="s">}</span>
 557 
 558 <span class="c"># Is descriptors generation successful?</span>
 559 <span class="c">#</span>
 560 <span class="c"># Notes:</span>
 561 <span class="c">#   . After successful generation of descriptor values by each descriptor class</span>
 562 <span class="c">#     corresponding to specified descriptor names, DescriptorsCalculated  to 1;</span>
 563 <span class="c">#     otherwise, it&#39;s set to 0.</span>
 564 <span class="c">#</span>
<a name="IsDescriptorsGenerationSuccessful-"></a> 565 <span class="k">sub </span><span class="m">IsDescriptorsGenerationSuccessful</span> <span class="s">{</span>
 566   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 567 
 568   <span class="k">return</span> <span class="i">$This</span>-&gt;{<span class="w">DescriptorsGenerated</span>} ? <span class="n">1</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 569 <span class="s">}</span>
 570 
 571 <span class="c"># Check and set default descriptor names for generating descriptor values...</span>
 572 <span class="c">#</span>
<a name="_CheckAndInitializeDescriptorNames-"></a> 573 <span class="k">sub </span><span class="m">_CheckAndInitializeDescriptorNames</span> <span class="s">{</span>
 574   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 575 
 576   <span class="k">if</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">Mode</span>} =~ <span class="q">/^(All|RuleOf5|RuleOf3)$/i</span><span class="s">)</span> <span class="s">{</span>
 577     <span class="k">if</span> <span class="s">(</span><span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">DescriptorNames</span>}}<span class="s">)</span> <span class="s">{</span>
 578       <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;_CheckAndInitializeDescriptorNames: Descriptor names can&#39;t be specified during \&quot;All, RuleOf5 or RuleOf3\&quot; values of descsriptors generation \&quot;Mode\&quot;...&quot;</span><span class="sc">;</span>
 579     <span class="s">}</span>
 580   <span class="s">}</span>
 581 
 582   <span class="k">if</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">Mode</span>} =~ <span class="q">/^All$/i</span><span class="s">)</span> <span class="s">{</span>
 583     <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">DescriptorNames</span>}} = <span class="i">GetAvailableDescriptorNames</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 584   <span class="s">}</span>
 585   <span class="k">elsif</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">Mode</span>} =~ <span class="q">/^RuleOf5$/i</span><span class="s">)</span> <span class="s">{</span>
 586     <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">DescriptorNames</span>}} = <span class="i">GetRuleOf5DescriptorNames</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 587   <span class="s">}</span>
 588   <span class="k">elsif</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">Mode</span>} =~ <span class="q">/^RuleOf3$/i</span><span class="s">)</span> <span class="s">{</span>
 589     <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">DescriptorNames</span>}} = <span class="i">GetRuleOf3DescriptorNames</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 590   <span class="s">}</span>
 591   <span class="k">elsif</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">Mode</span>} =~ <span class="q">/^Specify$/i</span><span class="s">)</span> <span class="s">{</span>
 592     <span class="k">if</span> <span class="s">(</span>!<span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">DescriptorNames</span>}}<span class="s">)</span> <span class="s">{</span>
 593       <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;_CheckAndInitializeDescriptorNames: DescriptorNames must be specified during Specify value for Mode...&quot;</span><span class="sc">;</span>
 594     <span class="s">}</span>
 595   <span class="s">}</span>
 596   <span class="k">else</span> <span class="s">{</span>
 597     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;_CheckAndInitializeDescriptorNames: Mode value, $This-&gt;{Mode}, is not valid...&quot;</span><span class="sc">;</span>
 598   <span class="s">}</span>
 599 <span class="s">}</span>
 600 
 601 <span class="c"># Instantiate descriptor classes corresponding to specified descriptor names...</span>
 602 <span class="c">#</span>
<a name="_InstantiateDescriptorClasses-"></a> 603 <span class="k">sub </span><span class="m">_InstantiateDescriptorClasses</span> <span class="s">{</span>
 604   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 605   <span class="k">my</span><span class="s">(</span><span class="i">$DescriptorClassName</span><span class="cm">,</span> <span class="i">$DescriptorName</span><span class="cm">,</span> <span class="i">$DescriptorClassPath</span><span class="s">)</span><span class="sc">;</span>
 606 
 607   <span class="i">$This</span>-&gt;{<span class="w">DescriptorClassesInstantiated</span>} = <span class="n">1</span><span class="sc">;</span>
 608 
 609   <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">DescriptorClassNames</span>}} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 610   <span class="i">%</span>{<span class="i">$This</span>-&gt;{<span class="w">DescriptorClassObjects</span>}} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 611 
 612   <span class="j">NAME:</span> <span class="k">for</span> <span class="i">$DescriptorName</span> <span class="s">(</span><span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">DescriptorNames</span>}}<span class="s">)</span> <span class="s">{</span>
 613     <span class="i">$DescriptorClassName</span> = <span class="i">$DescriptorsDataMap</span>{<span class="w">DescriptorToClassName</span>}{<span class="i">$DescriptorName</span>}<span class="sc">;</span>
 614 
 615     <span class="k">if</span> <span class="s">(</span><span class="k">exists</span> <span class="i">$This</span>-&gt;{<span class="w">DescriptorClassObjects</span>}{<span class="i">$DescriptorClassName</span>}<span class="s">)</span> <span class="s">{</span>
 616       <span class="k">next</span> <span class="j">NAME</span><span class="sc">;</span>
 617     <span class="s">}</span>
 618     <span class="k">push</span> <span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">DescriptorClassNames</span>}}<span class="cm">,</span> <span class="i">$DescriptorClassName</span><span class="sc">;</span>
 619 
 620     <span class="i">$DescriptorClassPath</span> = <span class="i">$DescriptorsDataMap</span>{<span class="w">ClassNameToClassPath</span>}{<span class="i">$DescriptorClassName</span>}<span class="sc">;</span>
 621 
 622     <span class="k">if</span> <span class="s">(</span><span class="k">exists</span> <span class="i">$This</span>-&gt;{<span class="w">DescriptorClassParameters</span>}{<span class="i">$DescriptorClassName</span>}<span class="s">)</span> <span class="s">{</span>
 623       <span class="i">$This</span>-&gt;{<span class="w">DescriptorClassObjects</span>}{<span class="i">$DescriptorClassName</span>} = <span class="i">$DescriptorClassPath</span><span class="i">-&gt;new</span><span class="s">(</span><span class="i">%</span>{<span class="i">$This</span>-&gt;{<span class="w">DescriptorClassParameters</span>}{<span class="i">$DescriptorClassName</span>}}<span class="s">)</span><span class="sc">;</span>
 624     <span class="s">}</span>
 625     <span class="k">else</span> <span class="s">{</span>
 626       <span class="i">$This</span>-&gt;{<span class="w">DescriptorClassObjects</span>}{<span class="i">$DescriptorClassName</span>} = <span class="i">$DescriptorClassPath</span><span class="i">-&gt;new</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 627     <span class="s">}</span>
 628   <span class="s">}</span>
 629 
 630   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 631 <span class="s">}</span>
 632 
 633 <span class="c"># Return a string containg data for MolecularDescriptorsGenerator object...</span>
 634 <span class="c">#</span>
<a name="StringifyMolecularDescriptorsGenerator-"></a> 635 <span class="k">sub </span><span class="m">StringifyMolecularDescriptorsGenerator</span> <span class="s">{</span>
 636   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 637   <span class="k">my</span><span class="s">(</span><span class="i">$TheString</span><span class="cm">,</span> <span class="i">$NamesAndValuesString</span><span class="cm">,</span> <span class="i">$Name</span><span class="cm">,</span> <span class="i">$Value</span><span class="cm">,</span> <span class="i">@NamesAndValuesInfo</span><span class="cm">,</span> <span class="i">%NamesAndValues</span><span class="s">)</span><span class="sc">;</span>
 638 
 639   <span class="c"># Type of MolecularDescriptors...</span>
 640   <span class="i">$TheString</span> = <span class="q">&quot;MolecularDescriptorsGenerator: Mode - $This-&gt;{Mode}; SpecifiedDescriptorNames - &lt; @{$This-&gt;{DescriptorNames}} &gt;; AvailableMolecularDescriptorClassNames - &lt; @{$DescriptorsDataMap{ClassNames}} &gt;&quot;</span><span class="sc">;</span>
 641 
 642   <span class="i">@NamesAndValuesInfo</span> = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 643   <span class="i">%NamesAndValues</span> = <span class="i">$This</span><span class="i">-&gt;GetDescriptorNamesAndValues</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 644 
 645   <span class="k">for</span> <span class="i">$Name</span> <span class="s">(</span><span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">DescriptorNames</span>}}<span class="s">)</span> <span class="s">{</span>
 646     <span class="i">$Value</span> = <span class="i">$NamesAndValues</span>{<span class="i">$Name</span>}<span class="sc">;</span>
 647     <span class="i">$Value</span> = <span class="s">(</span><span class="i">TextUtil::IsEmpty</span><span class="s">(</span><span class="i">$Value</span><span class="s">)</span> || <span class="i">$Value</span> =~ <span class="q">/^None$/i</span><span class="s">)</span> ? <span class="q">&#39;None&#39;</span> <span class="co">:</span> <span class="i">$Value</span><span class="sc">;</span>
 648     <span class="k">push</span> <span class="i">@NamesAndValuesInfo</span><span class="cm">,</span> <span class="q">&quot;$Name - $Value&quot;</span><span class="sc">;</span>
 649   <span class="s">}</span>
 650   <span class="k">if</span> <span class="s">(</span><span class="i">@NamesAndValuesInfo</span><span class="s">)</span> <span class="s">{</span>
 651     <span class="i">$TheString</span> .= <span class="q">&quot;Names - Values: &lt;&quot;</span> . <span class="i">TextUtil::JoinWords</span><span class="s">(</span>\<span class="i">@NamesAndValuesInfo</span><span class="cm">,</span> <span class="q">&quot;, &quot;</span><span class="cm">,</span> <span class="n">0</span><span class="s">)</span> . <span class="q">&quot;&gt;&quot;</span><span class="sc">;</span>
 652   <span class="s">}</span>
 653   <span class="k">else</span> <span class="s">{</span>
 654     <span class="i">$TheString</span> .= <span class="q">&quot;Names - Values: &lt; None&gt;&quot;</span><span class="sc">;</span>
 655   <span class="s">}</span>
 656 
 657   <span class="k">return</span> <span class="i">$TheString</span><span class="sc">;</span>
 658 <span class="s">}</span>
 659 
 660 <span class="c"># Is it a MolecularDescriptorsGenerator object?</span>
<a name="_IsMolecularDescriptorsGenerator-"></a> 661 <span class="k">sub </span><span class="m">_IsMolecularDescriptorsGenerator</span> <span class="s">{</span>
 662   <span class="k">my</span><span class="s">(</span><span class="i">$Object</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 663 
 664   <span class="k">return</span> <span class="s">(</span><span class="i">Scalar::Util::blessed</span><span class="s">(</span><span class="i">$Object</span><span class="s">)</span> &amp;&amp; <span class="i">$Object</span><span class="i">-&gt;isa</span><span class="s">(</span><span class="i">$ClassName</span><span class="s">)</span><span class="s">)</span> ? <span class="n">1</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 665 <span class="s">}</span>
 666 
 667 <span class="c"># Validate descriptor names for generating descriptor values...</span>
 668 <span class="c">#</span>
<a name="_ValidateDescriptorNames-"></a> 669 <span class="k">sub </span><span class="m">_ValidateDescriptorNames</span> <span class="s">{</span>
 670   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 671   <span class="k">my</span><span class="s">(</span><span class="i">$DescriptorName</span><span class="s">)</span><span class="sc">;</span>
 672 
 673   <span class="k">for</span> <span class="i">$DescriptorName</span> <span class="s">(</span><span class="i">@</span>{<span class="i">$This</span>-&gt;{<span class="w">DescriptorNames</span>}}<span class="s">)</span> <span class="s">{</span>
 674     <span class="k">if</span> <span class="s">(</span>!<span class="k">exists</span> <span class="i">$DescriptorsDataMap</span>{<span class="w">DescriptorToClassName</span>}{<span class="i">$DescriptorName</span>}<span class="s">)</span> <span class="s">{</span>
 675       <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;_SetAndValidateDescriptorNames: Specified descriptor name, $DescriptorName, is not valid...&quot;</span><span class="sc">;</span>
 676     <span class="s">}</span>
 677   <span class="s">}</span>
 678 
 679   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 680 <span class="s">}</span>
 681 
 682 <span class="c">#</span>
 683 <span class="c"># Load available molecular descriptors data...</span>
 684 <span class="c">#</span>
 685 <span class="c"># All available molecular descriptors classes are automatically detected in</span>
 686 <span class="c"># MolecularDescriptors directory under &lt;MayaChemTools&gt;/lib directory and</span>
 687 <span class="c"># information about available descriptor names is retrieved from each descriptor</span>
 688 <span class="c"># class using function GetDescriptorNames. The following %DescriptorsDataMap</span>
 689 <span class="c"># is setup containing all available molecular descriptors data:</span>
 690 <span class="c">#</span>
 691 <span class="c">#   @{$DescriptorsDataMap{ClassNames}}</span>
 692 <span class="c">#   %{$DescriptorsDataMap{ClassNameToPath}}</span>
 693 <span class="c">#   %{$DescriptorsDataMap{ClassToDescriptorNames}}</span>
 694 <span class="c">#   %{$DescriptorsDataMap{DescriptorToClassName}}</span>
 695 <span class="c">#</span>
 696 <span class="c"># GenerateDescriptors method is invoked fo each specified descriptor class</span>
 697 <span class="c"># object to calculate descriptor values for specified descriptors. After successful</span>
 698 <span class="c"># calculation of descriptors, GetDescriptorValues or GetDescriptorValueByName</span>
 699 <span class="c"># methods provided by descriptor objects are used to retrieve calculated</span>
 700 <span class="c"># descriptor values.</span>
 701 <span class="c">#</span>
<a name="_LoadMolecularDescriptorsData-"></a> 702 <span class="k">sub </span><span class="m">_LoadMolecularDescriptorsData</span> <span class="s">{</span>
 703 
 704   <span class="i">%DescriptorsDataMap</span> = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 705 
 706   <span class="i">_RetrieveAndLoadDescriptorClasses</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 707   <span class="i">_SetupDescriptorsDataMap</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 708 <span class="s">}</span>
 709 
 710 <span class="c">#</span>
 711 <span class="c"># Retrieve available molecular descriptors classes from MolecularDescriptors directory under</span>
 712 <span class="c"># &lt;MayaChemTools&gt;/lib directory...</span>
 713 <span class="c">#</span>
<a name="_RetrieveAndLoadDescriptorClasses-"></a> 714 <span class="k">sub </span><span class="m">_RetrieveAndLoadDescriptorClasses</span> <span class="s">{</span>
 715   <span class="k">my</span><span class="s">(</span><span class="i">$DescriptorsDirName</span><span class="cm">,</span> <span class="i">$MayaChemToolsLibDir</span><span class="cm">,</span> <span class="i">$DescriptorsDirPath</span><span class="cm">,</span> <span class="i">$IncludeDirName</span><span class="cm">,</span> <span class="i">$DescriptorClassName</span><span class="cm">,</span> <span class="i">$DescriptorClassPath</span><span class="cm">,</span> <span class="i">$DescriptorsClassFileName</span><span class="cm">,</span> <span class="i">@FileNames</span><span class="cm">,</span> <span class="i">@DescriptorsClassFileNames</span><span class="s">)</span><span class="sc">;</span>
 716 
 717   <span class="i">@</span>{<span class="i">$DescriptorsDataMap</span>{<span class="w">ClassNames</span>}} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 718   <span class="i">%</span>{<span class="i">$DescriptorsDataMap</span>{<span class="w">ClassNameToPath</span>}} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 719 
 720   <span class="i">$DescriptorsDirName</span> = <span class="q">&quot;MolecularDescriptors&quot;</span><span class="sc">;</span>
 721   <span class="i">$MayaChemToolsLibDir</span> = <span class="i">FileUtil::GetMayaChemToolsLibDirName</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 722 
 723   <span class="i">$DescriptorsDirPath</span> = <span class="q">&quot;$MayaChemToolsLibDir/$DescriptorsDirName&quot;</span><span class="sc">;</span>
 724 
 725   <span class="k">if</span> <span class="s">(</span>! <span class="k">-d</span> <span class="q">&quot;$DescriptorsDirPath&quot;</span><span class="s">)</span> <span class="s">{</span>
 726     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}::_RetrieveAndLoadDescriptorClasses: MayaChemTools package molecular descriptors directory, $DescriptorsDirPath, is missing: Possible installation problems...&quot;</span><span class="sc">;</span>
 727   <span class="s">}</span>
 728 
 729   <span class="i">@FileNames</span> = <span class="s">(</span><span class="q">&quot;$DescriptorsDirPath/*&quot;</span><span class="s">)</span><span class="sc">;</span>
 730   <span class="i">$IncludeDirName</span> = <span class="n">0</span><span class="sc">;</span>
 731   <span class="i">@DescriptorsClassFileNames</span> = <span class="i">FileUtil::ExpandFileNames</span><span class="s">(</span>\<span class="i">@FileNames</span><span class="cm">,</span> <span class="q">&quot;pm&quot;</span><span class="cm">,</span> <span class="i">$IncludeDirName</span><span class="s">)</span><span class="sc">;</span>
 732 
 733   <span class="k">if</span> <span class="s">(</span>!<span class="i">@DescriptorsClassFileNames</span><span class="s">)</span> <span class="s">{</span>
 734     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}::_RetrieveAndLoadDescriptorClasses: MayaChemTools package molecular descriptors directory, $DescriptorsDirPath, doesn&#39;t contain any molecular descriptor class: Possible installation problems...&quot;</span><span class="sc">;</span>
 735   <span class="s">}</span>
 736 
 737   <span class="j">FILENAME:</span> <span class="k">for</span> <span class="i">$DescriptorsClassFileName</span> <span class="s">(</span><span class="k">sort</span> <span class="i">@DescriptorsClassFileNames</span><span class="s">)</span> <span class="s">{</span>
 738     <span class="k">if</span> <span class="s">(</span><span class="i">$DescriptorsClassFileName</span> !~ <span class="q">/\.pm/</span><span class="s">)</span> <span class="s">{</span>
 739       <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}::_RetrieveAndLoadDescriptorClasses: MayaChemTools package molecular descriptors directory, $DescriptorsDirPath, contains invalid class file name $DescriptorsClassFileName: Possible installation problems...&quot;</span><span class="sc">;</span>
 740     <span class="s">}</span>
 741 
 742     <span class="c"># Ignore base class and descriptors generator class...</span>
 743     <span class="k">if</span> <span class="s">(</span><span class="i">$DescriptorsClassFileName</span> =~ <span class="q">/^(MolecularDescriptorsGenerator\.pm|MolecularDescriptors\.pm)$/</span><span class="s">)</span> <span class="s">{</span>
 744       <span class="k">next</span> <span class="j">FILENAME</span><span class="sc">;</span>
 745     <span class="s">}</span>
 746 
 747     <span class="s">(</span><span class="i">$DescriptorClassName</span><span class="s">)</span> = <span class="k">split</span> <span class="q">/\./</span><span class="cm">,</span> <span class="i">$DescriptorsClassFileName</span><span class="sc">;</span>
 748     <span class="i">$DescriptorClassPath</span> = <span class="q">&quot;${DescriptorsDirName}::${DescriptorClassName}&quot;</span><span class="sc">;</span>
 749 
 750     <span class="c"># Load descriptors class...</span>
 751     <span class="k">eval</span> <span class="q">&quot;use $DescriptorClassPath&quot;</span><span class="sc">;</span>
 752 
 753     <span class="k">if</span> <span class="s">(</span><span class="i">$@</span><span class="s">)</span> <span class="s">{</span>
 754       <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}::_RetrieveAndLoadDescriptorClasses: use $DescriptorClassPath failed: $@ ...&quot;</span><span class="sc">;</span>
 755     <span class="s">}</span>
 756 
 757     <span class="k">push</span> <span class="i">@</span>{<span class="i">$DescriptorsDataMap</span>{<span class="w">ClassNames</span>}}<span class="cm">,</span> <span class="i">$DescriptorClassName</span><span class="sc">;</span>
 758 
 759     <span class="i">$DescriptorsDataMap</span>{<span class="w">ClassNameToClassPath</span>}{<span class="i">$DescriptorClassName</span>} = <span class="i">$DescriptorClassPath</span><span class="sc">;</span>
 760   <span class="s">}</span>
 761 <span class="s">}</span>
 762 
 763 <span class="c">#</span>
 764 <span class="c"># Setup descriptors data map using loaded descriptor classes...</span>
 765 <span class="c">#</span>
<a name="_SetupDescriptorsDataMap-"></a> 766 <span class="k">sub </span><span class="m">_SetupDescriptorsDataMap</span> <span class="s">{</span>
 767   <span class="k">my</span><span class="s">(</span><span class="i">$DescriptorClassName</span><span class="cm">,</span> <span class="i">$DescriptorName</span><span class="cm">,</span> <span class="i">$DescriptorClassPath</span><span class="cm">,</span> <span class="i">@DescriptorNames</span><span class="s">)</span><span class="sc">;</span>
 768 
 769   <span class="c"># Class to decriptor names map...</span>
 770   <span class="i">%</span>{<span class="i">$DescriptorsDataMap</span>{<span class="w">ClassToDescriptorNames</span>}} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 771 
 772   <span class="c"># Descriptor to class name map...</span>
 773   <span class="i">%</span>{<span class="i">$DescriptorsDataMap</span>{<span class="w">DescriptorToClassName</span>}} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 774 
 775   <span class="k">for</span> <span class="i">$DescriptorClassName</span> <span class="s">(</span><span class="i">@</span>{<span class="i">$DescriptorsDataMap</span>{<span class="w">ClassNames</span>}}<span class="s">)</span> <span class="s">{</span>
 776     <span class="i">$DescriptorClassPath</span> = <span class="i">$DescriptorsDataMap</span>{<span class="w">ClassNameToClassPath</span>}{<span class="i">$DescriptorClassName</span>}<span class="sc">;</span>
 777 
 778     <span class="i">@DescriptorNames</span> = <span class="i">$DescriptorClassPath</span><span class="i">-&gt;GetDescriptorNames</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 779 
 780     <span class="k">if</span> <span class="s">(</span>!<span class="i">@DescriptorNames</span><span class="s">)</span> <span class="s">{</span>
 781       <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}::_SetupDescriptorsDataMap: Molecular descriptor class $DescriptorClassName doesn&#39;t provide any descriptor names...&quot;</span><span class="sc">;</span>
 782     <span class="s">}</span>
 783 
 784     <span class="k">if</span> <span class="s">(</span><span class="k">exists</span> <span class="i">$DescriptorsDataMap</span>{<span class="w">ClassToDescriptorNames</span>}{<span class="i">$DescriptorClassName</span>} <span class="s">)</span> <span class="s">{</span>
 785       <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}::_SetupDescriptorsDataMap: Molecular descriptor class $DescriptorClassName has already been processed...&quot;</span><span class="sc">;</span>
 786     <span class="s">}</span>
 787 
 788     <span class="i">@</span>{<span class="i">$DescriptorsDataMap</span>{<span class="w">ClassToDescriptorNames</span>}{<span class="i">$DescriptorClassName</span>}} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 789     <span class="i">@</span>{<span class="i">$DescriptorsDataMap</span>{<span class="w">ClassToDescriptorNames</span>}{<span class="i">$DescriptorClassName</span>}} = <span class="i">@DescriptorNames</span><span class="sc">;</span>
 790 
 791     <span class="k">for</span> <span class="i">$DescriptorName</span> <span class="s">(</span><span class="i">@DescriptorNames</span><span class="s">)</span> <span class="s">{</span>
 792       <span class="k">if</span> <span class="s">(</span><span class="k">exists</span> <span class="i">$DescriptorsDataMap</span>{<span class="w">DescriptorToClassName</span>}{<span class="i">$DescriptorName</span>}<span class="s">)</span> <span class="s">{</span>
 793         <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}::_SetupDescriptorsDataMap: Molecular descriptor name, $DescriptorName, in class name, $DescriptorClassName, has already been provided by class name $DescriptorsDataMap{DescriptorToClassName}{$DescriptorName}...&quot;</span><span class="sc">;</span>
 794       <span class="s">}</span>
 795 
 796       <span class="i">$DescriptorsDataMap</span>{<span class="w">DescriptorToClassName</span>}{<span class="i">$DescriptorName</span>} = <span class="i">$DescriptorClassName</span><span class="sc">;</span>
 797     <span class="s">}</span>
 798   <span class="s">}</span>
 799 <span class="s">}</span>
 800 
<a name="EOF-"></a></pre>
<p>&nbsp;</p>
<br />
<center>
<img src="../../../images/h2o2.png">
</center>
</body>
</html>
