<html>
<head>
<title>MayaChemTools:Code:Fingerprints/FingerprintsBitVector.pm</title>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<link rel="stylesheet" type="text/css" href="../../../css/MayaChemToolsCode.css">
</head>
<body leftmargin="20" rightmargin="20" topmargin="10" bottommargin="10">
<br/>
<center>
<a href="http://www.mayachemtools.org" title="MayaChemTools Home"><img src="../../../images/MayaChemToolsLogo.gif" border="0" alt="MayaChemTools"></a>
</center>
<br/>
<pre>
<a name="package-Fingerprints::FingerprintsBitVector-"></a>   1 <span class="k">package </span><span class="i">Fingerprints::FingerprintsBitVector</span><span class="sc">;</span>
   2 <span class="c">#</span>
   3 <span class="c"># File: FingerprintsBitVector.pm</span>
   4 <span class="c"># Author: Manish Sud &lt;msud@san.rr.com&gt;</span>
   5 <span class="c">#</span>
   6 <span class="c"># Copyright (C) 2020 Manish Sud. All rights reserved.</span>
   7 <span class="c">#</span>
   8 <span class="c"># This file is part of MayaChemTools.</span>
   9 <span class="c">#</span>
  10 <span class="c"># MayaChemTools is free software; you can redistribute it and/or modify it under</span>
  11 <span class="c"># the terms of the GNU Lesser General Public License as published by the Free</span>
  12 <span class="c"># Software Foundation; either version 3 of the License, or (at your option) any</span>
  13 <span class="c"># later version.</span>
  14 <span class="c">#</span>
  15 <span class="c"># MayaChemTools is distributed in the hope that it will be useful, but without</span>
  16 <span class="c"># any warranty; without even the implied warranty of merchantability of fitness</span>
  17 <span class="c"># for a particular purpose.  See the GNU Lesser General Public License for more</span>
  18 <span class="c"># details.</span>
  19 <span class="c">#</span>
  20 <span class="c"># You should have received a copy of the GNU Lesser General Public License</span>
  21 <span class="c"># along with MayaChemTools; if not, see &lt;http://www.gnu.org/licenses/&gt; or</span>
  22 <span class="c"># write to the Free Software Foundation Inc., 59 Temple Place, Suite 330,</span>
  23 <span class="c"># Boston, MA, 02111-1307, USA.</span>
  24 <span class="c">#</span>
  25 
  26 <span class="k">use</span> <span class="w">strict</span><span class="sc">;</span>
  27 <span class="k">use</span> <span class="w">Carp</span><span class="sc">;</span>
  28 <span class="k">use</span> <span class="w">Exporter</span><span class="sc">;</span>
  29 <span class="k">use</span> <span class="w">Scalar::Util</span> <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
  30 <span class="k">use</span> <span class="w">BitVector</span><span class="sc">;</span>
  31 <span class="k">use</span> <span class="w">MathUtil</span><span class="sc">;</span>
  32 <span class="k">use</span> <span class="w">TextUtil</span> <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
  33 
  34 <span class="k">use</span> <span class="w">vars</span> <span class="q">qw(@ISA @EXPORT @EXPORT_OK %EXPORT_TAGS)</span><span class="sc">;</span>
  35 
  36 <span class="i">@ISA</span> = <span class="q">qw(BitVector Exporter)</span><span class="sc">;</span>
  37 
  38 <span class="c"># Similiarity coefficients...</span>
  39 <span class="k">my</span><span class="s">(</span><span class="i">@SimilarityCoefficients</span><span class="s">)</span> = <span class="q">qw(BaroniUrbaniSimilarityCoefficient BuserSimilarityCoefficient CosineSimilarityCoefficient DiceSimilarityCoefficient DennisSimilarityCoefficient ForbesSimilarityCoefficient FossumSimilarityCoefficient HamannSimilarityCoefficient JacardSimilarityCoefficient Kulczynski1SimilarityCoefficient Kulczynski2SimilarityCoefficient MatchingSimilarityCoefficient McConnaugheySimilarityCoefficient OchiaiSimilarityCoefficient PearsonSimilarityCoefficient RogersTanimotoSimilarityCoefficient RussellRaoSimilarityCoefficient SimpsonSimilarityCoefficient SkoalSneath1SimilarityCoefficient SkoalSneath2SimilarityCoefficient SkoalSneath3SimilarityCoefficient TanimotoSimilarityCoefficient TverskySimilarityCoefficient YuleSimilarityCoefficient WeightedTanimotoSimilarityCoefficient WeightedTverskySimilarityCoefficient)</span><span class="sc">;</span>
  40 
  41 <span class="c"># New from string...</span>
  42 <span class="k">my</span><span class="s">(</span><span class="i">@NewFromString</span><span class="s">)</span> = <span class="q">qw(NewFromBinaryString NewFromHexadecimalString NewFromRawBinaryString)</span><span class="sc">;</span>
  43 
  44 <span class="i">@EXPORT</span> = <span class="q">qw(IsFingerprintsBitVector)</span><span class="sc">;</span>
  45 <span class="i">@EXPORT_OK</span> = <span class="q">qw(GetSupportedSimilarityCoefficients @NewFromString @SimilarityCoefficients)</span><span class="sc">;</span>
  46 
  47 <span class="i">%EXPORT_TAGS</span> = <span class="s">(</span>
  48                 <span class="w">new</span> <span class="cm">=&gt;</span> <span class="s">[</span><span class="i">@NewFromString</span><span class="s">]</span><span class="cm">,</span>
  49                 <span class="w">coefficients</span> <span class="cm">=&gt;</span> <span class="s">[</span><span class="i">@SimilarityCoefficients</span><span class="s">]</span><span class="cm">,</span>
  50                 <span class="w">all</span>  <span class="cm">=&gt;</span> <span class="s">[</span><span class="i">@EXPORT</span><span class="cm">,</span> <span class="i">@EXPORT_OK</span><span class="s">]</span>
  51                <span class="s">)</span><span class="sc">;</span>
  52 
  53 <span class="c"># Setup class variables...</span>
  54 <span class="k">my</span><span class="s">(</span><span class="i">$ClassName</span><span class="s">)</span><span class="sc">;</span>
  55 <span class="i">_InitializeClass</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
  56 
  57 <span class="k">use</span> <span class="w">overload</span> <span class="q">&#39;&quot;&quot;&#39;</span> <span class="cm">=&gt;</span> <span class="q">&#39;StringifyFingerprintsBitVector&#39;</span><span class="sc">;</span>
  58 
  59 <span class="c"># Class constructor...</span>
<a name="new-"></a>  60 <span class="k">sub </span><span class="m">new</span> <span class="s">{</span>
  61   <span class="k">my</span><span class="s">(</span><span class="i">$Class</span><span class="cm">,</span> <span class="i">$Size</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
  62 
  63   <span class="c"># Initialize object...</span>
  64   <span class="k">my</span> <span class="i">$This</span> = <span class="i">$Class</span><span class="i">-&gt;SUPER::new</span><span class="s">(</span><span class="i">$Size</span><span class="s">)</span><span class="sc">;</span>
  65   <span class="k">bless</span> <span class="i">$This</span><span class="cm">,</span> <span class="k">ref</span><span class="s">(</span><span class="i">$Class</span><span class="s">)</span> || <span class="i">$Class</span><span class="sc">;</span>
  66   <span class="i">$This</span><span class="i">-&gt;_InitializeFingerprintsBitVector</span><span class="s">(</span><span class="i">$Size</span><span class="s">)</span><span class="sc">;</span>
  67 
  68   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
  69 <span class="s">}</span>
  70 
  71 <span class="c"># Initialize object data...</span>
  72 <span class="c">#</span>
  73 <span class="c"># Note:</span>
  74 <span class="c">#  . The class, BitVector, used to derive this class provides all the functionality to</span>
  75 <span class="c">#    manipulate bits.</span>
  76 <span class="c">#  . Irrespective of specified size, Perl functions used to handle bit data in</span>
  77 <span class="c">#    BitVector class automatically sets the size to the next nearest power of 2.</span>
  78 <span class="c">#    SpecifiedSize is used by this class to process any aribitray size during similarity</span>
  79 <span class="c">#    coefficient calculations.</span>
  80 <span class="c">#</span>
<a name="_InitializeFingerprintsBitVector-"></a>  81 <span class="k">sub </span><span class="m">_InitializeFingerprintsBitVector</span> <span class="s">{</span>
  82   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Size</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
  83 
  84   <span class="k">if</span> <span class="s">(</span>!<span class="k">defined</span> <span class="i">$Size</span><span class="s">)</span> <span class="s">{</span>
  85     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;new: FingerprintsBitVector object instantiated without specifying its size ...&quot;</span><span class="sc">;</span>
  86   <span class="s">}</span>
  87   <span class="k">if</span> <span class="s">(</span><span class="i">$Size</span> &lt;=<span class="n">0</span><span class="s">)</span> <span class="s">{</span>
  88     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;new: Fingerprints bit vector size, $Size, must be a positive integer...&quot;</span><span class="sc">;</span>
  89   <span class="s">}</span>
  90 
  91   <span class="c"># Specified size of fingerprints...</span>
  92   <span class="i">$This</span>-&gt;{<span class="w">SpecifiedSize</span>} = <span class="i">$Size</span><span class="sc">;</span>
  93 
  94 <span class="s">}</span>
  95 
  96 <span class="c"># Initialize class ...</span>
<a name="_InitializeClass-"></a>  97 <span class="k">sub </span><span class="m">_InitializeClass</span> <span class="s">{</span>
  98   <span class="c">#Class name...</span>
  99   <span class="i">$ClassName</span> = <span class="w">__PACKAGE__</span><span class="sc">;</span>
 100 <span class="s">}</span>
 101 
 102 <span class="c"># Set specified size...</span>
 103 <span class="c">#</span>
 104 <span class="c"># Notes:</span>
 105 <span class="c">#   Irrespective of specified size, Perl functions used to handle bit data in</span>
 106 <span class="c">#   BitVector class automatically sets the size to the next nearest power of 2.</span>
 107 <span class="c">#   SpecifiedSize is used by this class to process any aribitray size during similarity</span>
 108 <span class="c">#   coefficient calculations.</span>
 109 <span class="c">#</span>
<a name="SetSpecifiedSize-"></a> 110 <span class="k">sub </span><span class="m">SetSpecifiedSize</span> <span class="s">{</span>
 111   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$SpecifiedSize</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 112 
 113   <span class="k">if</span> <span class="s">(</span>!<span class="s">(</span><span class="i">$SpecifiedSize</span> &gt; <span class="n">0</span> &amp;&amp; <span class="i">$SpecifiedSize</span> &lt;= <span class="i">$This</span>-&gt;{<span class="w">Size</span>}<span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 114     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;SetSpecifiedSize: Specified size, $SpecifiedSize, is not valid:  It must be &gt; 0 &amp;&amp; &lt;= &quot;</span><span class="cm">,</span> <span class="i">$This</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="cm">,</span><span class="q">&quot; ...&quot;</span><span class="sc">;</span>
 115   <span class="s">}</span>
 116   <span class="i">$This</span>-&gt;{<span class="w">SpecifiedSize</span>} = <span class="i">$SpecifiedSize</span><span class="sc">;</span>
 117 <span class="s">}</span>
 118 
 119 <span class="c"># Get specified size...</span>
<a name="GetSpecifiedSize-"></a> 120 <span class="k">sub </span><span class="m">GetSpecifiedSize</span> <span class="s">{</span>
 121   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 122 
 123   <span class="k">return</span> <span class="i">$This</span>-&gt;{<span class="w">SpecifiedSize</span>}<span class="sc">;</span>
 124 <span class="s">}</span>
 125 
 126 <span class="c"># Set ID...</span>
<a name="SetID-"></a> 127 <span class="k">sub </span><span class="m">SetID</span> <span class="s">{</span>
 128   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Value</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 129 
 130   <span class="i">$This</span>-&gt;{<span class="w">ID</span>} = <span class="i">$Value</span><span class="sc">;</span>
 131 
 132   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 133 <span class="s">}</span>
 134 
 135 <span class="c"># Get ID...</span>
<a name="GetID-"></a> 136 <span class="k">sub </span><span class="m">GetID</span> <span class="s">{</span>
 137   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 138 
 139   <span class="k">return</span> <span class="k">exists</span> <span class="i">$This</span>-&gt;{<span class="w">ID</span>} ? <span class="i">$This</span>-&gt;{<span class="w">ID</span>} <span class="co">:</span> <span class="q">&#39;None&#39;</span><span class="sc">;</span>
 140 <span class="s">}</span>
 141 
 142 <span class="c"># Set description...</span>
<a name="SetDescription-"></a> 143 <span class="k">sub </span><span class="m">SetDescription</span> <span class="s">{</span>
 144   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Value</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 145 
 146   <span class="i">$This</span>-&gt;{<span class="w">Description</span>} = <span class="i">$Value</span><span class="sc">;</span>
 147 
 148   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 149 <span class="s">}</span>
 150 
 151 <span class="c"># Get description...</span>
<a name="GetDescription-"></a> 152 <span class="k">sub </span><span class="m">GetDescription</span> <span class="s">{</span>
 153   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 154 
 155   <span class="k">return</span> <span class="k">exists</span> <span class="i">$This</span>-&gt;{<span class="w">Description</span>} ? <span class="i">$This</span>-&gt;{<span class="w">Description</span>} <span class="co">:</span> <span class="q">&#39;No description available&#39;</span><span class="sc">;</span>
 156 <span class="s">}</span>
 157 
 158 <span class="c"># Set vector type...</span>
<a name="SetVectorType-"></a> 159 <span class="k">sub </span><span class="m">SetVectorType</span> <span class="s">{</span>
 160   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Value</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 161 
 162   <span class="i">$This</span>-&gt;{<span class="w">VectorType</span>} = <span class="i">$Value</span><span class="sc">;</span>
 163 
 164   <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 165 <span class="s">}</span>
 166 
 167 <span class="c"># Get vector type...</span>
<a name="GetVectorType-"></a> 168 <span class="k">sub </span><span class="m">GetVectorType</span> <span class="s">{</span>
 169   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 170 
 171   <span class="k">return</span> <span class="k">exists</span> <span class="i">$This</span>-&gt;{<span class="w">VectorType</span>} ? <span class="i">$This</span>-&gt;{<span class="w">VectorType</span>} <span class="co">:</span> <span class="q">&#39;FingerprintsBitVector&#39;</span><span class="sc">;</span>
 172 <span class="s">}</span>
 173 
 174 <span class="c"># Create a new fingerprints bit vector using binary string. This functionality can be</span>
 175 <span class="c"># either invoked as a class function or an object method.</span>
 176 <span class="c">#</span>
<a name="NewFromBinaryString-"></a> 177 <span class="k">sub </span><span class="m">NewFromBinaryString ($;$)</span> <span class="s">{</span>
 178   <span class="k">my</span><span class="s">(</span><span class="i">$FirstParameter</span><span class="cm">,</span> <span class="i">$SecondParameter</span><span class="cm">,</span> <span class="i">$ThirdParameter</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 179 
 180   <span class="k">if</span> <span class="s">(</span><span class="i">_IsFingerprintsBitVector</span><span class="s">(</span><span class="i">$FirstParameter</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 181     <span class="k">return</span> <span class="i">_NewFingerptinsBitVectorFromString</span><span class="s">(</span><span class="q">&#39;Binary&#39;</span><span class="cm">,</span> <span class="i">$SecondParameter</span><span class="cm">,</span> <span class="i">$ThirdParameter</span><span class="s">)</span><span class="sc">;</span>
 182   <span class="s">}</span>
 183   <span class="k">else</span> <span class="s">{</span>
 184     <span class="k">return</span> <span class="i">_NewFingerptinsBitVectorFromString</span><span class="s">(</span> <span class="q">&#39;Binary&#39;</span><span class="cm">,</span> <span class="i">$FirstParameter</span><span class="cm">,</span> <span class="i">$SecondParameter</span><span class="s">)</span><span class="sc">;</span>
 185   <span class="s">}</span>
 186 <span class="s">}</span>
 187 
 188 <span class="c"># Create a new fingerprints bit vector using hexadecimal string. This functionality can be</span>
 189 <span class="c"># either invoked as a class function or an object method.</span>
 190 <span class="c">#</span>
<a name="NewFromHexadecimalString-"></a> 191 <span class="k">sub </span><span class="m">NewFromHexadecimalString ($;$)</span> <span class="s">{</span>
 192   <span class="k">my</span><span class="s">(</span><span class="i">$FirstParameter</span><span class="cm">,</span> <span class="i">$SecondParameter</span><span class="cm">,</span> <span class="i">$ThirdParameter</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 193 
 194   <span class="k">if</span> <span class="s">(</span><span class="i">_IsFingerprintsBitVector</span><span class="s">(</span><span class="i">$FirstParameter</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 195     <span class="k">return</span> <span class="i">_NewFingerptinsBitVectorFromString</span><span class="s">(</span><span class="q">&#39;Hexadecimal&#39;</span><span class="cm">,</span> <span class="i">$SecondParameter</span><span class="cm">,</span> <span class="i">$ThirdParameter</span><span class="s">)</span><span class="sc">;</span>
 196   <span class="s">}</span>
 197   <span class="k">else</span> <span class="s">{</span>
 198     <span class="k">return</span> <span class="i">_NewFingerptinsBitVectorFromString</span><span class="s">(</span> <span class="q">&#39;Hexadecimal&#39;</span><span class="cm">,</span> <span class="i">$FirstParameter</span><span class="cm">,</span> <span class="i">$SecondParameter</span><span class="s">)</span><span class="sc">;</span>
 199   <span class="s">}</span>
 200 <span class="s">}</span>
 201 
 202 <span class="c"># Create a new fingerprints bit vector using octal string. This functionality can be</span>
 203 <span class="c"># either invoked as a class function or an object method.</span>
 204 <span class="c">#</span>
 205 <span class="c">#</span>
<a name="NewFromOctalString-"></a> 206 <span class="k">sub </span><span class="m">NewFromOctalString ($)</span> <span class="s">{</span>
 207   <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;NewFromOctalString: Creation of fingerprits bit vector from an octal string is not supported ...&quot;</span><span class="sc">;</span>
 208 <span class="s">}</span>
 209 
 210 <span class="c"># Create a new fingerprints bit vector using decimal string. This functionality can be</span>
 211 <span class="c"># either invoked as a class function or an object method.</span>
 212 <span class="c">#</span>
<a name="NewFromDecimalString-"></a> 213 <span class="k">sub </span><span class="m">NewFromDecimalString ($;$)</span> <span class="s">{</span>
 214   <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;NewFromDecimalString: Creation of fingerprits bit vector from a decimal string is not supported ...&quot;</span><span class="sc">;</span>
 215 <span class="s">}</span>
 216 
 217 <span class="c"># Create a new fingerprints bit vector using raw binary string. This functionality can be</span>
 218 <span class="c"># either invoked as a class function or an object method.</span>
 219 <span class="c">#</span>
<a name="NewFromRawBinaryString-"></a> 220 <span class="k">sub </span><span class="m">NewFromRawBinaryString ($;$)</span> <span class="s">{</span>
 221   <span class="k">my</span><span class="s">(</span><span class="i">$FirstParameter</span><span class="cm">,</span> <span class="i">$SecondParameter</span><span class="cm">,</span> <span class="i">$ThirdParameter</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 222 
 223   <span class="k">if</span> <span class="s">(</span><span class="i">_IsFingerprintsBitVector</span><span class="s">(</span><span class="i">$FirstParameter</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 224     <span class="k">return</span> <span class="i">_NewFingerptinsBitVectorFromString</span><span class="s">(</span><span class="q">&#39;RawBinary&#39;</span><span class="cm">,</span> <span class="i">$SecondParameter</span><span class="cm">,</span> <span class="i">$ThirdParameter</span><span class="s">)</span><span class="sc">;</span>
 225   <span class="s">}</span>
 226   <span class="k">else</span> <span class="s">{</span>
 227     <span class="k">return</span> <span class="i">_NewFingerptinsBitVectorFromString</span><span class="s">(</span> <span class="q">&#39;RawBinary&#39;</span><span class="cm">,</span> <span class="i">$FirstParameter</span><span class="cm">,</span> <span class="i">$SecondParameter</span><span class="s">)</span><span class="sc">;</span>
 228   <span class="s">}</span>
 229 <span class="s">}</span>
 230 
 231 <span class="c"># Create a new fingerprints bit vector from a string...</span>
 232 <span class="c">#</span>
 233 <span class="c">#</span>
<a name="_NewFingerptinsBitVectorFromString-"></a> 234 <span class="k">sub </span><span class="m">_NewFingerptinsBitVectorFromString ($$;$)</span> <span class="s">{</span>
 235   <span class="k">my</span><span class="s">(</span><span class="i">$Format</span><span class="cm">,</span> <span class="i">$String</span><span class="cm">,</span> <span class="i">$BitsOrder</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 236   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsBitVector</span><span class="cm">,</span> <span class="i">$Size</span><span class="s">)</span><span class="sc">;</span>
 237 
 238   <span class="i">$Size</span> = <span class="i">BitVector::_CalculateStringSizeInBits</span><span class="s">(</span><span class="i">$Format</span><span class="cm">,</span> <span class="i">$String</span><span class="s">)</span><span class="sc">;</span>
 239 
 240   <span class="i">$FingerprintsBitVector</span> = <span class="i">new</span> <span class="i">Fingerprints::FingerprintsBitVector</span><span class="s">(</span><span class="i">$Size</span><span class="s">)</span><span class="sc">;</span>
 241   <span class="i">$FingerprintsBitVector</span><span class="i">-&gt;_SetBitsAsString</span><span class="s">(</span><span class="i">$Format</span><span class="cm">,</span> <span class="i">$String</span><span class="cm">,</span> <span class="i">$BitsOrder</span><span class="s">)</span><span class="sc">;</span>
 242 
 243   <span class="k">return</span> <span class="i">$FingerprintsBitVector</span><span class="sc">;</span>
 244 <span class="s">}</span>
 245 
 246 <span class="c"># Get fingerprint bits as a hexadecimal string...</span>
 247 <span class="c">#</span>
<a name="GetBitsAsHexadecimalString-"></a> 248 <span class="k">sub </span><span class="m">GetBitsAsHexadecimalString</span> <span class="s">{</span>
 249   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$BitsOrder</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 250 
 251   <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;_GetFingerprintBitsAsString</span><span class="s">(</span><span class="q">&#39;Hexadecimal&#39;</span><span class="cm">,</span> <span class="i">$BitsOrder</span><span class="s">)</span><span class="sc">;</span>
 252 <span class="s">}</span>
 253 
 254 <span class="c"># Get fingerprint bits as an octal string...</span>
 255 <span class="c">#</span>
<a name="GetBitsAsOctalString-"></a> 256 <span class="k">sub </span><span class="m">GetBitsAsOctalString</span> <span class="s">{</span>
 257   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$BitsOrder</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 258 
 259   <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;GetBitsAsOctalString: Retrieval of fingerprits bits as an octal string is not supported ...&quot;</span><span class="sc">;</span>
 260 <span class="s">}</span>
 261 
 262 <span class="c"># Get fingerprint bits as an decimal string...</span>
 263 <span class="c">#</span>
<a name="GetBitsAsDecimalString-"></a> 264 <span class="k">sub </span><span class="m">GetBitsAsDecimalString</span> <span class="s">{</span>
 265   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$BitsOrder</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 266 
 267   <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;GetBitsAsOctalString: Retrieval of fingerprits bits as a decimal string is not supported ...&quot;</span><span class="sc">;</span>
 268 <span class="s">}</span>
 269 
 270 <span class="c"># Get fingerprint bits as a binary string conatning 1s and 0s...</span>
 271 <span class="c">#</span>
<a name="GetBitsAsBinaryString-"></a> 272 <span class="k">sub </span><span class="m">GetBitsAsBinaryString</span> <span class="s">{</span>
 273   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$BitsOrder</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 274 
 275   <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;_GetFingerprintBitsAsString</span><span class="s">(</span><span class="q">&#39;Binary&#39;</span><span class="cm">,</span> <span class="i">$BitsOrder</span><span class="s">)</span><span class="sc">;</span>
 276 <span class="s">}</span>
 277 
 278 <span class="c"># Get fingerprint bits as a binary string conatning 1s and 0s...</span>
 279 <span class="c">#</span>
<a name="GetBitsAsRawBinaryString-"></a> 280 <span class="k">sub </span><span class="m">GetBitsAsRawBinaryString</span> <span class="s">{</span>
 281   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 282 
 283   <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;_GetFingerprintBitsAsString</span><span class="s">(</span><span class="q">&#39;RawBinary&#39;</span><span class="s">)</span><span class="sc">;</span>
 284 <span class="s">}</span>
 285 
 286 <span class="c"># Return fingerprint bits as a string...</span>
 287 <span class="c">#</span>
<a name="_GetFingerprintBitsAsString-"></a> 288 <span class="k">sub </span><span class="m">_GetFingerprintBitsAsString</span> <span class="s">{</span>
 289   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Format</span><span class="cm">,</span> <span class="i">$BitsOrder</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 290 
 291   <span class="i">$BitsOrder</span> = <span class="s">(</span><span class="k">defined</span><span class="s">(</span><span class="i">$BitsOrder</span><span class="s">)</span> &amp;&amp; <span class="i">$BitsOrder</span><span class="s">)</span> ? <span class="i">$BitsOrder</span> <span class="co">:</span> <span class="q">&#39;Ascending&#39;</span><span class="sc">;</span>
 292 
 293   <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;_GetBitsAsString</span><span class="s">(</span><span class="i">$Format</span><span class="cm">,</span> <span class="i">$BitsOrder</span><span class="s">)</span><span class="sc">;</span>
 294 <span class="s">}</span>
 295 
 296 <span class="c"># Is it a fingerprints bit vector object?</span>
<a name="IsFingerprintsBitVector-"></a> 297 <span class="k">sub </span><span class="m">IsFingerprintsBitVector ($)</span> <span class="s">{</span>
 298   <span class="k">my</span><span class="s">(</span><span class="i">$Object</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 299 
 300   <span class="k">return</span> <span class="i">_IsFingerprintsBitVector</span><span class="s">(</span><span class="i">$Object</span><span class="s">)</span><span class="sc">;</span>
 301 <span class="s">}</span>
 302 
 303 <span class="c"># Is it a fingerprints bit vector object?</span>
<a name="_IsFingerprintsBitVector-"></a> 304 <span class="k">sub </span><span class="m">_IsFingerprintsBitVector</span> <span class="s">{</span>
 305   <span class="k">my</span><span class="s">(</span><span class="i">$Object</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 306 
 307   <span class="k">return</span> <span class="s">(</span><span class="i">Scalar::Util::blessed</span><span class="s">(</span><span class="i">$Object</span><span class="s">)</span> &amp;&amp; <span class="i">$Object</span><span class="i">-&gt;isa</span><span class="s">(</span><span class="i">$ClassName</span><span class="s">)</span><span class="s">)</span> ? <span class="n">1</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 308 <span class="s">}</span>
 309 
 310 <span class="c"># Return a list of supported similarity coefficients...</span>
<a name="GetSupportedSimilarityCoefficients-"></a> 311 <span class="k">sub </span><span class="m">GetSupportedSimilarityCoefficients ()</span> <span class="s">{</span>
 312 
 313   <span class="k">return</span> <span class="i">@SimilarityCoefficients</span><span class="sc">;</span>
 314 <span class="s">}</span>
 315 
 316 <span class="c"># Get bit density for fingerprints bit vector corresponding to on bits...</span>
 317 <span class="c">#</span>
<a name="GetFingerprintsBitDensity-"></a> 318 <span class="k">sub </span><span class="m">GetFingerprintsBitDensity</span> <span class="s">{</span>
 319   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 320   <span class="k">my</span><span class="s">(</span><span class="i">$BitDensity</span><span class="s">)</span><span class="sc">;</span>
 321 
 322   <span class="i">$BitDensity</span> = <span class="i">$This</span><span class="i">-&gt;GetDensityOfSetBits</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 323 
 324   <span class="k">return</span> <span class="i">round</span><span class="s">(</span><span class="i">$BitDensity</span><span class="cm">,</span> <span class="n">2</span><span class="s">)</span><span class="sc">;</span>
 325 <span class="s">}</span>
 326 
 327 <span class="c"># Fold fingerprints bit vector by recursively reducing its size by half untill size is less than or equal to</span>
 328 <span class="c"># specified size...</span>
 329 <span class="c">#</span>
<a name="FoldFingerprintsBitVectorBySize-"></a> 330 <span class="k">sub </span><span class="m">FoldFingerprintsBitVectorBySize</span> <span class="s">{</span>
 331   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Size</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 332 
 333   <span class="k">if</span> <span class="s">(</span>!<span class="s">(</span><span class="i">$Size</span> &gt; <span class="n">0</span> &amp;&amp; <span class="i">$Size</span> &lt;= <span class="i">$This</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 334     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;FoldFingerprintsBitVectorBySize: Specified size, $Size, is not valid:  It must be &gt; 0 &amp;&amp; &lt;= &quot;</span><span class="cm">,</span> <span class="i">$This</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="cm">,</span><span class="q">&quot; ...&quot;</span><span class="sc">;</span>
 335   <span class="s">}</span>
 336 
 337   <span class="k">if</span> <span class="s">(</span><span class="i">$This</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span> &lt;= <span class="i">$Size</span><span class="s">)</span> <span class="s">{</span>
 338     <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 339   <span class="s">}</span>
 340   <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;_FoldFingerprintsBitVector</span><span class="s">(</span><span class="q">&#39;BySize&#39;</span><span class="cm">,</span> <span class="i">$Size</span><span class="s">)</span><span class="sc">;</span>
 341 <span class="s">}</span>
 342 
 343 <span class="c"># Fold fingerprints bit vector by recursively reducing its size by half untill bit density of set bits is greater than</span>
 344 <span class="c">#  or equal to specified density...</span>
 345 <span class="c">#</span>
<a name="FoldFingerprintsBitVectorByDensity-"></a> 346 <span class="k">sub </span><span class="m">FoldFingerprintsBitVectorByDensity</span> <span class="s">{</span>
 347   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Density</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 348 
 349   <span class="k">if</span> <span class="s">(</span>!<span class="s">(</span><span class="i">$Density</span> &gt; <span class="n">0</span> &amp;&amp; <span class="i">$Density</span> &lt;= <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 350     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;FoldFingerprintsBitVectorByDensity: Specified bit density, $Density, is not valid:  It must be &gt; 0 &amp;&amp; &lt;= 1 ...&quot;</span><span class="sc">;</span>
 351   <span class="s">}</span>
 352 
 353   <span class="k">if</span> <span class="s">(</span><span class="i">$This</span><span class="i">-&gt;GetDensityOfSetBits</span><span class="s">(</span><span class="s">)</span> &gt;= <span class="i">$Density</span><span class="s">)</span> <span class="s">{</span>
 354     <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 355   <span class="s">}</span>
 356   <span class="k">return</span> <span class="i">$This</span><span class="i">-&gt;_FoldFingerprintsBitVector</span><span class="s">(</span><span class="q">&#39;ByDensity&#39;</span><span class="cm">,</span> <span class="i">$Density</span><span class="s">)</span><span class="sc">;</span>
 357 <span class="s">}</span>
 358 
 359 <span class="c"># Fold fingerprints bit vector using size or density and return folded fingerprint bit vector...</span>
 360 <span class="c">#</span>
<a name="_FoldFingerprintsBitVector-"></a> 361 <span class="k">sub </span><span class="m">_FoldFingerprintsBitVector</span> <span class="s">{</span>
 362   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="cm">,</span> <span class="i">$Mode</span><span class="cm">,</span> <span class="i">$Value</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 363 
 364   <span class="c"># Fold upto size of 8 bits...</span>
 365   <span class="k">if</span> <span class="s">(</span><span class="i">$This</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span> &lt;= <span class="n">8</span><span class="s">)</span> <span class="s">{</span>
 366     <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 367   <span class="s">}</span>
 368 
 369   <span class="c"># Check size or density....</span>
 370   <span class="k">if</span> <span class="s">(</span><span class="i">$Mode</span> =~ <span class="q">/^BySize$/i</span><span class="s">)</span> <span class="s">{</span>
 371     <span class="k">if</span> <span class="s">(</span><span class="i">$This</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span> &lt;= <span class="i">$Value</span><span class="s">)</span> <span class="s">{</span>
 372       <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 373     <span class="s">}</span>
 374   <span class="s">}</span>
 375   <span class="k">elsif</span> <span class="s">(</span><span class="i">$Mode</span> =~ <span class="q">/^ByDensity$/i</span><span class="s">)</span> <span class="s">{</span>
 376     <span class="k">if</span> <span class="s">(</span><span class="i">$This</span><span class="i">-&gt;GetDensityOfSetBits</span><span class="s">(</span><span class="s">)</span> &gt;= <span class="i">$Value</span><span class="s">)</span> <span class="s">{</span>
 377       <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 378     <span class="s">}</span>
 379   <span class="s">}</span>
 380   <span class="k">else</span> <span class="s">{</span>
 381     <span class="k">return</span> <span class="i">$This</span><span class="sc">;</span>
 382   <span class="s">}</span>
 383 
 384   <span class="c"># Recursively reduce its size by half...</span>
 385   <span class="k">my</span><span class="s">(</span><span class="i">$FirstHalfBinaryString</span><span class="cm">,</span> <span class="i">$SecondHalfBinaryString</span><span class="cm">,</span> <span class="i">$FirstHalfFingerprintsBitVector</span><span class="cm">,</span> <span class="i">$SecondHalfFingerprintsBitVector</span><span class="cm">,</span> <span class="i">$FoldedFingerprintsBitVector</span><span class="cm">,</span> <span class="i">$BinaryString</span><span class="cm">,</span> <span class="i">$StringLength</span><span class="s">)</span><span class="sc">;</span>
 386 
 387   <span class="i">$BinaryString</span> = <span class="i">$This</span><span class="i">-&gt;GetBitsAsBinaryString</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 388   <span class="i">$StringLength</span> = <span class="k">length</span> <span class="i">$BinaryString</span><span class="sc">;</span>
 389 
 390   <span class="i">$FirstHalfBinaryString</span> = <span class="k">substr</span><span class="s">(</span><span class="i">$BinaryString</span><span class="cm">,</span> <span class="n">0</span><span class="cm">,</span> <span class="i">$StringLength</span>/<span class="n">2</span><span class="s">)</span><span class="sc">;</span>
 391   <span class="i">$SecondHalfBinaryString</span> = <span class="k">substr</span><span class="s">(</span><span class="i">$BinaryString</span><span class="cm">,</span> <span class="i">$StringLength</span>/<span class="n">2</span><span class="s">)</span><span class="sc">;</span>
 392 
 393   <span class="i">$FirstHalfFingerprintsBitVector</span> = <span class="i">NewFromBinaryString</span><span class="s">(</span><span class="i">$FirstHalfBinaryString</span><span class="s">)</span><span class="sc">;</span>
 394   <span class="i">$SecondHalfFingerprintsBitVector</span> = <span class="i">NewFromBinaryString</span><span class="s">(</span><span class="i">$SecondHalfBinaryString</span><span class="s">)</span><span class="sc">;</span>
 395 
 396   <span class="i">$FoldedFingerprintsBitVector</span> = <span class="i">$FirstHalfFingerprintsBitVector</span> | <span class="i">$SecondHalfFingerprintsBitVector</span><span class="sc">;</span>
 397 
 398   <span class="k">return</span> <span class="i">$FoldedFingerprintsBitVector</span><span class="i">-&gt;_FoldFingerprintsBitVector</span><span class="s">(</span><span class="i">$Mode</span><span class="cm">,</span> <span class="i">$Value</span><span class="s">)</span><span class="sc">;</span>
 399 <span class="s">}</span>
 400 
 401 <span class="c"># Is first bit vector subset of second bit vector?</span>
 402 <span class="c">#</span>
 403 <span class="c"># For a bit vector to be a subset of another bit vector, both vectors must be of</span>
 404 <span class="c"># the same size and the bit positions set in first vector must also be set in the</span>
 405 <span class="c"># secons bit vector.</span>
 406 <span class="c">#</span>
 407 <span class="c"># This functionality can be either invoked as a class function or an object method.</span>
 408 <span class="c">#</span>
<a name="IsSubSet-"></a> 409 <span class="k">sub </span><span class="m">IsSubSet ($$)</span> <span class="s">{</span>
 410   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 411 
 412   <span class="k">if</span> <span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span> != <span class="i">$FingerprintsBitVectorB</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 413     <span class="k">return</span> <span class="n">0</span><span class="sc">;</span>
 414   <span class="s">}</span>
 415   <span class="k">my</span><span class="s">(</span><span class="i">$AndFingerprintsBitVector</span><span class="s">)</span><span class="sc">;</span>
 416 
 417   <span class="i">$AndFingerprintsBitVector</span> = <span class="i">$FingerprintsBitVectorA</span> &amp; <span class="i">$FingerprintsBitVectorB</span><span class="sc">;</span>
 418 
 419   <span class="k">return</span> <span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="i">-&gt;GetNumOfSetBits</span><span class="s">(</span><span class="s">)</span> == <span class="i">$AndFingerprintsBitVector</span><span class="i">-&gt;GetNumOfSetBits</span><span class="s">(</span><span class="s">)</span><span class="s">)</span> ? <span class="n">1</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 420 <span class="s">}</span>
 421 
 422 <span class="c"># Return a string containing vector values...</span>
<a name="StringifyFingerprintsBitVector-"></a> 423 <span class="k">sub </span><span class="m">StringifyFingerprintsBitVector</span> <span class="s">{</span>
 424   <span class="k">my</span><span class="s">(</span><span class="i">$This</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 425   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsBitVectorString</span><span class="s">)</span><span class="sc">;</span>
 426 
 427   <span class="c"># BitVector size information...</span>
 428   <span class="c">#</span>
 429   <span class="k">if</span> <span class="s">(</span><span class="i">$This</span>-&gt;{<span class="w">SpecifiedSize</span>} != <span class="i">$This</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 430     <span class="i">$FingerprintsBitVectorString</span> = <span class="q">&quot;SpecifiedSize: &quot;</span> . <span class="i">$This</span>-&gt;{<span class="w">SpecifiedSize</span>} . <span class="q">&quot;; BitVectorSize: &quot;</span> . <span class="i">$This</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 431   <span class="s">}</span>
 432   <span class="k">else</span> <span class="s">{</span>
 433     <span class="i">$FingerprintsBitVectorString</span> = <span class="q">&quot;BitVectorSize: &quot;</span> . <span class="i">$This</span><span class="i">-&gt;GetSize</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 434   <span class="s">}</span>
 435   <span class="k">my</span><span class="s">(</span><span class="i">$NumOfSetBits</span><span class="cm">,</span> <span class="i">$BitDensity</span><span class="s">)</span><span class="sc">;</span>
 436   <span class="i">$NumOfSetBits</span> = <span class="i">$This</span><span class="i">-&gt;GetNumOfSetBits</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 437   <span class="i">$BitDensity</span> = <span class="i">$This</span><span class="i">-&gt;GetFingerprintsBitDensity</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 438 
 439   <span class="i">$FingerprintsBitVectorString</span> .= <span class="q">&quot;; NumOfOnBits: $NumOfSetBits; BitDensity: $BitDensity&quot;</span><span class="sc">;</span>
 440 
 441   <span class="c"># BitVector values...</span>
 442   <span class="i">$FingerprintsBitVectorString</span> .= <span class="q">&quot;; BitVector: &quot;</span> . <span class="i">$This</span><span class="i">-&gt;StringifyBitVector</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 443 
 444   <span class="k">return</span> <span class="i">$FingerprintsBitVectorString</span><span class="sc">;</span>
 445 <span class="s">}</span>
 446 
 447 <span class="c"># For two fingerprints bit vectors A and B of same size, let:</span>
 448 <span class="c">#</span>
 449 <span class="c">#  Na = Number of bits set to &quot;1&quot; in A</span>
 450 <span class="c">#  Nb = Number of bits set to &quot;1&quot; in B</span>
 451 <span class="c">#  Nc = Number of bits set to &quot;1&quot; in both A and B</span>
 452 <span class="c">#  Nd = Number of bits set to &quot;0&quot; in both A and B</span>
 453 <span class="c">#</span>
 454 <span class="c">#  Nt = Number of bits set to &quot;1&quot; or &quot;0&quot; in A or B = Size of A or B = Na + Nb - Nc + Nd</span>
 455 <span class="c">#</span>
 456 <span class="c">#  Na - Nc = Number of bits set to &quot;1&quot; in A but not in B</span>
 457 <span class="c">#  Nb - Nc = Number of bits set to &quot;1&quot; in B but not in A</span>
 458 <span class="c">#</span>
 459 <span class="c"># Various similarity coefficients [ Ref 40 - 42 ] for a pair of bit vectors A and B are</span>
 460 <span class="c"># defined as follows:</span>
 461 <span class="c">#</span>
 462 <span class="c"># . BaroniUrbani: ( SQRT( Nc * Nd ) + Nc ) / (  SQRT ( Nc * Nd ) + Nc + ( Na - Nc )  + ( Nb - Nc ) ) ( same as Buser )</span>
 463 <span class="c">#</span>
 464 <span class="c"># . Buser: ( SQRT ( Nc * Nd ) + Nc ) / (  SQRT ( Nc * Nd ) + Nc + ( Na - Nc )  + ( Nb - Nc ) ) ( same as BaroniUrbani )</span>
 465 <span class="c">#</span>
 466 <span class="c"># . Cosine: Nc / SQRT ( Na * Nb ) (same as Ochiai)</span>
 467 <span class="c">#</span>
 468 <span class="c"># . Dice: (2 * Nc) / ( Na + Nb )</span>
 469 <span class="c">#</span>
 470 <span class="c"># . Dennis: ( Nc * Nd - ( ( Na - Nc ) * ( Nb - Nc ) ) ) / SQRT ( Nt * Na * Nb)</span>
 471 <span class="c">#</span>
 472 <span class="c"># . Forbes: ( Nt * Nc ) / ( Na * Nb )</span>
 473 <span class="c">#</span>
 474 <span class="c"># . Fossum: ( Nt * ( ( Nc - 1/2 ) ** 2 ) / ( Na * Nb )</span>
 475 <span class="c">#</span>
 476 <span class="c"># . Hamann: ( ( Nc + Nd ) - ( Na - Nc ) - ( Nb - Nc ) ) / Nt</span>
 477 <span class="c">#</span>
 478 <span class="c"># . Jaccard: Nc /  ( ( Na - Nc) + ( Nb - Nc ) + Nc ) = Nc / ( Na + Nb - Nc ) (same as Tanimoto)</span>
 479 <span class="c">#</span>
 480 <span class="c"># . Kulczynski1: Nc / ( ( Na - Nc ) + ( Nb - Nc) ) = Nc / ( Na + Nb - 2Nc )</span>
 481 <span class="c">#</span>
 482 <span class="c"># . Kulczynski2: ( ( Nc / 2 ) * ( 2 * Nc + ( Na - Nc ) + ( Nb - Nc) ) ) / ( ( Nc + ( Na - Nc ) ) * ( Nc + ( Nb - Nc ) ) ) = 0.5 * ( Nc / Na + Nc / Nb )</span>
 483 <span class="c">#</span>
 484 <span class="c"># . Matching: ( Nc + Nd ) / Nt</span>
 485 <span class="c">#</span>
 486 <span class="c"># . McConnaughey: ( Nc ** 2 - ( Na - Nc ) * ( Nb - Nc) ) / (  Na * Nb )</span>
 487 <span class="c">#</span>
 488 <span class="c"># . Ochiai: Nc / SQRT ( Na * Nb ) (same as Cosine)</span>
 489 <span class="c">#</span>
 490 <span class="c"># . Pearson: ( ( Nc * Nd ) - ( ( Na - Nc ) * ( Nb - Nc ) ) / SQRT ( Na * Nb * (  Na - Nc + Nd ) * ( Nb - Nc + Nd ) )</span>
 491 <span class="c">#</span>
 492 <span class="c"># . RogersTanimoto: ( Nc + Nd ) / ( ( Na - Nc)  + ( Nb  - Nc) + Nt) = ( Nc + Nd ) / ( Na  + Nb  - 2Nc + Nt)</span>
 493 <span class="c">#</span>
 494 <span class="c"># . RussellRao: Nc / Nt</span>
 495 <span class="c">#</span>
 496 <span class="c"># . Simpson: Nc / MIN ( Na, Nb)</span>
 497 <span class="c">#</span>
 498 <span class="c"># . SkoalSneath1: Nc / ( Nc + 2 * ( Na - Nc)  + 2 * ( Nb - Nc) ) = Nc / ( 2 * Na + 2 * Nb - 3 * Nc )</span>
 499 <span class="c">#</span>
 500 <span class="c"># . SkoalSneath2: ( 2 * Nc + 2 * Nd ) / ( Nc + Nd + Nt )</span>
 501 <span class="c">#</span>
 502 <span class="c"># . SkoalSneath3: ( Nc + Nd ) / ( ( Na - Nc ) + ( Nb - Nc ) ) = ( Nc + Nd ) / ( Na + Nb - 2 * Nc  )</span>
 503 <span class="c">#</span>
 504 <span class="c"># . Tanimoto: Nc /  ( ( Na - Nc) + ( Nb - Nc ) + Nc ) = Nc / ( Na + Nb - Nc ) (same as Jaccard)</span>
 505 <span class="c">#</span>
 506 <span class="c"># . Tversky: Nc / ( alpha * ( Na - Nc ) + ( 1 - alpha) * ( Nb - Nc) + Nc ) = Nc / ( alpha * ( Na - Nb )  + Nb)</span>
 507 <span class="c">#</span>
 508 <span class="c"># . Yule: ( ( Nc * Nd ) - ( ( Na - Nc ) * ( Nb - Nc ) ) ) / ( ( Nc * Nd ) + ( ( Na - Nc ) * ( Nb - Nc ) )  )</span>
 509 <span class="c">#</span>
 510 <span class="c">#</span>
 511 <span class="c"># Values of Tanimoto/Jaccard and Tversky coefficients are dependent on only those bit which</span>
 512 <span class="c"># are set to &quot;1&quot; in both A and B. In order to take into account all bit positions, modified versions</span>
 513 <span class="c"># of Tanimoto [ Ref. 42 ] and Tversky [  Ref. 43 ] have been developed.</span>
 514 <span class="c">#</span>
 515 <span class="c"># Let:</span>
 516 <span class="c">#</span>
 517 <span class="c">#  Na&#39; = Number of bits set to &quot;0&quot; in A</span>
 518 <span class="c">#  Nb&#39; = Number of bits set to &quot;0&quot; in B</span>
 519 <span class="c">#  Nc&#39; = Number of bits set to &quot;0&quot; in both A and B</span>
 520 <span class="c">#</span>
 521 <span class="c"># . Tanimoto&#39;: Nc&#39; /  ( ( Na&#39; - Nc&#39;) + ( Nb&#39; - Nc&#39; ) + Nc&#39; ) = Nc&#39; / ( Na&#39; + Nb&#39; - Nc&#39; )</span>
 522 <span class="c">#</span>
 523 <span class="c"># . Tversky&#39;: Nc&#39; / ( alpha * ( Na&#39; - Nc&#39; ) + ( 1 - alpha) * ( Nb&#39; - Nc&#39; ) + Nc&#39; ) = Nc&#39; / ( alpha * ( Na&#39; - Nb&#39; )  + Nb&#39;)</span>
 524 <span class="c">#</span>
 525 <span class="c"># Then:</span>
 526 <span class="c">#</span>
 527 <span class="c"># . WeightedTanimoto = beta * Tanimoto + (1 - beta) * Tanimoto&#39;</span>
 528 <span class="c">#</span>
 529 <span class="c"># . WeightedTversky = beta * Tversky + (1 - beta) * Tversky&#39;</span>
 530 <span class="c">#</span>
 531 <span class="c">#</span>
 532 
 533 <span class="c"># Calculate BaroniUrbani similarity coefficient for two same size bit vectors.</span>
 534 <span class="c">#</span>
 535 <span class="c"># This functionality can be either invoked as a class function or an object method.</span>
 536 <span class="c">#</span>
<a name="BaroniUrbaniSimilarityCoefficient-"></a> 537 <span class="k">sub </span><span class="m">BaroniUrbaniSimilarityCoefficient ($$)</span> <span class="s">{</span>
 538   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 539 
 540   <span class="k">return</span> <span class="i">BuserSimilarityCoefficient</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span><span class="sc">;</span>
 541 <span class="s">}</span>
 542 
 543 <span class="c"># Calculate Buser similarity coefficient for two same size bit vectors.</span>
 544 <span class="c">#</span>
 545 <span class="c"># This functionality can be either invoked as a class function or an object method.</span>
 546 <span class="c">#</span>
<a name="BuserSimilarityCoefficient-"></a> 547 <span class="k">sub </span><span class="m">BuserSimilarityCoefficient ($$)</span> <span class="s">{</span>
 548   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 549   <span class="k">my</span><span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="cm">,</span> <span class="i">$Nd</span><span class="cm">,</span> <span class="i">$Nt</span><span class="cm">,</span> <span class="i">$Numerator</span><span class="cm">,</span> <span class="i">$Denominator</span><span class="s">)</span><span class="sc">;</span>
 550 
 551   <span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="s">)</span> = <span class="i">_GetNumOfIndividualAndCommonSetBits</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span><span class="sc">;</span>
 552   <span class="i">$Nd</span> = <span class="i">_GetNumOfCommonClearBits</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span><span class="sc">;</span>
 553   <span class="i">$Nt</span> = <span class="i">$Na</span> + <span class="i">$Nb</span> - <span class="i">$Nc</span> + <span class="i">$Nd</span><span class="sc">;</span>
 554 
 555   <span class="i">$Numerator</span> = <span class="k">sqrt</span><span class="s">(</span><span class="i">$Nc</span>*<span class="i">$Nd</span><span class="s">)</span> + <span class="i">$Nc</span><span class="sc">;</span>
 556   <span class="i">$Denominator</span> = <span class="k">sqrt</span><span class="s">(</span><span class="i">$Nc</span>*<span class="i">$Nd</span><span class="s">)</span> + <span class="s">(</span><span class="i">$Na</span> - <span class="i">$Nc</span><span class="s">)</span>  + <span class="s">(</span><span class="i">$Nb</span> - <span class="i">$Nc</span> <span class="s">)</span> + <span class="i">$Nc</span><span class="sc">;</span>
 557 
 558   <span class="k">return</span>  <span class="i">$Denominator</span> ? <span class="s">(</span><span class="i">$Numerator</span>/<span class="i">$Denominator</span><span class="s">)</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 559 <span class="s">}</span>
 560 
 561 <span class="c"># Calculate Cosine similarity coefficient for two same size bit vectors.</span>
 562 <span class="c">#</span>
 563 <span class="c"># This functionality can be either invoked as a class function or an object method.</span>
 564 <span class="c">#</span>
<a name="CosineSimilarityCoefficient-"></a> 565 <span class="k">sub </span><span class="m">CosineSimilarityCoefficient ($$)</span> <span class="s">{</span>
 566   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 567   <span class="k">my</span><span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="cm">,</span> <span class="i">$Numerator</span><span class="cm">,</span> <span class="i">$Denominator</span><span class="s">)</span><span class="sc">;</span>
 568 
 569   <span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="s">)</span> = <span class="i">_GetNumOfIndividualAndCommonSetBits</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span><span class="sc">;</span>
 570 
 571   <span class="i">$Numerator</span> = <span class="i">$Nc</span><span class="sc">;</span>
 572   <span class="i">$Denominator</span> = <span class="k">sqrt</span><span class="s">(</span><span class="i">$Na</span>*<span class="i">$Nb</span><span class="s">)</span><span class="sc">;</span>
 573 
 574   <span class="k">return</span>  <span class="i">$Denominator</span> ? <span class="s">(</span><span class="i">$Numerator</span>/<span class="i">$Denominator</span><span class="s">)</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 575 <span class="s">}</span>
 576 
 577 <span class="c"># Calculate Dice similarity coefficient for two same size bit vectors.</span>
 578 <span class="c">#</span>
 579 <span class="c"># This functionality can be either invoked as a class function or an object method.</span>
 580 <span class="c">#</span>
<a name="DiceSimilarityCoefficient-"></a> 581 <span class="k">sub </span><span class="m">DiceSimilarityCoefficient ($$)</span> <span class="s">{</span>
 582   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 583   <span class="k">my</span><span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="cm">,</span> <span class="i">$Numerator</span><span class="cm">,</span> <span class="i">$Denominator</span><span class="s">)</span><span class="sc">;</span>
 584 
 585   <span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="s">)</span> = <span class="i">_GetNumOfIndividualAndCommonSetBits</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span><span class="sc">;</span>
 586 
 587   <span class="i">$Numerator</span> = <span class="n">2</span>*<span class="i">$Nc</span><span class="sc">;</span>
 588   <span class="i">$Denominator</span> = <span class="i">$Na</span> + <span class="i">$Nb</span><span class="sc">;</span>
 589 
 590   <span class="k">return</span>  <span class="i">$Denominator</span> ? <span class="s">(</span><span class="i">$Numerator</span>/<span class="i">$Denominator</span><span class="s">)</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 591 <span class="s">}</span>
 592 
 593 <span class="c"># Calculate Dennis similarity coefficient for two same size bit vectors.</span>
 594 <span class="c">#</span>
 595 <span class="c"># This functionality can be either invoked as a class function or an object method.</span>
 596 <span class="c">#</span>
<a name="DennisSimilarityCoefficient-"></a> 597 <span class="k">sub </span><span class="m">DennisSimilarityCoefficient ($$)</span> <span class="s">{</span>
 598   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 599   <span class="k">my</span><span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="cm">,</span> <span class="i">$Nd</span><span class="cm">,</span> <span class="i">$Nt</span><span class="cm">,</span> <span class="i">$Numerator</span><span class="cm">,</span> <span class="i">$Denominator</span><span class="s">)</span><span class="sc">;</span>
 600 
 601   <span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="s">)</span> = <span class="i">_GetNumOfIndividualAndCommonSetBits</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span><span class="sc">;</span>
 602   <span class="i">$Nd</span> = <span class="i">_GetNumOfCommonClearBits</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span><span class="sc">;</span>
 603   <span class="i">$Nt</span> = <span class="i">$Na</span> + <span class="i">$Nb</span> - <span class="i">$Nc</span> + <span class="i">$Nd</span><span class="sc">;</span>
 604 
 605   <span class="i">$Numerator</span> = <span class="i">$Nc</span>*<span class="i">$Nd</span> - <span class="s">(</span><span class="s">(</span><span class="i">$Na</span> - <span class="i">$Nc</span><span class="s">)</span>*<span class="s">(</span><span class="i">$Nb</span> - <span class="i">$Nc</span><span class="s">)</span><span class="s">)</span><span class="sc">;</span>
 606   <span class="i">$Denominator</span> = <span class="k">sqrt</span><span class="s">(</span><span class="i">$Nt</span>*<span class="i">$Na</span>*<span class="i">$Nb</span><span class="s">)</span><span class="sc">;</span>
 607 
 608   <span class="k">return</span>  <span class="i">$Denominator</span> ? <span class="s">(</span><span class="i">$Numerator</span>/<span class="i">$Denominator</span><span class="s">)</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 609 <span class="s">}</span>
 610 
 611 <span class="c"># Calculate Forbes similarity coefficient for two same size bit vectors.</span>
 612 <span class="c">#</span>
 613 <span class="c"># This functionality can be either invoked as a class function or an object method.</span>
 614 <span class="c">#</span>
<a name="ForbesSimilarityCoefficient-"></a> 615 <span class="k">sub </span><span class="m">ForbesSimilarityCoefficient ($$)</span> <span class="s">{</span>
 616   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 617   <span class="k">my</span><span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="cm">,</span> <span class="i">$Nd</span><span class="cm">,</span> <span class="i">$Nt</span><span class="cm">,</span> <span class="i">$Numerator</span><span class="cm">,</span> <span class="i">$Denominator</span><span class="s">)</span><span class="sc">;</span>
 618 
 619   <span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="s">)</span> = <span class="i">_GetNumOfIndividualAndCommonSetBits</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span><span class="sc">;</span>
 620   <span class="i">$Nd</span> = <span class="i">_GetNumOfCommonClearBits</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span><span class="sc">;</span>
 621   <span class="i">$Nt</span> = <span class="i">$Na</span> + <span class="i">$Nb</span> - <span class="i">$Nc</span> + <span class="i">$Nd</span><span class="sc">;</span>
 622 
 623   <span class="i">$Numerator</span> = <span class="i">$Nt</span>*<span class="i">$Nc</span><span class="sc">;</span>
 624   <span class="i">$Denominator</span> = <span class="i">$Na</span>*<span class="i">$Nb</span><span class="sc">;</span>
 625 
 626   <span class="k">return</span>  <span class="i">$Denominator</span> ? <span class="s">(</span><span class="i">$Numerator</span>/<span class="i">$Denominator</span><span class="s">)</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 627 <span class="s">}</span>
 628 
 629 <span class="c"># Calculate Fossum similarity coefficient for two same size bit vectors.</span>
 630 <span class="c">#</span>
 631 <span class="c"># This functionality can be either invoked as a class function or an object method.</span>
 632 <span class="c">#</span>
<a name="FossumSimilarityCoefficient-"></a> 633 <span class="k">sub </span><span class="m">FossumSimilarityCoefficient ($$)</span> <span class="s">{</span>
 634   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 635   <span class="k">my</span><span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="cm">,</span> <span class="i">$Nd</span><span class="cm">,</span> <span class="i">$Nt</span><span class="cm">,</span> <span class="i">$Numerator</span><span class="cm">,</span> <span class="i">$Denominator</span><span class="s">)</span><span class="sc">;</span>
 636 
 637   <span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="s">)</span> = <span class="i">_GetNumOfIndividualAndCommonSetBits</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span><span class="sc">;</span>
 638   <span class="i">$Nd</span> = <span class="i">_GetNumOfCommonClearBits</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span><span class="sc">;</span>
 639   <span class="i">$Nt</span> = <span class="i">$Na</span> + <span class="i">$Nb</span> - <span class="i">$Nc</span> + <span class="i">$Nd</span><span class="sc">;</span>
 640 
 641   <span class="i">$Numerator</span> =  <span class="i">$Nt</span>*<span class="s">(</span><span class="s">(</span><span class="i">$Nc</span> - <span class="n">0.5</span><span class="s">)</span>** <span class="n">2</span><span class="s">)</span><span class="sc">;</span>
 642   <span class="i">$Denominator</span> =  <span class="i">$Na</span>*<span class="i">$Nb</span> <span class="sc">;</span>
 643 
 644   <span class="k">return</span>  <span class="i">$Denominator</span> ? <span class="s">(</span><span class="i">$Numerator</span>/<span class="i">$Denominator</span><span class="s">)</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 645 <span class="s">}</span>
 646 
 647 <span class="c"># Calculate Hamann similarity coefficient for two same size bit vectors.</span>
 648 <span class="c">#</span>
 649 <span class="c"># This functionality can be either invoked as a class function or an object method.</span>
 650 <span class="c">#</span>
<a name="HamannSimilarityCoefficient-"></a> 651 <span class="k">sub </span><span class="m">HamannSimilarityCoefficient ($$)</span> <span class="s">{</span>
 652   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 653   <span class="k">my</span><span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="cm">,</span> <span class="i">$Nd</span><span class="cm">,</span> <span class="i">$Nt</span><span class="cm">,</span> <span class="i">$Numerator</span><span class="cm">,</span> <span class="i">$Denominator</span><span class="s">)</span><span class="sc">;</span>
 654 
 655   <span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="s">)</span> = <span class="i">_GetNumOfIndividualAndCommonSetBits</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span><span class="sc">;</span>
 656   <span class="i">$Nd</span> = <span class="i">_GetNumOfCommonClearBits</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span><span class="sc">;</span>
 657   <span class="i">$Nt</span> = <span class="i">$Na</span> + <span class="i">$Nb</span> - <span class="i">$Nc</span> + <span class="i">$Nd</span><span class="sc">;</span>
 658 
 659   <span class="i">$Numerator</span> =  <span class="s">(</span><span class="i">$Nc</span> + <span class="i">$Nd</span> <span class="s">)</span> - <span class="s">(</span><span class="i">$Na</span> - <span class="i">$Nc</span><span class="s">)</span> - <span class="s">(</span><span class="i">$Nb</span> - <span class="i">$Nc</span><span class="s">)</span> <span class="sc">;</span>
 660   <span class="i">$Denominator</span> = <span class="i">$Nt</span><span class="sc">;</span>
 661 
 662   <span class="k">return</span>  <span class="i">$Denominator</span> ? <span class="s">(</span><span class="i">$Numerator</span>/<span class="i">$Denominator</span><span class="s">)</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 663 <span class="s">}</span>
 664 
 665 <span class="c"># Calculate Jacard similarity coefficient for two same size bit vectors.</span>
 666 <span class="c">#</span>
 667 <span class="c"># This functionality can be either invoked as a class function or an object method.</span>
 668 <span class="c">#</span>
<a name="JacardSimilarityCoefficient-"></a> 669 <span class="k">sub </span><span class="m">JacardSimilarityCoefficient ($$)</span> <span class="s">{</span>
 670   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 671 
 672   <span class="k">return</span> <span class="i">TanimotoSimilarityCoefficient</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span><span class="sc">;</span>
 673 <span class="s">}</span>
 674 
 675 <span class="c"># Calculate Kulczynski1 similarity coefficient for two same size bit vectors.</span>
 676 <span class="c">#</span>
 677 <span class="c"># This functionality can be either invoked as a class function or an object method.</span>
 678 <span class="c">#</span>
<a name="Kulczynski1SimilarityCoefficient-"></a> 679 <span class="k">sub </span><span class="m">Kulczynski1SimilarityCoefficient ($$)</span> <span class="s">{</span>
 680   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 681   <span class="k">my</span><span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="cm">,</span> <span class="i">$Numerator</span><span class="cm">,</span> <span class="i">$Denominator</span><span class="s">)</span><span class="sc">;</span>
 682 
 683   <span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="s">)</span> = <span class="i">_GetNumOfIndividualAndCommonSetBits</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span><span class="sc">;</span>
 684 
 685   <span class="i">$Numerator</span> = <span class="i">$Nc</span><span class="sc">;</span>
 686   <span class="i">$Denominator</span> =  <span class="i">$Na</span> + <span class="i">$Nb</span> - <span class="n">2</span>*<span class="i">$Nc</span><span class="sc">;</span>
 687 
 688   <span class="k">return</span>  <span class="i">$Denominator</span> ? <span class="s">(</span><span class="i">$Numerator</span>/<span class="i">$Denominator</span><span class="s">)</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 689 <span class="s">}</span>
 690 
 691 <span class="c"># Calculate Kulczynski2 similarity coefficient for two same size bit vectors.</span>
 692 <span class="c">#</span>
 693 <span class="c"># This functionality can be either invoked as a class function or an object method.</span>
 694 <span class="c">#</span>
<a name="Kulczynski2SimilarityCoefficient-"></a> 695 <span class="k">sub </span><span class="m">Kulczynski2SimilarityCoefficient ($$)</span> <span class="s">{</span>
 696   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 697   <span class="k">my</span><span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="cm">,</span> <span class="i">$Numerator</span><span class="cm">,</span> <span class="i">$Denominator</span><span class="s">)</span><span class="sc">;</span>
 698 
 699   <span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="s">)</span> = <span class="i">_GetNumOfIndividualAndCommonSetBits</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span><span class="sc">;</span>
 700 
 701   <span class="i">$Numerator</span> = <span class="n">0.5</span>*<span class="s">(</span><span class="i">$Na</span>*<span class="i">$Nc</span> + <span class="i">$Nb</span>*<span class="i">$Nc</span><span class="s">)</span><span class="sc">;</span>
 702   <span class="i">$Denominator</span> = <span class="i">$Na</span>*<span class="i">$Nb</span><span class="sc">;</span>
 703 
 704   <span class="k">return</span>  <span class="i">$Denominator</span> ? <span class="s">(</span><span class="i">$Numerator</span>/<span class="i">$Denominator</span><span class="s">)</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 705 <span class="s">}</span>
 706 
 707 <span class="c"># Calculate Matching similarity coefficient for two same size bit vectors.</span>
 708 <span class="c">#</span>
 709 <span class="c"># This functionality can be either invoked as a class function or an object method.</span>
 710 <span class="c">#</span>
<a name="MatchingSimilarityCoefficient-"></a> 711 <span class="k">sub </span><span class="m">MatchingSimilarityCoefficient ($$)</span> <span class="s">{</span>
 712   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 713   <span class="k">my</span><span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="cm">,</span> <span class="i">$Nd</span><span class="cm">,</span> <span class="i">$Nt</span><span class="cm">,</span> <span class="i">$Numerator</span><span class="cm">,</span> <span class="i">$Denominator</span><span class="s">)</span><span class="sc">;</span>
 714 
 715   <span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="s">)</span> = <span class="i">_GetNumOfIndividualAndCommonSetBits</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span><span class="sc">;</span>
 716   <span class="i">$Nd</span> = <span class="i">_GetNumOfCommonClearBits</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span><span class="sc">;</span>
 717   <span class="i">$Nt</span> = <span class="i">$Na</span> + <span class="i">$Nb</span> - <span class="i">$Nc</span> + <span class="i">$Nd</span><span class="sc">;</span>
 718 
 719   <span class="i">$Numerator</span> =  <span class="i">$Nc</span> + <span class="i">$Nd</span><span class="sc">;</span>
 720   <span class="i">$Denominator</span> = <span class="i">$Nt</span><span class="sc">;</span>
 721 
 722   <span class="k">return</span>  <span class="i">$Denominator</span> ? <span class="s">(</span><span class="i">$Numerator</span>/<span class="i">$Denominator</span><span class="s">)</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 723 <span class="s">}</span>
 724 
 725 <span class="c"># Calculate McConnaughey similarity coefficient for two same size bit vectors.</span>
 726 <span class="c">#</span>
 727 <span class="c"># This functionality can be either invoked as a class function or an object method.</span>
 728 <span class="c">#</span>
<a name="McConnaugheySimilarityCoefficient-"></a> 729 <span class="k">sub </span><span class="m">McConnaugheySimilarityCoefficient ($$)</span> <span class="s">{</span>
 730   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 731   <span class="k">my</span><span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="cm">,</span> <span class="i">$Numerator</span><span class="cm">,</span> <span class="i">$Denominator</span><span class="s">)</span><span class="sc">;</span>
 732 
 733   <span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="s">)</span> = <span class="i">_GetNumOfIndividualAndCommonSetBits</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span><span class="sc">;</span>
 734 
 735   <span class="i">$Numerator</span> =  <span class="i">$Nc</span>**<span class="n">2</span> - <span class="s">(</span><span class="s">(</span><span class="i">$Na</span> - <span class="i">$Nc</span><span class="s">)</span>*<span class="s">(</span><span class="i">$Nb</span> - <span class="i">$Nc</span><span class="s">)</span><span class="s">)</span><span class="sc">;</span>
 736   <span class="i">$Denominator</span> = <span class="i">$Na</span>*<span class="i">$Nb</span> <span class="sc">;</span>
 737 
 738   <span class="k">return</span>  <span class="i">$Denominator</span> ? <span class="s">(</span><span class="i">$Numerator</span>/<span class="i">$Denominator</span><span class="s">)</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 739 <span class="s">}</span>
 740 
 741 <span class="c"># Calculate Ochiai similarity coefficient for two same size bit vectors.</span>
 742 <span class="c">#</span>
 743 <span class="c"># This functionality can be either invoked as a class function or an object method.</span>
 744 <span class="c">#</span>
<a name="OchiaiSimilarityCoefficient-"></a> 745 <span class="k">sub </span><span class="m">OchiaiSimilarityCoefficient ($$)</span> <span class="s">{</span>
 746   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 747 
 748   <span class="k">return</span> <span class="i">CosineSimilarityCoefficient</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span><span class="sc">;</span>
 749 <span class="s">}</span>
 750 
 751 <span class="c"># Calculate Pearson similarity coefficient for two same size bit vectors.</span>
 752 <span class="c">#</span>
 753 <span class="c"># This functionality can be either invoked as a class function or an object method.</span>
 754 <span class="c">#</span>
<a name="PearsonSimilarityCoefficient-"></a> 755 <span class="k">sub </span><span class="m">PearsonSimilarityCoefficient ($$)</span> <span class="s">{</span>
 756   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 757   <span class="k">my</span><span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="cm">,</span> <span class="i">$Nd</span><span class="cm">,</span> <span class="i">$Nt</span><span class="cm">,</span> <span class="i">$Numerator</span><span class="cm">,</span> <span class="i">$Denominator</span><span class="s">)</span><span class="sc">;</span>
 758 
 759   <span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="s">)</span> = <span class="i">_GetNumOfIndividualAndCommonSetBits</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span><span class="sc">;</span>
 760   <span class="i">$Nd</span> = <span class="i">_GetNumOfCommonClearBits</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span><span class="sc">;</span>
 761   <span class="i">$Nt</span> = <span class="i">$Na</span> + <span class="i">$Nb</span> - <span class="i">$Nc</span> + <span class="i">$Nd</span><span class="sc">;</span>
 762 
 763   <span class="i">$Numerator</span> = <span class="s">(</span><span class="i">$Nc</span>*<span class="i">$Nd</span> <span class="s">)</span> - <span class="s">(</span><span class="s">(</span><span class="i">$Na</span> - <span class="i">$Nc</span><span class="s">)</span>*<span class="s">(</span><span class="i">$Nb</span> - <span class="i">$Nc</span><span class="s">)</span><span class="s">)</span><span class="sc">;</span>
 764   <span class="i">$Denominator</span> =  <span class="k">sqrt</span><span class="s">(</span><span class="i">$Na</span>*<span class="i">$Nb</span>*<span class="s">(</span><span class="i">$Na</span> - <span class="i">$Nc</span> + <span class="i">$Nd</span> <span class="s">)</span>*<span class="s">(</span><span class="i">$Nb</span> - <span class="i">$Nc</span> + <span class="i">$Nd</span><span class="s">)</span><span class="s">)</span><span class="sc">;</span>
 765 
 766   <span class="k">return</span>  <span class="i">$Denominator</span> ? <span class="s">(</span><span class="i">$Numerator</span>/<span class="i">$Denominator</span><span class="s">)</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 767 <span class="s">}</span>
 768 
 769 <span class="c"># Calculate RogersTanimoto similarity coefficient for two same size bit vectors.</span>
 770 <span class="c">#</span>
 771 <span class="c"># This functionality can be either invoked as a class function or an object method.</span>
 772 <span class="c">#</span>
<a name="RogersTanimotoSimilarityCoefficient-"></a> 773 <span class="k">sub </span><span class="m">RogersTanimotoSimilarityCoefficient ($$)</span> <span class="s">{</span>
 774   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 775   <span class="k">my</span><span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="cm">,</span> <span class="i">$Nd</span><span class="cm">,</span> <span class="i">$Nt</span><span class="cm">,</span> <span class="i">$Numerator</span><span class="cm">,</span> <span class="i">$Denominator</span><span class="s">)</span><span class="sc">;</span>
 776 
 777   <span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="s">)</span> = <span class="i">_GetNumOfIndividualAndCommonSetBits</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span><span class="sc">;</span>
 778   <span class="i">$Nd</span> = <span class="i">_GetNumOfCommonClearBits</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span><span class="sc">;</span>
 779   <span class="i">$Nt</span> = <span class="i">$Na</span> + <span class="i">$Nb</span> - <span class="i">$Nc</span> + <span class="i">$Nd</span><span class="sc">;</span>
 780 
 781   <span class="i">$Numerator</span> = <span class="i">$Nc</span> + <span class="i">$Nd</span><span class="sc">;</span>
 782   <span class="i">$Denominator</span> =  <span class="s">(</span><span class="i">$Na</span> - <span class="i">$Nc</span><span class="s">)</span>  + <span class="s">(</span><span class="i">$Nb</span>  - <span class="i">$Nc</span><span class="s">)</span> + <span class="i">$Nt</span><span class="sc">;</span>
 783 
 784   <span class="k">return</span>  <span class="i">$Denominator</span> ? <span class="s">(</span><span class="i">$Numerator</span>/<span class="i">$Denominator</span><span class="s">)</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 785 <span class="s">}</span>
 786 
 787 <span class="c"># Calculate RussellRao similarity coefficient for two same size bit vectors.</span>
 788 <span class="c">#</span>
 789 <span class="c"># This functionality can be either invoked as a class function or an object method.</span>
 790 <span class="c">#</span>
<a name="RussellRaoSimilarityCoefficient-"></a> 791 <span class="k">sub </span><span class="m">RussellRaoSimilarityCoefficient ($$)</span> <span class="s">{</span>
 792   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 793   <span class="k">my</span><span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="cm">,</span> <span class="i">$Nd</span><span class="cm">,</span> <span class="i">$Nt</span><span class="cm">,</span> <span class="i">$Numerator</span><span class="cm">,</span> <span class="i">$Denominator</span><span class="s">)</span><span class="sc">;</span>
 794 
 795   <span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="s">)</span> = <span class="i">_GetNumOfIndividualAndCommonSetBits</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span><span class="sc">;</span>
 796   <span class="i">$Nd</span> = <span class="i">_GetNumOfCommonClearBits</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span><span class="sc">;</span>
 797   <span class="i">$Nt</span> = <span class="i">$Na</span> + <span class="i">$Nb</span> - <span class="i">$Nc</span> + <span class="i">$Nd</span><span class="sc">;</span>
 798 
 799   <span class="i">$Numerator</span> = <span class="i">$Nc</span><span class="sc">;</span>
 800   <span class="i">$Denominator</span> = <span class="i">$Nt</span><span class="sc">;</span>
 801 
 802   <span class="k">return</span>  <span class="i">$Denominator</span> ? <span class="s">(</span><span class="i">$Numerator</span>/<span class="i">$Denominator</span><span class="s">)</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 803 <span class="s">}</span>
 804 
 805 <span class="c"># Calculate Simpson similarity coefficient for two same size bit vectors.</span>
 806 <span class="c">#</span>
 807 <span class="c"># This functionality can be either invoked as a class function or an object method.</span>
 808 <span class="c">#</span>
<a name="SimpsonSimilarityCoefficient-"></a> 809 <span class="k">sub </span><span class="m">SimpsonSimilarityCoefficient ($$)</span> <span class="s">{</span>
 810   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 811   <span class="k">my</span><span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="cm">,</span> <span class="i">$Numerator</span><span class="cm">,</span> <span class="i">$Denominator</span><span class="s">)</span><span class="sc">;</span>
 812 
 813   <span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="s">)</span> = <span class="i">_GetNumOfIndividualAndCommonSetBits</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span><span class="sc">;</span>
 814 
 815   <span class="i">$Numerator</span> = <span class="i">$Nc</span><span class="sc">;</span>
 816   <span class="i">$Denominator</span> =  <span class="i">min</span><span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="s">)</span><span class="sc">;</span>
 817 
 818   <span class="k">return</span>  <span class="i">$Denominator</span> ? <span class="s">(</span><span class="i">$Numerator</span>/<span class="i">$Denominator</span><span class="s">)</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 819 <span class="s">}</span>
 820 
 821 <span class="c"># Calculate SkoalSneath1 similarity coefficient for two same size bit vectors.</span>
 822 <span class="c">#</span>
 823 <span class="c"># This functionality can be either invoked as a class function or an object method.</span>
 824 <span class="c">#</span>
<a name="SkoalSneath1SimilarityCoefficient-"></a> 825 <span class="k">sub </span><span class="m">SkoalSneath1SimilarityCoefficient ($$)</span> <span class="s">{</span>
 826   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 827   <span class="k">my</span><span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="cm">,</span> <span class="i">$Numerator</span><span class="cm">,</span> <span class="i">$Denominator</span><span class="s">)</span><span class="sc">;</span>
 828 
 829   <span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="s">)</span> = <span class="i">_GetNumOfIndividualAndCommonSetBits</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span><span class="sc">;</span>
 830 
 831   <span class="i">$Numerator</span> = <span class="i">$Nc</span><span class="sc">;</span>
 832   <span class="i">$Denominator</span> = <span class="i">$Nc</span> + <span class="n">2</span>*<span class="s">(</span><span class="i">$Na</span> - <span class="i">$Nc</span><span class="s">)</span>  + <span class="n">2</span>*<span class="s">(</span><span class="i">$Nb</span> - <span class="i">$Nc</span><span class="s">)</span><span class="sc">;</span>
 833 
 834   <span class="k">return</span>  <span class="i">$Denominator</span> ? <span class="s">(</span><span class="i">$Numerator</span>/<span class="i">$Denominator</span><span class="s">)</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 835 <span class="s">}</span>
 836 
 837 <span class="c"># Calculate SkoalSneath2 similarity coefficient for two same size bit vectors.</span>
 838 <span class="c">#</span>
 839 <span class="c"># This functionality can be either invoked as a class function or an object method.</span>
 840 <span class="c">#</span>
<a name="SkoalSneath2SimilarityCoefficient-"></a> 841 <span class="k">sub </span><span class="m">SkoalSneath2SimilarityCoefficient ($$)</span> <span class="s">{</span>
 842   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 843   <span class="k">my</span><span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="cm">,</span> <span class="i">$Nd</span><span class="cm">,</span> <span class="i">$Nt</span><span class="cm">,</span> <span class="i">$Numerator</span><span class="cm">,</span> <span class="i">$Denominator</span><span class="s">)</span><span class="sc">;</span>
 844 
 845   <span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="s">)</span> = <span class="i">_GetNumOfIndividualAndCommonSetBits</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span><span class="sc">;</span>
 846   <span class="i">$Nd</span> = <span class="i">_GetNumOfCommonClearBits</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span><span class="sc">;</span>
 847   <span class="i">$Nt</span> = <span class="i">$Na</span> + <span class="i">$Nb</span> - <span class="i">$Nc</span> + <span class="i">$Nd</span><span class="sc">;</span>
 848 
 849   <span class="i">$Numerator</span> = <span class="n">2</span>*<span class="i">$Nc</span> + <span class="n">2</span>*<span class="i">$Nd</span>  <span class="sc">;</span>
 850   <span class="i">$Denominator</span> = <span class="i">$Nc</span> + <span class="i">$Nd</span> + <span class="i">$Nt</span> <span class="sc">;</span>
 851 
 852   <span class="k">return</span>  <span class="i">$Denominator</span> ? <span class="s">(</span><span class="i">$Numerator</span>/<span class="i">$Denominator</span><span class="s">)</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 853 <span class="s">}</span>
 854 
 855 <span class="c"># Calculate SkoalSneath3 similarity coefficient for two same size bit vectors.</span>
 856 <span class="c">#</span>
 857 <span class="c"># This functionality can be either invoked as a class function or an object method.</span>
 858 <span class="c">#</span>
<a name="SkoalSneath3SimilarityCoefficient-"></a> 859 <span class="k">sub </span><span class="m">SkoalSneath3SimilarityCoefficient ($$)</span> <span class="s">{</span>
 860   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 861   <span class="k">my</span><span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="cm">,</span> <span class="i">$Nd</span><span class="cm">,</span> <span class="i">$Nt</span><span class="cm">,</span> <span class="i">$Numerator</span><span class="cm">,</span> <span class="i">$Denominator</span><span class="s">)</span><span class="sc">;</span>
 862 
 863   <span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="s">)</span> = <span class="i">_GetNumOfIndividualAndCommonSetBits</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span><span class="sc">;</span>
 864   <span class="i">$Nd</span> = <span class="i">_GetNumOfCommonClearBits</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span><span class="sc">;</span>
 865   <span class="i">$Nt</span> = <span class="i">$Na</span> + <span class="i">$Nb</span> - <span class="i">$Nc</span> + <span class="i">$Nd</span><span class="sc">;</span>
 866 
 867   <span class="i">$Numerator</span> =  <span class="i">$Nc</span> + <span class="i">$Nd</span><span class="sc">;</span>
 868   <span class="i">$Denominator</span> = <span class="s">(</span><span class="i">$Na</span> - <span class="i">$Nc</span><span class="s">)</span> + <span class="s">(</span><span class="i">$Nb</span> - <span class="i">$Nc</span> <span class="s">)</span> <span class="sc">;</span>
 869 
 870   <span class="k">return</span>  <span class="i">$Denominator</span> ? <span class="s">(</span><span class="i">$Numerator</span>/<span class="i">$Denominator</span><span class="s">)</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 871 <span class="s">}</span>
 872 
 873 <span class="c"># Calculate Tanimoto similarity coefficient for two same size bit vectors.</span>
 874 <span class="c">#</span>
 875 <span class="c"># This functionality can be either invoked as a class function or an object method.</span>
 876 <span class="c">#</span>
<a name="TanimotoSimilarityCoefficient-"></a> 877 <span class="k">sub </span><span class="m">TanimotoSimilarityCoefficient ($$)</span> <span class="s">{</span>
 878   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 879   <span class="k">my</span><span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="cm">,</span> <span class="i">$Numerator</span><span class="cm">,</span> <span class="i">$Denominator</span><span class="s">)</span><span class="sc">;</span>
 880 
 881   <span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="s">)</span> = <span class="i">_GetNumOfIndividualAndCommonSetBits</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span><span class="sc">;</span>
 882 
 883   <span class="i">$Numerator</span> = <span class="i">$Nc</span><span class="sc">;</span>
 884   <span class="i">$Denominator</span> = <span class="i">$Na</span> + <span class="i">$Nb</span> - <span class="i">$Nc</span><span class="sc">;</span>
 885 
 886   <span class="k">return</span>  <span class="i">$Denominator</span> ? <span class="s">(</span><span class="i">$Numerator</span>/<span class="i">$Denominator</span><span class="s">)</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 887 <span class="s">}</span>
 888 
 889 <span class="c"># Calculate Tversky similarity coefficient for two same size bit vectors.</span>
 890 <span class="c">#</span>
 891 <span class="c"># This functionality can be either invoked as a class function or an object method.</span>
 892 <span class="c">#</span>
<a name="TverskySimilarityCoefficient-"></a> 893 <span class="k">sub </span><span class="m">TverskySimilarityCoefficient ($$$)</span> <span class="s">{</span>
 894   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="cm">,</span> <span class="i">$Alpha</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 895   <span class="k">my</span><span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="cm">,</span> <span class="i">$Numerator</span><span class="cm">,</span> <span class="i">$Denominator</span><span class="s">)</span><span class="sc">;</span>
 896 
 897   <span class="k">if</span> <span class="s">(</span>!<span class="s">(</span><span class="k">defined</span><span class="s">(</span><span class="i">$Alpha</span><span class="s">)</span> &amp;&amp; <span class="s">(</span><span class="i">$Alpha</span> &gt;= <span class="n">0</span> &amp;&amp; <span class="i">$Alpha</span> &lt;= <span class="n">1</span><span class="s">)</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 898     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;TverskySimilarityCoefficient: Alpha parameters must be defined and its value must be &gt;=0 and &lt;=1 ...&quot;</span><span class="sc">;</span>
 899   <span class="s">}</span>
 900 
 901   <span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="s">)</span> = <span class="i">_GetNumOfIndividualAndCommonSetBits</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span><span class="sc">;</span>
 902 
 903   <span class="i">$Numerator</span> = <span class="i">$Nc</span><span class="sc">;</span>
 904   <span class="i">$Denominator</span> =  <span class="i">$Alpha</span>*<span class="s">(</span><span class="i">$Na</span> - <span class="i">$Nb</span> <span class="s">)</span>  + <span class="i">$Nb</span><span class="sc">;</span>
 905 
 906   <span class="k">return</span>  <span class="i">$Denominator</span> ? <span class="s">(</span><span class="i">$Numerator</span>/<span class="i">$Denominator</span><span class="s">)</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 907 <span class="s">}</span>
 908 
 909 <span class="c"># Calculate Yule similarity coefficient for two same size bit vectors.</span>
 910 <span class="c">#</span>
 911 <span class="c"># This functionality can be either invoked as a class function or an object method.</span>
 912 <span class="c">#</span>
<a name="YuleSimilarityCoefficient-"></a> 913 <span class="k">sub </span><span class="m">YuleSimilarityCoefficient ($$)</span> <span class="s">{</span>
 914   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 915   <span class="k">my</span><span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="cm">,</span> <span class="i">$Nd</span><span class="cm">,</span> <span class="i">$Nt</span><span class="cm">,</span> <span class="i">$Numerator</span><span class="cm">,</span> <span class="i">$Denominator</span><span class="s">)</span><span class="sc">;</span>
 916 
 917   <span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="s">)</span> = <span class="i">_GetNumOfIndividualAndCommonSetBits</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span><span class="sc">;</span>
 918   <span class="i">$Nd</span> = <span class="i">_GetNumOfCommonClearBits</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span><span class="sc">;</span>
 919   <span class="i">$Nt</span> = <span class="i">$Na</span> + <span class="i">$Nb</span> - <span class="i">$Nc</span> + <span class="i">$Nd</span><span class="sc">;</span>
 920 
 921   <span class="i">$Numerator</span> = <span class="s">(</span><span class="i">$Nc</span>*<span class="i">$Nd</span><span class="s">)</span> - <span class="s">(</span><span class="s">(</span><span class="i">$Na</span> - <span class="i">$Nc</span><span class="s">)</span>*<span class="s">(</span><span class="i">$Nb</span> - <span class="i">$Nc</span><span class="s">)</span><span class="s">)</span> <span class="sc">;</span>
 922   <span class="i">$Denominator</span> = <span class="s">(</span><span class="i">$Nc</span>*<span class="i">$Nd</span><span class="s">)</span> + <span class="s">(</span><span class="s">(</span><span class="i">$Na</span> - <span class="i">$Nc</span><span class="s">)</span>*<span class="s">(</span><span class="i">$Nb</span> - <span class="i">$Nc</span><span class="s">)</span><span class="s">)</span>  <span class="sc">;</span>
 923 
 924   <span class="k">return</span>  <span class="i">$Denominator</span> ? <span class="s">(</span><span class="i">$Numerator</span>/<span class="i">$Denominator</span><span class="s">)</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 925 <span class="s">}</span>
 926 
 927 <span class="c"># Calculate WeightedTanimoto similarity coefficient for two same size bit vectors.</span>
 928 <span class="c">#</span>
 929 <span class="c"># This functionality can be either invoked as a class function or an object method.</span>
 930 <span class="c">#</span>
<a name="WeightedTanimotoSimilarityCoefficient-"></a> 931 <span class="k">sub </span><span class="m">WeightedTanimotoSimilarityCoefficient ($$$)</span> <span class="s">{</span>
 932   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="cm">,</span> <span class="i">$Beta</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 933   <span class="k">my</span><span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="cm">,</span> <span class="i">$TanimotoForSetBits</span><span class="cm">,</span> <span class="i">$TanimotoForClearBits</span><span class="cm">,</span> <span class="i">$Numerator</span><span class="cm">,</span> <span class="i">$Denominator</span><span class="cm">,</span> <span class="i">$WeightedTanimoto</span><span class="s">)</span><span class="sc">;</span>
 934 
 935   <span class="k">if</span> <span class="s">(</span>!<span class="s">(</span><span class="k">defined</span><span class="s">(</span><span class="i">$Beta</span><span class="s">)</span> &amp;&amp; <span class="s">(</span><span class="i">$Beta</span> &gt;= <span class="n">0</span> &amp;&amp; <span class="i">$Beta</span> &lt;= <span class="n">1</span><span class="s">)</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 936     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;WeightedTanimotoSimilarityCoefficient: Beta parameters must be defined and its value must be &gt;=0 and &lt;=1 ...&quot;</span><span class="sc">;</span>
 937   <span class="s">}</span>
 938 
 939   <span class="c"># Get Tanimoto for set bits...</span>
 940   <span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="s">)</span> = <span class="i">_GetNumOfIndividualAndCommonSetBits</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span><span class="sc">;</span>
 941 
 942   <span class="i">$Numerator</span> = <span class="i">$Nc</span><span class="sc">;</span>
 943   <span class="i">$Denominator</span> = <span class="i">$Na</span> + <span class="i">$Nb</span> - <span class="i">$Nc</span><span class="sc">;</span>
 944   <span class="i">$TanimotoForSetBits</span> = <span class="i">$Denominator</span> ? <span class="s">(</span><span class="i">$Numerator</span>/<span class="i">$Denominator</span><span class="s">)</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 945 
 946   <span class="c"># Get Tanimoto for clear bits...</span>
 947   <span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="s">)</span> = <span class="i">_GetNumOfIndividualAndCommonClearBits</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span><span class="sc">;</span>
 948 
 949   <span class="i">$Numerator</span> = <span class="i">$Nc</span><span class="sc">;</span>
 950   <span class="i">$Denominator</span> = <span class="i">$Na</span> + <span class="i">$Nb</span> - <span class="i">$Nc</span><span class="sc">;</span>
 951   <span class="i">$TanimotoForClearBits</span> = <span class="i">$Denominator</span> ? <span class="s">(</span><span class="i">$Numerator</span>/<span class="i">$Denominator</span><span class="s">)</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 952 
 953   <span class="i">$WeightedTanimoto</span> = <span class="i">$Beta</span>*<span class="i">$TanimotoForSetBits</span> + <span class="s">(</span><span class="n">1</span> - <span class="i">$Beta</span><span class="s">)</span>*<span class="i">$TanimotoForClearBits</span><span class="sc">;</span>
 954 
 955   <span class="k">return</span>  <span class="i">$WeightedTanimoto</span><span class="sc">;</span>
 956 <span class="s">}</span>
 957 
 958 <span class="c"># Calculate WeightedTversky similarity coefficient for two same size bit vectors.</span>
 959 <span class="c">#</span>
 960 <span class="c"># This functionality can be either invoked as a class function or an object method.</span>
 961 <span class="c">#</span>
<a name="WeightedTverskySimilarityCoefficient-"></a> 962 <span class="k">sub </span><span class="m">WeightedTverskySimilarityCoefficient ($$$)</span> <span class="s">{</span>
 963   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="cm">,</span> <span class="i">$Alpha</span><span class="cm">,</span> <span class="i">$Beta</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 964   <span class="k">my</span><span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="cm">,</span> <span class="i">$TverskyForSetBits</span><span class="cm">,</span> <span class="i">$TverskyForClearBits</span><span class="cm">,</span> <span class="i">$Numerator</span><span class="cm">,</span> <span class="i">$Denominator</span><span class="cm">,</span> <span class="i">$WeightedTversky</span><span class="s">)</span><span class="sc">;</span>
 965 
 966   <span class="k">if</span> <span class="s">(</span>!<span class="s">(</span><span class="k">defined</span><span class="s">(</span><span class="i">$Alpha</span><span class="s">)</span> &amp;&amp; <span class="s">(</span><span class="i">$Alpha</span> &gt;= <span class="n">0</span> &amp;&amp; <span class="i">$Alpha</span> &lt;= <span class="n">1</span><span class="s">)</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 967     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;WeightedTverskySimilarityCoefficient: Alpha parameters must be defined and its value must be &gt;=0 and &lt;=1 ...&quot;</span><span class="sc">;</span>
 968   <span class="s">}</span>
 969   <span class="k">if</span> <span class="s">(</span>!<span class="s">(</span><span class="k">defined</span><span class="s">(</span><span class="i">$Beta</span><span class="s">)</span> &amp;&amp; <span class="s">(</span><span class="i">$Beta</span> &gt;= <span class="n">0</span> &amp;&amp; <span class="i">$Beta</span> &lt;= <span class="n">1</span><span class="s">)</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 970     <span class="w">croak</span> <span class="q">&quot;Error: ${ClassName}-&gt;WeightedTverskySimilarityCoefficient: Beta parameters must be defined and its value must be &gt;=0 and &lt;=1 ...&quot;</span><span class="sc">;</span>
 971   <span class="s">}</span>
 972 
 973   <span class="c"># Get Tversky for set bits...</span>
 974   <span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="s">)</span> = <span class="i">_GetNumOfIndividualAndCommonSetBits</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span><span class="sc">;</span>
 975 
 976   <span class="i">$Numerator</span> = <span class="i">$Nc</span><span class="sc">;</span>
 977   <span class="i">$Denominator</span> =  <span class="i">$Alpha</span>*<span class="s">(</span><span class="i">$Na</span> - <span class="i">$Nb</span> <span class="s">)</span>  + <span class="i">$Nb</span><span class="sc">;</span>
 978   <span class="i">$TverskyForSetBits</span> =  <span class="i">$Denominator</span> ? <span class="s">(</span><span class="i">$Numerator</span>/<span class="i">$Denominator</span><span class="s">)</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 979 
 980   <span class="c"># Get Tversky for clear bits...</span>
 981   <span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="s">)</span> = <span class="i">_GetNumOfIndividualAndCommonClearBits</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span><span class="sc">;</span>
 982 
 983   <span class="i">$Numerator</span> = <span class="i">$Nc</span><span class="sc">;</span>
 984   <span class="i">$Denominator</span> =  <span class="i">$Alpha</span>*<span class="s">(</span><span class="i">$Na</span> - <span class="i">$Nb</span> <span class="s">)</span>  + <span class="i">$Nb</span><span class="sc">;</span>
 985   <span class="i">$TverskyForClearBits</span> =  <span class="i">$Denominator</span> ? <span class="s">(</span><span class="i">$Numerator</span>/<span class="i">$Denominator</span><span class="s">)</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 986 
 987   <span class="i">$WeightedTversky</span> = <span class="i">$Beta</span>*<span class="i">$TverskyForSetBits</span> + <span class="s">(</span><span class="n">1</span> - <span class="i">$Beta</span><span class="s">)</span>*<span class="i">$TverskyForClearBits</span><span class="sc">;</span>
 988 
 989   <span class="k">return</span>  <span class="i">$WeightedTversky</span><span class="sc">;</span>
 990 <span class="s">}</span>
 991 
 992 <span class="c"># Get number of Na, Nb and Nc bits in bit vector A and B to be used for similarity coefficient calculations...</span>
 993 <span class="c">#</span>
<a name="_GetNumOfIndividualAndCommonSetBits-"></a> 994 <span class="k">sub </span><span class="m">_GetNumOfIndividualAndCommonSetBits ($$)</span> <span class="s">{</span>
 995   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 996   <span class="k">my</span><span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="cm">,</span> <span class="i">$Nd</span><span class="s">)</span><span class="sc">;</span>
 997 
 998   <span class="c"># Number of bits set to &quot;1&quot; in A</span>
 999   <span class="i">$Na</span> = <span class="i">$FingerprintsBitVectorA</span><span class="i">-&gt;GetNumOfSetBits</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1000 
1001   <span class="c"># Number of bits set to &quot;1&quot; in B</span>
1002   <span class="i">$Nb</span> = <span class="i">$FingerprintsBitVectorB</span><span class="i">-&gt;GetNumOfSetBits</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1003 
1004   <span class="c"># Number of bits set to &quot;1&quot; in both A and B</span>
1005   <span class="k">my</span><span class="s">(</span><span class="i">$NcBitVector</span><span class="s">)</span><span class="sc">;</span>
1006   <span class="i">$NcBitVector</span> = <span class="i">$FingerprintsBitVectorA</span> &amp; <span class="i">$FingerprintsBitVectorB</span><span class="sc">;</span>
1007   <span class="i">$Nc</span> = <span class="i">$NcBitVector</span><span class="i">-&gt;GetNumOfSetBits</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1008 
1009   <span class="k">return</span> <span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="s">)</span><span class="sc">;</span>
1010 <span class="s">}</span>
1011 
1012 <span class="c"># Get number of Nd bits in bit vector A and B to be used for similarity coefficient calculations...</span>
1013 <span class="c">#</span>
<a name="_GetNumOfCommonClearBits-"></a>1014 <span class="k">sub </span><span class="m">_GetNumOfCommonClearBits ($$)</span> <span class="s">{</span>
1015   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1016   <span class="k">my</span><span class="s">(</span><span class="i">$Nd</span><span class="cm">,</span> <span class="i">$NdBitVector</span><span class="s">)</span><span class="sc">;</span>
1017 
1018   <span class="c">#  Number of bits set to &quot;0&quot; in both A and B</span>
1019   <span class="i">$NdBitVector</span> = ~<span class="i">$FingerprintsBitVectorA</span> &amp; ~<span class="i">$FingerprintsBitVectorB</span><span class="sc">;</span>
1020   <span class="i">$Nd</span> = <span class="i">$NdBitVector</span><span class="i">-&gt;GetNumOfSetBits</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1021 
1022   <span class="c"># Correct for number of clear bits used for padding...</span>
1023   <span class="k">if</span> <span class="s">(</span><span class="i">_IsNumOfClearBitsCorrectionRequired</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1024     <span class="i">$Nd</span> = <span class="i">$Nd</span> - <span class="i">_GetNumOfClearBitsCorrection</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="s">)</span><span class="sc">;</span>
1025   <span class="s">}</span>
1026   <span class="k">elsif</span> <span class="s">(</span><span class="i">_IsNumOfClearBitsCorrectionRequired</span><span class="s">(</span><span class="i">$FingerprintsBitVectorB</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1027     <span class="i">$Nd</span> = <span class="i">$Nd</span> - <span class="i">_GetNumOfClearBitsCorrection</span><span class="s">(</span><span class="i">$FingerprintsBitVectorB</span><span class="s">)</span><span class="sc">;</span>
1028   <span class="s">}</span>
1029 
1030   <span class="k">return</span> <span class="i">$Nd</span><span class="sc">;</span>
1031 <span class="s">}</span>
1032 
1033 <span class="c"># Get number of Na, Nb and Nc bits in bit vector A and B to be used for similarity coefficient calculations...</span>
1034 <span class="c">#</span>
<a name="_GetNumOfIndividualAndCommonClearBits-"></a>1035 <span class="k">sub </span><span class="m">_GetNumOfIndividualAndCommonClearBits ($$)</span> <span class="s">{</span>
1036   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1037   <span class="k">my</span><span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="cm">,</span> <span class="i">$Nd</span><span class="s">)</span><span class="sc">;</span>
1038 
1039   <span class="c"># Number of bits set to &quot;0&quot; in A</span>
1040   <span class="i">$Na</span> = <span class="i">$FingerprintsBitVectorA</span><span class="i">-&gt;GetNumOfClearBits</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1041 
1042   <span class="c"># Correct for number of clear bits used for padding...</span>
1043   <span class="k">if</span> <span class="s">(</span><span class="i">_IsNumOfClearBitsCorrectionRequired</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1044     <span class="i">$Na</span> = <span class="i">$Na</span> - <span class="i">_GetNumOfClearBitsCorrection</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="s">)</span><span class="sc">;</span>
1045   <span class="s">}</span>
1046 
1047   <span class="c"># Number of bits set to &quot;0&quot; in B</span>
1048   <span class="i">$Nb</span> = <span class="i">$FingerprintsBitVectorB</span><span class="i">-&gt;GetNumOfClearBits</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
1049 
1050   <span class="c"># Correct for number of clear bits used for padding...</span>
1051   <span class="k">if</span> <span class="s">(</span><span class="i">_IsNumOfClearBitsCorrectionRequired</span><span class="s">(</span><span class="i">$FingerprintsBitVectorB</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
1052     <span class="i">$Nb</span> = <span class="i">$Nb</span> - <span class="i">_GetNumOfClearBitsCorrection</span><span class="s">(</span><span class="i">$FingerprintsBitVectorB</span><span class="s">)</span><span class="sc">;</span>
1053   <span class="s">}</span>
1054 
1055   <span class="c"># Number of bits set to &quot;0&quot; in both A and B</span>
1056   <span class="i">$Nc</span> = <span class="i">_GetNumOfCommonClearBits</span><span class="s">(</span><span class="i">$FingerprintsBitVectorA</span><span class="cm">,</span> <span class="i">$FingerprintsBitVectorB</span><span class="s">)</span><span class="sc">;</span>
1057 
1058   <span class="k">return</span> <span class="s">(</span><span class="i">$Na</span><span class="cm">,</span> <span class="i">$Nb</span><span class="cm">,</span> <span class="i">$Nc</span><span class="s">)</span><span class="sc">;</span>
1059 <span class="s">}</span>
1060 
1061 <span class="c"># Irrespective of specified size, Perl functions used to handle bit data data in</span>
1062 <span class="c"># BitVector class automatically sets the size to the next nearest power of 2</span>
1063 <span class="c"># and clear the extra bits.</span>
1064 <span class="c">#</span>
1065 <span class="c"># SpecifiedSize is used by this class to process any aribitray size during similarity</span>
1066 <span class="c"># coefficient calculations.</span>
1067 <span class="c">#</span>
1068 <span class="c"># Assuming the FingerprintsBitBector class only manipulates bits upto specified</span>
1069 <span class="c"># size, a correction for the extra bits added by BitVector class needs to be applied</span>
1070 <span class="c"># to number of clear bits.</span>
1071 <span class="c">#</span>
<a name="_GetNumOfClearBitsCorrection-"></a>1072 <span class="k">sub </span><span class="m">_GetNumOfClearBitsCorrection</span> <span class="s">{</span>
1073   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsBitVector</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1074 
1075   <span class="k">return</span> <span class="s">(</span><span class="i">$FingerprintsBitVector</span>-&gt;{<span class="w">Size</span>} - <span class="i">$FingerprintsBitVector</span>-&gt;{<span class="w">SpecifiedSize</span>}<span class="s">)</span><span class="sc">;</span>
1076 <span class="s">}</span>
1077 
1078 <span class="c"># Is number of clear bits correction required?</span>
1079 <span class="c">#</span>
<a name="_IsNumOfClearBitsCorrectionRequired-"></a>1080 <span class="k">sub </span><span class="m">_IsNumOfClearBitsCorrectionRequired</span> <span class="s">{</span>
1081   <span class="k">my</span><span class="s">(</span><span class="i">$FingerprintsBitVector</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
1082 
1083   <span class="k">return</span> <span class="s">(</span><span class="i">$FingerprintsBitVector</span>-&gt;{<span class="w">Size</span>} &gt; <span class="i">$FingerprintsBitVector</span>-&gt;{<span class="w">SpecifiedSize</span>}<span class="s">)</span> ? <span class="n">1</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
1084 <span class="s">}</span>
1085 
1086 
<a name="EOF-"></a></pre>
<p>&nbsp;</p>
<br />
<center>
<img src="../../../images/h2o2.png">
</center>
</body>
</html>
