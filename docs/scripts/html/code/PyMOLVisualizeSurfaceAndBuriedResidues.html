<html>
<head>
<title>MayaChemTools:Code:PyMOLVisualizeSurfaceAndBuriedResidues.py</title>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<link rel="stylesheet" type="text/css" href="../../../css/MayaChemToolsPythonCode.css">
</head>
<body leftmargin="20" rightmargin="20" topmargin="10" bottommargin="10">
<br/>
<center>
<a href="http://www.mayachemtools.org" title="MayaChemTools Home"><img src="../../../images/MayaChemToolsLogo.gif" border="0" alt="MayaChemTools"></a>
</center>
<br/>
<pre>
    1 <span class="ch">#!/bin/env python</span>
    2 <span class="c1">#</span>
    3 <span class="c1"># File: PyMOLVisualizeSurfaceAndBuriedResidues.py</span>
    4 <span class="c1"># Author: Manish Sud &lt;msud@san.rr.com&gt;</span>
    5 <span class="c1">#</span>
    6 <span class="c1"># Copyright (C) 2020 Manish Sud. All rights reserved.</span>
    7 <span class="c1">#</span>
    8 <span class="c1"># The functionality available in this script is implemented using PyMOL, a</span>
    9 <span class="c1"># molecular visualization system on an open source foundation originally</span>
   10 <span class="c1"># developed by Warren DeLano.</span>
   11 <span class="c1">#</span>
   12 <span class="c1"># This file is part of MayaChemTools.</span>
   13 <span class="c1">#</span>
   14 <span class="c1"># MayaChemTools is free software; you can redistribute it and/or modify it under</span>
   15 <span class="c1"># the terms of the GNU Lesser General Public License as published by the Free</span>
   16 <span class="c1"># Software Foundation; either version 3 of the License, or (at your option) any</span>
   17 <span class="c1"># later version.</span>
   18 <span class="c1">#</span>
   19 <span class="c1"># MayaChemTools is distributed in the hope that it will be useful, but without</span>
   20 <span class="c1"># any warranty; without even the implied warranty of merchantability of fitness</span>
   21 <span class="c1"># for a particular purpose.  See the GNU Lesser General Public License for more</span>
   22 <span class="c1"># details.</span>
   23 <span class="c1">#</span>
   24 <span class="c1"># You should have received a copy of the GNU Lesser General Public License</span>
   25 <span class="c1"># along with MayaChemTools; if not, see &lt;http://www.gnu.org/licenses/&gt; or</span>
   26 <span class="c1"># write to the Free Software Foundation Inc., 59 Temple Place, Suite 330,</span>
   27 <span class="c1"># Boston, MA, 02111-1307, USA.</span>
   28 <span class="c1">#</span>
   29 
   30 <span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
   31 
   32 <span class="c1"># Add local python path to the global path and import standard library modules...</span>
   33 <span class="kn">import</span> <span class="nn">os</span>
   34 <span class="kn">import</span> <span class="nn">sys</span><span class="p">;</span>  <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="s2">&quot;..&quot;</span><span class="p">,</span> <span class="s2">&quot;lib&quot;</span><span class="p">,</span> <span class="s2">&quot;Python&quot;</span><span class="p">))</span>
   35 <span class="kn">import</span> <span class="nn">time</span>
   36 <span class="kn">import</span> <span class="nn">re</span>
   37 
   38 <span class="c1"># PyMOL imports...</span>
   39 <span class="k">try</span><span class="p">:</span>
   40     <span class="kn">import</span> <span class="nn">pymol</span>
   41     <span class="c1"># Finish launching PyMOL in  a command line mode for batch processing (-c)</span>
   42     <span class="c1"># along with the following options:  disable loading of pymolrc and plugins (-k);</span>
   43     <span class="c1"># suppress start up messages (-q)</span>
   44     <span class="n">pymol</span><span class="o">.</span><span class="n">finish_launching</span><span class="p">([</span><span class="s1">&#39;pymol&#39;</span><span class="p">,</span> <span class="s1">&#39;-ckq&#39;</span><span class="p">])</span>
   45 <span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">ErrMsg</span><span class="p">:</span>
   46     <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Failed to import PyMOL module/package: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ErrMsg</span><span class="p">)</span>
   47     <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Check/update your PyMOL environment and try again.</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
   48     <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
   49 
   50 <span class="c1"># MayaChemTools imports...</span>
   51 <span class="k">try</span><span class="p">:</span>
   52     <span class="kn">from</span> <span class="nn">docopt</span> <span class="kn">import</span> <span class="n">docopt</span>
   53     <span class="kn">import</span> <span class="nn">MiscUtil</span>
   54     <span class="kn">import</span> <span class="nn">PyMOLUtil</span>
   55 <span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">ErrMsg</span><span class="p">:</span>
   56     <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Failed to import MayaChemTools module/package: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ErrMsg</span><span class="p">)</span>
   57     <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Check/update your MayaChemTools environment and try again.</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
   58     <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
   59 
   60 <span class="n">ScriptName</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
   61 <span class="n">Options</span> <span class="o">=</span> <span class="p">{}</span>
   62 <span class="n">OptionsInfo</span> <span class="o">=</span> <span class="p">{}</span>
   63 
   64 <span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
   65     <span class="sd">&quot;&quot;&quot;Start execution of the script&quot;&quot;&quot;</span>
   66     
   67     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="s2"> (PyMOL v</span><span class="si">%s</span><span class="s2">; </span><span class="si">%s</span><span class="s2">) Starting...</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ScriptName</span><span class="p">,</span> <span class="n">pymol</span><span class="o">.</span><span class="n">cmd</span><span class="o">.</span><span class="n">get_version</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="n">time</span><span class="o">.</span><span class="n">asctime</span><span class="p">()))</span>
   68     
   69     <span class="p">(</span><span class="n">WallClockTime</span><span class="p">,</span> <span class="n">ProcessorTime</span><span class="p">)</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">GetWallClockAndProcessorTime</span><span class="p">()</span>
   70     
   71     <span class="c1"># Retrieve command line arguments and options...</span>
   72     <span class="n">RetrieveOptions</span><span class="p">()</span>
   73     
   74     <span class="c1"># Process and validate command line arguments and options...</span>
   75     <span class="n">ProcessOptions</span><span class="p">()</span>
   76 
   77     <span class="c1"># Perform actions required by the script...</span>
   78     <span class="n">GenerateSurfaceAndBuriedResiduesVisualization</span><span class="p">()</span>
   79     
   80     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="s2">: Done...</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ScriptName</span><span class="p">)</span>
   81     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Total time: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">GetFormattedElapsedTime</span><span class="p">(</span><span class="n">WallClockTime</span><span class="p">,</span> <span class="n">ProcessorTime</span><span class="p">))</span>
   82 
   83 <span class="k">def</span> <span class="nf">GenerateSurfaceAndBuriedResiduesVisualization</span><span class="p">():</span>
   84     <span class="sd">&quot;&quot;&quot;Generate visualization for surface and buried residues.&quot;&quot;&quot;</span>
   85 
   86     <span class="n">Outfile</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMLOutfile&quot;</span><span class="p">]</span>
   87     <span class="n">OutFH</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">Outfile</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
   88     <span class="k">if</span> <span class="n">OutFH</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
   89         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;Failed to open output fie </span><span class="si">%s</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">Outfile</span><span class="p">)</span>
   90     
   91     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Generating file </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">Outfile</span><span class="p">)</span>
   92 
   93     <span class="c1"># Setup header...</span>
   94     <span class="n">WritePMLHeader</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">ScriptName</span><span class="p">)</span>
   95     <span class="n">WritePyMOLParameters</span><span class="p">(</span><span class="n">OutFH</span><span class="p">)</span>
   96     
   97     <span class="c1"># Load reffile for alignment..</span>
   98     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Align&quot;</span><span class="p">]:</span>
   99         <span class="n">WriteAlignReference</span><span class="p">(</span><span class="n">OutFH</span><span class="p">)</span>
  100 
  101     <span class="c1"># Setup view for each input file...</span>
  102     <span class="n">FirstComplex</span> <span class="o">=</span> <span class="bp">True</span>
  103     <span class="n">FirstComplexFirstChainName</span> <span class="o">=</span> <span class="bp">None</span>
  104     <span class="k">for</span> <span class="n">FileIndex</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">])):</span>
  105         <span class="c1"># Setup PyMOL object names...</span>
  106         <span class="n">PyMOLObjectNames</span> <span class="o">=</span> <span class="n">SetupPyMOLObjectNames</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">)</span>
  107 
  108         <span class="c1"># Setup complex view...</span>
  109         <span class="n">WriteComplexView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">FirstComplex</span><span class="p">)</span>
  110         
  111         <span class="n">SpecifiedChainsAndLigandsInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
  112         <span class="n">FirstChain</span> <span class="o">=</span> <span class="bp">True</span>
  113         <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]:</span>
  114             <span class="k">if</span> <span class="n">FirstComplex</span> <span class="ow">and</span> <span class="n">FirstChain</span><span class="p">:</span>
  115                 <span class="n">FirstComplexFirstChainName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAlone&quot;</span><span class="p">]</span>
  116                 
  117             <span class="n">WriteChainView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
  118             
  119             <span class="c1"># Setup ligand views...</span>
  120             <span class="n">FirstLigand</span> <span class="o">=</span> <span class="bp">True</span>
  121             <span class="k">for</span> <span class="n">LigandID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]:</span>
  122                 <span class="n">WriteChainLigandView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">)</span>
  123                 
  124                 <span class="c1"># Set up ligand level group...</span>
  125                 <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span> <span class="o">=</span> <span class="p">[</span><span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">]</span>
  126                 <span class="k">if</span> <span class="n">FirstLigand</span><span class="p">:</span>
  127                     <span class="n">FirstLigand</span> <span class="o">=</span> <span class="bp">False</span>
  128                     <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span> <span class="o">=</span> <span class="p">[</span><span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;open&quot;</span><span class="p">]</span>
  129                 <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="s2">&quot;ChainLigandGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="s2">&quot;ChainLigandGroupMembers&quot;</span><span class="p">],</span> <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span><span class="p">)</span>
  130             
  131             <span class="c1"># Setup Chain level group...</span>
  132             <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span> <span class="o">=</span> <span class="p">[</span><span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">]</span>
  133             <span class="k">if</span> <span class="n">FirstChain</span><span class="p">:</span>
  134                 <span class="n">FirstChain</span> <span class="o">=</span> <span class="bp">False</span>
  135                 <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span> <span class="o">=</span> <span class="p">[</span><span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;open&quot;</span><span class="p">]</span>
  136             <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroupMembers&quot;</span><span class="p">],</span> <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span><span class="p">)</span>
  137     
  138         <span class="c1"># Set up complex level group...</span>
  139         <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span> <span class="o">=</span> <span class="p">[</span><span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">]</span>
  140         <span class="k">if</span> <span class="n">FirstComplex</span><span class="p">:</span>
  141             <span class="n">FirstComplex</span> <span class="o">=</span> <span class="bp">False</span>
  142             <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span> <span class="o">=</span> <span class="p">[</span><span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;open&quot;</span><span class="p">]</span>
  143         <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;PDBGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;PDBGroupMembers&quot;</span><span class="p">],</span> <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span><span class="p">)</span>
  144         
  145         <span class="c1"># Delete empty PyMOL objects...</span>
  146         <span class="n">DeleteEmptyPyMOLObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">)</span>
  147         
  148     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Align&quot;</span><span class="p">]:</span>
  149         <span class="n">DeleteAlignReference</span><span class="p">(</span><span class="n">OutFH</span><span class="p">)</span>
  150 
  151     <span class="k">if</span> <span class="n">FirstComplexFirstChainName</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
  152         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">cmd.orient(&quot;</span><span class="si">%s</span><span class="s2">&quot;, animate = -1)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">FirstComplexFirstChainName</span><span class="p">)</span>
  153     <span class="k">else</span><span class="p">:</span>
  154         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">cmd.orient(&quot;visible&quot;, animate = -1)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  155     
  156     <span class="n">OutFH</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
  157 
  158     <span class="c1"># Generate PSE file as needed...</span>
  159     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PSEOut&quot;</span><span class="p">]:</span>
  160         <span class="n">GeneratePyMOLSessionFile</span><span class="p">()</span>
  161 
  162 <span class="k">def</span> <span class="nf">WritePMLHeader</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">ScriptName</span><span class="p">):</span>
  163     <span class="sd">&quot;&quot;&quot;Write out PML setting up complex view&quot;&quot;&quot;</span>
  164 
  165     <span class="n">HeaderInfo</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLHeaderInfo</span><span class="p">(</span><span class="n">ScriptName</span><span class="p">)</span>
  166     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">HeaderInfo</span><span class="p">)</span>
  167 
  168 <span class="k">def</span> <span class="nf">WritePyMOLParameters</span><span class="p">(</span><span class="n">OutFH</span><span class="p">):</span>
  169     <span class="sd">&quot;&quot;&quot;Write out PyMOL global parameters. &quot;&quot;&quot;</span>
  170 
  171     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
  172     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;transparency&quot;, </span><span class="si">%.2f</span><span class="s2">, &quot;&quot;, 0)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceTransparency&quot;</span><span class="p">]))</span>
  173     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;label_font_id&quot;, </span><span class="si">%s</span><span class="s2">)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;LabelFontID&quot;</span><span class="p">]))</span>
  174 
  175     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
  176     
  177     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Setting up PyMOL gobal parameters...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  178     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  179     
  180 <span class="k">def</span> <span class="nf">WriteAlignReference</span><span class="p">(</span><span class="n">OutFH</span><span class="p">):</span>
  181     <span class="sd">&quot;&quot;&quot;Setup object for alignment reference &quot;&quot;&quot;</span>
  182 
  183     <span class="n">RefFileInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;RefFileInfo&quot;</span><span class="p">]</span>
  184     <span class="n">RefFile</span> <span class="o">=</span> <span class="n">RefFileInfo</span><span class="p">[</span><span class="s2">&quot;RefFileName&quot;</span><span class="p">]</span>
  185     <span class="n">RefName</span> <span class="o">=</span> <span class="n">RefFileInfo</span><span class="p">[</span><span class="s2">&quot;PyMOLObjectName&quot;</span><span class="p">]</span>
  186     
  187     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
  188     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.load(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">RefFile</span><span class="p">,</span> <span class="n">RefName</span><span class="p">))</span>
  189     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.hide(&quot;everything&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">RefName</span><span class="p">))</span>
  190     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.disable(&quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">RefName</span><span class="p">))</span>
  191     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
  192     
  193     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Loading </span><span class="si">%s</span><span class="s2"> and setting up view for align reference...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">RefFile</span><span class="p">)</span>
  194     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  195     
  196 <span class="k">def</span> <span class="nf">WriteAlignComplex</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">):</span>
  197     <span class="sd">&quot;&quot;&quot;Setup alignment of complex to reference&quot;&quot;&quot;</span>
  198 
  199     <span class="n">RefFileInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;RefFileInfo&quot;</span><span class="p">]</span>
  200     <span class="n">RefName</span> <span class="o">=</span> <span class="n">RefFileInfo</span><span class="p">[</span><span class="s2">&quot;PyMOLObjectName&quot;</span><span class="p">]</span>
  201     
  202     <span class="n">ComplexName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Complex&quot;</span><span class="p">]</span>
  203     
  204     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^FirstChain$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AlignMode&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  205         <span class="n">RefFirstChainID</span> <span class="o">=</span> <span class="n">RefFileInfo</span><span class="p">[</span><span class="s2">&quot;ChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
  206         <span class="n">RefAlignSelection</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">RefName</span><span class="p">,</span> <span class="n">RefFirstChainID</span><span class="p">)</span>
  207         
  208         <span class="n">ComplexFirstChainID</span> <span class="o">=</span> <span class="n">RetrieveFirstChainID</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">)</span>
  209         <span class="n">ComplexAlignSelection</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ComplexName</span><span class="p">,</span> <span class="n">ComplexFirstChainID</span><span class="p">)</span>
  210     <span class="k">else</span><span class="p">:</span>
  211         <span class="n">RefAlignSelection</span> <span class="o">=</span> <span class="n">RefName</span>
  212         <span class="n">ComplexAlignSelection</span> <span class="o">=</span> <span class="n">ComplexName</span>
  213 
  214     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForAlignment</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AlignMethod&quot;</span><span class="p">],</span> <span class="n">RefAlignSelection</span><span class="p">,</span> <span class="n">ComplexAlignSelection</span><span class="p">)</span>
  215     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Aligning </span><span class="si">%s</span><span class="s2"> against reference </span><span class="si">%s</span><span class="s2"> ...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ComplexAlignSelection</span><span class="p">,</span> <span class="n">RefAlignSelection</span><span class="p">))</span>
  216     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  217     
  218 <span class="k">def</span> <span class="nf">DeleteAlignReference</span><span class="p">(</span><span class="n">OutFH</span><span class="p">):</span>
  219     <span class="sd">&quot;&quot;&quot;Delete alignment reference object.&quot;&quot;&quot;</span>
  220     
  221     <span class="n">RefName</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;RefFileInfo&quot;</span><span class="p">][</span><span class="s2">&quot;PyMOLObjectName&quot;</span><span class="p">]</span>
  222     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Deleting alignment reference object </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">RefName</span><span class="p">)</span>
  223     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.delete(&quot;</span><span class="si">%s</span><span class="s2">&quot;)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">RefName</span><span class="p">)</span>
  224 
  225 <span class="k">def</span> <span class="nf">WriteComplexView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">FirstComplex</span><span class="p">):</span>
  226     <span class="sd">&quot;&quot;&quot;Write out PML for viewing polymer complex.&quot;&quot;&quot;</span>
  227 
  228     <span class="c1"># Setup complex...</span>
  229     <span class="n">Infile</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
  230     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForPolymerComplexView</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Complex&quot;</span><span class="p">],</span> <span class="n">Infile</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
  231     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Loading </span><span class="si">%s</span><span class="s2"> and setting up view for complex...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">Infile</span><span class="p">)</span>
  232     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  233 
  234     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Align&quot;</span><span class="p">]:</span>
  235         <span class="c1"># No need to align complex on to itself...</span>
  236         <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^FirstInputFile$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AlignRefFile&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="ow">and</span> <span class="n">FirstComplex</span><span class="p">):</span>
  237             <span class="n">WriteAlignComplex</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">)</span>
  238     
  239     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceComplex&quot;</span><span class="p">]:</span>
  240         <span class="c1"># Setup hydrophobic surface...</span>
  241         <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForHydrophobicSurfaceView</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexHydrophobicSurface&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Complex&quot;</span><span class="p">],</span> <span class="n">ColorPalette</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceColorPalette&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
  242         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  243     
  244     <span class="c1"># Setup complex group...</span>
  245     <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexGroupMembers&quot;</span><span class="p">],</span> <span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  246 
  247 <span class="k">def</span> <span class="nf">WriteChainView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  248     <span class="sd">&quot;&quot;&quot;Write out PML for viewing chain.&quot;&quot;&quot;</span>
  249     
  250     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Setting up views for chain </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">ChainID</span><span class="p">)</span>
  251     
  252     <span class="n">ChainComplexName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplex&quot;</span><span class="p">]</span>
  253     
  254     <span class="c1"># Setup chain complex group view...</span>
  255     <span class="n">WriteChainComplexViews</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
  256 
  257     <span class="c1"># Setup chain view...</span>
  258     <span class="n">WriteChainAloneViews</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
  259     
  260     <span class="c1"># Setup chain solvent view...</span>
  261     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForSolventView</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;Solvent&quot;</span><span class="p">],</span> <span class="n">ChainComplexName</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
  262     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  263 
  264     <span class="c1"># Setup chain inorganic view...</span>
  265     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForInorganicView</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;Inorganic&quot;</span><span class="p">],</span> <span class="n">ChainComplexName</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
  266     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  267 
  268 <span class="k">def</span> <span class="nf">WriteChainComplexViews</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  269     <span class="sd">&quot;&quot;&quot;Write chain complex views. &quot;&quot;&quot;</span>
  270     
  271     <span class="c1"># Setup chain complex...</span>
  272     <span class="n">ChainComplexName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplex&quot;</span><span class="p">]</span>
  273     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForPolymerChainComplexView</span><span class="p">(</span><span class="n">ChainComplexName</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Complex&quot;</span><span class="p">],</span> <span class="n">ChainID</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
  274     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  275 
  276     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChainComplex&quot;</span><span class="p">]:</span>
  277         <span class="c1"># Setup hydrophobic surface...</span>
  278         <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForHydrophobicSurfaceView</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexHydrophobicSurface&quot;</span><span class="p">],</span> <span class="n">ChainComplexName</span><span class="p">,</span> <span class="n">ColorPalette</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceColorPalette&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
  279         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  280     
  281     <span class="c1"># Setup chain complex group...</span>
  282     <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexGroupMembers&quot;</span><span class="p">],</span> <span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  283     
  284 <span class="k">def</span> <span class="nf">WriteChainAloneViews</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  285     <span class="sd">&quot;&quot;&quot;Write individual chain views. &quot;&quot;&quot;</span>
  286 
  287     <span class="n">ChainComplexName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplex&quot;</span><span class="p">]</span>
  288     
  289     <span class="c1"># Setup a chain view...</span>
  290     <span class="n">ChainName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAlone&quot;</span><span class="p">]</span>
  291     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForPolymerChainView</span><span class="p">(</span><span class="n">ChainName</span><span class="p">,</span> <span class="n">ChainComplexName</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
  292     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  293 
  294     <span class="n">ChainAloneGroupID</span> <span class="o">=</span> <span class="s2">&quot;ChainAloneGroup&quot;</span>
  295     <span class="n">ChainAloneGroupName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneGroup&quot;</span><span class="p">]</span>
  296     
  297     <span class="k">for</span> <span class="n">GroupType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Surface_Residues&quot;</span><span class="p">,</span> <span class="s2">&quot;Buried_Residues&quot;</span><span class="p">]:</span>
  298         <span class="n">GroupID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">GroupType</span><span class="p">)</span>
  299         
  300         <span class="n">ResiduesGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainAloneGroupID</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">)</span>
  301         <span class="n">ResiduesGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Members&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupID</span><span class="p">)</span>
  302 
  303         <span class="c1"># Setup a chain view using residues selection...</span>
  304         <span class="n">ResiduesChainNameID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Chain&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupID</span><span class="p">)</span>
  305         <span class="n">ResiduesChainName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesChainNameID</span><span class="p">]</span>
  306         <span class="n">ChainResiduesSelection</span> <span class="o">=</span> <span class="n">GetChainResiduesSelection</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">GroupType</span><span class="p">)</span>
  307 
  308         <span class="n">Selection</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2"> and polymer and (</span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainComplexName</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">ChainResiduesSelection</span><span class="p">)</span>
  309         <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForSelectionDisplayView</span><span class="p">(</span><span class="n">ResiduesChainName</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="s2">&quot;cartoon&quot;</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
  310         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  311 
  312         <span class="n">WriteChainAloneResiduesGroupResiduesTypesView</span><span class="p">(</span><span class="n">GroupType</span><span class="p">,</span> <span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">ResiduesGroupID</span><span class="p">)</span>
  313         <span class="n">WriteChainAloneResiduesGroupResiduesSurfacesView</span><span class="p">(</span><span class="n">GroupType</span><span class="p">,</span> <span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">ResiduesGroupID</span><span class="p">)</span>
  314 
  315         <span class="c1"># Setup residues group...</span>
  316         <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesGroupID</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesGroupMembersID</span><span class="p">],</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;open&quot;</span><span class="p">)</span>
  317 
  318     <span class="c1"># Setup chain group...</span>
  319     <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneGroupMembers&quot;</span><span class="p">],</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;open&quot;</span><span class="p">)</span>
  320     
  321 <span class="k">def</span> <span class="nf">WriteChainLigandView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">):</span>
  322     <span class="sd">&quot;&quot;&quot;Write out PML for viewing ligand in a chain.&quot;&quot;&quot;</span>
  323 
  324     <span class="n">GroupID</span> <span class="o">=</span> <span class="s2">&quot;Ligand&quot;</span>
  325     <span class="n">ComplexName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplex&quot;</span><span class="p">]</span>
  326     <span class="n">LigandName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="s2">&quot;Ligand&quot;</span><span class="p">]</span>
  327     
  328     <span class="c1"># Setup main object...</span>
  329     <span class="n">GroupTypeObjectID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  330     <span class="n">GroupTypeObjectName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupTypeObjectID</span><span class="p">]</span>
  331     
  332     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Setting up views for ligand </span><span class="si">%s</span><span class="s2"> in chain </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">LigandID</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">))</span>
  333     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForLigandView</span><span class="p">(</span><span class="n">GroupTypeObjectName</span><span class="p">,</span> <span class="n">ComplexName</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
  334     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  335     
  336     <span class="c1"># Setup ball and stick view...</span>
  337     <span class="n">BallAndStickNameID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">BallAndStick&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  338     <span class="n">BallAndStickName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">BallAndStickNameID</span><span class="p">]</span>
  339     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForBallAndStickView</span><span class="p">(</span><span class="n">BallAndStickName</span><span class="p">,</span> <span class="n">GroupTypeObjectName</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
  340     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  341             
  342     <span class="c1"># Setup group....</span>
  343     <span class="n">GroupNameID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  344     <span class="n">GroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">GroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  345     <span class="n">GroupName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupNameID</span><span class="p">]</span>
  346     <span class="n">GroupMembers</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupMembersID</span><span class="p">]</span>
  347 
  348     <span class="n">Action</span> <span class="o">=</span> <span class="s2">&quot;close&quot;</span>
  349     <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span>
  350     <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">GroupName</span><span class="p">,</span> <span class="n">GroupMembers</span><span class="p">,</span> <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span><span class="p">)</span>
  351 
  352 <span class="k">def</span> <span class="nf">GetChainResiduesSelection</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">GroupType</span><span class="p">):</span>
  353     <span class="sd">&quot;&quot;&quot;Get residue selection for surface or buried residues for a chain&quot;&quot;&quot;</span>
  354     
  355     <span class="n">SpecifiedChainsAndLigandsInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
  356     <span class="n">ResiduesSelection</span> <span class="o">=</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceResiduesSelection&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Surface_Residues$&quot;</span><span class="p">,</span> <span class="n">GroupType</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;BuriedResiduesSelection&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
  357     
  358     <span class="k">return</span> <span class="n">ResiduesSelection</span>
  359 
  360 <span class="k">def</span> <span class="nf">WriteChainAloneResiduesGroupResiduesTypesView</span><span class="p">(</span><span class="n">GroupType</span><span class="p">,</span> <span class="n">OutFH</span><span class="p">,</span>  <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">MainGroupID</span><span class="p">):</span>
  361     <span class="sd">&quot;&quot;&quot;Write out PML for viewing residue types for surface or buried residues in a chain. &quot;&quot;&quot;</span>
  362 
  363     <span class="k">if</span> <span class="ow">not</span> <span class="n">GetChainAloneResidueTypesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  364         <span class="k">return</span>
  365     
  366     <span class="n">NameID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Chain&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MainGroupID</span><span class="p">)</span>
  367     <span class="n">ChainName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">NameID</span><span class="p">]</span>
  368     
  369     <span class="n">ResiduesGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">ResiduesGroup&quot;</span> <span class="o">%</span> <span class="n">MainGroupID</span>
  370     <span class="n">ResiduesGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Members&quot;</span> <span class="o">%</span> <span class="n">ResiduesGroupID</span>
  371     
  372     <span class="c1"># Setup residue types objects...</span>
  373     <span class="k">for</span> <span class="n">SubGroupType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Aromatic&quot;</span><span class="p">,</span> <span class="s2">&quot;Hydrophobic&quot;</span><span class="p">,</span> <span class="s2">&quot;Polar&quot;</span><span class="p">,</span> <span class="s2">&quot;Positively_Charged&quot;</span><span class="p">,</span> <span class="s2">&quot;Negatively_Charged&quot;</span><span class="p">,</span> <span class="s2">&quot;Other&quot;</span><span class="p">]:</span>
  374         <span class="n">SubGroupID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">SubGroupType</span><span class="p">)</span>
  375 
  376         <span class="n">ResiduesSubGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupID</span><span class="p">,</span> <span class="n">SubGroupID</span><span class="p">)</span>
  377         <span class="n">ResiduesSubGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Members&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesSubGroupID</span><span class="p">)</span>
  378 
  379         <span class="n">ResiduesObjectID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Residues&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesSubGroupID</span><span class="p">)</span>
  380         <span class="n">ResiduesObjectName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesObjectID</span><span class="p">]</span>
  381         
  382         <span class="n">ResiduesSurfaceObjectID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Surface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesSubGroupID</span><span class="p">)</span>
  383         <span class="n">ResiduesSurfaceObjectName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesSurfaceObjectID</span><span class="p">]</span>
  384 
  385         <span class="n">ResiduesColor</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesParams&quot;</span><span class="p">][</span><span class="n">SubGroupType</span><span class="p">][</span><span class="s2">&quot;Color&quot;</span><span class="p">]</span> 
  386         <span class="n">ResiduesNames</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesParams&quot;</span><span class="p">][</span><span class="n">SubGroupType</span><span class="p">][</span><span class="s2">&quot;Residues&quot;</span><span class="p">]</span>
  387 
  388         <span class="n">NegateResidueNames</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Other$&quot;</span><span class="p">,</span> <span class="n">SubGroupType</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
  389         <span class="n">WriteResidueTypesResiduesAndSurfaceView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">ResiduesObjectName</span><span class="p">,</span> <span class="n">ResiduesSurfaceObjectName</span><span class="p">,</span> <span class="n">ResiduesColor</span><span class="p">,</span> <span class="n">ResiduesNames</span><span class="p">,</span> <span class="n">NegateResidueNames</span><span class="p">)</span>
  390 
  391         <span class="c1"># Setup sub groups for residue types..</span>
  392         <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesSubGroupID</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesSubGroupMembersID</span><span class="p">],</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  393         
  394     <span class="c1"># Setup residues group...</span>
  395     <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesGroupID</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesGroupMembersID</span><span class="p">],</span> <span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  396 
  397 <span class="k">def</span> <span class="nf">WriteResidueTypesResiduesAndSurfaceView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">SelectionObjectName</span><span class="p">,</span> <span class="n">Name</span><span class="p">,</span> <span class="n">SurfaceName</span><span class="p">,</span> <span class="n">ResiduesColor</span><span class="p">,</span> <span class="n">ResiduesNames</span><span class="p">,</span> <span class="n">NegateResidueNames</span><span class="p">):</span>
  398     <span class="sd">&quot;&quot;&quot;Write residue types residues and surface view. &quot;&quot;&quot;</span>
  399 
  400     <span class="n">ResidueNamesSelection</span> <span class="o">=</span> <span class="s2">&quot;+&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ResiduesNames</span><span class="p">)</span>
  401     <span class="k">if</span> <span class="n">NegateResidueNames</span><span class="p">:</span>
  402         <span class="n">Selection</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> and (not resn </span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionObjectName</span><span class="p">,</span> <span class="n">ResidueNamesSelection</span><span class="p">)</span>
  403     <span class="k">else</span><span class="p">:</span>
  404         <span class="n">Selection</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> and (resn </span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionObjectName</span><span class="p">,</span> <span class="n">ResidueNamesSelection</span><span class="p">)</span>
  405 
  406     <span class="c1"># Setup residues...</span>
  407     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForSelectionDisplayView</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="s2">&quot;lines&quot;</span><span class="p">,</span> <span class="n">ResiduesColor</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
  408     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  409 
  410     <span class="c1"># Setup surface...</span>
  411     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForSelectionDisplayView</span><span class="p">(</span><span class="n">SurfaceName</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="s2">&quot;surface&quot;</span><span class="p">,</span> <span class="n">ResiduesColor</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
  412     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  413     
  414 <span class="k">def</span> <span class="nf">WriteChainAloneResiduesGroupResiduesSurfacesView</span><span class="p">(</span><span class="n">GroupType</span><span class="p">,</span> <span class="n">OutFH</span><span class="p">,</span>  <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">MainGroupID</span><span class="p">):</span>
  415     <span class="sd">&quot;&quot;&quot;Write out PML for viewing surfaces for surface and buried residues in chains. &quot;&quot;&quot;</span>
  416 
  417     <span class="k">if</span> <span class="ow">not</span> <span class="n">GetChainAloneContainsSurfacesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  418         <span class="k">return</span>
  419     
  420     <span class="n">NameID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Chain&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MainGroupID</span><span class="p">)</span>
  421     <span class="n">ChainName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">NameID</span><span class="p">]</span>
  422     
  423     <span class="n">SurfacesGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">SurfaceGroup&quot;</span> <span class="o">%</span> <span class="n">MainGroupID</span>
  424     <span class="n">SurfacesGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Members&quot;</span> <span class="o">%</span> <span class="n">SurfacesGroupID</span>
  425 
  426     <span class="n">ProcessingBuriedResidues</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Buried_Residues$&quot;</span><span class="p">,</span> <span class="n">GroupType</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
  427     
  428     <span class="c1"># Setup a generic color surface...</span>
  429     <span class="n">SurfaceID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Surface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfacesGroupID</span><span class="p">)</span>
  430     <span class="n">SurfaceName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SurfaceID</span><span class="p">]</span>
  431     <span class="n">ColorName</span> <span class="o">=</span>  <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceBuriedResiduesColor&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="n">ProcessingBuriedResidues</span> <span class="k">else</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceColor&quot;</span><span class="p">]</span>
  432     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForSurfaceView</span><span class="p">(</span><span class="n">SurfaceName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span>  <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">DisplayAs</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Color</span> <span class="o">=</span> <span class="n">ColorName</span><span class="p">)</span>
  433     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  434     
  435     <span class="k">if</span> <span class="n">GetChainAloneSurfaceChainStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  436         <span class="c1"># Setup surface colored by hydrophobicity...</span>
  437         <span class="n">HydrophobicSurfaceID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">HydrophobicSurface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfacesGroupID</span><span class="p">)</span>
  438         <span class="n">HydrophobicSurfaceName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">HydrophobicSurfaceID</span><span class="p">]</span>
  439         <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForHydrophobicSurfaceView</span><span class="p">(</span><span class="n">HydrophobicSurfaceName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">ColorPalette</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceColorPalette&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">DisplayAs</span> <span class="o">=</span> <span class="bp">None</span><span class="p">)</span>
  440         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  441         
  442         <span class="c1"># Setup surface colored by hyrdophobicity and charge...</span>
  443         <span class="n">HydrophobicChargeSurfaceID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">HydrophobicChargeSurface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfacesGroupID</span><span class="p">)</span>
  444         <span class="n">HydrophobicChargeSurfaceName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">HydrophobicChargeSurfaceID</span><span class="p">]</span>
  445         <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForHydrophobicAndChargeSurfaceView</span><span class="p">(</span><span class="n">HydrophobicChargeSurfaceName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AtomTypesColorNames&quot;</span><span class="p">][</span><span class="s2">&quot;HydrophobicAtomsColor&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AtomTypesColorNames&quot;</span><span class="p">][</span><span class="s2">&quot;NegativelyChargedAtomsColor&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AtomTypesColorNames&quot;</span><span class="p">][</span><span class="s2">&quot;PositivelyChargedAtomsColor&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AtomTypesColorNames&quot;</span><span class="p">][</span><span class="s2">&quot;OtherAtomsColor&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">DisplayAs</span> <span class="o">=</span> <span class="bp">None</span><span class="p">)</span>
  446         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  447     
  448         <span class="k">if</span> <span class="n">GetChainAloneSurfaceChainElectrostaticsStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  449             <span class="c1"># Setup electrostatics surface...</span>
  450             <span class="n">ElectrostaticsGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">ElectrostaticsGroup&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfacesGroupID</span><span class="p">)</span>
  451             <span class="n">ElectrostaticsGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Members&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ElectrostaticsGroupID</span><span class="p">)</span>
  452             <span class="n">ElectrostaticsGroupName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ElectrostaticsGroupID</span><span class="p">]</span>
  453             <span class="n">ElectrostaticsGroupMembers</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ElectrostaticsGroupMembersID</span><span class="p">]</span>
  454             <span class="n">WriteSurfaceElectrostaticsView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">ElectrostaticsGroupName</span><span class="p">,</span> <span class="n">ElectrostaticsGroupMembers</span><span class="p">,</span> <span class="n">DisplayAs</span> <span class="o">=</span> <span class="bp">None</span><span class="p">)</span>
  455 
  456     <span class="c1"># Setup surafces group...</span>
  457     <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SurfacesGroupID</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SurfacesGroupMembersID</span><span class="p">],</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  458     
  459 <span class="k">def</span> <span class="nf">WriteSurfaceElectrostaticsView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">SelectionObjectName</span><span class="p">,</span> <span class="n">ElectrostaticsGroupName</span><span class="p">,</span> <span class="n">ElectrostaticsGroupMembers</span><span class="p">,</span> <span class="n">DisplayAs</span> <span class="o">=</span> <span class="s2">&quot;lines&quot;</span><span class="p">):</span>
  460     <span class="sd">&quot;&quot;&quot;Write out PML for viewing surface electrostatics. &quot;&quot;&quot;</span>
  461 
  462     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ElectrostaticsGroupMembers</span><span class="p">)</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
  463         <span class="n">Name</span><span class="p">,</span> <span class="n">ContactPotentialName</span><span class="p">,</span> <span class="n">MapName</span><span class="p">,</span> <span class="n">LegendName</span><span class="p">,</span> <span class="n">VolumeName</span> <span class="o">=</span> <span class="n">ElectrostaticsGroupMembers</span>
  464     <span class="k">else</span><span class="p">:</span>
  465         <span class="n">Name</span><span class="p">,</span> <span class="n">ContactPotentialName</span><span class="p">,</span> <span class="n">MapName</span><span class="p">,</span> <span class="n">LegendName</span> <span class="o">=</span> <span class="n">ElectrostaticsGroupMembers</span>
  466         <span class="n">VolumeName</span> <span class="o">=</span> <span class="bp">None</span>
  467 
  468     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
  469 
  470     <span class="c1"># Setup chain...</span>
  471     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.create(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;(</span><span class="si">%s</span><span class="s2">)&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">SelectionObjectName</span><span class="p">))</span>
  472 
  473     <span class="c1"># Setup vacuum electrostatics surface along with associated objects...</span>
  474     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;util.protein_vacuum_esp(&quot;</span><span class="si">%s</span><span class="s2">&quot;, mode=2, quiet=0, _self=cmd)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
  475     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set_name(&quot;</span><span class="si">%s</span><span class="s2">_e_chg&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">ContactPotentialName</span><span class="p">))</span>
  476     
  477     <span class="k">if</span> <span class="n">DisplayAs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
  478         <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.show(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;(</span><span class="si">%s</span><span class="s2">)&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">DisplayAs</span><span class="p">,</span> <span class="n">ContactPotentialName</span><span class="p">))</span>
  479 
  480     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">ContactPotentialName</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">))</span>
  481     
  482     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set_name(&quot;</span><span class="si">%s</span><span class="s2">_e_map&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">MapName</span><span class="p">))</span>
  483     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">MapName</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">))</span>
  484     
  485     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set_name(&quot;</span><span class="si">%s</span><span class="s2">_e_pot&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">LegendName</span><span class="p">))</span>
  486     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">LegendName</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">))</span>
  487 
  488     <span class="k">if</span> <span class="n">VolumeName</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
  489         <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.volume(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;(</span><span class="si">%s</span><span class="s2">)&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">VolumeName</span><span class="p">,</span> <span class="n">MapName</span><span class="p">,</span> <span class="s2">&quot;esp&quot;</span><span class="p">,</span> <span class="n">Name</span><span class="p">))</span>
  490         <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">VolumeName</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">))</span>
  491     
  492     <span class="c1"># Delete name and take it out from the group membership. It is</span>
  493     <span class="c1"># is already part of ContactPotential object.</span>
  494     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.delete(&quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
  495     <span class="n">ElectrostaticsGroupMembers</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
  496     
  497     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
  498     
  499     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  500     
  501     <span class="c1"># Setup group...</span>
  502     <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">ElectrostaticsGroupName</span><span class="p">,</span> <span class="n">ElectrostaticsGroupMembers</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  503 
  504 <span class="k">def</span> <span class="nf">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">GroupName</span><span class="p">,</span> <span class="n">GroupMembers</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">Action</span> <span class="o">=</span> <span class="s2">&quot;close&quot;</span><span class="p">):</span>
  505     <span class="sd">&quot;&quot;&quot;Generate and write PML for group. &quot;&quot;&quot;</span>
  506     
  507     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForGroup</span><span class="p">(</span><span class="n">GroupName</span><span class="p">,</span> <span class="n">GroupMembers</span><span class="p">,</span> <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span><span class="p">)</span>
  508     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Setting up group </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">GroupName</span><span class="p">)</span>
  509     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  510 
  511 <span class="k">def</span> <span class="nf">GeneratePyMOLSessionFile</span><span class="p">():</span>
  512     <span class="sd">&quot;&quot;&quot;Generate PME file from PML file. &quot;&quot;&quot;</span>
  513 
  514     <span class="n">PSEOutfile</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PSEOutfile&quot;</span><span class="p">]</span>
  515     <span class="n">PMLOutfile</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMLOutfile&quot;</span><span class="p">]</span>
  516     
  517     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Generating file </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">PSEOutfile</span><span class="p">)</span>
  518     
  519     <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">ConvertPMLFileToPSEFile</span><span class="p">(</span><span class="n">PMLOutfile</span><span class="p">,</span> <span class="n">PSEOutfile</span><span class="p">)</span>
  520     
  521     <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">PSEOutfile</span><span class="p">):</span>
  522         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;Failed to generate PSE file, </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">PSEOutfile</span><span class="p">))</span>
  523     
  524     <span class="k">if</span> <span class="ow">not</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMLOut&quot;</span><span class="p">]:</span>
  525         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Deleting file </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">PMLOutfile</span><span class="p">)</span>
  526         <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">PMLOutfile</span><span class="p">)</span>
  527 
  528 <span class="k">def</span> <span class="nf">DeleteEmptyPyMOLObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">):</span>
  529     <span class="sd">&quot;&quot;&quot;Delete empty PyMOL objects. &quot;&quot;&quot;</span>
  530     
  531     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AllowEmptyObjects&quot;</span><span class="p">]:</span>
  532         <span class="k">return</span>
  533 
  534     <span class="n">SpecifiedChainsAndLigandsInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
  535     <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]:</span>
  536         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Checking and deleting empty objects for chain </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainID</span><span class="p">))</span>
  537         
  538         <span class="c1"># Delete any chain level objects...</span>
  539         <span class="n">WritePMLToCheckAndDeleteEmptyObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;Solvent&quot;</span><span class="p">])</span>
  540         <span class="n">WritePMLToCheckAndDeleteEmptyObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;Inorganic&quot;</span><span class="p">])</span>
  541 
  542         <span class="c1"># Delete any chain alone level objects</span>
  543         <span class="n">ChainAloneGroupID</span> <span class="o">=</span> <span class="s2">&quot;ChainAloneGroup&quot;</span>
  544         
  545         <span class="k">for</span> <span class="n">GroupType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Surface_Residues&quot;</span><span class="p">,</span> <span class="s2">&quot;Buried_Residues&quot;</span><span class="p">]:</span>
  546             <span class="n">GroupID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">GroupType</span><span class="p">)</span>
  547             <span class="n">ResiduesGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainAloneGroupID</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">)</span>
  548 
  549             <span class="c1"># Delete empty chain object...</span>
  550             <span class="n">ResiduesChainNameID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Chain&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupID</span><span class="p">)</span>
  551             <span class="n">WritePMLToCheckAndDeleteEmptyObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesChainNameID</span><span class="p">])</span>
  552             
  553             <span class="c1"># Delete empty residue type objects...</span>
  554             <span class="n">DeleteEmptyChainAloneResiduesGroupResiduesTypesObjects</span><span class="p">(</span><span class="n">GroupType</span><span class="p">,</span> <span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">ResiduesGroupID</span><span class="p">)</span>
  555 
  556             <span class="c1"># Delete empty surface objects...</span>
  557             <span class="n">DeleteEmptyAloneResiduesGroupResiduesSurfacesObjects</span><span class="p">(</span><span class="n">GroupType</span><span class="p">,</span> <span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">ResiduesGroupID</span><span class="p">)</span>
  558 
  559 <span class="k">def</span> <span class="nf">DeleteEmptyChainAloneResiduesGroupResiduesTypesObjects</span><span class="p">(</span><span class="n">GroupType</span><span class="p">,</span> <span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">MainGroupID</span><span class="p">):</span>
  560     <span class="sd">&quot;&quot;&quot;Delete empty residue type objects for surface or buried residues in a chain.&quot;&quot;&quot;</span>
  561     
  562     <span class="k">if</span> <span class="ow">not</span> <span class="n">GetChainAloneResidueTypesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  563         <span class="k">return</span>
  564 
  565     <span class="n">ResiduesGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">ResiduesGroup&quot;</span> <span class="o">%</span> <span class="n">MainGroupID</span>
  566     <span class="k">for</span> <span class="n">SubGroupType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Aromatic&quot;</span><span class="p">,</span> <span class="s2">&quot;Hydrophobic&quot;</span><span class="p">,</span> <span class="s2">&quot;Polar&quot;</span><span class="p">,</span> <span class="s2">&quot;Positively_Charged&quot;</span><span class="p">,</span> <span class="s2">&quot;Negatively_Charged&quot;</span><span class="p">,</span> <span class="s2">&quot;Other&quot;</span><span class="p">]:</span>
  567         <span class="n">SubGroupID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">SubGroupType</span><span class="p">)</span>
  568         
  569         <span class="n">ResiduesSubGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupID</span><span class="p">,</span> <span class="n">SubGroupID</span><span class="p">)</span>
  570         <span class="n">SubGroupName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesSubGroupID</span><span class="p">]</span>
  571         
  572         <span class="n">SubGroupObjectNamesList</span> <span class="o">=</span> <span class="p">[]</span>
  573         
  574         <span class="n">ResiduesObjectID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Residues&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesSubGroupID</span><span class="p">)</span>
  575         <span class="n">ResiduesObjectName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesObjectID</span><span class="p">]</span>
  576         <span class="n">SubGroupObjectNamesList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ResiduesObjectName</span><span class="p">)</span>
  577         
  578         <span class="n">ResiduesSurfaceObjectID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Surface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesSubGroupID</span><span class="p">)</span>
  579         <span class="n">ResiduesSurfaceObjectName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesSurfaceObjectID</span><span class="p">]</span>
  580         <span class="n">SubGroupObjectNamesList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ResiduesSurfaceObjectName</span><span class="p">)</span>
  581         
  582         <span class="n">SubGroupObjectNames</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">SubGroupObjectNamesList</span><span class="p">)</span>
  583         <span class="n">WritePMLToCheckAndDeleteEmptyObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">SubGroupObjectNames</span><span class="p">,</span> <span class="n">SubGroupName</span><span class="p">)</span>
  584 
  585     <span class="c1"># Delete residues group object...</span>
  586     <span class="n">DeleteResiduesGroup</span> <span class="o">=</span> <span class="bp">False</span> <span class="k">if</span> <span class="n">AreGroupTypeResiduesPresent</span><span class="p">(</span><span class="n">GroupType</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span> <span class="k">else</span> <span class="bp">True</span>
  587     <span class="k">if</span> <span class="n">DeleteResiduesGroup</span><span class="p">:</span>
  588         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.delete(&quot;</span><span class="si">%s</span><span class="s2">&quot;)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesGroupID</span><span class="p">])</span>
  589 
  590 <span class="k">def</span> <span class="nf">DeleteEmptyAloneResiduesGroupResiduesSurfacesObjects</span><span class="p">(</span><span class="n">GroupType</span><span class="p">,</span> <span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">MainGroupID</span><span class="p">):</span>
  591     <span class="sd">&quot;&quot;&quot;Delete empty surfaces objects for surface or buried residues in a chain.&quot;&quot;&quot;</span>
  592     
  593     <span class="k">if</span> <span class="ow">not</span> <span class="n">GetChainAloneResidueTypesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  594         <span class="k">return</span>
  595 
  596     <span class="k">if</span> <span class="n">AreGroupTypeResiduesPresent</span><span class="p">(</span><span class="n">GroupType</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  597         <span class="k">return</span>
  598     
  599     <span class="n">SurfacesGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">SurfaceGroup&quot;</span> <span class="o">%</span> <span class="n">MainGroupID</span>
  600 
  601     <span class="c1"># Delete plain surface...</span>
  602     <span class="n">SurfaceID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Surface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfacesGroupID</span><span class="p">)</span>
  603     <span class="n">WritePMLToCheckAndDeleteEmptyObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SurfaceID</span><span class="p">])</span>
  604     
  605     <span class="k">if</span> <span class="n">GetChainAloneSurfaceChainStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  606         <span class="n">HydrophobicSurfaceID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">HydrophobicSurface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfacesGroupID</span><span class="p">)</span>
  607         <span class="n">WritePMLToCheckAndDeleteEmptyObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">HydrophobicSurfaceID</span><span class="p">])</span>
  608         
  609         <span class="n">HydrophobicChargeSurfaceID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">HydrophobicChargeSurface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfacesGroupID</span><span class="p">)</span>
  610         <span class="n">WritePMLToCheckAndDeleteEmptyObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">HydrophobicChargeSurfaceID</span><span class="p">])</span>
  611         
  612         <span class="k">if</span> <span class="n">GetChainAloneSurfaceChainElectrostaticsStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  613             <span class="n">ElectrostaticsGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">ElectrostaticsGroup&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfacesGroupID</span><span class="p">)</span>
  614             <span class="n">ElectrostaticsGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Members&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ElectrostaticsGroupID</span><span class="p">)</span>
  615             
  616             <span class="n">ElectrostaticsGroupName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ElectrostaticsGroupID</span><span class="p">]</span>
  617             <span class="n">ElectrostaticsGroupMembers</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ElectrostaticsGroupMembersID</span><span class="p">]</span>
  618             <span class="n">ElectrostaticsGroupMembersNames</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ElectrostaticsGroupMembers</span><span class="p">)</span>
  619             <span class="n">WritePMLToCheckAndDeleteEmptyObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">ElectrostaticsGroupMembersNames</span><span class="p">,</span> <span class="n">ElectrostaticsGroupName</span><span class="p">)</span>
  620             
  621     <span class="c1"># Delete surface group...</span>
  622     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.delete(&quot;</span><span class="si">%s</span><span class="s2">&quot;)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SurfacesGroupID</span><span class="p">])</span>
  623             
  624 <span class="k">def</span> <span class="nf">AreGroupTypeResiduesPresent</span><span class="p">(</span><span class="n">GroupType</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  625     <span class="sd">&quot;&quot;&quot;Check presence of surface or buries residue groups in a chain. &quot;&quot;&quot;</span>
  626 
  627     <span class="n">GroupTypeResiduesPresent</span> <span class="o">=</span> <span class="bp">True</span>
  628     
  629     <span class="n">SpecifiedChainsAndLigandsInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
  630     
  631     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Surface_Residues$&quot;</span><span class="p">,</span> <span class="n">GroupType</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  632         <span class="n">GroupTypeResiduesPresent</span> <span class="o">=</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceResiduesPresent&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
  633     <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Buried_Residues$&quot;</span><span class="p">,</span> <span class="n">GroupType</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  634         <span class="n">GroupTypeResiduesPresent</span> <span class="o">=</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;BuriedResiduesPresent&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
  635 
  636     <span class="k">return</span> <span class="n">GroupTypeResiduesPresent</span>
  637 
  638 <span class="k">def</span> <span class="nf">WritePMLToCheckAndDeleteEmptyObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">ObjectName</span><span class="p">,</span> <span class="n">ParentObjectName</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
  639     <span class="sd">&quot;&quot;&quot;Write PML to check and delete empty PyMOL objects. &quot;&quot;&quot;</span>
  640     
  641     <span class="k">if</span> <span class="n">ParentObjectName</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
  642         <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;CheckAndDeleteEmptyObjects(&quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ObjectName</span><span class="p">)</span>
  643     <span class="k">else</span><span class="p">:</span>
  644         <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;CheckAndDeleteEmptyObjects(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ObjectName</span><span class="p">,</span> <span class="n">ParentObjectName</span><span class="p">)</span>
  645     
  646     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  647     
  648 <span class="k">def</span> <span class="nf">SetupPyMOLObjectNames</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">):</span>
  649     <span class="sd">&quot;&quot;&quot;Setup hierarchy of PyMOL groups and objects for ligand centric views of</span>
  650 <span class="sd">    chains and ligands present in input file.</span>
  651 <span class="sd">    &quot;&quot;&quot;</span>
  652 
  653     <span class="n">PyMOLObjectNames</span> <span class="o">=</span> <span class="p">{}</span>
  654     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  655     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  656 
  657     <span class="c1"># Setup groups and objects for complex...</span>
  658     <span class="n">SetupPyMOLObjectNamesForComplex</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">)</span>
  659     
  660     <span class="c1"># Setup groups and objects for chain...</span>
  661     <span class="n">SpecifiedChainsAndLigandsInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
  662     <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]:</span>
  663         <span class="n">SetupPyMOLObjectNamesForChain</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
  664         
  665         <span class="c1"># Setup groups and objects for ligand...</span>
  666         <span class="k">for</span> <span class="n">LigandID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]:</span>
  667             <span class="n">SetupPyMOLObjectNamesForLigand</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">)</span>
  668 
  669     <span class="k">return</span> <span class="n">PyMOLObjectNames</span>
  670 
  671 <span class="k">def</span> <span class="nf">SetupPyMOLObjectNamesForComplex</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">):</span>
  672     <span class="sd">&quot;&quot;&quot;Setup groups and objects for complex. &quot;&quot;&quot;</span>
  673     
  674     <span class="n">PDBFileRoot</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InfilesRoots&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
  675     
  676     <span class="n">PDBGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PDBFileRoot</span>
  677     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;PDBGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PDBGroupName</span>
  678     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;PDBGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  679 
  680     <span class="n">ComplexGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Complex&quot;</span> <span class="o">%</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;PDBGroup&quot;</span><span class="p">]</span>
  681     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ComplexGroupName</span>
  682     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;PDBGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ComplexGroupName</span><span class="p">)</span>
  683     
  684     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Complex&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Complex&quot;</span> <span class="o">%</span> <span class="n">ComplexGroupName</span>
  685     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceComplex&quot;</span><span class="p">]:</span>
  686         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexHydrophobicSurface&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Surface&quot;</span> <span class="o">%</span> <span class="n">ComplexGroupName</span>
  687 
  688     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  689     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Complex&quot;</span><span class="p">])</span>
  690     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceComplex&quot;</span><span class="p">]:</span>
  691         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexHydrophobicSurface&quot;</span><span class="p">])</span>
  692     
  693 <span class="k">def</span> <span class="nf">SetupPyMOLObjectNamesForChain</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  694     <span class="sd">&quot;&quot;&quot;Setup groups and objects for chain.&quot;&quot;&quot;</span>
  695     
  696     <span class="n">PDBGroupName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;PDBGroup&quot;</span><span class="p">]</span>
  697     
  698     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  699     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  700     
  701     <span class="c1"># Set up chain group and chain objects...</span>
  702     <span class="n">ChainGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Chain</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">PDBGroupName</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
  703     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ChainGroupName</span>
  704     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;PDBGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ChainGroupName</span><span class="p">)</span>
  705     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  706     
  707     <span class="c1"># Setup chain complex group and objects...</span>
  708     <span class="n">ChainComplexGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Complex&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainGroupName</span><span class="p">)</span>
  709     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ChainComplexGroupName</span>
  710     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ChainComplexGroupName</span><span class="p">)</span>
  711 
  712     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  713     
  714     <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Complex&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainComplexGroupName</span><span class="p">)</span>
  715     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplex&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
  716     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
  717     
  718     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChainComplex&quot;</span><span class="p">]:</span>
  719         <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Surface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainComplexGroupName</span><span class="p">)</span>
  720         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexHydrophobicSurface&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
  721         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
  722 
  723     <span class="c1"># Setup up a group for individual chains...</span>
  724     <span class="n">ChainAloneGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Chain&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainGroupName</span><span class="p">)</span>
  725     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ChainAloneGroupName</span>
  726     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ChainAloneGroupName</span><span class="p">)</span>
  727         
  728     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  729         
  730     <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Chain&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainAloneGroupName</span><span class="p">)</span>
  731     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAlone&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
  732     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
  733     
  734     <span class="c1"># Setup groups and their members for surface and buried residues...</span>
  735     <span class="n">ChainAloneGroupID</span> <span class="o">=</span> <span class="s2">&quot;ChainAloneGroup&quot;</span>
  736     <span class="k">for</span> <span class="n">GroupType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Surface_Residues&quot;</span><span class="p">,</span> <span class="s2">&quot;Buried_Residues&quot;</span><span class="p">]:</span>
  737         <span class="n">GroupID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">GroupType</span><span class="p">)</span>
  738         
  739         <span class="n">ResiduesGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainAloneGroupName</span><span class="p">,</span> <span class="n">GroupType</span><span class="p">)</span>
  740         <span class="n">ResiduesGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainAloneGroupID</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">)</span>
  741         <span class="n">ResiduesGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Members&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupID</span><span class="p">)</span>
  742         
  743         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesGroupID</span><span class="p">]</span> <span class="o">=</span> <span class="n">ResiduesGroupName</span>
  744         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ResiduesGroupName</span><span class="p">)</span>
  745         
  746         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesGroupMembersID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  747         
  748         <span class="c1"># Add a chain for surface and buried residues...</span>
  749         <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Chain&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupName</span><span class="p">)</span>
  750         <span class="n">NameID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Chain&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupID</span><span class="p">)</span>
  751         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">NameID</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
  752         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
  753         
  754         <span class="n">SetupPyMOLObjectNamesForChainResiduesTypes</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">ResiduesGroupName</span><span class="p">,</span> <span class="n">ResiduesGroupID</span><span class="p">,</span> <span class="n">ResiduesGroupMembersID</span><span class="p">)</span>
  755         <span class="n">SetupPyMOLObjectNamesForChainResiduesSurafces</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">ResiduesGroupName</span><span class="p">,</span> <span class="n">ResiduesGroupID</span><span class="p">,</span> <span class="n">ResiduesGroupMembersID</span><span class="p">)</span>
  756     
  757     <span class="c1"># Setup solvent and inorganic objects for chain...</span>
  758     <span class="k">for</span> <span class="n">NameID</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Solvent&quot;</span><span class="p">,</span> <span class="s2">&quot;Inorganic&quot;</span><span class="p">]:</span>
  759         <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainGroupName</span><span class="p">,</span> <span class="n">NameID</span><span class="p">)</span>
  760         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">NameID</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
  761         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
  762     
  763 <span class="k">def</span> <span class="nf">SetupPyMOLObjectNamesForChainResiduesTypes</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">MainGroupName</span><span class="p">,</span> <span class="n">MainGroupID</span><span class="p">,</span> <span class="n">MainGroupMembersID</span><span class="p">):</span>
  764     <span class="sd">&quot;&quot;&quot;Setup residue type groups and its objects for residues.&quot;&quot;&quot;</span>
  765     
  766     <span class="k">if</span> <span class="ow">not</span> <span class="n">GetChainAloneResidueTypesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  767         <span class="k">return</span>
  768     
  769     <span class="n">ResiduesGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Residues&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MainGroupName</span><span class="p">)</span>
  770     <span class="n">ResiduesGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">ResiduesGroup&quot;</span> <span class="o">%</span> <span class="n">MainGroupID</span>
  771     <span class="n">ResiduesGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Members&quot;</span> <span class="o">%</span> <span class="n">ResiduesGroupID</span>
  772     
  773     <span class="c1"># Add residue type group to residues group...</span>
  774     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesGroupID</span><span class="p">]</span> <span class="o">=</span> <span class="n">ResiduesGroupName</span>
  775     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">MainGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ResiduesGroupName</span><span class="p">)</span>
  776         
  777     <span class="c1"># Initialize residue type group members...</span>
  778     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesGroupMembersID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  779     
  780     <span class="c1"># Setup residues sub groups and its members...</span>
  781     <span class="k">for</span> <span class="n">SubGroupType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Aromatic&quot;</span><span class="p">,</span> <span class="s2">&quot;Hydrophobic&quot;</span><span class="p">,</span> <span class="s2">&quot;Polar&quot;</span><span class="p">,</span> <span class="s2">&quot;Positively_Charged&quot;</span><span class="p">,</span> <span class="s2">&quot;Negatively_Charged&quot;</span><span class="p">,</span> <span class="s2">&quot;Other&quot;</span><span class="p">]:</span>
  782         <span class="n">SubGroupID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">SubGroupType</span><span class="p">)</span>
  783         
  784         <span class="n">ResiduesSubGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupName</span><span class="p">,</span> <span class="n">SubGroupType</span><span class="p">)</span>
  785         <span class="n">ResiduesSubGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesGroupID</span><span class="p">,</span> <span class="n">SubGroupID</span><span class="p">)</span>
  786         <span class="n">ResiduesSubGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Members&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesSubGroupID</span><span class="p">)</span>
  787         
  788         <span class="c1"># Add sub group to residues group...</span>
  789         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesSubGroupID</span><span class="p">]</span> <span class="o">=</span> <span class="n">ResiduesSubGroupName</span>
  790         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ResiduesSubGroupName</span><span class="p">)</span>
  791         
  792         <span class="c1"># Initialize sub group members...</span>
  793         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesSubGroupMembersID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  794             
  795         <span class="c1"># Add sub group members to subgroup...</span>
  796         <span class="k">for</span> <span class="n">MemberType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Residues&quot;</span><span class="p">,</span> <span class="s2">&quot;Surface&quot;</span><span class="p">]:</span>
  797             <span class="n">MemberID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">MemberType</span><span class="p">)</span>
  798             
  799             <span class="n">SubGroupMemberName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesSubGroupName</span><span class="p">,</span> <span class="n">MemberType</span><span class="p">)</span>
  800             <span class="n">SubGroupMemberID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResiduesSubGroupID</span><span class="p">,</span> <span class="n">MemberID</span><span class="p">)</span>
  801                 
  802             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SubGroupMemberID</span><span class="p">]</span> <span class="o">=</span> <span class="n">SubGroupMemberName</span>
  803             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ResiduesSubGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SubGroupMemberName</span><span class="p">)</span>
  804 
  805 <span class="k">def</span> <span class="nf">SetupPyMOLObjectNamesForChainResiduesSurafces</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">MainGroupName</span><span class="p">,</span> <span class="n">MainGroupID</span><span class="p">,</span> <span class="n">MainGroupMembersID</span><span class="p">):</span>
  806     <span class="sd">&quot;&quot;&quot;Setup residue surface groups and its objects for residues.&quot;&quot;&quot;</span>
  807     
  808     <span class="k">if</span> <span class="ow">not</span> <span class="n">GetChainAloneContainsSurfacesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  809         <span class="k">return</span>
  810     
  811     <span class="n">SubGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Surface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MainGroupName</span><span class="p">)</span>
  812     <span class="n">SubGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">SurfaceGroup&quot;</span> <span class="o">%</span> <span class="n">MainGroupID</span>
  813     <span class="n">SubGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Members&quot;</span> <span class="o">%</span> <span class="n">SubGroupID</span>
  814 
  815     <span class="c1"># Add surface group to main group...</span>
  816     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SubGroupID</span><span class="p">]</span> <span class="o">=</span> <span class="n">SubGroupName</span>
  817     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">MainGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SubGroupName</span><span class="p">)</span>
  818 
  819     <span class="c1"># Initialize surface group members...</span>
  820     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SubGroupMembersID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  821     
  822     <span class="c1"># Setup a generic color surface...</span>
  823     <span class="n">SurfaceName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Surface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SubGroupName</span><span class="p">)</span>
  824     <span class="n">SurfaceID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Surface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SubGroupID</span><span class="p">)</span>
  825     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SurfaceID</span><span class="p">]</span> <span class="o">=</span> <span class="n">SurfaceName</span>
  826     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SubGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SurfaceName</span><span class="p">)</span>
  827     
  828     <span class="k">if</span> <span class="n">GetChainAloneSurfaceChainStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  829         <span class="c1"># Setup hydrophobicity surface...</span>
  830         <span class="n">HydrophobicSurfaceName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Hydrophobicity&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SubGroupName</span><span class="p">)</span>
  831         <span class="n">HydrophobicSurfaceID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">HydrophobicSurface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SubGroupID</span><span class="p">)</span>
  832         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">HydrophobicSurfaceID</span><span class="p">]</span> <span class="o">=</span> <span class="n">HydrophobicSurfaceName</span>
  833         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SubGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">HydrophobicSurfaceName</span><span class="p">)</span>
  834         
  835         <span class="c1"># Setup hydrophobicity and charge surface...</span>
  836         <span class="n">HydrophobicChargeSurfaceName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Hydrophobicity_Charge&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SubGroupName</span><span class="p">)</span>
  837         <span class="n">HydrophobicChargeSurfaceID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">HydrophobicChargeSurface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SubGroupID</span><span class="p">)</span>
  838         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">HydrophobicChargeSurfaceID</span><span class="p">]</span> <span class="o">=</span> <span class="n">HydrophobicChargeSurfaceName</span>
  839         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SubGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">HydrophobicChargeSurfaceName</span><span class="p">)</span>
  840         
  841         <span class="k">if</span> <span class="n">GetChainAloneSurfaceChainElectrostaticsStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  842             <span class="c1"># Setup electrostatics group...</span>
  843             <span class="n">ElectrostaticsGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Vacuum_Electrostatics&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SubGroupName</span><span class="p">)</span>
  844             <span class="n">ElectrostaticsGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">ElectrostaticsGroup&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SubGroupID</span><span class="p">)</span>
  845             <span class="n">ElectrostaticsGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">ElectrostaticsGroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SubGroupID</span><span class="p">)</span>
  846             
  847             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ElectrostaticsGroupID</span><span class="p">]</span> <span class="o">=</span> <span class="n">ElectrostaticsGroupName</span>
  848             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SubGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ElectrostaticsGroupName</span><span class="p">)</span>
  849             
  850             <span class="c1"># Setup electrostatics group members...</span>
  851             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ElectrostaticsGroupMembersID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  852             
  853             <span class="k">for</span> <span class="n">MemberType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Chain&quot;</span><span class="p">,</span> <span class="s2">&quot;Contact_Potential&quot;</span><span class="p">,</span> <span class="s2">&quot;Map&quot;</span><span class="p">,</span> <span class="s2">&quot;Legend&quot;</span><span class="p">]:</span>
  854                 <span class="n">MemberID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">MemberType</span><span class="p">)</span>
  855                 
  856                 <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ElectrostaticsGroupName</span><span class="p">,</span> <span class="n">MemberType</span><span class="p">)</span>
  857                 <span class="n">NameID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ElectrostaticsGroupID</span><span class="p">,</span> <span class="n">MemberID</span><span class="p">)</span>
  858                 
  859                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">NameID</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
  860                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">ElectrostaticsGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
  861 
  862 <span class="k">def</span> <span class="nf">SetupPyMOLObjectNamesForLigand</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">):</span>
  863     <span class="sd">&quot;&quot;&quot;Stetup groups and objects for ligand.&quot;&quot;&quot;</span>
  864 
  865     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  866     
  867     <span class="n">ChainGroupName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroup&quot;</span><span class="p">]</span>
  868     
  869     <span class="c1"># Setup a chain level ligand group...</span>
  870     <span class="n">ChainLigandGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Ligand</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainGroupName</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">)</span>
  871     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="s2">&quot;ChainLigandGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ChainLigandGroupName</span>
  872     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ChainLigandGroupName</span><span class="p">)</span>
  873     
  874     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="s2">&quot;ChainLigandGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  875 
  876     <span class="c1"># Set up ligand group and its members...</span>
  877     <span class="n">GroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Ligand&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainLigandGroupName</span><span class="p">)</span>
  878     <span class="n">GroupNameID</span> <span class="o">=</span> <span class="s2">&quot;LigandGroup&quot;</span>
  879     <span class="n">GroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;LigandGroupMembers&quot;</span>
  880     
  881     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupNameID</span><span class="p">]</span> <span class="o">=</span> <span class="n">GroupName</span>
  882     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="s2">&quot;ChainLigandGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">GroupName</span><span class="p">)</span>
  883     
  884     <span class="n">LigandName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Ligand&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupName</span><span class="p">)</span>
  885     <span class="n">LigandNameID</span> <span class="o">=</span> <span class="s2">&quot;Ligand&quot;</span>
  886     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">LigandNameID</span><span class="p">]</span> <span class="o">=</span> <span class="n">LigandName</span>
  887     
  888     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupMembersID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  889     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">LigandName</span><span class="p">)</span>
  890     
  891     <span class="c1"># Add ball and stick...</span>
  892     <span class="n">BallAndStickName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.BallAndStick&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupName</span><span class="p">)</span>
  893     <span class="n">BallAndStickID</span> <span class="o">=</span> <span class="s2">&quot;LigandBallAndStick&quot;</span>
  894     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">BallAndStickID</span><span class="p">]</span> <span class="o">=</span> <span class="n">BallAndStickName</span>
  895     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">BallAndStickName</span><span class="p">)</span>
  896 
  897 <span class="k">def</span> <span class="nf">RetrieveInfilesInfo</span><span class="p">():</span>
  898     <span class="sd">&quot;&quot;&quot;Retrieve information for input files.&quot;&quot;&quot;</span>
  899 
  900     <span class="n">InfilesInfo</span> <span class="o">=</span> <span class="p">{}</span>
  901     
  902     <span class="n">InfilesInfo</span><span class="p">[</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  903     <span class="n">InfilesInfo</span><span class="p">[</span><span class="s2">&quot;InfilesRoots&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  904     <span class="n">InfilesInfo</span><span class="p">[</span><span class="s2">&quot;ChainsAndLigandsInfo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  905     
  906     <span class="k">for</span> <span class="n">Infile</span> <span class="ow">in</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">]:</span>
  907         <span class="n">FileDir</span><span class="p">,</span> <span class="n">FileName</span><span class="p">,</span> <span class="n">FileExt</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ParseFileName</span><span class="p">(</span><span class="n">Infile</span><span class="p">)</span>
  908         <span class="n">InfileRoot</span> <span class="o">=</span> <span class="n">FileName</span>
  909         
  910         <span class="n">ChainsAndLigandInfo</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">GetChainsAndLigandsInfo</span><span class="p">(</span><span class="n">Infile</span><span class="p">,</span> <span class="n">InfileRoot</span><span class="p">)</span>
  911         
  912         <span class="n">InfilesInfo</span><span class="p">[</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Infile</span><span class="p">)</span>
  913         <span class="n">InfilesInfo</span><span class="p">[</span><span class="s2">&quot;InfilesRoots&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">InfileRoot</span><span class="p">)</span>
  914         <span class="n">InfilesInfo</span><span class="p">[</span><span class="s2">&quot;ChainsAndLigandsInfo&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ChainsAndLigandInfo</span><span class="p">)</span>
  915     
  916     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">InfilesInfo</span>
  917 
  918 <span class="k">def</span> <span class="nf">RetrieveRefFileInfo</span><span class="p">():</span>
  919     <span class="sd">&quot;&quot;&quot;Retrieve information for ref file.&quot;&quot;&quot;</span>
  920 
  921     <span class="n">RefFileInfo</span> <span class="o">=</span> <span class="p">{}</span>
  922     <span class="k">if</span> <span class="ow">not</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Align&quot;</span><span class="p">]:</span>
  923         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;RefFileInfo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">RefFileInfo</span>
  924         <span class="k">return</span>
  925 
  926     <span class="n">RefFile</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;RefFileName&quot;</span><span class="p">]</span>
  927     
  928     <span class="n">FileDir</span><span class="p">,</span> <span class="n">FileName</span><span class="p">,</span> <span class="n">FileExt</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ParseFileName</span><span class="p">(</span><span class="n">RefFile</span><span class="p">)</span>
  929     <span class="n">RefFileRoot</span> <span class="o">=</span> <span class="n">FileName</span>
  930     
  931     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^FirstInputFile$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AlignRefFile&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  932         <span class="n">ChainsAndLigandInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;ChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
  933     <span class="k">else</span><span class="p">:</span>
  934         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Retrieving chain and ligand information for alignment reference file </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">RefFile</span><span class="p">)</span>
  935         <span class="n">ChainsAndLigandInfo</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">GetChainsAndLigandsInfo</span><span class="p">(</span><span class="n">RefFile</span><span class="p">,</span> <span class="n">RefFileRoot</span><span class="p">)</span>
  936 
  937     <span class="n">RefFileInfo</span><span class="p">[</span><span class="s2">&quot;RefFileName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">RefFile</span>
  938     <span class="n">RefFileInfo</span><span class="p">[</span><span class="s2">&quot;RefFileRoot&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">RefFileRoot</span>
  939     <span class="n">RefFileInfo</span><span class="p">[</span><span class="s2">&quot;PyMOLObjectName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;AlignRef_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">RefFileRoot</span>
  940     <span class="n">RefFileInfo</span><span class="p">[</span><span class="s2">&quot;ChainsAndLigandsInfo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ChainsAndLigandInfo</span>
  941     
  942     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;RefFileInfo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">RefFileInfo</span>
  943 
  944 <span class="k">def</span> <span class="nf">ProcessChainAndLigandIDs</span><span class="p">():</span>
  945     <span class="sd">&quot;&quot;&quot;Process specified chain and ligand IDs for infiles.&quot;&quot;&quot;</span>
  946     
  947     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  948     
  949     <span class="k">for</span> <span class="n">FileIndex</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">])):</span>
  950         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Processing specified chain and ligand IDs for input file </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">])</span>
  951         
  952         <span class="n">ChainsAndLigandsInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;ChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
  953         <span class="n">SpecifiedChainsAndLigandsInfo</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">ProcessChainsAndLigandsOptionsInfo</span><span class="p">(</span><span class="n">ChainsAndLigandsInfo</span><span class="p">,</span> <span class="s2">&quot;-c, --chainIDs&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">],</span> <span class="s2">&quot;-l, --ligandIDs&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">])</span>
  954         <span class="n">ProcessResidueTypesAndSurfaceOptions</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">)</span>
  955         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">)</span>
  956         
  957         <span class="n">CheckPresenceOfValidLigandIDs</span><span class="p">(</span><span class="n">ChainsAndLigandsInfo</span><span class="p">,</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">)</span>
  958 
  959 <span class="k">def</span> <span class="nf">RetrieveSurfaceAndBuriedResiduesInfo</span><span class="p">():</span>
  960     <span class="sd">&quot;&quot;&quot;Setup surface and buried residues for specified chains.&quot;&quot;&quot;</span>
  961 
  962     <span class="k">for</span> <span class="n">FileIndex</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">])):</span>
  963         <span class="n">Infile</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
  964         <span class="n">MolName</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InfilesRoots&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
  965         
  966         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Retrieving surface and buried residues from input file </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">Infile</span><span class="p">)</span>
  967         
  968         <span class="c1"># Load infile...</span>
  969         <span class="n">pymol</span><span class="o">.</span><span class="n">cmd</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">Infile</span><span class="p">,</span> <span class="n">MolName</span><span class="p">)</span>
  970 
  971         <span class="n">SpecifiedChainsAndLigandsInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
  972         
  973         <span class="c1"># Initialize surface and buried residues selection...</span>
  974         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceResiduesPresent&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  975         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceResiduesSelection&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  976         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;BuriedResiduesSelection&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  977         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;BuriedResiduesPresent&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  978         
  979         <span class="c1"># Go over all specified chains...</span>
  980         <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]:</span>
  981             <span class="n">SurfaceResiduesInfo</span><span class="p">,</span> <span class="n">BuriedResiduesInfo</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">GetSurfaceAndBuriedResiduesInfo</span><span class="p">(</span><span class="n">MolName</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;CutoffSASA&quot;</span><span class="p">])</span>
  982 
  983             <span class="c1"># Retrieve surface and buried residue numbers...</span>
  984             <span class="n">SurfaceResiduesNums</span> <span class="o">=</span> <span class="n">RetrieveResiduesNumbers</span><span class="p">(</span><span class="n">SurfaceResiduesInfo</span><span class="p">)</span>
  985             <span class="n">BuriedResiduesNums</span> <span class="o">=</span> <span class="n">RetrieveResiduesNumbers</span><span class="p">(</span><span class="n">BuriedResiduesInfo</span><span class="p">)</span>
  986 
  987             <span class="c1"># Setup PyMOL selection for surface and buried residue numbers...</span>
  988             <span class="n">SurfaceResiduesSelection</span><span class="p">,</span> <span class="n">BuriedResiduesSelection</span> <span class="o">=</span> <span class="n">SetupSurfaceAndBuriedResiduesSelection</span><span class="p">(</span><span class="n">SurfaceResiduesNums</span><span class="p">,</span> <span class="n">BuriedResiduesNums</span><span class="p">)</span>
  989             
  990             <span class="c1"># Track surface and buried residues...</span>
  991             <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceResiduesPresent&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">SurfaceResiduesNums</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
  992             <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceResiduesSelection&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">SurfaceResiduesSelection</span>
  993             
  994             <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;BuriedResiduesPresent&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">BuriedResiduesNums</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
  995             <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;BuriedResiduesSelection&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">BuriedResiduesSelection</span>
  996 
  997             <span class="c1"># List surface residues...</span>
  998             <span class="n">SurfaceResiduesCount</span><span class="p">,</span> <span class="n">SurfaceResiduesDistribution</span><span class="p">,</span> <span class="n">SurfaceResiduesIDs</span> <span class="o">=</span> <span class="n">FormatResiduesInfo</span><span class="p">(</span><span class="n">SurfaceResiduesInfo</span><span class="p">)</span>
  999             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Input file: </span><span class="si">%s</span><span class="s2">; ChainID: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">Number of surface residues: </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Infile</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">SurfaceResiduesCount</span><span class="p">))</span>
 1000             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Residue distribution: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfaceResiduesDistribution</span><span class="p">))</span>
 1001             <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueIDs&quot;</span><span class="p">]:</span>
 1002                 <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Residue IDs: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfaceResiduesIDs</span><span class="p">))</span>
 1003                 
 1004             <span class="c1"># List buried residues...</span>
 1005             <span class="n">BuriedResiduesCount</span><span class="p">,</span> <span class="n">BuriedResiduesDistribution</span><span class="p">,</span> <span class="n">BuriedResiduesIDs</span> <span class="o">=</span> <span class="n">FormatResiduesInfo</span><span class="p">(</span><span class="n">BuriedResiduesInfo</span><span class="p">)</span>
 1006             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Input file: </span><span class="si">%s</span><span class="s2">;ChainID: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">Number of buried residues: </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Infile</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">BuriedResiduesCount</span><span class="p">))</span>
 1007             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Residue distribution: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">BuriedResiduesDistribution</span><span class="p">))</span>
 1008             <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueIDs&quot;</span><span class="p">]:</span>
 1009                 <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Residue IDs: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">BuriedResiduesIDs</span><span class="p">))</span>
 1010             
 1011         <span class="c1"># Delete loaded object...</span>
 1012         <span class="n">pymol</span><span class="o">.</span><span class="n">cmd</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">MolName</span><span class="p">)</span>
 1013         
 1014 <span class="k">def</span> <span class="nf">RetrieveResiduesNumbers</span><span class="p">(</span><span class="n">ResiduesInfo</span><span class="p">):</span>
 1015     <span class="sd">&quot;&quot;&quot;Retrieve residue numbers.&quot;&quot;&quot;</span>
 1016     
 1017     <span class="c1"># Setup residue IDs sorted by residue numbers...</span>
 1018     <span class="n">ResNumMap</span> <span class="o">=</span> <span class="p">{}</span>
 1019     <span class="k">for</span> <span class="n">ResName</span> <span class="ow">in</span> <span class="n">ResiduesInfo</span><span class="p">[</span><span class="s2">&quot;ResNames&quot;</span><span class="p">]:</span>
 1020         <span class="k">for</span> <span class="n">ResNum</span> <span class="ow">in</span> <span class="n">ResiduesInfo</span><span class="p">[</span><span class="s2">&quot;ResNum&quot;</span><span class="p">][</span><span class="n">ResName</span><span class="p">]:</span>
 1021             <span class="n">ResNumMap</span><span class="p">[</span><span class="n">ResNum</span><span class="p">]</span> <span class="o">=</span> <span class="n">ResName</span>
 1022 
 1023     <span class="n">ResNumsList</span> <span class="o">=</span> <span class="p">[]</span>
 1024     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ResNumMap</span><span class="p">):</span>
 1025         <span class="n">ResNumsList</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">ResNumMap</span><span class="p">,</span> <span class="n">key</span> <span class="o">=</span> <span class="nb">int</span><span class="p">)</span>
 1026     
 1027     <span class="k">return</span> <span class="n">ResNumsList</span>
 1028 
 1029 <span class="k">def</span> <span class="nf">SetupSurfaceAndBuriedResiduesSelection</span><span class="p">(</span><span class="n">SurfaceResiduesNums</span><span class="p">,</span> <span class="n">BuriedResiduesNums</span><span class="p">):</span>
 1030     <span class="sd">&quot;&quot;&quot;Setup PyMOL selection for surface and buried residues.&quot;&quot;&quot;</span>
 1031 
 1032     <span class="n">SurfaceResiduesSelection</span><span class="p">,</span> <span class="n">BuriedResiduesSelection</span> <span class="o">=</span> <span class="p">[</span><span class="bp">None</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span>
 1033     <span class="n">UseSurfaceResidueNums</span><span class="p">,</span> <span class="n">UseBuriedResidueNums</span> <span class="o">=</span> <span class="p">[</span><span class="bp">False</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span>
 1034     
 1035     <span class="n">SurfaceResiduesCount</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">SurfaceResiduesNums</span><span class="p">)</span>
 1036     <span class="n">BuriedResiduesCount</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">BuriedResiduesNums</span><span class="p">)</span>
 1037 
 1038     <span class="c1"># Setup selections using the  residue list containing lower number of residues for</span>
 1039     <span class="c1"># ease of read in PML file...</span>
 1040     <span class="k">if</span> <span class="n">SurfaceResiduesCount</span> <span class="ow">and</span> <span class="n">BuriedResiduesCount</span><span class="p">:</span>
 1041         <span class="k">if</span> <span class="n">SurfaceResiduesCount</span> <span class="o">&lt;</span> <span class="n">BuriedResiduesCount</span><span class="p">:</span>
 1042             <span class="n">UseSurfaceResidueNums</span> <span class="o">=</span> <span class="bp">True</span>
 1043         <span class="k">else</span><span class="p">:</span>
 1044             <span class="n">UseBuriedResidueNums</span> <span class="o">=</span> <span class="bp">True</span>
 1045     <span class="k">elif</span> <span class="n">SurfaceResiduesCount</span><span class="p">:</span>
 1046         <span class="n">UseSurfaceResidueNums</span> <span class="o">=</span> <span class="bp">True</span>
 1047     <span class="k">elif</span> <span class="n">BuriedResiduesCount</span><span class="p">:</span>
 1048         <span class="n">UseBuriedResidueNums</span> <span class="o">=</span> <span class="bp">True</span>
 1049     
 1050     <span class="k">if</span> <span class="n">UseSurfaceResidueNums</span><span class="p">:</span>
 1051         <span class="n">SurfaceResiduesSelection</span> <span class="o">=</span> <span class="s2">&quot;resi </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s2">&quot;+&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">SurfaceResiduesNums</span><span class="p">))</span>
 1052         <span class="n">BuriedResiduesSelection</span> <span class="o">=</span> <span class="s2">&quot;not </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">SurfaceResiduesSelection</span>
 1053     <span class="k">elif</span> <span class="n">UseBuriedResidueNums</span><span class="p">:</span>
 1054         <span class="n">BuriedResiduesSelection</span> <span class="o">=</span> <span class="s2">&quot;resi </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s2">&quot;+&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">BuriedResiduesNums</span><span class="p">))</span>
 1055         <span class="n">SurfaceResiduesSelection</span> <span class="o">=</span> <span class="s2">&quot;not </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">BuriedResiduesSelection</span>
 1056         
 1057     <span class="k">return</span> <span class="n">SurfaceResiduesSelection</span><span class="p">,</span> <span class="n">BuriedResiduesSelection</span>
 1058 
 1059 <span class="k">def</span> <span class="nf">FormatResiduesInfo</span><span class="p">(</span><span class="n">SelectionInfo</span><span class="p">):</span>
 1060     <span class="sd">&quot;&quot;&quot;Format residues info.&quot;&quot;&quot;</span>
 1061     
 1062     <span class="c1"># Setup distribution of residues...</span>
 1063     <span class="n">LineWords</span> <span class="o">=</span> <span class="p">[]</span>
 1064     <span class="n">ResiduesCount</span> <span class="o">=</span> <span class="mi">0</span>
 1065     <span class="n">SortedResNames</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">SelectionInfo</span><span class="p">[</span><span class="s2">&quot;ResNames&quot;</span><span class="p">],</span> <span class="n">key</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">ResName</span><span class="p">:</span> <span class="n">SelectionInfo</span><span class="p">[</span><span class="s2">&quot;ResCount&quot;</span><span class="p">][</span><span class="n">ResName</span><span class="p">],</span> <span class="n">reverse</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
 1066     <span class="k">for</span> <span class="n">ResName</span> <span class="ow">in</span> <span class="n">SortedResNames</span><span class="p">:</span>
 1067         <span class="n">ResCount</span> <span class="o">=</span> <span class="n">SelectionInfo</span><span class="p">[</span><span class="s2">&quot;ResCount&quot;</span><span class="p">][</span><span class="n">ResName</span><span class="p">]</span>
 1068         <span class="n">LineWords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> - </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResName</span><span class="p">,</span> <span class="n">ResCount</span><span class="p">))</span>
 1069         <span class="n">ResiduesCount</span> <span class="o">+=</span> <span class="n">ResCount</span>
 1070     
 1071     <span class="n">ResiduesDistribution</span> <span class="o">=</span> <span class="s2">&quot;; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">LineWords</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">LineWords</span><span class="p">)</span> <span class="k">else</span> <span class="bp">None</span>
 1072     
 1073     <span class="c1"># Setup residue IDs sorted by residue numbers...</span>
 1074     <span class="n">ResNumMap</span> <span class="o">=</span> <span class="p">{}</span>
 1075     <span class="k">for</span> <span class="n">ResName</span> <span class="ow">in</span> <span class="n">SelectionInfo</span><span class="p">[</span><span class="s2">&quot;ResNames&quot;</span><span class="p">]:</span>
 1076         <span class="k">for</span> <span class="n">ResNum</span> <span class="ow">in</span> <span class="n">SelectionInfo</span><span class="p">[</span><span class="s2">&quot;ResNum&quot;</span><span class="p">][</span><span class="n">ResName</span><span class="p">]:</span>
 1077             <span class="n">ResNumMap</span><span class="p">[</span><span class="n">ResNum</span><span class="p">]</span> <span class="o">=</span> <span class="n">ResName</span>
 1078 
 1079     <span class="n">ResNumsList</span> <span class="o">=</span> <span class="p">[]</span>
 1080     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ResNumMap</span><span class="p">):</span>
 1081         <span class="n">ResNumsList</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">ResNumMap</span><span class="p">,</span> <span class="n">key</span> <span class="o">=</span> <span class="nb">int</span><span class="p">)</span>
 1082     
 1083     <span class="n">LineWords</span> <span class="o">=</span> <span class="p">[]</span>
 1084     <span class="k">for</span> <span class="n">ResNum</span> <span class="ow">in</span> <span class="n">ResNumsList</span><span class="p">:</span>
 1085         <span class="n">ResName</span> <span class="o">=</span> <span class="n">ResNumMap</span><span class="p">[</span><span class="n">ResNum</span><span class="p">]</span>
 1086         <span class="n">ResID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ResName</span><span class="p">,</span> <span class="n">ResNum</span><span class="p">)</span>
 1087         <span class="n">LineWords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ResID</span><span class="p">)</span>
 1088     <span class="n">ResiduesIDs</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">LineWords</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">LineWords</span><span class="p">)</span> <span class="k">else</span> <span class="bp">None</span>
 1089                 
 1090     <span class="k">return</span> <span class="n">ResiduesCount</span><span class="p">,</span> <span class="n">ResiduesDistribution</span><span class="p">,</span> <span class="n">ResiduesIDs</span>
 1091 
 1092 <span class="k">def</span> <span class="nf">ProcessResidueTypesAndSurfaceOptions</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">):</span>
 1093     <span class="sd">&quot;&quot;&quot;Process residue types and surface options for chains.&quot;&quot;&quot;</span>
 1094 
 1095     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainSurfaces&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1096     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChain&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1097     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChainElectrostatics&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1098     
 1099     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesChain&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1100 
 1101     <span class="c1"># Load infile...</span>
 1102     <span class="n">Infile</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
 1103     <span class="n">MolName</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InfilesRoots&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
 1104     <span class="n">pymol</span><span class="o">.</span><span class="n">cmd</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">Infile</span><span class="p">,</span> <span class="n">MolName</span><span class="p">)</span>
 1105     
 1106     <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]:</span>
 1107         <span class="n">AminoAcidsPresent</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">AreAminoAcidResiduesPresent</span><span class="p">(</span><span class="n">MolName</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
 1108 
 1109         <span class="c1"># Process surfaces for chains...</span>
 1110         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChain&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1111             <span class="n">SurfaceChain</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">AminoAcidsPresent</span> <span class="k">else</span> <span class="bp">False</span>
 1112         <span class="k">else</span><span class="p">:</span>
 1113             <span class="n">SurfaceChain</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^yes$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChain&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1114         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChain&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">SurfaceChain</span>
 1115 
 1116         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChainElectrostatics&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1117             <span class="n">SurfaceChainElectrostatics</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">AminoAcidsPresent</span> <span class="k">else</span> <span class="bp">False</span>
 1118         <span class="k">else</span><span class="p">:</span>
 1119             <span class="n">SurfaceChainElectrostatics</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^yes$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChainElectrostatics&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1120         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChainElectrostatics&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">SurfaceChainElectrostatics</span>
 1121 
 1122         <span class="c1"># A generic color surafce is always created...</span>
 1123         <span class="n">ChainSurfaces</span> <span class="o">=</span> <span class="bp">True</span>
 1124         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainSurfaces&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">ChainSurfaces</span>
 1125         
 1126         <span class="c1"># Process residue types for chains...</span>
 1127         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesChain&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1128             <span class="n">ResidueTypesChain</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">AminoAcidsPresent</span> <span class="k">else</span> <span class="bp">False</span>
 1129         <span class="k">else</span><span class="p">:</span>
 1130             <span class="n">ResidueTypesChain</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^yes$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesChain&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1131         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesChain&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">ResidueTypesChain</span>
 1132 
 1133     <span class="c1"># Delete loaded object...</span>
 1134     <span class="n">pymol</span><span class="o">.</span><span class="n">cmd</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">MolName</span><span class="p">)</span>
 1135 
 1136 <span class="k">def</span> <span class="nf">GetChainAloneResidueTypesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
 1137     <span class="sd">&quot;&quot;&quot;Get status of residue types for chain alone object.&quot;&quot;&quot;</span>
 1138 
 1139     <span class="c1">#  o Need to handle Surface_Residues and Buried residues group based detection...</span>
 1140     <span class="n">Status</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">][</span><span class="s2">&quot;ResidueTypesChain&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="k">else</span> <span class="bp">False</span>
 1141     
 1142     <span class="k">return</span> <span class="n">Status</span>
 1143 
 1144 <span class="k">def</span> <span class="nf">GetChainAloneContainsSurfacesStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
 1145     <span class="sd">&quot;&quot;&quot;Get status of surfaces present in chain alone object.&quot;&quot;&quot;</span>
 1146 
 1147     <span class="k">return</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">][</span><span class="s2">&quot;ChainSurfaces&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
 1148 
 1149 <span class="k">def</span> <span class="nf">GetChainAloneSurfaceChainStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
 1150     <span class="sd">&quot;&quot;&quot;Get status of hydrophobic surfaces for chain alone object.&quot;&quot;&quot;</span>
 1151 
 1152     <span class="k">return</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">][</span><span class="s2">&quot;SurfaceChain&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
 1153 
 1154 <span class="k">def</span> <span class="nf">GetChainAloneSurfaceChainElectrostaticsStatus</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
 1155     <span class="sd">&quot;&quot;&quot;Get status of electrostatics surfaces for chain alone object.&quot;&quot;&quot;</span>
 1156 
 1157     <span class="k">return</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">][</span><span class="s2">&quot;SurfaceChainElectrostatics&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
 1158 
 1159 <span class="k">def</span> <span class="nf">CheckPresenceOfValidLigandIDs</span><span class="p">(</span><span class="n">ChainsAndLigandsInfo</span><span class="p">,</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">):</span>
 1160     <span class="sd">&quot;&quot;&quot;Check presence of valid ligand IDs.&quot;&quot;&quot;</span>
 1161 
 1162     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Specified chain IDs: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">])))</span>
 1163     
 1164     <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]:</span>
 1165         <span class="k">if</span> <span class="nb">len</span> <span class="p">(</span><span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]):</span>
 1166             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Chain ID: </span><span class="si">%s</span><span class="s2">; Specified LigandIDs: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainID</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">])))</span>
 1167         <span class="k">else</span><span class="p">:</span>
 1168             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Chain IDs: </span><span class="si">%s</span><span class="s2">; Specified LigandIDs: None&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainID</span><span class="p">))</span>
 1169             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;No valid ligand IDs found for chain ID, </span><span class="si">%s</span><span class="s2">. PyMOL groups and objects related to ligand and binding pockect won&#39;t be created.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainID</span><span class="p">))</span>
 1170 
 1171 <span class="k">def</span> <span class="nf">RetrieveFirstChainID</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">):</span>
 1172     <span class="sd">&quot;&quot;&quot;Get first chain ID.&quot;&quot;&quot;</span>
 1173     
 1174     <span class="n">ChainsAndLigandsInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;ChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
 1175     
 1176     <span class="n">FirstChainID</span> <span class="o">=</span> <span class="bp">None</span>
 1177     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]):</span>
 1178         <span class="n">FirstChainID</span> <span class="o">=</span> <span class="n">ChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
 1179     
 1180     <span class="k">return</span> <span class="n">FirstChainID</span>
 1181 
 1182 <span class="k">def</span> <span class="nf">ProcessResidueTypes</span><span class="p">():</span>
 1183     <span class="sd">&quot;&quot;&quot;Process residue types. &quot;&quot;&quot;</span>
 1184 
 1185     <span class="n">ResidueTypesNamesInfo</span><span class="p">,</span> <span class="n">ResidueTypesParamsInfo</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">ProcessResidueTypesOptionsInfo</span><span class="p">(</span><span class="s2">&quot;-r, --residueTypes&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypes&quot;</span><span class="p">])</span>
 1186     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesNames&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ResidueTypesNamesInfo</span>
 1187     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesParams&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ResidueTypesParamsInfo</span>
 1188     
 1189 <span class="k">def</span> <span class="nf">ProcessSurfaceAtomTypesColors</span><span class="p">():</span>
 1190     <span class="sd">&quot;&quot;&quot;Process surface atom types colors. &quot;&quot;&quot;</span>
 1191 
 1192     <span class="n">AtomTypesColorNamesInfo</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">ProcessSurfaceAtomTypesColorsOptionsInfo</span><span class="p">(</span><span class="s2">&quot;--surfaceAtomTypesColors&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceAtomTypesColors&quot;</span><span class="p">])</span>
 1193     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AtomTypesColorNames&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">AtomTypesColorNamesInfo</span>
 1194 
 1195 <span class="k">def</span> <span class="nf">ProcessOptions</span><span class="p">():</span>
 1196     <span class="sd">&quot;&quot;&quot;Process and validate command line arguments and options&quot;&quot;&quot;</span>
 1197 
 1198     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Processing options...&quot;</span><span class="p">)</span>
 1199     
 1200     <span class="c1"># Validate options...</span>
 1201     <span class="n">ValidateOptions</span><span class="p">()</span>
 1202     
 1203     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Align&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Yes$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--align&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1204     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AlignMethod&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--alignMethod&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
 1205     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AlignMode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--alignMode&quot;</span><span class="p">]</span>
 1206     
 1207     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AllowEmptyObjects&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Yes$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--allowEmptyObjects&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1208 
 1209     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;CutoffSASA&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--cutoffSASA&quot;</span><span class="p">])</span>
 1210     
 1211     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Infiles&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--infiles&quot;</span><span class="p">]</span>
 1212     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--infileNames&quot;</span><span class="p">]</span>
 1213 
 1214     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AlignRefFile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--alignRefFile&quot;</span><span class="p">]</span>
 1215     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^FirstInputFile$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--alignRefFile&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1216         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;RefFileName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
 1217     <span class="k">else</span><span class="p">:</span>
 1218         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;RefFileName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--alignRefFile&quot;</span><span class="p">]</span>
 1219     
 1220     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Overwrite&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--overwrite&quot;</span><span class="p">]</span>
 1221     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMLOut&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Yes$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--PMLOut&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1222     
 1223     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Outfile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--outfile&quot;</span><span class="p">]</span>
 1224     <span class="n">FileDir</span><span class="p">,</span> <span class="n">FileName</span><span class="p">,</span> <span class="n">FileExt</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ParseFileName</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Outfile&quot;</span><span class="p">])</span>
 1225     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PSEOut&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span> 
 1226     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^pml$&quot;</span><span class="p">,</span> <span class="n">FileExt</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1227         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMLOutfile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Outfile&quot;</span><span class="p">]</span> 
 1228         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMEOutfile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;.pml$&quot;</span><span class="p">,</span> <span class="s2">&quot;.pme&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Outfile&quot;</span><span class="p">])</span> 
 1229     <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^pse$&quot;</span><span class="p">,</span> <span class="n">FileExt</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1230         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PSEOut&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span> 
 1231         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PSEOutfile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Outfile&quot;</span><span class="p">]</span> 
 1232         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMLOutfile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;.pse$&quot;</span><span class="p">,</span> <span class="s2">&quot;.pml&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Outfile&quot;</span><span class="p">])</span> 
 1233         <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMLOutfile&quot;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Overwrite&quot;</span><span class="p">]):</span>
 1234             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The intermediate output file to be generated, </span><span class="si">%s</span><span class="s2">, already exist. Use option </span><span class="se">\&quot;</span><span class="s2">--ov</span><span class="se">\&quot;</span><span class="s2"> or </span><span class="se">\&quot;</span><span class="s2">--overwrite</span><span class="se">\&quot;</span><span class="s2"> and try again.&quot;</span> <span class="o">%</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMLOutfile&quot;</span><span class="p">]</span> <span class="p">)</span>
 1235 
 1236     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;LabelFontID&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--labelFontID&quot;</span><span class="p">])</span>
 1237     
 1238     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueIDs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Yes$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--residueIDs&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1239     
 1240     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypesChain&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--residueTypesChain&quot;</span><span class="p">]</span>
 1241     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ResidueTypes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--residueTypes&quot;</span><span class="p">]</span>
 1242     <span class="n">ProcessResidueTypes</span><span class="p">()</span>
 1243     
 1244     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChain&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceChain&quot;</span><span class="p">]</span>
 1245     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChainElectrostatics&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceChainElectrostatics&quot;</span><span class="p">]</span>
 1246     
 1247     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChainComplex&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Yes$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceChainComplex&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1248     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceComplex&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Yes$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceComplex&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1249     
 1250     <span class="c1"># Retrieve surface colors for generic surfaces..</span>
 1251     <span class="n">SurfaceColors</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceColors&quot;</span><span class="p">])</span>
 1252     <span class="n">SurfaceColorsWords</span> <span class="o">=</span> <span class="n">SurfaceColors</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
 1253     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">SurfaceColorsWords</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
 1254         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The number of comma delimited color names, </span><span class="si">%d</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="s2">--surfaceColors</span><span class="se">\&quot;</span><span class="s2"> option, </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">,  must be a 2.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">SurfaceColorsWords</span><span class="p">),</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceColors&quot;</span><span class="p">]))</span>
 1255     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceColors&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SurfaceColors</span>
 1256     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceColor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SurfaceColorsWords</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
 1257     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceBuriedResiduesColor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SurfaceColorsWords</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
 1258     
 1259     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceColorPalette&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceColorPalette&quot;</span><span class="p">]</span>
 1260     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceAtomTypesColors&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceAtomTypesColors&quot;</span><span class="p">]</span>
 1261     <span class="n">ProcessSurfaceAtomTypesColors</span><span class="p">()</span>
 1262     
 1263     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceTransparency&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceTransparency&quot;</span><span class="p">])</span>
 1264     
 1265     <span class="n">RetrieveInfilesInfo</span><span class="p">()</span>
 1266     <span class="n">RetrieveRefFileInfo</span><span class="p">()</span>
 1267     
 1268     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--chainIDs&quot;</span><span class="p">]</span>
 1269     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--ligandIDs&quot;</span><span class="p">]</span>
 1270     <span class="n">ProcessChainAndLigandIDs</span><span class="p">()</span>
 1271     
 1272     <span class="n">RetrieveSurfaceAndBuriedResiduesInfo</span><span class="p">()</span>
 1273 
 1274 <span class="k">def</span> <span class="nf">RetrieveOptions</span><span class="p">():</span> 
 1275     <span class="sd">&quot;&quot;&quot;Retrieve command line arguments and options&quot;&quot;&quot;</span>
 1276     
 1277     <span class="c1"># Get options...</span>
 1278     <span class="k">global</span> <span class="n">Options</span>
 1279     <span class="n">Options</span> <span class="o">=</span> <span class="n">docopt</span><span class="p">(</span><span class="n">_docoptUsage_</span><span class="p">)</span>
 1280 
 1281     <span class="c1"># Set current working directory to the specified directory...</span>
 1282     <span class="n">WorkingDir</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--workingdir&quot;</span><span class="p">]</span>
 1283     <span class="k">if</span> <span class="n">WorkingDir</span><span class="p">:</span>
 1284         <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">WorkingDir</span><span class="p">)</span>
 1285     
 1286     <span class="c1"># Handle examples option...</span>
 1287     <span class="k">if</span> <span class="s2">&quot;--examples&quot;</span> <span class="ow">in</span> <span class="n">Options</span> <span class="ow">and</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--examples&quot;</span><span class="p">]:</span>
 1288         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="n">MiscUtil</span><span class="o">.</span><span class="n">GetExamplesTextFromDocOptText</span><span class="p">(</span><span class="n">_docoptUsage_</span><span class="p">))</span>
 1289         <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
 1290 
 1291 <span class="k">def</span> <span class="nf">ValidateOptions</span><span class="p">():</span>
 1292     <span class="sd">&quot;&quot;&quot;Validate option values&quot;&quot;&quot;</span>
 1293     
 1294     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--align&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--align&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
 1295     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--alignMethod&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--alignMethod&quot;</span><span class="p">],</span> <span class="s2">&quot;align cealign super&quot;</span><span class="p">)</span>
 1296     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--alignMode&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--alignMode&quot;</span><span class="p">],</span> <span class="s2">&quot;FirstChain Complex&quot;</span><span class="p">)</span>
 1297     
 1298     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--allowEmptyObjects&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--allowEmptyObjects&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
 1299 
 1300     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFloatValue</span><span class="p">(</span><span class="s2">&quot;--cutoffSASA&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--cutoffSASA&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s2">&quot;&gt;&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">})</span>
 1301     
 1302     <span class="c1"># Expand infiles to handle presence of multiple input files...</span>
 1303     <span class="n">InfileNames</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ExpandFileNames</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--infiles&quot;</span><span class="p">],</span> <span class="s2">&quot;,&quot;</span><span class="p">)</span>
 1304     <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">InfileNames</span><span class="p">):</span>
 1305         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;No input files specified for </span><span class="se">\&quot;</span><span class="s2">-i, --infiles</span><span class="se">\&quot;</span><span class="s2"> option&quot;</span><span class="p">)</span>
 1306 
 1307     <span class="c1"># Validate file extensions...</span>
 1308     <span class="k">for</span> <span class="n">Infile</span> <span class="ow">in</span> <span class="n">InfileNames</span><span class="p">:</span>
 1309         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFilePath</span><span class="p">(</span><span class="s2">&quot;-i, --infiles&quot;</span><span class="p">,</span> <span class="n">Infile</span><span class="p">)</span>
 1310         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFileExt</span><span class="p">(</span><span class="s2">&quot;-i, --infiles&quot;</span><span class="p">,</span> <span class="n">Infile</span><span class="p">,</span> <span class="s2">&quot;pdb cif&quot;</span><span class="p">)</span>
 1311         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionsDistinctFileNames</span><span class="p">(</span><span class="s2">&quot;-i, --infiles&quot;</span><span class="p">,</span> <span class="n">Infile</span><span class="p">,</span> <span class="s2">&quot;-o, --outfile&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--outfile&quot;</span><span class="p">])</span>
 1312     <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--infileNames&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">InfileNames</span>
 1313     
 1314     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFileExt</span><span class="p">(</span><span class="s2">&quot;-o, --outfile&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--outfile&quot;</span><span class="p">],</span> <span class="s2">&quot;pml pse&quot;</span><span class="p">)</span>
 1315     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionsOutputFileOverwrite</span><span class="p">(</span><span class="s2">&quot;-o, --outfile&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--outfile&quot;</span><span class="p">],</span> <span class="s2">&quot;--overwrite&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--overwrite&quot;</span><span class="p">])</span>
 1316 
 1317     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^yes$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--align&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1318         <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^FirstInputFile$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--alignRefFile&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1319             <span class="n">AlignRefFile</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--alignRefFile&quot;</span><span class="p">]</span>
 1320             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFilePath</span><span class="p">(</span><span class="s2">&quot;--alignRefFile&quot;</span><span class="p">,</span> <span class="n">AlignRefFile</span><span class="p">)</span>
 1321             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFileExt</span><span class="p">(</span><span class="s2">&quot;--alignRefFile&quot;</span><span class="p">,</span> <span class="n">AlignRefFile</span><span class="p">,</span> <span class="s2">&quot;pdb cif&quot;</span><span class="p">)</span>
 1322             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionsDistinctFileNames</span><span class="p">(</span><span class="s2">&quot;--AlignRefFile&quot;</span><span class="p">,</span> <span class="n">AlignRefFile</span><span class="p">,</span> <span class="s2">&quot;-o, --outfile&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--outfile&quot;</span><span class="p">])</span>
 1323     
 1324     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--PMLOut&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--PMLOut&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
 1325     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionIntegerValue</span><span class="p">(</span><span class="s2">&quot;--labelFontID&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--labelFontID&quot;</span><span class="p">],</span> <span class="p">{})</span>
 1326 
 1327     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--residueIDs&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--residueIDs&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
 1328     
 1329     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--residueTypesChain&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--residueTypesChain&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no auto&quot;</span><span class="p">)</span>
 1330     
 1331     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--surfaceChain&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceChain&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no auto&quot;</span><span class="p">)</span>
 1332     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--surfaceComplex&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceComplex&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
 1333     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--surfaceChainComplex&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceChainComplex&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
 1334     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--surfaceChainElectrostatics&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceChainElectrostatics&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no auto&quot;</span><span class="p">)</span>
 1335     
 1336     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--surfaceColorPalette&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceColorPalette&quot;</span><span class="p">],</span> <span class="s2">&quot;RedToWhite WhiteToGreen&quot;</span><span class="p">)</span>
 1337     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFloatValue</span><span class="p">(</span><span class="s2">&quot;--surfaceTransparency&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceTransparency&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s2">&quot;&gt;=&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s2">&quot;&lt;=&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">})</span>
 1338     
 1339 <span class="c1"># Setup a usage string for docopt...</span>
 1340 <span class="n">_docoptUsage_</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
 1341 <span class="s2">PyMOLVisualizeSurfaceAndBuriedResidues.py - Visualize surface and buried residues in macromolecules</span>
 1342 
 1343 <span class="s2">Usage:</span>
 1344 <span class="s2">    PyMOLVisualizeSurfaceAndBuriedResidues.py [--align &lt;yes or no&gt;] [--alignMethod &lt;align, cealign, super&gt;]</span>
 1345 <span class="s2">                                    [--alignMode &lt;FirstChain or Complex&gt;] [--alignRefFile &lt;filename&gt;]</span>
 1346 <span class="s2">                                    [--allowEmptyObjects &lt;yes or no&gt;] [--chainIDs &lt;First, All or ID1,ID2...&gt;]</span>
 1347 <span class="s2">                                    [--cutoffSASA &lt;number&gt; ] [--labelFontID &lt;number&gt;]</span>
 1348 <span class="s2">                                    [--ligandIDs &lt;Largest, All or ID1,ID2...&gt; ] [--PMLOut &lt;yes or no&gt;] [--residueIDs &lt;yes or no&gt; ]</span>
 1349 <span class="s2">                                    [--residueTypes &lt;Type,Color,ResNames,...&gt;] [--residueTypesChain &lt;yes or no&gt;]</span>
 1350 <span class="s2">                                    [--surfaceChain &lt;yes or no&gt;] [--surfaceChainElectrostatics &lt;yes or no&gt;]</span>
 1351 <span class="s2">                                    [--surfaceChainComplex &lt;yes or no&gt;] [--surfaceComplex &lt;yes or no&gt;]</span>
 1352 <span class="s2">                                    [--surfaceAtomTypesColors &lt;ColorType,ColorSpec,...&gt;]</span>
 1353 <span class="s2">                                    [--surfaceColors &lt;ColorName1,ColorName2&gt;] [--surfaceColorPalette &lt;RedToWhite or WhiteToGreen&gt;]</span>
 1354 <span class="s2">                                    [--surfaceTransparency &lt;number&gt;] [--overwrite] [-w &lt;dir&gt;] -i &lt;infile1,infile2,infile3...&gt; -o &lt;outfile&gt;</span>
 1355 <span class="s2">    PyMOLVisualizeSurfaceAndBuriedResidues.py -h | --help | -e | --examples</span>
 1356 
 1357 <span class="s2">Description:</span>
 1358 <span class="s2">    Generate PyMOL visualization files for viewing surface and buried residues</span>
 1359 <span class="s2">    in macromolecules including proteins and nucleic acids.</span>
 1360 
 1361 <span class="s2">    The supported input file format are: PDB (.pdb), CIF (.cif)</span>
 1362 
 1363 <span class="s2">    The supported output file formats are: PyMOL script file (.pml), PyMOL session</span>
 1364 <span class="s2">    file (.pse)</span>
 1365 
 1366 <span class="s2">    A variety of PyMOL groups and objects may be  created for visualization of</span>
 1367 <span class="s2">    surface and buried residues in macromolecules. These groups and objects</span>
 1368 <span class="s2">    correspond to complexes, surfaces, chains, ligands, and inorganics. A complete</span>
 1369 <span class="s2">    hierarchy of all possible PyMOL groups and objects is shown below:</span>
 1370 <span class="s2">    </span>
 1371 <span class="s2">        &lt;PDBFileRoot&gt;</span>
 1372 <span class="s2">            .Complex</span>
 1373 <span class="s2">                .Complex</span>
 1374 <span class="s2">                .Surface</span>
 1375 <span class="s2">            .Chain&lt;ID&gt;</span>
 1376 <span class="s2">                .Complex</span>
 1377 <span class="s2">                    .Complex</span>
 1378 <span class="s2">                    .Surface</span>
 1379 <span class="s2">                .Chain</span>
 1380 <span class="s2">                    .Chain</span>
 1381 <span class="s2">                    .Surface_Residues</span>
 1382 <span class="s2">                         .Chain</span>
 1383 <span class="s2">                        .Residues</span>
 1384 <span class="s2">                            .Aromatic</span>
 1385 <span class="s2">                                .Residues</span>
 1386 <span class="s2">                                .Surface</span>
 1387 <span class="s2">                            .Hydrophobic</span>
 1388 <span class="s2">                                .Residues</span>
 1389 <span class="s2">                                .Surface</span>
 1390 <span class="s2">                            .Polar</span>
 1391 <span class="s2">                                .Residues</span>
 1392 <span class="s2">                                .Surface</span>
 1393 <span class="s2">                            .Positively_Charged</span>
 1394 <span class="s2">                                .Residues</span>
 1395 <span class="s2">                                .Surface</span>
 1396 <span class="s2">                            .Negatively_Charged</span>
 1397 <span class="s2">                                .Residues</span>
 1398 <span class="s2">                                .Surface</span>
 1399 <span class="s2">                            .Other</span>
 1400 <span class="s2">                                .Residues</span>
 1401 <span class="s2">                                .Surface</span>
 1402 <span class="s2">                        .Surface</span>
 1403 <span class="s2">                            .Surface</span>
 1404 <span class="s2">                            .Hydrophobicity</span>
 1405 <span class="s2">                            .Hydrophobicity_Charge</span>
 1406 <span class="s2">                            .Vacuum_Electrostatics</span>
 1407 <span class="s2">                                .Contact_Potentials</span>
 1408 <span class="s2">                                .Map</span>
 1409 <span class="s2">                                .Legend</span>
 1410 <span class="s2">                    .Buried_Residues</span>
 1411 <span class="s2">                         .Chain</span>
 1412 <span class="s2">                        .Residues</span>
 1413 <span class="s2">                            .Aromatic</span>
 1414 <span class="s2">                                .Residues</span>
 1415 <span class="s2">                                .Surface</span>
 1416 <span class="s2">                            .Hydrophobic</span>
 1417 <span class="s2">                                .Residues</span>
 1418 <span class="s2">                                .Surface</span>
 1419 <span class="s2">                            .Polar</span>
 1420 <span class="s2">                                .Residues</span>
 1421 <span class="s2">                                .Surface</span>
 1422 <span class="s2">                            .Positively_Charged</span>
 1423 <span class="s2">                                .Residues</span>
 1424 <span class="s2">                                .Surface</span>
 1425 <span class="s2">                            .Negatively_Charged</span>
 1426 <span class="s2">                                .Residues</span>
 1427 <span class="s2">                                .Surface</span>
 1428 <span class="s2">                            .Other</span>
 1429 <span class="s2">                                .Residues</span>
 1430 <span class="s2">                                .Surface</span>
 1431 <span class="s2">                        .Surface</span>
 1432 <span class="s2">                            .Surface</span>
 1433 <span class="s2">                            .Hydrophobicity</span>
 1434 <span class="s2">                            .Hydrophobicity_Charge</span>
 1435 <span class="s2">                            .Vacuum_Electrostatics</span>
 1436 <span class="s2">                                .Contact_Potentials</span>
 1437 <span class="s2">                                .Map</span>
 1438 <span class="s2">                                .Legend</span>
 1439 <span class="s2">                .Solvent</span>
 1440 <span class="s2">                .Inorganic</span>
 1441 <span class="s2">                .Ligand&lt;ID&gt;</span>
 1442 <span class="s2">                    .Ligand</span>
 1443 <span class="s2">                        .Ligand</span>
 1444 <span class="s2">                        .BallAndStick</span>
 1445 <span class="s2">                .Ligand&lt;ID&gt;</span>
 1446 <span class="s2">                    .Ligand</span>
 1447 <span class="s2">                        ... ... ...</span>
 1448 <span class="s2">            .Chain&lt;ID&gt;</span>
 1449 <span class="s2">                ... ... ...</span>
 1450 <span class="s2">                .Ligand&lt;ID&gt;</span>
 1451 <span class="s2">                    ... ... ...</span>
 1452 <span class="s2">                .Ligand&lt;ID&gt;</span>
 1453 <span class="s2">                    ... ... ...</span>
 1454 <span class="s2">            .Chain&lt;ID&gt;</span>
 1455 <span class="s2">                ... ... ...</span>
 1456 <span class="s2">        &lt;PDBFileRoot&gt;</span>
 1457 <span class="s2">            .Complex</span>
 1458 <span class="s2">                ... ... ...</span>
 1459 <span class="s2">            .Chain&lt;ID&gt;</span>
 1460 <span class="s2">                ... ... ...</span>
 1461 <span class="s2">                .Ligand&lt;ID&gt;</span>
 1462 <span class="s2">                    ... ... ...</span>
 1463 <span class="s2">                .Ligand&lt;ID&gt;</span>
 1464 <span class="s2">                    ... ... ...</span>
 1465 <span class="s2">            .Chain&lt;ID&gt;</span>
 1466 <span class="s2">                ... ... ...</span>
 1467 <span class="s2">    </span>
 1468 <span class="s2">    The hydrophobic and electrostatic surfaces are not created for complete complex</span>
 1469 <span class="s2">    and chain complex in input file(s) by default. A word to the wise: The creation of</span>
 1470 <span class="s2">    surface objects may slow down loading of PML file and generation of PSE file, based</span>
 1471 <span class="s2">    on the size of input complexes. The generation of PSE file may also fail.</span>
 1472 
 1473 <span class="s2">Options:</span>
 1474 <span class="s2">    -a, --align &lt;yes or no&gt;  [default: no]</span>
 1475 <span class="s2">        Align input files to a reference file before visualization.</span>
 1476 <span class="s2">    --alignMethod &lt;align, cealign, super&gt;  [default: super]</span>
 1477 <span class="s2">        Alignment methodology to use for aligning input files to a</span>
 1478 <span class="s2">        reference file.</span>
 1479 <span class="s2">    --alignMode &lt;FirstChain or Complex&gt;  [default: FirstChain]</span>
 1480 <span class="s2">        Portion of input and reference files to use for spatial alignment of</span>
 1481 <span class="s2">        input files against reference file.  Possible values: FirstChain or</span>
 1482 <span class="s2">        Complex.</span>
 1483 <span class="s2">        </span>
 1484 <span class="s2">        The FirstChain mode allows alignment of the first chain in each input</span>
 1485 <span class="s2">        file to the first chain in the reference file along with moving the rest</span>
 1486 <span class="s2">        of the complex to coordinate space of the reference file. The complete</span>
 1487 <span class="s2">        complex in each input file is aligned to the complete complex in reference</span>
 1488 <span class="s2">        file for the Complex mode.</span>
 1489 <span class="s2">    --alignRefFile &lt;filename&gt;  [default: FirstInputFile]</span>
 1490 <span class="s2">        Reference input file name. The default is to use the first input file</span>
 1491 <span class="s2">        name specified using &#39;-i, --infiles&#39; option.</span>
 1492 <span class="s2">    --allowEmptyObjects &lt;yes or no&gt;  [default: no]</span>
 1493 <span class="s2">        Allow creation of empty PyMOL objects corresponding to solvent and</span>
 1494 <span class="s2">        inorganic atom selections across chains and ligands in input file(s). By</span>
 1495 <span class="s2">        default, the empty objects are marked for deletion.</span>
 1496 <span class="s2">    -c, --chainIDs &lt;First, All or ID1,ID2...&gt;  [default: First]</span>
 1497 <span class="s2">        List of chain IDs to use for visualizing surface and buried residues in</span>
 1498 <span class="s2">        macromolecules. Possible values: First, All, or a comma delimited</span>
 1499 <span class="s2">        list of chain IDs. The default is to use the chain ID for the first chain</span>
 1500 <span class="s2">        in each input file.</span>
 1501 <span class="s2">    --cutoffSASA &lt;number&gt;  [default: 2.5]</span>
 1502 <span class="s2">        Solvent Accessible Surface Area (SASA) cutoff value in Angstroms**2</span>
 1503 <span class="s2">        for identification of surface and buried residues in chains. The residues</span>
 1504 <span class="s2">        with SASA less than the cutoff value are considered buried residues.</span>
 1505 <span class="s2">    -e, --examples</span>
 1506 <span class="s2">        Print examples.</span>
 1507 <span class="s2">    -h, --help</span>
 1508 <span class="s2">        Print this help message.</span>
 1509 <span class="s2">    -i, --infiles &lt;infile1,infile2,infile3...&gt;</span>
 1510 <span class="s2">        Input file names.</span>
 1511 <span class="s2">    --labelFontID &lt;number&gt;  [default: 7]</span>
 1512 <span class="s2">        Font ID for drawing labels. Default: 7 (Sans Bold). Valid values: 5 to 16.</span>
 1513 <span class="s2">        The specified value must be a valid PyMOL font ID. No validation is</span>
 1514 <span class="s2">        performed. The complete lists of valid font IDs is available at:</span>
 1515 <span class="s2">        pymolwiki.org/index.php/Label_font_id. Examples: 5 - Sans;</span>
 1516 <span class="s2">        7 - Sans Bold; 9 - Serif; 10 - Serif Bold.</span>
 1517 <span class="s2">    -l, --ligandIDs &lt;Largest, All or ID1,ID2...&gt;  [default: All]</span>
 1518 <span class="s2">        List of ligand IDs to show in chains during visualizing of surface and buried</span>
 1519 <span class="s2">        residues in macromolecules. Possible values: Largest, All, or a comma delimited</span>
 1520 <span class="s2">        list of ligand IDs. The default is to show all ligands present in all or</span>
 1521 <span class="s2">        specified chains in each input file.</span>
 1522 <span class="s2">        </span>
 1523 <span class="s2">        Ligands are identified using organic selection operator available in PyMOL.</span>
 1524 <span class="s2">        It&#39;ll also  identify buffer molecules as ligands. The largest ligand contains</span>
 1525 <span class="s2">        the highest number of heavy atoms.</span>
 1526 <span class="s2">    -o, --outfile &lt;outfile&gt;</span>
 1527 <span class="s2">        Output file name.</span>
 1528 <span class="s2">    -p, --PMLOut &lt;yes or no&gt;  [default: yes]</span>
 1529 <span class="s2">        Save PML file during generation of PSE file.</span>
 1530 <span class="s2">    --residueIDs &lt;yes or no&gt;  [default: no]</span>
 1531 <span class="s2">        List residue IDs (ResName_ResNum) corresponding to surface and buried</span>
 1532 <span class="s2">        residues. The count and residue distribution for these residues is always</span>
 1533 <span class="s2">        listed.</span>
 1534 <span class="s2">    -r, --residueTypes &lt;Type,Color,ResNames,...&gt;  [default: auto]</span>
 1535 <span class="s2">        Residue types, colors, and names to generate for residue groups during</span>
 1536 <span class="s2">        &#39;--residueTypesChain&#39; option. It is only valid for amino acids.</span>
 1537 <span class="s2">        </span>
 1538 <span class="s2">        It is a triplet of comma delimited list of amino acid residues type, residues</span>
 1539 <span class="s2">        color, and a space delimited list three letter residue names. </span>
 1540 <span class="s2">        </span>
 1541 <span class="s2">        The default values for residue type, color, and name triplets  are shown</span>
 1542 <span class="s2">        below:</span>
 1543 <span class="s2">            </span>
 1544 <span class="s2">            Aromatic,brightorange,HIS PHE TRP TYR,</span>
 1545 <span class="s2">            Hydrophobic,orange,ALA GLY VAL LEU ILE PRO MET,</span>
 1546 <span class="s2">            Polar,palegreen,ASN GLN SER THR CYS,</span>
 1547 <span class="s2">            Positively_Charged,marine,ARG LYS,</span>
 1548 <span class="s2">            Negatively_Charged,red,ASP GLU</span>
 1549 <span class="s2">            </span>
 1550 <span class="s2">        The color name must be a valid PyMOL name. No validation is performed.</span>
 1551 <span class="s2">        An amino acid name may appear across multiple residue types. All other</span>
 1552 <span class="s2">        residues are grouped under &#39;Other&#39;.</span>
 1553 <span class="s2">    --residueTypesChain &lt;yes or no&gt;  [default: auto]</span>
 1554 <span class="s2">        Chain residue types. The residue groups are generated using residue types,</span>
 1555 <span class="s2">        colors, and names specified by &#39;--residueTypes&#39; option. It is only valid for</span>
 1556 <span class="s2">        amino acids.  By default, the residue type groups are automatically created</span>
 1557 <span class="s2">        for chains containing amino acids and skipped for chains only containing</span>
 1558 <span class="s2">        nucleic acids.</span>
 1559 <span class="s2">    --surfaceChain &lt;yes or no&gt;  [default: auto]</span>
 1560 <span class="s2">        Surfaces around individual chain colored by hydrophobicity alone and</span>
 1561 <span class="s2">        both hydrophobicity and charge. The hydrophobicity surface is colored</span>
 1562 <span class="s2">        at residue level using Eisenberg hydrophobicity scale for residues and color</span>
 1563 <span class="s2">        gradient specified by &#39;--surfaceColorPalette&#39; option. The  hydrophobicity and</span>
 1564 <span class="s2">        charge surface is colored [ Ref 140 ] at atom level using colors specified for</span>
 1565 <span class="s2">        groups of atoms by &#39;--surfaceAtomTypesColors&#39; option. This scheme allows</span>
 1566 <span class="s2">        simultaneous mapping of hyrophobicity and charge values on the surfaces.</span>
 1567 <span class="s2">        </span>
 1568 <span class="s2">        This option is only valid for amino acids. By default, both surfaces are</span>
 1569 <span class="s2">        automatically created for chains containing amino acids and skipped for</span>
 1570 <span class="s2">        chains containing only nucleic acids.</span>
 1571 <span class="s2">        </span>
 1572 <span class="s2">        In addition, generic surfaces colored by &#39;--surfaceColor&#39; are always created</span>
 1573 <span class="s2">        for chain residues containing amino acids and nucleic acids.</span>
 1574 <span class="s2">    --surfaceChainElectrostatics &lt;yes or no&gt;  [default: no]</span>
 1575 <span class="s2">        Vacuum electrostatics contact potential surface around individual</span>
 1576 <span class="s2">        chain. A word to the wise from PyMOL documentation: The computed protein</span>
 1577 <span class="s2">        contact potentials are only qualitatively useful, due to short cutoffs,</span>
 1578 <span class="s2">        truncation, and lack of solvent &quot;screening&quot;.</span>
 1579 <span class="s2">        </span>
 1580 <span class="s2">        This option is only valid for amino acids. By default, the electrostatics surface</span>
 1581 <span class="s2">        is automatically created for chains containing amino acids and</span>
 1582 <span class="s2">        skipped for chains containing only nucleic acids.</span>
 1583 <span class="s2">    --surfaceChainComplex &lt;yes or no&gt;  [default: no]</span>
 1584 <span class="s2">        Hydrophobic surface around chain complex. The  surface is colored by</span>
 1585 <span class="s2">        hydrophobicity. It is only valid for amino acids.</span>
 1586 <span class="s2">    --surfaceComplex &lt;yes or no&gt;  [default: no]</span>
 1587 <span class="s2">        Hydrophobic surface around complete complex. The  surface is colored by</span>
 1588 <span class="s2">        hydrophobicity. It is only valid for amino acids.</span>
 1589 <span class="s2">    --surfaceAtomTypesColors &lt;ColorType,ColorSpec,...&gt;  [default: auto]</span>
 1590 <span class="s2">        Atom colors for generating surfaces colored by hyrophobicity and charge</span>
 1591 <span class="s2">        around chains and pockets in proteins. It&#39;s a pairwise comma delimited list</span>
 1592 <span class="s2">        of atom color type and color specification for goups of atoms.</span>
 1593 <span class="s2">        </span>
 1594 <span class="s2">        The default values for color types [ Ref 140 ] along wth color specifications</span>
 1595 <span class="s2">        are shown below: </span>
 1596 <span class="s2">            </span>
 1597 <span class="s2">            HydrophobicAtomsColor, yellow,</span>
 1598 <span class="s2">            NegativelyChargedAtomsColor, red,</span>
 1599 <span class="s2">            PositivelyChargedAtomsColor, blue,</span>
 1600 <span class="s2">            OtherAtomsColor, gray90</span>
 1601 <span class="s2">            </span>
 1602 <span class="s2">        The color names must be valid PyMOL names.</span>
 1603 <span class="s2">        </span>
 1604 <span class="s2">        The color values may also be specified as space delimited RGB triplets:</span>
 1605 <span class="s2">             </span>
 1606 <span class="s2">            HydrophobicAtomsColor, 0.95 0.78 0.0,</span>
 1607 <span class="s2">            NegativelyChargedAtomsColor, 1.0 0.4 0.4,</span>
 1608 <span class="s2">            PositivelyChargedAtomsColor, 0.2 0.5 0.8,</span>
 1609 <span class="s2">            OtherAtomsColor, 0.95 0.95 0.95</span>
 1610 <span class="s2">            </span>
 1611 <span class="s2">    --surfaceColors &lt;ColorName1,ColorName2&gt;  [default: lightblue,salmon]</span>
 1612 <span class="s2">        Color names for surface and burieds residues in chains. These colors are not</span>
 1613 <span class="s2">        used for surfaces  colored by hydrophobicity and charge. The color names</span>
 1614 <span class="s2">        must be valid PyMOL names.</span>
 1615 <span class="s2">    --surfaceColorPalette &lt;RedToWhite or WhiteToGreen&gt;  [default: RedToWhite]</span>
 1616 <span class="s2">        Color palette for hydrophobic surfaces around chains and pockets in proteins.</span>
 1617 <span class="s2">        Possible values: RedToWhite or WhiteToGreen from most hydrophobic amino</span>
 1618 <span class="s2">        acid to least hydrophobic. The colors values for amino acids are taken from</span>
 1619 <span class="s2">        color_h script available as part of the Script Library at PyMOL Wiki.</span>
 1620 <span class="s2">    --surfaceTransparency &lt;number&gt;  [default: 0.25]</span>
 1621 <span class="s2">        Surface transparency for molecular surfaces.</span>
 1622 <span class="s2">    --overwrite</span>
 1623 <span class="s2">        Overwrite existing files.</span>
 1624 <span class="s2">    -w, --workingdir &lt;dir&gt;</span>
 1625 <span class="s2">        Location of working directory which defaults to the current directory.</span>
 1626 
 1627 <span class="s2">Examples:</span>
 1628 <span class="s2">    To visualize surface and buried residues in the first chain along with the</span>
 1629 <span class="s2">    largest ligand in the first chain, solvents, and inorganics, in a PDB file, and</span>
 1630 <span class="s2">    generate a PML file, type:</span>
 1631 
 1632 <span class="s2">        % PyMOLVisualizeSurfaceAndBuriedResidues.py -i Sample4.pdb</span>
 1633 <span class="s2">          -o Sample4.pml</span>
 1634 
 1635 <span class="s2">    To visualize surface and buries residues in all chain along with all ligands,</span>
 1636 <span class="s2">    solvents, and inorganics, in a PDB file, and generate a PML file, type:</span>
 1637 
 1638 <span class="s2">        % PyMOLVisualizeSurfaceAndBuriedResidues.py -c All -l All</span>
 1639 <span class="s2">          -i Sample4.pdb -o Sample4.pml</span>
 1640 
 1641 <span class="s2">    To visualize surface and buried residues in the first chain at a specific</span>
 1642 <span class="s2">    cutoff using specifc colors for surfaces corresponding to surface and</span>
 1643 <span class="s2">    buried residues, and generate a PML file, type:</span>
 1644 
 1645 <span class="s2">        % PyMOLVisualizeSurfaceAndBuriedResidues.py  --cutoffSASA 3</span>
 1646 <span class="s2">           --surfaceColors &quot;blue,red&quot; -i Sample4.pdb -o Sample4.pml</span>
 1647 
 1648 <span class="s2">    To visualize surface and buried residues in the first chain along with the</span>
 1649 <span class="s2">    largest ligand in the first chain, solvents, and inorganics, in PDB files, along</span>
 1650 <span class="s2">    with aligning first chain in each input file to the first chain inand generate a</span>
 1651 <span class="s2">    PML file, type:</span>
 1652 
 1653 <span class="s2">        % PyMOLVisualizeSurfaceAndBuriedResidues.py --align yes</span>
 1654 <span class="s2">          -i &quot;Sample5.pdb,Sample6.pdb,Sample7.pdb&quot;</span>
 1655 <span class="s2">          -o SampleOut.pml</span>
 1656 
 1657 <span class="s2">Author:</span>
 1658 <span class="s2">    Manish Sud(msud@san.rr.com)</span>
 1659 
 1660 <span class="s2">See also:</span>
 1661 <span class="s2">    DownloadPDBFiles.pl, PyMOLVisualizeCavities.py,</span>
 1662 <span class="s2">    PyMOLVisualizeCryoEMDensity.py, PyMOLVisualizeElectronDensity.py,</span>
 1663 <span class="s2">    PyMOLVisualizeInterfaces.py, PyMOLVisualizeMacromolecules.py</span>
 1664 
 1665 <span class="s2">Copyright:</span>
 1666 <span class="s2">    Copyright (C) 2020 Manish Sud. All rights reserved.</span>
 1667 
 1668 <span class="s2">    The functionality available in this script is implemented using PyMOL, a</span>
 1669 <span class="s2">    molecular visualization system on an open source foundation originally</span>
 1670 <span class="s2">    developed by Warren DeLano.</span>
 1671 
 1672 <span class="s2">    This file is part of MayaChemTools.</span>
 1673 
 1674 <span class="s2">    MayaChemTools is free software; you can redistribute it and/or modify it under</span>
 1675 <span class="s2">    the terms of the GNU Lesser General Public License as published by the Free</span>
 1676 <span class="s2">    Software Foundation; either version 3 of the License, or (at your option) any</span>
 1677 <span class="s2">    later version.</span>
 1678 
 1679 <span class="s2">&quot;&quot;&quot;</span>
 1680 
 1681 <span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
 1682     <span class="n">main</span><span class="p">()</span>
</pre>
<br />
<center>
<img src="../../../images/h2o2.png">
</center>
</body>
</html>
