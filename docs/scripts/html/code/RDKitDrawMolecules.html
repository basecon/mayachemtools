<html>
<head>
<title>MayaChemTools:Code:RDKitDrawMolecules.py</title>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<link rel="stylesheet" type="text/css" href="../../../css/MayaChemToolsPythonCode.css">
</head>
<body leftmargin="20" rightmargin="20" topmargin="10" bottommargin="10">
<br/>
<center>
<a href="http://www.mayachemtools.org" title="MayaChemTools Home"><img src="../../../images/MayaChemToolsLogo.gif" border="0" alt="MayaChemTools"></a>
</center>
<br/>
<pre>
    1 <span class="ch">#!/bin/env python</span>
    2 <span class="c1">#</span>
    3 <span class="c1"># File: RDKitDrawMolecules.py</span>
    4 <span class="c1"># Author: Manish Sud &lt;msud@san.rr.com&gt;</span>
    5 <span class="c1">#</span>
    6 <span class="c1"># Copyright (C) 2020 Manish Sud. All rights reserved.</span>
    7 <span class="c1">#</span>
    8 <span class="c1"># The functionality available in this script is implemented using RDKit, an</span>
    9 <span class="c1"># open source toolkit for cheminformatics developed by Greg Landrum.</span>
   10 <span class="c1">#</span>
   11 <span class="c1"># This file is part of MayaChemTools.</span>
   12 <span class="c1">#</span>
   13 <span class="c1"># MayaChemTools is free software; you can redistribute it and/or modify it under</span>
   14 <span class="c1"># the terms of the GNU Lesser General Public License as published by the Free</span>
   15 <span class="c1"># Software Foundation; either version 3 of the License, or (at your option) any</span>
   16 <span class="c1"># later version.</span>
   17 <span class="c1">#</span>
   18 <span class="c1"># MayaChemTools is distributed in the hope that it will be useful, but without</span>
   19 <span class="c1"># any warranty; without even the implied warranty of merchantability of fitness</span>
   20 <span class="c1"># for a particular purpose.  See the GNU Lesser General Public License for more</span>
   21 <span class="c1"># details.</span>
   22 <span class="c1">#</span>
   23 <span class="c1"># You should have received a copy of the GNU Lesser General Public License</span>
   24 <span class="c1"># along with MayaChemTools; if not, see &lt;http://www.gnu.org/licenses/&gt; or</span>
   25 <span class="c1"># write to the Free Software Foundation Inc., 59 Temple Place, Suite 330,</span>
   26 <span class="c1"># Boston, MA, 02111-1307, USA.</span>
   27 <span class="c1">#</span>
   28 
   29 <span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
   30 
   31 <span class="c1"># Add local python path to the global path and import standard library modules...</span>
   32 <span class="kn">import</span> <span class="nn">os</span>
   33 <span class="kn">import</span> <span class="nn">sys</span><span class="p">;</span>  <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="s2">&quot;..&quot;</span><span class="p">,</span> <span class="s2">&quot;lib&quot;</span><span class="p">,</span> <span class="s2">&quot;Python&quot;</span><span class="p">))</span>
   34 <span class="kn">import</span> <span class="nn">time</span>
   35 <span class="kn">import</span> <span class="nn">re</span>
   36 
   37 <span class="c1"># RDKit imports...</span>
   38 <span class="k">try</span><span class="p">:</span>
   39     <span class="kn">from</span> <span class="nn">rdkit</span> <span class="kn">import</span> <span class="n">rdBase</span>
   40     <span class="kn">from</span> <span class="nn">rdkit</span> <span class="kn">import</span> <span class="n">Chem</span>
   41     <span class="kn">from</span> <span class="nn">rdkit.Chem</span> <span class="kn">import</span> <span class="n">AllChem</span>
   42     <span class="kn">from</span> <span class="nn">rdkit.Chem</span> <span class="kn">import</span> <span class="n">Draw</span>
   43     <span class="kn">from</span> <span class="nn">rdkit.Chem.Draw.MolDrawing</span> <span class="kn">import</span> <span class="n">DrawingOptions</span>
   44 <span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">ErrMsg</span><span class="p">:</span>
   45     <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Failed to import RDKit module/package: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ErrMsg</span><span class="p">)</span>
   46     <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Check/update your RDKit environment and try again.</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
   47     <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
   48 
   49 <span class="c1"># MayaChemTools imports...</span>
   50 <span class="k">try</span><span class="p">:</span>
   51     <span class="kn">from</span> <span class="nn">docopt</span> <span class="kn">import</span> <span class="n">docopt</span>
   52     <span class="kn">import</span> <span class="nn">MiscUtil</span>
   53     <span class="kn">import</span> <span class="nn">RDKitUtil</span>
   54 <span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">ErrMsg</span><span class="p">:</span>
   55     <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Failed to import MayaChemTools module/package: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ErrMsg</span><span class="p">)</span>
   56     <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Check/update your MayaChemTools environment and try again.</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
   57     <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
   58 
   59 <span class="n">ScriptName</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
   60 <span class="n">Options</span> <span class="o">=</span> <span class="p">{}</span>
   61 <span class="n">OptionsInfo</span> <span class="o">=</span> <span class="p">{}</span>
   62 
   63 <span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
   64     <span class="sd">&quot;&quot;&quot;Start execution of the script&quot;&quot;&quot;</span>
   65     
   66     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="s2"> (RDK v</span><span class="si">%s</span><span class="s2">; </span><span class="si">%s</span><span class="s2">): Starting...</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ScriptName</span><span class="p">,</span> <span class="n">rdBase</span><span class="o">.</span><span class="n">rdkitVersion</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">asctime</span><span class="p">()))</span>
   67     
   68     <span class="p">(</span><span class="n">WallClockTime</span><span class="p">,</span> <span class="n">ProcessorTime</span><span class="p">)</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">GetWallClockAndProcessorTime</span><span class="p">()</span>
   69     
   70     <span class="c1"># Retrieve command line arguments and options...</span>
   71     <span class="n">RetrieveOptions</span><span class="p">()</span>
   72     
   73     <span class="c1"># Process and validate command line arguments and options...</span>
   74     <span class="n">ProcessOptions</span><span class="p">()</span>
   75     
   76     <span class="c1"># Perform actions required by the script...</span>
   77     <span class="n">DrawMolecules</span><span class="p">()</span>
   78     
   79     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="s2">: Done...</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ScriptName</span><span class="p">)</span>
   80     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Total time: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">GetFormattedElapsedTime</span><span class="p">(</span><span class="n">WallClockTime</span><span class="p">,</span> <span class="n">ProcessorTime</span><span class="p">))</span>
   81 
   82 <span class="k">def</span> <span class="nf">DrawMolecules</span><span class="p">():</span>
   83     <span class="sd">&quot;&quot;&quot;Draw molecules&quot;&quot;&quot;</span>
   84     
   85     <span class="n">Infile</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Infile&quot;</span><span class="p">]</span>
   86     <span class="n">Outfile</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Outfile&quot;</span><span class="p">]</span>
   87     
   88     <span class="c1"># Read molecules...</span>
   89     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Reading file </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">Infile</span><span class="p">)</span>
   90 
   91     <span class="n">ValidMols</span><span class="p">,</span> <span class="n">MolCount</span><span class="p">,</span> <span class="n">ValidMolCount</span>  <span class="o">=</span> <span class="n">RDKitUtil</span><span class="o">.</span><span class="n">ReadAndValidateMolecules</span><span class="p">(</span><span class="n">Infile</span><span class="p">,</span> <span class="o">**</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfileParams&quot;</span><span class="p">])</span>
   92     
   93     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Total number of molecules: </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">MolCount</span><span class="p">)</span>
   94     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Number of valid molecules: </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ValidMolCount</span><span class="p">)</span>
   95     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Number of ignored molecules: </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MolCount</span> <span class="o">-</span> <span class="n">ValidMolCount</span><span class="p">))</span>
   96 
   97     <span class="c1"># Compute 2D coordinates...</span>
   98     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Compute2DCoords&quot;</span><span class="p">]:</span>
   99         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Computing 2D coordinates...&quot;</span><span class="p">)</span>
  100         <span class="k">for</span> <span class="n">Mol</span> <span class="ow">in</span> <span class="n">ValidMols</span><span class="p">:</span>
  101             <span class="n">AllChem</span><span class="o">.</span><span class="n">Compute2DCoords</span><span class="p">(</span><span class="n">Mol</span><span class="p">)</span>
  102     
  103     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Generating image grid...&quot;</span><span class="p">)</span>
  104     
  105     <span class="c1"># Setup atoms lists for highlighting atoms and bonds...</span>
  106     <span class="n">AtomLists</span> <span class="o">=</span> <span class="n">SetupAtomListsToHighlight</span><span class="p">(</span><span class="n">ValidMols</span><span class="p">)</span>
  107     <span class="n">BondLists</span> <span class="o">=</span> <span class="bp">None</span>
  108         
  109     <span class="c1"># Set up legends...</span>
  110     <span class="n">MolNames</span> <span class="o">=</span> <span class="bp">None</span>
  111     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ShowMolName&quot;</span><span class="p">]:</span>
  112         <span class="n">MolNames</span> <span class="o">=</span> <span class="p">[]</span>
  113         <span class="n">MolCount</span> <span class="o">=</span> <span class="mi">0</span>
  114         <span class="k">for</span> <span class="n">Mol</span> <span class="ow">in</span> <span class="n">ValidMols</span><span class="p">:</span>
  115             <span class="n">MolCount</span> <span class="o">+=</span> <span class="mi">1</span>
  116             <span class="n">MolName</span> <span class="o">=</span> <span class="n">RDKitUtil</span><span class="o">.</span><span class="n">GetMolName</span><span class="p">(</span><span class="n">Mol</span><span class="p">,</span> <span class="n">MolCount</span><span class="p">)</span>
  117             <span class="n">MolNames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">MolName</span><span class="p">)</span>
  118     
  119     <span class="c1"># Perform alignment to a common template...</span>
  120     <span class="n">PerformAlignment</span><span class="p">(</span><span class="n">ValidMols</span><span class="p">)</span>
  121 
  122     <span class="c1"># Generate appropriate output files...</span>
  123     <span class="k">if</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">CheckFileExt</span><span class="p">(</span><span class="n">Outfile</span><span class="p">,</span> <span class="s2">&quot;svg&quot;</span><span class="p">):</span>
  124         <span class="n">GenerateSVGImageFile</span><span class="p">(</span><span class="n">ValidMols</span><span class="p">,</span> <span class="n">MolNames</span><span class="p">,</span> <span class="n">AtomLists</span><span class="p">,</span> <span class="n">BondLists</span><span class="p">)</span>
  125     <span class="k">elif</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">CheckFileExt</span><span class="p">(</span><span class="n">Outfile</span><span class="p">,</span> <span class="s2">&quot;html htm&quot;</span><span class="p">):</span>
  126         <span class="n">GenerateHTMLTableFile</span><span class="p">(</span><span class="n">ValidMols</span><span class="p">,</span> <span class="n">MolNames</span><span class="p">,</span> <span class="n">AtomLists</span><span class="p">,</span> <span class="n">BondLists</span><span class="p">)</span>
  127     <span class="k">else</span><span class="p">:</span>
  128         <span class="n">GenerateImageFile</span><span class="p">(</span><span class="n">ValidMols</span><span class="p">,</span> <span class="n">MolNames</span><span class="p">,</span> <span class="n">AtomLists</span><span class="p">,</span> <span class="n">BondLists</span><span class="p">)</span>
  129     
  130 <span class="k">def</span> <span class="nf">GenerateSVGImageFile</span><span class="p">(</span><span class="n">ValidMols</span><span class="p">,</span> <span class="n">MolNames</span><span class="p">,</span> <span class="n">AtomLists</span><span class="p">,</span> <span class="n">BondLists</span><span class="p">):</span>
  131     <span class="sd">&quot;&quot;&quot;Generate a SVG image file.&quot;&quot;&quot;</span>
  132     
  133     <span class="n">MolsSVGText</span> <span class="o">=</span> <span class="n">RDKitUtil</span><span class="o">.</span><span class="n">GetSVGForMolecules</span><span class="p">(</span><span class="n">ValidMols</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;NumOfMolsPerRow&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MolImageWidth&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MolImageHeight&quot;</span><span class="p">],</span> <span class="n">Legends</span> <span class="o">=</span> <span class="n">MolNames</span><span class="p">,</span> <span class="n">AtomListsToHighlight</span> <span class="o">=</span> <span class="n">AtomLists</span><span class="p">,</span> <span class="n">BondListsToHighlight</span> <span class="o">=</span> <span class="n">BondLists</span><span class="p">,</span> <span class="n">BoldText</span> <span class="o">=</span>  <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;FontBold&quot;</span><span class="p">])</span>
  134     
  135     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Generating SVG image file </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Outfile&quot;</span><span class="p">])</span>
  136     
  137     <span class="n">OutFH</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Outfile&quot;</span><span class="p">],</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
  138     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">MolsSVGText</span><span class="p">)</span>
  139     <span class="n">OutFH</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
  140     
  141 <span class="k">def</span> <span class="nf">GenerateImageFile</span><span class="p">(</span><span class="n">ValidMols</span><span class="p">,</span> <span class="n">MolNames</span><span class="p">,</span> <span class="n">AtomLists</span><span class="p">,</span> <span class="n">BondLists</span><span class="p">):</span>
  142     <span class="sd">&quot;&quot;&quot;Generate a non SVG image file.&quot;&quot;&quot;</span>
  143     
  144     <span class="n">Outfile</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Outfile&quot;</span><span class="p">]</span>
  145     
  146     <span class="n">NumOfMolsPerRow</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;NumOfMolsPerRow&quot;</span><span class="p">]</span>
  147     <span class="n">Width</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MolImageWidth&quot;</span><span class="p">]</span>
  148     <span class="n">Height</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MolImageHeight&quot;</span><span class="p">]</span>
  149     
  150     <span class="c1"># Setup drawing options...</span>
  151     <span class="n">UpdatedDrawingOptions</span> <span class="o">=</span> <span class="n">DrawingOptions</span><span class="p">()</span>
  152     <span class="n">UpdatedDrawingOptions</span><span class="o">.</span><span class="n">atomLabelFontSize</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AtomLabelFontSize&quot;</span><span class="p">])</span>
  153     <span class="n">UpdatedDrawingOptions</span><span class="o">.</span><span class="n">bondLineWidth</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;BondLineWidth&quot;</span><span class="p">])</span>
  154     
  155     <span class="n">MolsImage</span> <span class="o">=</span> <span class="n">Draw</span><span class="o">.</span><span class="n">MolsToGridImage</span><span class="p">(</span><span class="n">ValidMols</span><span class="p">,</span> <span class="n">molsPerRow</span> <span class="o">=</span> <span class="n">NumOfMolsPerRow</span><span class="p">,</span>  <span class="n">subImgSize</span> <span class="o">=</span> <span class="p">(</span><span class="n">Width</span><span class="p">,</span><span class="n">Height</span><span class="p">),</span> <span class="n">legends</span> <span class="o">=</span> <span class="n">MolNames</span><span class="p">,</span> <span class="n">highlightAtomLists</span> <span class="o">=</span> <span class="n">AtomLists</span><span class="p">,</span> <span class="n">highlightBondLists</span> <span class="o">=</span> <span class="n">BondLists</span><span class="p">,</span> <span class="n">useSVG</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">kekulize</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Kekulize&quot;</span><span class="p">],</span>  <span class="n">options</span> <span class="o">=</span> <span class="n">UpdatedDrawingOptions</span><span class="p">)</span>
  156     
  157     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Generating image file </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">Outfile</span><span class="p">)</span>
  158     
  159     <span class="k">if</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">CheckFileExt</span><span class="p">(</span><span class="n">Outfile</span><span class="p">,</span> <span class="s2">&quot;pdf&quot;</span><span class="p">):</span>
  160         <span class="k">if</span> <span class="n">MolsImage</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;RGBA&#39;</span><span class="p">:</span>
  161             <span class="n">MolsImage</span> <span class="o">=</span> <span class="n">MolsImage</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s1">&#39;RGB&#39;</span><span class="p">)</span>
  162     
  163     <span class="n">MolsImage</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">Outfile</span><span class="p">)</span>
  164     
  165 <span class="k">def</span> <span class="nf">GenerateHTMLTableFile</span><span class="p">(</span><span class="n">ValidMols</span><span class="p">,</span> <span class="n">MolNames</span><span class="p">,</span> <span class="n">HighlightAtomLists</span><span class="p">,</span> <span class="n">HighlightBondLists</span><span class="p">):</span>
  166     <span class="sd">&quot;&quot;&quot;Generate a HTML table file.&quot;&quot;&quot;</span>
  167 
  168     <span class="n">Outfile</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Outfile&quot;</span><span class="p">]</span>
  169     
  170     <span class="n">Writer</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">Outfile</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
  171     <span class="k">if</span> <span class="n">Writer</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
  172         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;Failed to setup a writer for output fie </span><span class="si">%s</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">Outfile</span><span class="p">)</span>
  173     
  174     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Generating HTML table file </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">Outfile</span><span class="p">)</span>
  175 
  176     <span class="n">WriteHTMLPageHeader</span><span class="p">(</span><span class="n">Writer</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ValidMols</span><span class="p">))</span>
  177     <span class="n">WriteHTMLPageTitle</span><span class="p">(</span><span class="n">Writer</span><span class="p">)</span>
  178     
  179     <span class="n">WriteHTMLTableHeader</span><span class="p">(</span><span class="n">Writer</span><span class="p">)</span>
  180     <span class="n">WriteHTMLTableRows</span><span class="p">(</span><span class="n">Writer</span><span class="p">,</span> <span class="n">ValidMols</span><span class="p">,</span> <span class="n">MolNames</span><span class="p">,</span> <span class="n">HighlightAtomLists</span><span class="p">,</span> <span class="n">HighlightBondLists</span><span class="p">)</span>
  181     <span class="n">WriteHTMLTableEnd</span><span class="p">(</span><span class="n">Writer</span><span class="p">)</span>
  182     
  183     <span class="n">WriteHTMLPageFooter</span><span class="p">(</span><span class="n">Writer</span><span class="p">)</span>
  184     <span class="n">WriteHTMLPageEnd</span><span class="p">(</span><span class="n">Writer</span><span class="p">)</span>
  185     
  186     <span class="k">if</span> <span class="n">Writer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
  187         <span class="n">Writer</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
  188 
  189 <span class="k">def</span> <span class="nf">WriteHTMLTableRows</span><span class="p">(</span><span class="n">Writer</span><span class="p">,</span> <span class="n">ValidMols</span><span class="p">,</span> <span class="n">MolNames</span><span class="p">,</span> <span class="n">HighlightAtomLists</span><span class="p">,</span> <span class="n">HighlightBondLists</span><span class="p">):</span>
  190     <span class="sd">&quot;&quot;&quot;Write out HTML table rows.&quot;&quot;&quot;</span>
  191 
  192     <span class="n">WriteTableHeaderRow</span><span class="p">(</span><span class="n">Writer</span><span class="p">,</span> <span class="n">ValidMols</span><span class="p">)</span>
  193     <span class="n">WriteTableDataRows</span><span class="p">(</span><span class="n">Writer</span><span class="p">,</span> <span class="n">ValidMols</span><span class="p">,</span> <span class="n">MolNames</span><span class="p">,</span> <span class="n">HighlightAtomLists</span><span class="p">,</span> <span class="n">HighlightBondLists</span><span class="p">)</span>
  194     <span class="n">WriteTableFooterRow</span><span class="p">(</span><span class="n">Writer</span><span class="p">,</span> <span class="n">ValidMols</span><span class="p">)</span>
  195 
  196 <span class="k">def</span> <span class="nf">WriteTableDataRows</span><span class="p">(</span><span class="n">Writer</span><span class="p">,</span> <span class="n">ValidMols</span><span class="p">,</span> <span class="n">MolNames</span><span class="p">,</span> <span class="n">HighlightAtomLists</span><span class="p">,</span> <span class="n">HighlightBondLists</span><span class="p">):</span>
  197     <span class="sd">&quot;&quot;&quot;Write out table data row.&quot;&quot;&quot;</span>
  198 
  199     <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;        &lt;tbody&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  200 
  201     <span class="n">MolCount</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ValidMols</span><span class="p">)</span>
  202     <span class="n">ColCount</span> <span class="o">=</span> <span class="n">GetColCount</span><span class="p">(</span><span class="n">MolCount</span><span class="p">)</span>
  203 
  204     <span class="k">for</span> <span class="n">Index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">MolCount</span><span class="p">,</span> <span class="n">ColCount</span><span class="p">):</span>
  205         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;          &lt;tr&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  206     
  207         <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;CounterCol&quot;</span><span class="p">]:</span>
  208             <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;            &lt;td&gt;&lt;/td&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  209 
  210         <span class="k">for</span> <span class="n">MolIndex</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Index</span><span class="p">,</span> <span class="p">(</span><span class="n">Index</span> <span class="o">+</span> <span class="n">ColCount</span><span class="p">)):</span>
  211             <span class="n">SetupStructureDataDrawing</span><span class="p">(</span><span class="n">Writer</span><span class="p">,</span> <span class="n">MolIndex</span><span class="p">,</span> <span class="n">ValidMols</span><span class="p">,</span> <span class="n">MolNames</span><span class="p">,</span> <span class="n">HighlightAtomLists</span><span class="p">,</span> <span class="n">HighlightBondLists</span><span class="p">)</span>
  212         
  213         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;          &lt;/tr&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  214         
  215     <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;        &lt;/tbody&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  216 
  217 <span class="k">def</span> <span class="nf">SetupStructureDataDrawing</span><span class="p">(</span><span class="n">Writer</span><span class="p">,</span> <span class="n">MolIndex</span><span class="p">,</span> <span class="n">Mols</span><span class="p">,</span> <span class="n">MolNames</span><span class="p">,</span> <span class="n">HighlightAtomLists</span><span class="p">,</span> <span class="n">HighlightBondLists</span><span class="p">):</span>
  218     <span class="sd">&quot;&quot;&quot;Setup structure data drawing for a tabel cell.&quot;&quot;&quot;</span>
  219     
  220     <span class="k">if</span> <span class="n">MolIndex</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Mols</span><span class="p">):</span>
  221         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;            &lt;td&gt;&lt;/td&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  222         <span class="k">return</span>
  223 
  224     <span class="n">Mol</span> <span class="o">=</span> <span class="n">Mols</span><span class="p">[</span><span class="n">MolIndex</span><span class="p">]</span>
  225     <span class="n">MolName</span> <span class="o">=</span> <span class="bp">None</span> <span class="k">if</span> <span class="n">MolNames</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">MolNames</span><span class="p">[</span><span class="n">MolIndex</span><span class="p">]</span>
  226     <span class="n">HighlightAtomList</span> <span class="o">=</span> <span class="bp">None</span> <span class="k">if</span> <span class="n">HighlightAtomLists</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">HighlightAtomLists</span><span class="p">[</span><span class="n">MolIndex</span><span class="p">]</span>
  227     <span class="n">HighlightBondList</span> <span class="o">=</span> <span class="bp">None</span> <span class="k">if</span> <span class="n">HighlightBondLists</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">HighlightBondLists</span><span class="p">[</span><span class="n">MolIndex</span><span class="p">]</span>
  228     
  229     <span class="n">SVGText</span> <span class="o">=</span> <span class="n">RDKitUtil</span><span class="o">.</span><span class="n">GetInlineSVGForMolecule</span><span class="p">(</span><span class="n">Mol</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MolImageWidth&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MolImageHeight&quot;</span><span class="p">],</span> <span class="n">Legend</span> <span class="o">=</span> <span class="n">MolName</span><span class="p">,</span> <span class="n">AtomListToHighlight</span> <span class="o">=</span> <span class="n">HighlightAtomList</span><span class="p">,</span> <span class="n">BondListToHighlight</span> <span class="o">=</span> <span class="n">HighlightBondList</span><span class="p">,</span> <span class="n">BoldText</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;FontBold&quot;</span><span class="p">],</span> <span class="n">Base64Encoded</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MolImageEncoded&quot;</span><span class="p">])</span>
  230 
  231     <span class="n">PopoverTag</span> <span class="o">=</span> <span class="n">GetMolPopoverTag</span><span class="p">(</span><span class="n">Mol</span><span class="p">)</span>
  232     <span class="n">ImageTag</span> <span class="o">=</span> <span class="s2">&quot;img&quot;</span> <span class="k">if</span> <span class="n">PopoverTag</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="s2">&quot;img </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PopoverTag</span>
  233     
  234     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MolImageEncoded&quot;</span><span class="p">]:</span>
  235         <span class="n">SVGInlineImageTag</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> src=</span><span class="se">\&quot;</span><span class="s2">data:image/svg+xml;base64,</span><span class="se">\n</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ImageTag</span><span class="p">,</span> <span class="n">SVGText</span><span class="p">)</span>
  236     <span class="k">else</span><span class="p">:</span>
  237         <span class="n">SVGInlineImageTag</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> src=</span><span class="se">\&quot;</span><span class="s2">data:image/svg+xml;charset=UTF-8,</span><span class="se">\n</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ImageTag</span><span class="p">,</span> <span class="n">SVGText</span><span class="p">)</span>
  238     
  239     <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;            &lt;td bgcolor=&quot;white&quot;&gt;&lt;</span><span class="si">%s</span><span class="s2">&gt;&lt;/td&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">SVGInlineImageTag</span><span class="p">)</span>
  240 
  241 <span class="k">def</span> <span class="nf">WriteTableHeaderRow</span><span class="p">(</span><span class="n">Writer</span><span class="p">,</span> <span class="n">ValidMols</span><span class="p">):</span>
  242     <span class="sd">&quot;&quot;&quot;Write out table header row.&quot;&quot;&quot;</span>
  243 
  244     <span class="k">if</span> <span class="ow">not</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;TableHeader&quot;</span><span class="p">]:</span>
  245         <span class="k">return</span>
  246     
  247     <span class="n">TableHeaderStyle</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;TableHeaderStyle&quot;</span><span class="p">]</span>
  248     <span class="k">if</span> <span class="n">TableHeaderStyle</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
  249         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;      &lt;thead&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  250         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;        &lt;tr&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  251     <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(thead|table)&quot;</span><span class="p">,</span> <span class="n">TableHeaderStyle</span><span class="p">):</span>
  252         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;      &lt;thead class=&quot;</span><span class="si">%s</span><span class="s2">&quot;&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">TableHeaderStyle</span><span class="p">)</span>
  253         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;        &lt;tr&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  254     <span class="k">else</span><span class="p">:</span>
  255         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;      &lt;thead&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  256         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;        &lt;tr bgcolor=&quot;</span><span class="si">%s</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">TableHeaderStyle</span><span class="p">)</span>
  257 
  258     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;CounterCol&quot;</span><span class="p">]:</span>
  259         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;          &lt;th&gt;&lt;/th&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  260     
  261     <span class="c1"># Write out rest of the column headers...</span>
  262     <span class="n">MolCount</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ValidMols</span><span class="p">)</span>
  263     <span class="n">ColCount</span> <span class="o">=</span> <span class="n">GetColCount</span><span class="p">(</span><span class="n">MolCount</span><span class="p">)</span>
  264     <span class="k">for</span> <span class="n">ColIndex</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ColCount</span><span class="p">):</span>
  265         <span class="n">ColLabel</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">GetExcelStyleColumnLabel</span><span class="p">(</span><span class="n">ColIndex</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
  266         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;          &lt;th&gt;</span><span class="si">%s</span><span class="s2">&lt;/th&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">ColLabel</span><span class="p">)</span>
  267         
  268     <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;        &lt;/tr&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  269     <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;      &lt;/thead&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  270 
  271 <span class="k">def</span> <span class="nf">WriteTableFooterRow</span><span class="p">(</span><span class="n">Writer</span><span class="p">,</span> <span class="n">ValidMols</span><span class="p">):</span>
  272     <span class="sd">&quot;&quot;&quot;Write out table footer row.&quot;&quot;&quot;</span>
  273 
  274     <span class="k">if</span> <span class="ow">not</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;TableFooter&quot;</span><span class="p">]:</span>
  275         <span class="k">return</span>
  276     
  277     <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;      &lt;tfoot&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  278     <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;        &lt;tr&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  279 
  280     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;CounterCol&quot;</span><span class="p">]:</span>
  281         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;          &lt;td&gt;&lt;/td&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  282 
  283     <span class="c1"># Write out rest of the column headers...</span>
  284     <span class="n">MolCount</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ValidMols</span><span class="p">)</span>
  285     <span class="n">ColCount</span> <span class="o">=</span> <span class="n">GetColCount</span><span class="p">(</span><span class="n">MolCount</span><span class="p">)</span>
  286     <span class="k">for</span> <span class="n">ColIndex</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ColCount</span><span class="p">):</span>
  287         <span class="n">ColLabel</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">GetExcelStyleColumnLabel</span><span class="p">(</span><span class="n">ColIndex</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
  288         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;          &lt;td&gt;</span><span class="si">%s</span><span class="s2">&lt;/td&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">ColLabel</span><span class="p">)</span>
  289         
  290     <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;        &lt;/tr&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  291     <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;      &lt;/tfoot&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  292 
  293 <span class="k">def</span> <span class="nf">WriteHTMLPageHeader</span><span class="p">(</span><span class="n">Writer</span><span class="p">,</span> <span class="n">MolCount</span><span class="p">):</span>
  294     <span class="sd">&quot;&quot;&quot;Write out HTML page header.&quot;&quot;&quot;</span>
  295 
  296     <span class="n">ColCount</span> <span class="o">=</span> <span class="n">GetColCount</span><span class="p">(</span><span class="n">MolCount</span><span class="p">)</span>
  297     
  298     <span class="c1"># Exclude counter and structure columns from sorting and searching...</span>
  299     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;CounterCol&quot;</span><span class="p">]:</span>
  300         <span class="n">ColIndicesList</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;0&quot;</span><span class="p">]</span>
  301         <span class="n">ColVisibilityExcludeColIndicesList</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;0&quot;</span><span class="p">]</span>
  302         <span class="n">ColIndexOffset</span> <span class="o">=</span> <span class="mi">1</span>
  303         <span class="n">FreezeLeftColumns</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span>
  304     <span class="k">else</span><span class="p">:</span>
  305         <span class="n">ColIndicesList</span> <span class="o">=</span> <span class="p">[]</span>
  306         <span class="n">ColVisibilityExcludeColIndicesList</span> <span class="o">=</span> <span class="p">[]</span>
  307         <span class="n">ColIndexOffset</span> <span class="o">=</span> <span class="mi">0</span>
  308 
  309     <span class="n">MaxDataColVisColCount</span> <span class="o">=</span> <span class="mi">25</span>
  310     <span class="k">for</span> <span class="n">Index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ColCount</span><span class="p">):</span>
  311         <span class="n">ColIndex</span> <span class="o">=</span> <span class="n">Index</span> <span class="o">+</span> <span class="n">ColIndexOffset</span>
  312         <span class="n">ColIndicesList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ColIndex</span><span class="p">)</span>
  313         
  314         <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ColVisibility&quot;</span><span class="p">]:</span>
  315             <span class="k">if</span> <span class="n">Index</span> <span class="o">&gt;=</span> <span class="n">MaxDataColVisColCount</span><span class="p">:</span>
  316                 <span class="n">ColVisibilityExcludeColIndicesList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span><span class="n">ColIndex</span><span class="p">)</span>
  317     
  318     <span class="n">ColIndices</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">JoinWords</span><span class="p">(</span><span class="n">ColIndicesList</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="p">)</span> <span class="k">if</span>  <span class="nb">len</span><span class="p">(</span><span class="n">ColIndicesList</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
  319     <span class="n">ColVisibilityExcludeColIndices</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">JoinWords</span><span class="p">(</span><span class="n">ColVisibilityExcludeColIndicesList</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ColVisibilityExcludeColIndicesList</span><span class="p">)</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
  320         
  321     <span class="n">DataColVisibilityExclude</span> <span class="o">=</span> <span class="bp">False</span>
  322     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ColVisibility&quot;</span><span class="p">]:</span>
  323         <span class="k">if</span> <span class="n">ColCount</span> <span class="o">&gt;</span> <span class="n">MaxDataColVisColCount</span><span class="p">:</span>
  324             <span class="n">DataColVisibilityExclude</span> <span class="o">=</span> <span class="bp">True</span>
  325             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;The number of data columns, </span><span class="si">%d</span><span class="s2">, is quite large. Only first </span><span class="si">%d</span><span class="s2"> data columns will be available in column visibility pulldown.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ColCount</span><span class="p">,</span> <span class="n">MaxDataColVisColCount</span><span class="p">))</span>
  326             
  327     <span class="n">DisplayButtons</span> <span class="o">=</span> <span class="bp">False</span>
  328     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ColVisibility&quot;</span><span class="p">]:</span>
  329         <span class="k">if</span> <span class="n">ColCount</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
  330             <span class="n">DisplayButtons</span> <span class="o">=</span> <span class="bp">True</span>
  331     
  332     <span class="n">FreezeCols</span> <span class="o">=</span> <span class="bp">False</span>
  333     <span class="k">if</span> <span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;CounterCol&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ScrollX&quot;</span><span class="p">]):</span>
  334         <span class="n">FreezeCols</span> <span class="o">=</span> <span class="bp">True</span>
  335     
  336     <span class="n">Paging</span> <span class="o">=</span> <span class="s2">&quot;true&quot;</span> <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Paging&quot;</span><span class="p">]</span> <span class="k">else</span> <span class="s2">&quot;false&quot;</span>
  337     <span class="n">PageLength</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PageLength&quot;</span><span class="p">]</span>
  338     <span class="n">PagingType</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PagingType&quot;</span><span class="p">]</span>
  339 
  340     <span class="n">ScrollX</span> <span class="o">=</span> <span class="s2">&quot;true&quot;</span> <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ScrollX&quot;</span><span class="p">]</span> <span class="k">else</span> <span class="s2">&quot;false&quot;</span>
  341     
  342     <span class="n">ScrollY</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
  343     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ScrollY&quot;</span><span class="p">]:</span>
  344         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">&quot;vh$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ScrollYSize&quot;</span><span class="p">]):</span>
  345             <span class="n">ScrollY</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ScrollYSize&quot;</span><span class="p">]</span>
  346         <span class="k">else</span><span class="p">:</span>
  347             <span class="n">ScrollY</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ScrollYSize&quot;</span><span class="p">]</span>
  348     
  349     <span class="c1"># Start HTML header...</span>
  350     <span class="n">Title</span> <span class="o">=</span> <span class="s2">&quot;Molecules table&quot;</span> <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Header&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Header&quot;</span><span class="p">]</span>
  351     
  352     <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
  353 <span class="s2">&lt;!doctype html&gt;</span>
  354 <span class="s2">&lt;html lang=&quot;en&quot;&gt;</span>
  355 <span class="s2">&lt;head&gt;</span>
  356 <span class="s2">    &lt;title&gt;</span><span class="si">%s</span><span class="s2">&lt;/title&gt;</span>
  357 <span class="s2">    &lt;meta charset=&quot;utf-8&quot;&gt;</span>
  358 <span class="s2">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1, shrink-to-fit=no&quot;&gt;</span>
  359 <span class="s2">    &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css&quot;&gt;</span>
  360 <span class="s2">    &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://cdn.datatables.net/1.10.16/css/dataTables.bootstrap4.min.css&quot;&gt;</span>
  361 <span class="s2">  </span>
  362 <span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Title</span><span class="p">))</span>
  363 
  364     <span class="k">if</span> <span class="p">(</span><span class="n">FreezeCols</span><span class="p">):</span>
  365         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
  366 <span class="s2">    &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://cdn.datatables.net/fixedcolumns/3.2.4/css/fixedColumns.bootstrap4.min.css&quot;&gt;</span>
  367 <span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  368     
  369     <span class="k">if</span> <span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;KeysNavigation&quot;</span><span class="p">]):</span>
  370         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
  371 <span class="s2">    &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;https://cdn.datatables.net/keytable/2.3.2/css/keyTable.bootstrap4.min.css&quot;&gt;</span>
  372 <span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  373     
  374     <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
  375 
  376 <span class="s2">    &lt;script type=&quot;text/javascript&quot; language=&quot;javascript&quot; src=&quot;https://code.jquery.com/jquery-1.12.4.js&quot;&gt;&lt;/script&gt;</span>
  377 <span class="s2">    &lt;script type=&quot;text/javascript&quot; language=&quot;javascript&quot; src=&quot;https://cdn.datatables.net/1.10.16/js/jquery.dataTables.min.js&quot;&gt;&lt;/script&gt;</span>
  378 <span class="s2">    &lt;script type=&quot;text/javascript&quot; language=&quot;javascript&quot; src=&quot;https://cdn.datatables.net/1.10.16/js/dataTables.bootstrap4.min.js&quot;&gt;&lt;/script&gt;</span>
  379 
  380 <span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  381 
  382     <span class="k">if</span> <span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Popover&quot;</span><span class="p">]):</span>
  383         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
  384 <span class="s2">    &lt;script type=&quot;text/javascript&quot; language=&quot;javascript&quot; src=&quot;https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js&quot;&gt;&lt;/script&gt;</span>
  385 <span class="s2">    &lt;script type=&quot;text/javascript&quot; language=&quot;javascript&quot; src=&quot;https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js&quot;&gt;&lt;/script&gt;</span>
  386 
  387 <span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  388         
  389     <span class="k">if</span> <span class="n">DisplayButtons</span><span class="p">:</span>
  390         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
  391 <span class="s2">    &lt;script type=&quot;text/javascript&quot; language=&quot;javascript&quot; src=&quot;https://cdn.datatables.net/buttons/1.5.1/js/dataTables.buttons.min.js&quot;&gt;&lt;/script&gt;</span>
  392 <span class="s2">    &lt;script type=&quot;text/javascript&quot; language=&quot;javascript&quot; src=&quot;https://cdn.datatables.net/buttons/1.5.1/js/buttons.bootstrap4.min.js&quot;&gt;&lt;/script&gt;</span>
  393 <span class="s2">    &lt;script type=&quot;text/javascript&quot; language=&quot;javascript&quot; src=&quot;https://cdn.datatables.net/buttons/1.5.1/js/buttons.colVis.min.js&quot;&gt;&lt;/script&gt;</span>
  394 
  395 <span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  396     
  397     <span class="k">if</span> <span class="p">(</span><span class="n">FreezeCols</span><span class="p">):</span>
  398         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
  399 <span class="s2">    &lt;script type=&quot;text/javascript&quot; language=&quot;javascript&quot; src=&quot;https://cdn.datatables.net/fixedcolumns/3.2.4/js/dataTables.fixedColumns.min.js&quot;&gt;&lt;/script&gt;</span>
  400 <span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  401     
  402     <span class="k">if</span> <span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;KeysNavigation&quot;</span><span class="p">]):</span>
  403         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
  404 <span class="s2">    &lt;script type=&quot;text/javascript&quot; language=&quot;javascript&quot; src=&quot;https://cdn.datatables.net/keytable/2.3.2/js/dataTables.keyTable.min.js&quot;&gt;&lt;/script&gt;</span>
  405 <span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  406     
  407     <span class="c1"># Intialize table using Bootstrap, DataTables and JQuery frameworks...</span>
  408     <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
  409 
  410 <span class="s2">    &lt;script type=&quot;text/javascript&quot; class=&quot;init&quot;&gt;</span>
  411 
  412 <span class="s2">$(document).ready(function() {</span>
  413 <span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  414 
  415     <span class="k">if</span> <span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Popover&quot;</span><span class="p">]):</span>
  416         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
  417 <span class="s2">    $(&#39;.MolPopover&#39;).popover();</span>
  418 
  419 <span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  420         
  421     <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
  422 <span class="s2">    var MolsTable = $(&#39;#MolsTable&#39;).DataTable( {</span>
  423 <span class="s2">        &quot;columnDefs&quot;: [</span>
  424 <span class="s2">            {</span>
  425 <span class="s2">                &quot;orderable&quot;: false,</span>
  426 <span class="s2">                &quot;searchable&quot;: false,</span>
  427 <span class="s2">                &quot;targets&quot;: [</span><span class="si">%s</span><span class="s2">]</span>
  428 <span class="s2">            },</span>
  429 <span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ColIndices</span><span class="p">))</span>
  430 
  431     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ColVisibility&quot;</span><span class="p">]:</span>
  432         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
  433 <span class="s2">            {</span>
  434 <span class="s2">                &quot;className&quot;: &quot;noColVisCtrl&quot;,</span>
  435 <span class="s2">                &quot;targets&quot;: [</span><span class="si">%s</span><span class="s2">]</span>
  436 <span class="s2">            }</span>
  437 <span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ColVisibilityExcludeColIndices</span><span class="p">))</span>
  438 
  439     <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
  440 <span class="s2">        ],</span>
  441 <span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  442 
  443     <span class="c1"># Set up dom for displaying button and other options...</span>
  444     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ColVisibility&quot;</span><span class="p">]:</span>
  445         <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Paging&quot;</span><span class="p">]:</span>
  446             <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
  447 <span class="s2">        &quot;dom&quot;:  &quot;&lt;&#39;row&#39;&lt;&#39;col-sm-6&#39;l&gt;&lt;&#39;col-sm-6&#39;&lt;&#39;float-right&#39;B&gt;&gt;&gt;&quot; +</span>
  448 <span class="s2">            &quot;&lt;&#39;row&#39;&lt;&#39;col-sm-12&#39;tr&gt;&gt;&quot; +</span>
  449 <span class="s2">            &quot;&lt;&#39;row&#39;&lt;&#39;col-sm-5&#39;i&gt;&lt;&#39;col-sm-7&#39;p&gt;&gt;&quot;,</span>
  450 <span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  451         <span class="k">else</span><span class="p">:</span>
  452             <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
  453 <span class="s2">        &quot;dom&quot;:  &quot;&lt;&#39;row&#39;&lt;&#39;col&#39;&lt;&#39;float-right&#39;B&gt;&gt;&gt;&quot; +</span>
  454 <span class="s2">            &quot;&lt;&#39;row&#39;&lt;&#39;col-sm-12&#39;tr&gt;&gt;&quot; +</span>
  455 <span class="s2">            &quot;&lt;&#39;row&#39;&lt;&#39;col-sm-5&#39;i&gt;&lt;&#39;col-sm-7&#39;p&gt;&gt;&quot;,</span>
  456 <span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  457     <span class="k">else</span><span class="p">:</span>
  458             <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
  459 <span class="s2">        &quot;dom&quot;:  &quot;&lt;&#39;row&#39;&lt;&#39;col&#39;l&gt;&gt;&quot; +</span>
  460 <span class="s2">            &quot;&lt;&#39;row&#39;&lt;&#39;col-sm-12&#39;tr&gt;&gt;&quot; +</span>
  461 <span class="s2">            &quot;&lt;&#39;row&#39;&lt;&#39;col-sm-5&#39;i&gt;&lt;&#39;col-sm-7&#39;p&gt;&gt;&quot;,</span>
  462 <span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  463     
  464     <span class="c1">#</span>
  465     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ColVisibility&quot;</span><span class="p">]:</span>
  466         <span class="c1"># Set up buttons...</span>
  467         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
  468 <span class="s2">        &quot;buttons&quot;: [</span>
  469 <span class="s2">            {</span>
  470 <span class="s2">                &quot;extend&quot;: &quot;colvis&quot;,</span>
  471 <span class="s2">                &quot;text&quot;: &quot;Column visibility&quot;,</span>
  472 <span class="s2">                &quot;className&quot;: &quot;btn btn-outline-light text-dark&quot;,</span>
  473 <span class="s2">                &quot;columns&quot;: &quot;:not(.noColVisCtrl)&quot;,</span>
  474 <span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  475         <span class="k">if</span> <span class="ow">not</span> <span class="n">DataColVisibilityExclude</span><span class="p">:</span>
  476             <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
  477 <span class="s2">                &quot;prefixButtons&quot;: [ &quot;colvisRestore&quot; ],</span>
  478 <span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  479         
  480         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
  481 <span class="s2">                &quot;columnText&quot;: function ( dt, colIndex, colLabel ) {</span>
  482 <span class="s2">                    return &quot;Column &quot; + (colIndex + 1);</span>
  483 <span class="s2">                },</span>
  484 <span class="s2">            }</span>
  485 <span class="s2">        ],</span>
  486 <span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  487     
  488     <span class="c1"># Write out rest of the variables for DataTables...</span>
  489     <span class="k">if</span> <span class="n">FreezeCols</span><span class="p">:</span>
  490         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
  491 <span class="s2">        &quot;fixedColumns&quot;: {</span>
  492 <span class="s2">            &quot;leftColumns&quot;: </span><span class="si">%s</span><span class="s2"></span>
  493 <span class="s2">        },</span>
  494 <span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">FreezeLeftColumns</span><span class="p">))</span>
  495     
  496     <span class="k">if</span> <span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;KeysNavigation&quot;</span><span class="p">]):</span>
  497         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
  498 <span class="s2">        &quot;keys&quot;: true,</span>
  499 <span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  500     
  501     <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
  502 <span class="s2">        &quot;pageLength&quot;: </span><span class="si">%s</span><span class="s2">,</span>
  503 <span class="s2">        &quot;lengthMenu&quot;: [ [5, 10, 15, 25, 50, 100, 500, 1000, -1], [5, 10, 15, 25, 50, 100, 500, 1000, &quot;All&quot;] ],</span>
  504 <span class="s2">        &quot;paging&quot;: </span><span class="si">%s</span><span class="s2">,</span>
  505 <span class="s2">        &quot;pagingType&quot;: </span><span class="si">%s</span><span class="s2">,</span>
  506 <span class="s2">        &quot;scrollX&quot;: </span><span class="si">%s</span><span class="s2">,</span>
  507 <span class="s2">        &quot;scrollY&quot;: </span><span class="si">%s</span><span class="s2">,</span>
  508 <span class="s2">        &quot;scrollCollapse&quot;: true,</span>
  509 <span class="s2">        &quot;order&quot;: [],</span>
  510 <span class="s2">    } );</span>
  511 <span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">PageLength</span><span class="p">,</span> <span class="n">Paging</span><span class="p">,</span> <span class="n">PagingType</span><span class="p">,</span> <span class="n">ScrollX</span><span class="p">,</span> <span class="n">ScrollY</span><span class="p">))</span>
  512     
  513     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;CounterCol&quot;</span><span class="p">]:</span>
  514         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
  515 <span class="s2">    MolsTable.on( &#39;order.dt search.dt&#39;, function () {</span>
  516 <span class="s2">        MolsTable.column(0, {search:&#39;applied&#39;, order:&#39;applied&#39;}).nodes().each( function (cell, rowIndex) {</span>
  517 <span class="s2">            cell.innerHTML = rowIndex + 1;</span>
  518 <span class="s2">        } );</span>
  519 <span class="s2">    } ).draw();</span>
  520 <span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  521     
  522     <span class="c1"># End of Javacscript code...</span>
  523     <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
  524 <span class="s2">} );</span>
  525 
  526 <span class="s2">    &lt;/script&gt;</span>
  527 <span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  528 
  529     <span class="c1"># Finish up HTML header...</span>
  530     <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
  531 <span class="s2">  </span>
  532 <span class="s2">&lt;/head&gt;</span>
  533 <span class="s2">&lt;body&gt;</span>
  534 <span class="s2">  &lt;div class=&quot;container-fluid&quot;&gt;</span>
  535 <span class="s2">    &lt;br/&gt;</span>
  536 <span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  537         
  538 <span class="k">def</span> <span class="nf">WriteHTMLPageEnd</span><span class="p">(</span><span class="n">Writer</span><span class="p">):</span>
  539     <span class="sd">&quot;&quot;&quot;Write out HTML page end.&quot;&quot;&quot;</span>
  540 
  541     <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
  542 <span class="s2">  &lt;/div&gt;</span>
  543 <span class="s2">&lt;/body&gt;</span>
  544 <span class="s2">&lt;/html&gt;</span>
  545 <span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  546 
  547 <span class="k">def</span> <span class="nf">WriteHTMLPageTitle</span><span class="p">(</span><span class="n">Writer</span><span class="p">):</span>
  548     <span class="sd">&quot;&quot;&quot;Write out HTML page title.&quot;&quot;&quot;</span>
  549 
  550     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Header&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
  551         <span class="k">return</span>
  552 
  553     <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;    &lt;</span><span class="si">%s</span><span class="s2"> class=&quot;text-center&quot;&gt;</span><span class="si">%s</span><span class="s2">&lt;/</span><span class="si">%s</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HeaderStyle&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Header&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HeaderStyle&quot;</span><span class="p">]))</span>
  554 
  555 <span class="k">def</span> <span class="nf">WriteHTMLPageFooter</span><span class="p">(</span><span class="n">Writer</span><span class="p">):</span>
  556     <span class="sd">&quot;&quot;&quot;Write out HTML page footer.&quot;&quot;&quot;</span>
  557 
  558     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Footer&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
  559         <span class="k">return</span>
  560 
  561     <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;    &lt;br/&gt;</span><span class="se">\n</span><span class="s2">    &lt;p class=&quot;</span><span class="si">%s</span><span class="s2">&quot;&gt;</span><span class="si">%s</span><span class="s2">&lt;/p&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;FooterClass&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Footer&quot;</span><span class="p">]))</span>
  562 
  563 <span class="k">def</span> <span class="nf">WriteHTMLTableHeader</span><span class="p">(</span><span class="n">Writer</span><span class="p">):</span>
  564     <span class="sd">&quot;&quot;&quot;Write out HTML table header.&quot;&quot;&quot;</span>
  565 
  566     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;TableStyle&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
  567         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">    &lt;table id=&quot;MolsTable&quot; cellspacing=&quot;0&quot; width=&quot;100%&quot;&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  568     <span class="k">else</span><span class="p">:</span>
  569         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;    &lt;table id=&quot;MolsTable&quot; class=&quot;</span><span class="si">%s</span><span class="s2">&quot; cellspacing=&quot;0&quot; width=&quot;100</span><span class="si">%s</span><span class="s2">&quot;&gt;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;TableStyle&quot;</span><span class="p">],</span> <span class="s2">&quot;%&quot;</span><span class="p">))</span>
  570         
  571 <span class="k">def</span> <span class="nf">WriteHTMLTableEnd</span><span class="p">(</span><span class="n">Writer</span><span class="p">):</span>
  572     <span class="sd">&quot;&quot;&quot;Write out HTML table end.&quot;&quot;&quot;</span>
  573 
  574     <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;    &lt;/table&gt;</span><span class="se">\n\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  575 
  576 <span class="k">def</span> <span class="nf">GetColCount</span><span class="p">(</span><span class="n">MolCount</span><span class="p">):</span>
  577     <span class="sd">&quot;&quot;&quot;Get tabke column count.&quot;&quot;&quot;</span>
  578     
  579     <span class="n">ColCount</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;NumOfMolsPerRow&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;NumOfMolsPerRow&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">MolCount</span> <span class="k">else</span> <span class="n">MolCount</span>
  580     
  581     <span class="k">return</span> <span class="n">ColCount</span>
  582 
  583 <span class="k">def</span> <span class="nf">SetupAtomListsToHighlight</span><span class="p">(</span><span class="n">ValidMols</span><span class="p">):</span>
  584     <span class="sd">&quot;&quot;&quot;Set up atom lists to highlight using specified SMARTS pattern.&quot;&quot;&quot;</span>
  585 
  586     <span class="n">AtomListsToHighlight</span> <span class="o">=</span> <span class="bp">None</span>
  587     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightSMARTSPattern&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
  588         <span class="k">return</span>  <span class="n">AtomListsToHighlight</span>
  589     
  590     <span class="n">PatternMol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmarts</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightSMARTSPattern&quot;</span><span class="p">])</span>
  591     <span class="n">AtomListsToHighlight</span> <span class="o">=</span> <span class="p">[]</span>
  592     <span class="k">for</span> <span class="n">ValidMol</span> <span class="ow">in</span> <span class="n">ValidMols</span><span class="p">:</span>
  593         <span class="c1"># Get matched atom lists and flatten it...</span>
  594         <span class="n">MatchedAtomsLists</span> <span class="o">=</span> <span class="n">ValidMol</span><span class="o">.</span><span class="n">GetSubstructMatches</span><span class="p">(</span><span class="n">PatternMol</span><span class="p">)</span>
  595         <span class="n">MatchedAtoms</span> <span class="o">=</span> <span class="p">[</span> <span class="n">Atom</span> <span class="k">for</span> <span class="n">AtomsList</span> <span class="ow">in</span> <span class="n">MatchedAtomsLists</span> <span class="k">for</span> <span class="n">Atom</span> <span class="ow">in</span> <span class="n">AtomsList</span><span class="p">]</span> 
  596         <span class="n">AtomListsToHighlight</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">MatchedAtoms</span><span class="p">)</span>
  597     
  598     <span class="k">return</span>  <span class="n">AtomListsToHighlight</span>
  599 
  600 <span class="k">def</span> <span class="nf">PerformAlignment</span><span class="p">(</span><span class="n">ValidMols</span><span class="p">):</span>
  601     <span class="sd">&quot;&quot;&quot;Perform alignment to a common template specified by a SMARTS pattern.&quot;&quot;&quot;</span>
  602     
  603     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AlignmentSMARTSPattern&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
  604         <span class="k">return</span>
  605     
  606     <span class="n">PatternMol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmarts</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AlignmentSMARTSPattern&quot;</span><span class="p">])</span>
  607     <span class="n">AllChem</span><span class="o">.</span><span class="n">Compute2DCoords</span><span class="p">(</span><span class="n">PatternMol</span><span class="p">)</span>
  608         
  609     <span class="n">MatchedValidMols</span> <span class="o">=</span> <span class="p">[</span><span class="n">ValidMol</span> <span class="k">for</span> <span class="n">ValidMol</span> <span class="ow">in</span> <span class="n">ValidMols</span> <span class="k">if</span> <span class="n">ValidMol</span><span class="o">.</span><span class="n">HasSubstructMatch</span><span class="p">(</span><span class="n">PatternMol</span><span class="p">)]</span>
  610     <span class="k">for</span> <span class="n">ValidMol</span> <span class="ow">in</span> <span class="n">MatchedValidMols</span><span class="p">:</span>
  611         <span class="n">AllChem</span><span class="o">.</span><span class="n">GenerateDepictionMatching2DStructure</span><span class="p">(</span><span class="n">ValidMol</span><span class="p">,</span> <span class="n">PatternMol</span><span class="p">)</span>
  612 
  613 <span class="k">def</span> <span class="nf">GetMolPopoverTag</span><span class="p">(</span><span class="n">Mol</span><span class="p">):</span>
  614     <span class="sd">&quot;&quot;&quot;Set up a popover window containing any additional information about molecule.&quot;&quot;&quot;</span>
  615     
  616     <span class="k">if</span> <span class="ow">not</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Popover&quot;</span><span class="p">]:</span>
  617         <span class="k">return</span> <span class="bp">None</span>
  618     
  619     <span class="c1"># Set up data label and values...</span>
  620     <span class="n">AvailableDataLabels</span> <span class="o">=</span> <span class="n">Mol</span><span class="o">.</span><span class="n">GetPropNames</span><span class="p">(</span><span class="n">includePrivate</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">includeComputed</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
  621     
  622     <span class="n">DataContentLines</span> <span class="o">=</span> <span class="p">[]</span>
  623     <span class="n">MaxDataCharWidth</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PopoverTextWidth&quot;</span><span class="p">]</span>
  624     <span class="n">MaxDataDisplayCount</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PopoverDataCount&quot;</span><span class="p">]</span>
  625 
  626     <span class="n">DataDisplayCount</span> <span class="o">=</span> <span class="mi">0</span>
  627     <span class="n">SkippedDataDisplay</span> <span class="o">=</span> <span class="bp">False</span>
  628     <span class="k">for</span> <span class="n">DataLabel</span> <span class="ow">in</span> <span class="n">AvailableDataLabels</span><span class="p">:</span>
  629         <span class="n">DataDisplayCount</span> <span class="o">+=</span> <span class="mi">1</span>
  630         <span class="k">if</span> <span class="n">DataDisplayCount</span> <span class="o">&gt;</span> <span class="n">MaxDataDisplayCount</span><span class="p">:</span>
  631             <span class="n">SkippedDataDisplay</span> <span class="o">=</span> <span class="bp">True</span>
  632             <span class="k">break</span>
  633         
  634         <span class="n">DataValue</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">Mol</span><span class="o">.</span><span class="n">GetProp</span><span class="p">(</span><span class="n">DataLabel</span><span class="p">)</span>
  635         <span class="n">DataValue</span> <span class="o">=</span> <span class="n">DataValue</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
  636         <span class="k">if</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">IsEmpty</span><span class="p">(</span><span class="n">DataValue</span><span class="p">):</span>
  637             <span class="k">continue</span>
  638 
  639         <span class="c1"># Change any new lines to ;</span>
  640         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">&quot;(</span><span class="se">\r\n</span><span class="s2">|</span><span class="se">\r</span><span class="s2">|</span><span class="se">\n</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">DataValue</span><span class="p">):</span>
  641             <span class="n">DataValue</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;(</span><span class="se">\r\n</span><span class="s2">|</span><span class="se">\r</span><span class="s2">|</span><span class="se">\n</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="s2">&quot;; &quot;</span><span class="p">,</span> <span class="n">DataValue</span><span class="p">)</span>
  642         
  643         <span class="n">DataValue</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">TruncateText</span><span class="p">(</span><span class="n">DataValue</span><span class="p">,</span> <span class="n">MaxDataCharWidth</span><span class="p">,</span> <span class="s2">&quot;...&quot;</span><span class="p">)</span>
  644         <span class="n">DataValue</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ReplaceHTMLEntitiesInText</span><span class="p">(</span><span class="n">DataValue</span><span class="p">)</span>
  645         
  646         <span class="n">DataContent</span> <span class="o">=</span> <span class="s2">&quot;&lt;b&gt;</span><span class="si">%s</span><span class="s2">&lt;/b&gt;: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">DataLabel</span><span class="p">,</span> <span class="n">DataValue</span><span class="p">)</span>
  647         <span class="n">DataContentLines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DataContent</span><span class="p">)</span>
  648 
  649     <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">DataContentLines</span><span class="p">):</span>
  650         <span class="k">return</span> <span class="bp">None</span>
  651 
  652     <span class="k">if</span> <span class="n">SkippedDataDisplay</span><span class="p">:</span>
  653         <span class="n">DataContent</span> <span class="o">=</span> <span class="s2">&quot;&lt;b&gt;... ... ...&lt;/b&gt;&quot;</span>
  654         <span class="n">DataContentLines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DataContent</span><span class="p">)</span>
  655         
  656         <span class="n">DataContent</span> <span class="o">=</span> <span class="s2">&quot;Showing 1 to </span><span class="si">%s</span><span class="s2"> of </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MaxDataDisplayCount</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">AvailableDataLabels</span><span class="p">))</span>
  657         <span class="n">DataContentLines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DataContent</span><span class="p">)</span>
  658     <span class="k">else</span><span class="p">:</span>
  659         <span class="n">DataContent</span> <span class="o">=</span> <span class="s2">&quot;Showing 1 to </span><span class="si">%s</span><span class="s2"> of </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">DataDisplayCount</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">AvailableDataLabels</span><span class="p">))</span>
  660         <span class="n">DataContentLines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DataContent</span><span class="p">)</span>
  661         
  662     <span class="n">DataContent</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">JoinWords</span><span class="p">(</span><span class="n">DataContentLines</span><span class="p">,</span> <span class="s2">&quot;&lt;br/&gt;&quot;</span><span class="p">)</span>
  663     <span class="n">PopoverTag</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;class=&quot;MolPopover&quot; data-toggle=&quot;popover&quot; data-html=&quot;true&quot; data-trigger=&quot;click&quot; data-placement=&quot;right&quot; title=&quot;&lt;span class=&#39;small&#39;&gt;&lt;b&gt;Additional Information&lt;/b&gt;&lt;/span&gt;&quot; data-content=&quot;&lt;span class=&#39;small&#39;&gt;</span><span class="si">%s</span><span class="s2">&lt;/span&gt;&quot; &quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">DataContent</span>
  664     
  665     <span class="k">return</span> <span class="n">PopoverTag</span>
  666 
  667 <span class="k">def</span> <span class="nf">ProcessOptions</span><span class="p">():</span>
  668     <span class="sd">&quot;&quot;&quot;Process and validate command line arguments and options&quot;&quot;&quot;</span>
  669     
  670     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Processing options...&quot;</span><span class="p">)</span>
  671     
  672     <span class="c1"># Validate options...</span>
  673     <span class="n">ValidateOptions</span><span class="p">()</span>
  674     
  675     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Infile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--infile&quot;</span><span class="p">]</span>
  676     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Outfile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--outfile&quot;</span><span class="p">]</span>
  677     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Overwrite&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--overwrite&quot;</span><span class="p">]</span>
  678     
  679     <span class="c1"># No need for any RDKit specific --outfileParams....</span>
  680     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfileParams&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ProcessOptionInfileParameters</span><span class="p">(</span><span class="s2">&quot;--infileParams&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--infileParams&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Infile&quot;</span><span class="p">])</span>
  681 
  682     <span class="n">AlignmentSMARTSPattern</span> <span class="o">=</span> <span class="bp">None</span>
  683     <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^None$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--alignmentSMARTS&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  684         <span class="n">AlignmentSMARTSPattern</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--alignmentSMARTS&quot;</span><span class="p">]</span>
  685     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AlignmentSMARTSPattern&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">AlignmentSMARTSPattern</span>
  686     
  687     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AtomLabelFontSize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--atomLabelFontSize&quot;</span><span class="p">]</span>
  688     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;BondLineWidth&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--bondLineWidth&quot;</span><span class="p">]</span>
  689     
  690     <span class="n">Compute2DCoords</span> <span class="o">=</span> <span class="bp">True</span>
  691     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^yes$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--compute2DCoords&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  692         <span class="n">Compute2DCoords</span> <span class="o">=</span> <span class="bp">True</span>
  693     <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^no$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--compute2DCoords&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  694         <span class="n">Compute2DCoords</span> <span class="o">=</span> <span class="bp">False</span>
  695     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Compute2DCoords&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">Compute2DCoords</span>
  696 
  697     <span class="n">CounterCol</span> <span class="o">=</span> <span class="bp">True</span>
  698     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^no$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--counterCol&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  699         <span class="n">CounterCol</span> <span class="o">=</span> <span class="bp">False</span>
  700     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;CounterCol&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">CounterCol</span>
  701     
  702     <span class="n">ColVisibility</span> <span class="o">=</span> <span class="bp">True</span>
  703     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^no$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--colVisibility&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  704         <span class="n">ColVisibility</span> <span class="o">=</span> <span class="bp">False</span>
  705     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ColVisibility&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">ColVisibility</span>
  706     
  707     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;FontBold&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
  708     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^no$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--fontBold&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  709         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;FontBold&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
  710         
  711     <span class="n">Footer</span> <span class="o">=</span> <span class="bp">None</span>
  712     <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^None$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--footer&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  713         <span class="n">Footer</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--footer&quot;</span><span class="p">]</span>
  714     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Footer&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">Footer</span>
  715 
  716     <span class="n">FooterClass</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--footerClass&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
  717     <span class="k">if</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">IsEmpty</span><span class="p">(</span><span class="n">FooterClass</span><span class="p">):</span>
  718         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The value specified using option </span><span class="se">\&quot;</span><span class="s2">--footerClass</span><span class="se">\&quot;</span><span class="s2"> is empty.&quot;</span><span class="p">)</span>
  719     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;FooterClass&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">FooterClass</span>
  720     
  721     <span class="n">Header</span> <span class="o">=</span> <span class="bp">None</span>
  722     <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^None$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--header&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  723         <span class="n">Header</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--header&quot;</span><span class="p">]</span>
  724     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Header&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">Header</span>
  725     
  726     <span class="n">HeaderStyle</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--headerStyle&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
  727     <span class="k">if</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">IsEmpty</span><span class="p">(</span><span class="n">HeaderStyle</span><span class="p">):</span>
  728         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The value specified using option </span><span class="se">\&quot;</span><span class="s2">--headerStyle</span><span class="se">\&quot;</span><span class="s2"> is empty.&quot;</span><span class="p">)</span>
  729     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HeaderStyle&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">HeaderStyle</span>
  730     
  731     <span class="n">HighlightSMARTSPattern</span> <span class="o">=</span> <span class="bp">None</span>
  732     <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^None$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--highlightSMARTS&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  733         <span class="n">HighlightSMARTSPattern</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--highlightSMARTS&quot;</span><span class="p">]</span>
  734     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;HighlightSMARTSPattern&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">HighlightSMARTSPattern</span>
  735     
  736     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Kekulize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
  737     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^no$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--kekulize&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  738         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Kekulize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
  739         
  740     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;KeysNavigation&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
  741     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^no$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--keysNavigation&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  742         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;KeysNavigation&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
  743     
  744     <span class="n">SizeValues</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--molImageSize&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
  745     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MolImageWidth&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">SizeValues</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
  746     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MolImageHeight&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">SizeValues</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
  747 
  748     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MolImageEncoded&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
  749     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^no$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--molImageEncoded&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  750         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MolImageEncoded&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
  751     
  752     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;NumOfMolsPerRow&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--numOfMolsPerRow&quot;</span><span class="p">])</span>
  753 
  754     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Paging&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
  755     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^no$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--paging&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  756         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Paging&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
  757     
  758     <span class="n">PagingType</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pagingType&quot;</span><span class="p">]</span>
  759     <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(numbers|simple|simple_numbers|full|full_numbers|simple_number)$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pagingType&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  760         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;The paging type name, </span><span class="si">%s</span><span class="s2">, specified using option </span><span class="se">\&quot;</span><span class="s2">--pagingType</span><span class="se">\&quot;</span><span class="s2"> appears to be a unknown type...&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">PagingType</span><span class="p">))</span>
  761     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PagingType&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PagingType</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
  762     
  763     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PageLength&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pageLength&quot;</span><span class="p">])</span>
  764     
  765     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Popover&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
  766     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^no$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--popover&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  767         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Popover&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
  768     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PopoverDataCount&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--popoverDataCount&quot;</span><span class="p">])</span>
  769     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PopoverTextWidth&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--popoverTextWidth&quot;</span><span class="p">])</span>
  770     
  771     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ShowMolName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
  772     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^no$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--showMolName&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  773         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ShowMolName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
  774     
  775     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ScrollX&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
  776     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^no$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--scrollX&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  777         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ScrollX&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
  778         
  779     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ScrollY&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
  780     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^no$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--scrollY&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  781         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ScrollY&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
  782 
  783     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ScrollYSize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--scrollYSize&quot;</span><span class="p">]</span>
  784     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;vh$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--scrollYSize&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  785         <span class="n">ScrollYSize</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;vh$&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--scrollYSize&quot;</span><span class="p">]))</span>
  786         <span class="k">if</span> <span class="n">ScrollYSize</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
  787             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The value specified, </span><span class="si">%s</span><span class="s2">, for option </span><span class="se">\&quot;</span><span class="s2">--scrollYSize</span><span class="se">\&quot;</span><span class="s2"> is not valid. Supported value: &gt; 0 followed by </span><span class="se">\&quot;</span><span class="s2">vh</span><span class="se">\&quot;</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--scrollYSize&quot;</span><span class="p">])</span>
  788     
  789     <span class="n">TableStyle</span> <span class="o">=</span> <span class="bp">None</span>
  790     <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^None$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--tableStyle&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  791         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^All$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--tableStyle&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  792             <span class="n">TableStyle</span> <span class="o">=</span> <span class="s2">&quot;table table-striped table-bordered table-hover table-dark&quot;</span>
  793         <span class="k">else</span><span class="p">:</span>
  794             <span class="n">TableStyle</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--tableStyle&quot;</span><span class="p">])</span>
  795             <span class="k">for</span> <span class="n">Style</span> <span class="ow">in</span> <span class="p">[</span><span class="n">Style</span> <span class="k">for</span> <span class="n">Style</span> <span class="ow">in</span> <span class="n">TableStyle</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)]:</span>
  796                 <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(table|table-striped|table-bordered|table-hover|table-dark|table-sm)$&quot;</span><span class="p">,</span> <span class="n">Style</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  797                     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;The table style name, </span><span class="si">%s</span><span class="s2">, specified using option </span><span class="se">\&quot;</span><span class="s2">-t, --tableStyle</span><span class="se">\&quot;</span><span class="s2"> appears to be a unknown style...&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Style</span><span class="p">))</span>
  798             <span class="n">TableStyle</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">TableStyle</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
  799     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;TableStyle&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">TableStyle</span>
  800 
  801     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;TableFooter&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
  802     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^no$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--tableFooter&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  803         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;TableFooter&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
  804     
  805     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;TableHeader&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
  806     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^no$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--tableHeader&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  807         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;TableHeader&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
  808     
  809     <span class="n">TableHeaderStyle</span> <span class="o">=</span> <span class="bp">None</span>
  810     <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^None$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--tableHeaderStyle&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  811         <span class="n">TableHeaderStyle</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--tableHeaderStyle&quot;</span><span class="p">]</span>
  812         <span class="n">TableHeaderStyle</span> <span class="o">=</span> <span class="n">TableHeaderStyle</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
  813         <span class="n">CheckOptionTableClassColorValues</span><span class="p">(</span><span class="s2">&quot;--tableHeaderStyle&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">TableHeaderStyle</span><span class="p">])</span>
  814     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;TableHeaderStyle&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">TableHeaderStyle</span>
  815 
  816 <span class="k">def</span> <span class="nf">CheckOptionTableClassColorValues</span><span class="p">(</span><span class="n">OptionName</span><span class="p">,</span> <span class="n">ColorsList</span><span class="p">):</span>
  817     <span class="sd">&quot;&quot;&quot;Check names of table color classes and issue a warning for unknown names.&quot;&quot;&quot;</span>
  818 
  819     <span class="n">TableClassColors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;thead-dark&quot;</span><span class="p">,</span> <span class="s2">&quot;thead-light&quot;</span><span class="p">,</span> <span class="s2">&quot;table-primary&quot;</span><span class="p">,</span> <span class="s2">&quot;table-success&quot;</span><span class="p">,</span> <span class="s2">&quot;table-danger&quot;</span><span class="p">,</span> <span class="s2">&quot;table-info&quot;</span><span class="p">,</span> <span class="s2">&quot;table-warning&quot;</span><span class="p">,</span> <span class="s2">&quot;table-active&quot;</span><span class="p">,</span> <span class="s2">&quot;table-secondary&quot;</span><span class="p">,</span> <span class="s2">&quot;table-light&quot;</span><span class="p">,</span> <span class="s2">&quot;table-dark&quot;</span><span class="p">,</span> <span class="s2">&quot;bg-primary&quot;</span><span class="p">,</span> <span class="s2">&quot;bg-success&quot;</span><span class="p">,</span> <span class="s2">&quot;bg-danger&quot;</span><span class="p">,</span>  <span class="s2">&quot;bg-info&quot;</span><span class="p">,</span> <span class="s2">&quot;bg-warning&quot;</span><span class="p">,</span> <span class="s2">&quot;bg-secondary&quot;</span><span class="p">,</span> <span class="s2">&quot;bg-dark&quot;</span><span class="p">,</span> <span class="s2">&quot;bg-light&quot;</span><span class="p">]</span>
  820 
  821     <span class="k">for</span> <span class="n">Color</span> <span class="ow">in</span> <span class="n">ColorsList</span><span class="p">:</span>
  822         <span class="k">if</span> <span class="ow">not</span> <span class="n">Color</span> <span class="ow">in</span> <span class="n">TableClassColors</span><span class="p">:</span>
  823             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;The color class name, </span><span class="si">%s</span><span class="s2">, specified using option </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> appears to be a unknown name...&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Color</span><span class="p">,</span> <span class="n">OptionName</span><span class="p">))</span>
  824         
  825 <span class="k">def</span> <span class="nf">RetrieveOptions</span><span class="p">():</span>
  826     <span class="sd">&quot;&quot;&quot;Retrieve command line arguments and options&quot;&quot;&quot;</span>
  827     
  828     <span class="c1"># Get options...</span>
  829     <span class="k">global</span> <span class="n">Options</span>
  830     <span class="n">Options</span> <span class="o">=</span> <span class="n">docopt</span><span class="p">(</span><span class="n">_docoptUsage_</span><span class="p">)</span>
  831     
  832     <span class="c1"># Set current working directory to the specified directory...</span>
  833     <span class="n">WorkingDir</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--workingdir&quot;</span><span class="p">]</span>
  834     <span class="k">if</span> <span class="n">WorkingDir</span><span class="p">:</span>
  835         <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">WorkingDir</span><span class="p">)</span>
  836     
  837     <span class="c1"># Handle examples option...</span>
  838     <span class="k">if</span> <span class="s2">&quot;--examples&quot;</span> <span class="ow">in</span> <span class="n">Options</span> <span class="ow">and</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--examples&quot;</span><span class="p">]:</span>
  839         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="n">MiscUtil</span><span class="o">.</span><span class="n">GetExamplesTextFromDocOptText</span><span class="p">(</span><span class="n">_docoptUsage_</span><span class="p">))</span>
  840         <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
  841 
  842 <span class="k">def</span> <span class="nf">ValidateOptions</span><span class="p">():</span>
  843     <span class="sd">&quot;&quot;&quot;Validate option values&quot;&quot;&quot;</span>
  844     
  845     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFilePath</span><span class="p">(</span><span class="s2">&quot;-i, --infile&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--infile&quot;</span><span class="p">])</span>
  846     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFileExt</span><span class="p">(</span><span class="s2">&quot;-i, --infile&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--infile&quot;</span><span class="p">],</span> <span class="s2">&quot;sdf sd mol smi csv tsv txt&quot;</span><span class="p">)</span>
  847 
  848     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionsOutputFileOverwrite</span><span class="p">(</span><span class="s2">&quot;-o, --outfile&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--outfile&quot;</span><span class="p">],</span> <span class="s2">&quot;--overwrite&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--overwrite&quot;</span><span class="p">])</span>
  849     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionsDistinctFileNames</span><span class="p">(</span><span class="s2">&quot;-i, --infile&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--infile&quot;</span><span class="p">],</span> <span class="s2">&quot;-o, --outfile&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--outfile&quot;</span><span class="p">])</span>
  850     
  851     <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^None$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--alignmentSMARTS&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  852         <span class="n">PatternMol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmarts</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--alignmentSMARTS&quot;</span><span class="p">])</span>
  853         <span class="k">if</span> <span class="n">PatternMol</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
  854             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The value specified, </span><span class="si">%s</span><span class="s2">, using option </span><span class="se">\&quot;</span><span class="s2">--alignmentSMARTS</span><span class="se">\&quot;</span><span class="s2"> is not a valid SMARTS: Failed to create pattern molecule&quot;</span> <span class="o">%</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--alignmentSMARTS&quot;</span><span class="p">])</span>
  855     
  856     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionIntegerValue</span><span class="p">(</span><span class="s2">&quot;--atomLabelFontSize&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--atomLabelFontSize&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s2">&quot;&gt;&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>
  857     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFloatValue</span><span class="p">(</span><span class="s2">&quot;-b, --bondLineWidth&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--bondLineWidth&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s2">&quot;&gt;&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">})</span>
  858     
  859     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--compute2DCoords&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--compute2DCoords&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no auto&quot;</span><span class="p">)</span>
  860     
  861     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--counterCol&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--counterCol&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
  862     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--colVisibility&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--colVisibility&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
  863     
  864     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--f, -fontBold&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--fontBold&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
  865     
  866     <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^None$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--highlightSMARTS&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  867         <span class="n">PatternMol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmarts</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--highlightSMARTS&quot;</span><span class="p">])</span>
  868         <span class="k">if</span> <span class="n">PatternMol</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
  869             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The value specified, </span><span class="si">%s</span><span class="s2">, using option </span><span class="se">\&quot;</span><span class="s2">--highlightSMARTS</span><span class="se">\&quot;</span><span class="s2"> is not a valid SMARTS: Failed to create pattern molecule&quot;</span> <span class="o">%</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--highlightSMARTS&quot;</span><span class="p">])</span>
  870     
  871     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--kekulize&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--kekulize&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
  872     
  873     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;-k, --keysNavigation&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--keysNavigation&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
  874     
  875     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionNumberValues</span><span class="p">(</span><span class="s2">&quot;-m, --molImageSize&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--molImageSize&quot;</span><span class="p">],</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="s2">&quot;integer&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;&gt;&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>
  876     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--molImageEncoded&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--molImageEncoded&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
  877     
  878     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionIntegerValue</span><span class="p">(</span><span class="s2">&quot;--numOfMolsPerRow&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--numOfMolsPerRow&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s2">&quot;&gt;&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>
  879     
  880     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;-p, --paging&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--paging&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
  881     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionIntegerValue</span><span class="p">(</span><span class="s2">&quot;--pageLength&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pageLength&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s2">&quot;&gt;&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>
  882     
  883     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--popover&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--popover&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
  884     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionIntegerValue</span><span class="p">(</span><span class="s2">&quot;--popoverDataCount&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--popoverDataCount&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s2">&quot;&gt;&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>
  885     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionIntegerValue</span><span class="p">(</span><span class="s2">&quot;--popoverTextWidth&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--popoverTextWidth&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s2">&quot;&gt;&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>
  886     
  887     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--showMolName&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--showMolName&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
  888     
  889     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--scrollX&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--scrollX&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
  890     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--scrollY&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--scrollY&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
  891     <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">&quot;vh$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--scrollYSize&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  892         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionIntegerValue</span><span class="p">(</span><span class="s2">&quot;--scrollYSize&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--scrollYSize&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s2">&quot;&gt;&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>
  893 
  894     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--tableFooter&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--tableFooter&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
  895     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--tableHeader&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--tableHeader&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
  896     
  897 <span class="c1"># Setup a usage string for docopt...</span>
  898 <span class="n">_docoptUsage_</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
  899 <span class="s2">RDKitDrawMolecules.py - Draw molecules and generate an image or HTML file</span>
  900 
  901 <span class="s2">Usage:</span>
  902 <span class="s2">    RDKitDrawMolecules.py [--alignmentSMARTS &lt;SMARTS&gt;] [--atomLabelFontSize &lt;number&gt;]</span>
  903 <span class="s2">                             [--bondLineWidth &lt;number&gt;] [--compute2DCoords &lt;yes | no&gt;] [--counterCol &lt;yes or no&gt;]</span>
  904 <span class="s2">                             [--colVisibility &lt;yes or no&gt;] [--fontBold &lt;yes or no&gt;] [--footer &lt;text&gt;] [--footerClass &lt;text&gt;] </span>
  905 <span class="s2">                             [--header &lt;text&gt;] [--headerStyle &lt;text&gt;] [--highlightSMARTS &lt;SMARTS&gt;]</span>
  906 <span class="s2">                             [--infileParams &lt;Name,Value,...&gt;] [--kekulize &lt;yes or no&gt;] [--keysNavigation &lt;yes or no&gt;]</span>
  907 <span class="s2">                             [--molImageSize &lt;width,height&gt;] [--molImageEncoded &lt;yes or no&gt; ]</span>
  908 <span class="s2">                             [--numOfMolsPerRow &lt;number&gt;] [--overwrite] [--paging &lt;yes or no&gt;]</span>
  909 <span class="s2">                             [--pagingType &lt;numbers, simple, ...&gt;] [--pageLength &lt;number&gt;]</span>
  910 <span class="s2">                             [--popover &lt;yes or no&gt;] [--popoverDataCount &lt;number&gt;] [--popoverTextWidth &lt;number&gt;]</span>
  911 <span class="s2">                             [--showMolName &lt;yes or no&gt;] [--scrollX &lt;yes or no&gt;] [--scrollY &lt;yes or no&gt;]</span>
  912 <span class="s2">                             [--scrollYSize &lt;number&gt;] [--tableFooter &lt;yes or no&gt;] [--tableHeader &lt;yes or no&gt;]</span>
  913 <span class="s2">                             [--tableHeaderStyle &lt;thead-dark,thead-light,...&gt;]</span>
  914 <span class="s2">                             [--tableStyle &lt;table,table-striped,...&gt;] [-w &lt;dir&gt;] -i &lt;infile&gt; -o &lt;outfile&gt;</span>
  915 <span class="s2">    RDKitDrawMolecules.py -h | --help | -e | --examples</span>
  916 
  917 <span class="s2">Description:</span>
  918 <span class="s2">    Draw molecules in a grid and write them out as an image file or a HTML table file. The</span>
  919 <span class="s2">    SVG image or HTML table file appears to be the best among all the available image file</span>
  920 <span class="s2">    options, as rendered in a browser. The Python modules aggdraw/cairo are required to</span>
  921 <span class="s2">    generate high quality PNG images.</span>
  922 <span class="s2">    </span>
  923 <span class="s2">    The drawing of the molecules are embedded in HTML table columns as in line SVG</span>
  924 <span class="s2">    images. The HTML table is an interactive table and requires internet access for viewing</span>
  925 <span class="s2">    in a browser. It employs he following frameworks: JQuery, Bootstrap, and DataTable.</span>
  926 <span class="s2">    </span>
  927 <span class="s2">    The options &#39;--atomLabelFontSize&#39; and &#39;--bondLineWidth&#39; don&#39;t appear</span>
  928 <span class="s2">    to work during the generation of a SVG image.</span>
  929 
  930 <span class="s2">    The supported input file formats are: Mol (.mol), SD (.sdf, .sd), SMILES (.smi,</span>
  931 <span class="s2">    .txt, .csv, .tsv)</span>
  932 
  933 <span class="s2">    The output image file can be saved in any format supported by the Python Image</span>
  934 <span class="s2">    Library (PIL). The image format is automatically detected from the output file extension.</span>
  935 
  936 <span class="s2">    Some of the most common output image file formats are: GIF (.gif), JPEG (.jpg),</span>
  937 <span class="s2">    PNG (.png), SVG (.svg), TIFF (.tif). In addition, a HTML (.html) file format</span>
  938 <span class="s2">    containing a table is supported.</span>
  939 
  940 <span class="s2">Options:</span>
  941 <span class="s2">    -a, --alignmentSMARTS &lt;SMARTS&gt;  [default: none]</span>
  942 <span class="s2">        SMARTS pattern for aligning molecules to a common template.</span>
  943 <span class="s2">    --atomLabelFontSize &lt;number&gt;  [default: 12]</span>
  944 <span class="s2">        Font size for drawing atom labels. This option is ignored during the generation of</span>
  945 <span class="s2">        a SVG and HTML output file.</span>
  946 <span class="s2">    -b, --bondLineWidth &lt;number&gt;  [default: 1.2]</span>
  947 <span class="s2">        Line width for drawing bonds. This option is ignored during the generation of a SVG</span>
  948 <span class="s2">        and HTML output file.</span>
  949 <span class="s2">    -c, --compute2DCoords &lt;yes or no&gt;  [default: auto]</span>
  950 <span class="s2">        Compute 2D coordinates of molecules before drawing. Default: yes for all file</span>
  951 <span class="s2">        formats.</span>
  952 <span class="s2">    --counterCol &lt;yes or no&gt;  [default: yes]</span>
  953 <span class="s2">        Show a counter column as the first column in the table. It contains the position</span>
  954 <span class="s2">        for each row in the HTML table. This option is only used during the generation of</span>
  955 <span class="s2">        a HTML table file.</span>
  956 <span class="s2">    --colVisibility &lt;yes or no&gt;  [default: yes]</span>
  957 <span class="s2">        Show a dropdown button to toggle visibility of columns in the table. This option is</span>
  958 <span class="s2">        only used during the generation of a HTML table file.</span>
  959 <span class="s2">    -e, --examples</span>
  960 <span class="s2">        Print examples.</span>
  961 <span class="s2">    -f --fontBold &lt;yes or no&gt;  [default: yes]</span>
  962 <span class="s2">        Make all text fonts bold during the generation of  a SVG and HTML output file. This</span>
  963 <span class="s2">        option is ignored for all other output files.</span>
  964 <span class="s2">    --footer &lt;text&gt;  [default: none]</span>
  965 <span class="s2">        Footer text to insert at the bottom of the HTML page after the table. This option is</span>
  966 <span class="s2">        only used during the generation of a HTML table file.</span>
  967 <span class="s2">    --footerClass &lt;text&gt;  [default: small text-center text-muted]</span>
  968 <span class="s2">        Footer class style to use with &lt;p&gt; tag. This option is only used during the</span>
  969 <span class="s2">        generation of a HTML table file.</span>
  970 <span class="s2">    -h, --help</span>
  971 <span class="s2">        Print this help message.</span>
  972 <span class="s2">    --header &lt;text&gt;  [default: none]</span>
  973 <span class="s2">        Header text to insert at the top of the HTML page before the table. This option is</span>
  974 <span class="s2">        only used during the generation of a HTML table file.</span>
  975 <span class="s2">    --headerStyle &lt;text&gt;  [default: h5]</span>
  976 <span class="s2">        Header style to use. Possible values: h1 to h6. This option is only used during the</span>
  977 <span class="s2">        generation of a HTML table file.</span>
  978 <span class="s2">    --highlightSMARTS &lt;SMARTS&gt;  [default: none]</span>
  979 <span class="s2">        SMARTS pattern for highlighting atoms and bonds in molecules. All matched</span>
  980 <span class="s2">        substructures are highlighted.</span>
  981 <span class="s2">    -i, --infile &lt;infile&gt;</span>
  982 <span class="s2">        Input file name.</span>
  983 <span class="s2">    --infileParams &lt;Name,Value,...&gt;  [default: auto]</span>
  984 <span class="s2">        A comma delimited list of parameter name and value pairs for reading</span>
  985 <span class="s2">        molecules from files. The supported parameter names for different file</span>
  986 <span class="s2">        formats, along with their default values, are shown below:</span>
  987 <span class="s2">            </span>
  988 <span class="s2">            SD, MOL: removeHydrogens,yes,sanitize,yes,strictParsing,yes</span>
  989 <span class="s2">            SMILES: smilesColumn,1,smilesNameColumn,2,smilesDelimiter,space,</span>
  990 <span class="s2">                smilesTitleLine,auto,sanitize,yes</span>
  991 <span class="s2">            </span>
  992 <span class="s2">        Possible values for smilesDelimiter: space, comma or tab.</span>
  993 <span class="s2">    -k, --kekulize &lt;yes or no&gt;  [default: yes]</span>
  994 <span class="s2">        Perform kekulization on molecules. This option is ignored during the generation of</span>
  995 <span class="s2">        a SVG and HTML output file.</span>
  996 <span class="s2">    --keysNavigation &lt;yes or no&gt;  [default: yes]</span>
  997 <span class="s2">        Provide Excel like keyboard cell navigation for the table. This option is only used</span>
  998 <span class="s2">        during the generation of a HTML table file.</span>
  999 <span class="s2">    -m, --molImageSize &lt;width,height&gt;  [default: 250,200]</span>
 1000 <span class="s2">        Image size of a molecule in pixels.</span>
 1001 <span class="s2">    --molImageEncoded &lt;yes or no&gt;  [default: yes]</span>
 1002 <span class="s2">        Base64 encode SVG image of a molecule for inline embedding in a HTML page.</span>
 1003 <span class="s2">        The inline SVG image may fail to display in browsers without encoding.</span>
 1004 <span class="s2">    -n, --numOfMolsPerRow &lt;number&gt;  [default: 4]</span>
 1005 <span class="s2">        Number of molecules to draw in a row.</span>
 1006 <span class="s2">    -o, --outfile &lt;outfile&gt;</span>
 1007 <span class="s2">        Output file name.</span>
 1008 <span class="s2">    --overwrite</span>
 1009 <span class="s2">        Overwrite existing files.</span>
 1010 <span class="s2">    -p, --paging &lt;yes or no&gt;  [default: yes]</span>
 1011 <span class="s2">        Provide page navigation for browsing data in the table. This option is only used</span>
 1012 <span class="s2">        during the generation of a HTML table file.</span>
 1013 <span class="s2">    --pagingType &lt;numbers, simple, ...&gt;  [default: full_numbers]</span>
 1014 <span class="s2">        Type of page navigation. Possible values: numbers, simple, simple_numbers,</span>
 1015 <span class="s2">        full, full_numbers, or first_last_numbers.</span>
 1016 <span class="s2">            </span>
 1017 <span class="s2">            numbers - Page number buttons only</span>
 1018 <span class="s2">            simple - &#39;Previous&#39; and &#39;Next&#39; buttons only</span>
 1019 <span class="s2">            simple_numbers - &#39;Previous&#39; and &#39;Next&#39; buttons, plus page numbers</span>
 1020 <span class="s2">            full - &#39;First&#39;, &#39;Previous&#39;, &#39;Next&#39; and &#39;Last&#39; buttons</span>
 1021 <span class="s2">            full_numbers - &#39;First&#39;, &#39;Previous&#39;, &#39;Next&#39; and &#39;Last&#39; buttons, plus</span>
 1022 <span class="s2">                page numbers</span>
 1023 <span class="s2">            first_last_numbers - &#39;First&#39; and &#39;Last&#39; buttons, plus page numbers</span>
 1024 <span class="s2">            </span>
 1025 <span class="s2">        This option is only used during the generation of a HTML table file.</span>
 1026 <span class="s2">    --pageLength &lt;number&gt;  [default: 5]</span>
 1027 <span class="s2">        Number of rows to show per page. This option is only used during the</span>
 1028 <span class="s2">        generation of a HTML table file.</span>
 1029 <span class="s2">    --popover &lt;yes or no&gt;  [default: yes]</span>
 1030 <span class="s2">        Display a popover window containing additional information about the</span>
 1031 <span class="s2">        molecule. The popover is opened after a click on the drawing of a</span>
 1032 <span class="s2">        molecule. A subsequent click on the same drawing closes the popover.</span>
 1033 <span class="s2">        This option is only used during the generation of a HTML table file.</span>
 1034 <span class="s2">    --popoverDataCount &lt;number&gt;  [default: 25]</span>
 1035 <span class="s2">        Maximum number of data fields to show in a popover window. This option is</span>
 1036 <span class="s2">        only used during the generation of a HTML table file.</span>
 1037 <span class="s2">    --popoverTextWidth &lt;number&gt;  [default: 50]</span>
 1038 <span class="s2">        Maximum width in characters for text display in a popover window before</span>
 1039 <span class="s2">        truncating the text. This option is only used during the generation of a HTML</span>
 1040 <span class="s2">        table file.</span>
 1041 <span class="s2">    -s, --showMolName &lt;yes or no&gt;  [default: yes]</span>
 1042 <span class="s2">        Show molecule names under the images.This option is only used during the</span>
 1043 <span class="s2">        generation of a HTML table file.</span>
 1044 <span class="s2">    --scrollX &lt;yes or no&gt;  [default: yes]</span>
 1045 <span class="s2">        Provide horizontal scroll bar in the table as needed.This option is only used</span>
 1046 <span class="s2">        during the generation of a HTML table file.</span>
 1047 <span class="s2">    --scrollY &lt;yes or no&gt;  [default: yes]</span>
 1048 <span class="s2">        Provide vertical scroll bar in the table as needed.This option is only used during</span>
 1049 <span class="s2">        the generation of a HTML table file.</span>
 1050 <span class="s2">    --scrollYSize &lt;number&gt;  [default: 75vh]</span>
 1051 <span class="s2">        Maximum height of table viewport either in pixels or percentage of the browser</span>
 1052 <span class="s2">        window height before providing a vertical scroll bar. Default: 75</span><span class="si">% o</span><span class="s2">f the height of</span>
 1053 <span class="s2">        browser window.This option is only used during the generation of a HTML table file.</span>
 1054 <span class="s2">    -t, --tableStyle &lt;table,table-striped,...&gt;  [default: table,table-hover,table-sm]</span>
 1055 <span class="s2">        Style of table. Possible values: table, table-striped, table-bordered,</span>
 1056 <span class="s2">        table-hover, table-dark, table-sm, none, or All. Default: &#39;table,table-hover&#39;. A</span>
 1057 <span class="s2">        comma delimited list of any valid Bootstrap table styles is also supported</span>
 1058 <span class="s2">        </span>
 1059 <span class="s2">        This option is only used during the generation of a HTML table file.</span>
 1060 <span class="s2">    --tableFooter &lt;yes or no&gt;  [default: yes]</span>
 1061 <span class="s2">        Show Excel style column headers at the end of  the table. This option is only</span>
 1062 <span class="s2">        used during the generation of a HTML table file.</span>
 1063 <span class="s2">    --tableHeader &lt;yes or no&gt;  [default: yes]</span>
 1064 <span class="s2">        Show Excel style column headers in the table. This option is only used</span>
 1065 <span class="s2">        during the generation of a HTML table file.</span>
 1066 <span class="s2">    --tableHeaderStyle &lt;thead-dark,thead-light,...&gt;  [default: thead-dark]</span>
 1067 <span class="s2">        Style of table header. Possible values: thead-dark, thead-light, or none.</span>
 1068 <span class="s2">        The names of the following contextual color classes are also supported:</span>
 1069 <span class="s2">        table-primary (Blue), table-success (Green), table-danger (Red), table-info</span>
 1070 <span class="s2">        (Light blue), table-warning (Orange), table-active (Grey), table-light (Light</span>
 1071 <span class="s2">        grey), and  table-dark (Dark grey).</span>
 1072 <span class="s2">        </span>
 1073 <span class="s2">        This option is only used during the generation of a HTML table file.</span>
 1074 <span class="s2">    -w, --workingdir &lt;dir&gt;</span>
 1075 <span class="s2">        Location of working directory which defaults to the current directory.</span>
 1076 
 1077 <span class="s2">Examples:</span>
 1078 <span class="s2">    To automatically compute 2D coordinates for molecules in a SMILES file and</span>
 1079 <span class="s2">    generate a SVG image file containing 4 molecules per row in a grid with cell</span>
 1080 <span class="s2">    size of 250 x 200 pixels, type:</span>
 1081 
 1082 <span class="s2">        % RDKitDrawMolecules.py -i Sample.smi -o SampleOut.svg</span>
 1083 
 1084 <span class="s2">    To automatically compute 2D coordinates for molecules in a SMILES file and</span>
 1085 <span class="s2">    generate a SVG image file containing 2 molecules per row in a grid with cell</span>
 1086 <span class="s2">    size of 400 x 300 pixels and without any keulization along with highlighting</span>
 1087 <span class="s2">    a specific set of atoms and bonds indicated by a SMARTS pattern, type:</span>
 1088 
 1089 <span class="s2">        % RDKitDrawMolecules.py -n 2 -m &quot;400,300&quot; -k no --fontBold no</span>
 1090 <span class="s2">          --highlightSMARTS  &#39;c1ccccc1&#39; -i Sample.smi -o SampleOut.svg</span>
 1091 
 1092 <span class="s2">    To generate a PNG image file for molecules in a SD file using existing 2D</span>
 1093 <span class="s2">    coordinates, type</span>
 1094 
 1095 <span class="s2">        % RDKitDrawMolecules.py --compute2DCoords no -i Sample.sdf</span>
 1096 <span class="s2">          -o SampleOut.png</span>
 1097 
 1098 <span class="s2">    To automatically compute 2D coordinates for molecules in a SD file and</span>
 1099 <span class="s2">    generate a HTML file containing 4 molecules per row in a table, along with</span>
 1100 <span class="s2">    all the bells and whistles to interact with the table, type:</span>
 1101 
 1102 <span class="s2">        % RDKitDrawMolecules.py -i Sample.sdf -o SampleOut.html</span>
 1103 
 1104 <span class="s2">    To automatically compute 2D coordinates for molecules in a SD file and</span>
 1105 <span class="s2">    generate a HTML file containing 4 molecules per row in a table without</span>
 1106 <span class="s2">    any bells and whistles to interact with the table, type:</span>
 1107 
 1108 <span class="s2">        % RDKitDrawMolecules.py --counterCol no --colVisibility no</span>
 1109 <span class="s2">          --keysNavigation no --paging  no --popover no --scrollX no</span>
 1110 <span class="s2">          --scroll no --tableFooter no --tableHeader  no -i Sample.sdf</span>
 1111 <span class="s2">          -o SampleOut.html</span>
 1112 
 1113 <span class="s2">    To automatically compute 2D coordinates for molecules in a CSV SMILES file</span>
 1114 <span class="s2">    with column headers, SMILES strings in column 1, and name in column 2 and</span>
 1115 <span class="s2">    generate a PDF image file, type:</span>
 1116 
 1117 <span class="s2">        % RDKitDrawMolecules.py --infileParams &quot;smilesDelimiter,comma,</span>
 1118 <span class="s2">          smilesTitleLine,yes,smilesColumn,1,smilesNameColumn,2&quot;</span>
 1119 <span class="s2">          -i SampleSMILES.csv -o SampleOut.pdf</span>
 1120 
 1121 <span class="s2">Author:</span>
 1122 <span class="s2">    Manish Sud(msud@san.rr.com)</span>
 1123 
 1124 <span class="s2">See also:</span>
 1125 <span class="s2">    RDKitConvertFileFormat.py, RDKitDrawMoleculesAndDataTable.py, RDKitRemoveDuplicateMolecules.py,</span>
 1126 <span class="s2">    RDKitSearchFunctionalGroups.py, RDKitSearchSMARTS.py</span>
 1127 
 1128 <span class="s2">Copyright:</span>
 1129 <span class="s2">    Copyright (C) 2020 Manish Sud. All rights reserved.</span>
 1130 
 1131 <span class="s2">    The functionality available in this script is implemented using RDKit, an</span>
 1132 <span class="s2">    open source toolkit for cheminformatics developed by Greg Landrum.</span>
 1133 
 1134 <span class="s2">    This file is part of MayaChemTools.</span>
 1135 
 1136 <span class="s2">    MayaChemTools is free software; you can redistribute it and/or modify it under</span>
 1137 <span class="s2">    the terms of the GNU Lesser General Public License as published by the Free</span>
 1138 <span class="s2">    Software Foundation; either version 3 of the License, or (at your option) any</span>
 1139 <span class="s2">    later version.</span>
 1140 
 1141 <span class="s2">&quot;&quot;&quot;</span>
 1142 
 1143 <span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
 1144     <span class="n">main</span><span class="p">()</span>
</pre>
<br />
<center>
<img src="../../../images/h2o2.png">
</center>
</body>
</html>
