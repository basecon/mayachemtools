<html>
<head>
<title>MayaChemTools:Code:RDKitPerformRGroupDecomposition.py</title>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<link rel="stylesheet" type="text/css" href="../../../css/MayaChemToolsPythonCode.css">
</head>
<body leftmargin="20" rightmargin="20" topmargin="10" bottommargin="10">
<br/>
<center>
<a href="http://www.mayachemtools.org" title="MayaChemTools Home"><img src="../../../images/MayaChemToolsLogo.gif" border="0" alt="MayaChemTools"></a>
</center>
<br/>
<pre>
   1 <span class="ch">#!/bin/env python</span>
   2 <span class="c1">#</span>
   3 <span class="c1"># File: RDKitPerformRGroupDecomposition.py</span>
   4 <span class="c1"># Author: Manish Sud &lt;msud@san.rr.com&gt;</span>
   5 <span class="c1">#</span>
   6 <span class="c1"># Copyright (C) 2020 Manish Sud. All rights reserved.</span>
   7 <span class="c1">#</span>
   8 <span class="c1"># The functionality available in this script is implemented using RDKit, an</span>
   9 <span class="c1"># open source toolkit for cheminformatics developed by Greg Landrum.</span>
  10 <span class="c1">#</span>
  11 <span class="c1"># This file is part of MayaChemTools.</span>
  12 <span class="c1">#</span>
  13 <span class="c1"># MayaChemTools is free software; you can redistribute it and/or modify it under</span>
  14 <span class="c1"># the terms of the GNU Lesser General Public License as published by the Free</span>
  15 <span class="c1"># Software Foundation; either version 3 of the License, or (at your option) any</span>
  16 <span class="c1"># later version.</span>
  17 <span class="c1">#</span>
  18 <span class="c1"># MayaChemTools is distributed in the hope that it will be useful, but without</span>
  19 <span class="c1"># any warranty; without even the implied warranty of merchantability of fitness</span>
  20 <span class="c1"># for a particular purpose.  See the GNU Lesser General Public License for more</span>
  21 <span class="c1"># details.</span>
  22 <span class="c1">#</span>
  23 <span class="c1"># You should have received a copy of the GNU Lesser General Public License</span>
  24 <span class="c1"># along with MayaChemTools; if not, see &lt;http://www.gnu.org/licenses/&gt; or</span>
  25 <span class="c1"># write to the Free Software Foundation Inc., 59 Temple Place, Suite 330,</span>
  26 <span class="c1"># Boston, MA, 02111-1307, USA.</span>
  27 <span class="c1">#</span>
  28 
  29 <span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
  30 
  31 <span class="c1"># Add local python path to the global path and import standard library modules...</span>
  32 <span class="kn">import</span> <span class="nn">os</span>
  33 <span class="kn">import</span> <span class="nn">sys</span><span class="p">;</span>  <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="s2">&quot;..&quot;</span><span class="p">,</span> <span class="s2">&quot;lib&quot;</span><span class="p">,</span> <span class="s2">&quot;Python&quot;</span><span class="p">))</span>
  34 <span class="kn">import</span> <span class="nn">time</span>
  35 <span class="kn">import</span> <span class="nn">re</span>
  36 
  37 <span class="c1"># RDKit imports...</span>
  38 <span class="k">try</span><span class="p">:</span>
  39     <span class="kn">from</span> <span class="nn">rdkit</span> <span class="kn">import</span> <span class="n">rdBase</span>
  40     <span class="kn">from</span> <span class="nn">rdkit</span> <span class="kn">import</span> <span class="n">Chem</span>
  41     <span class="kn">from</span> <span class="nn">rdkit.Chem</span> <span class="kn">import</span> <span class="n">AllChem</span>
  42     <span class="kn">from</span> <span class="nn">rdkit.Chem</span> <span class="kn">import</span> <span class="n">rdRGroupDecomposition</span> <span class="k">as</span> <span class="n">rgd</span>
  43     <span class="kn">from</span> <span class="nn">rdkit.Chem</span> <span class="kn">import</span> <span class="n">rdFMCS</span>
  44 <span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">ErrMsg</span><span class="p">:</span>
  45     <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Failed to import RDKit module/package: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ErrMsg</span><span class="p">)</span>
  46     <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Check/update your RDKit environment and try again.</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
  47     <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
  48 
  49 <span class="c1"># MayaChemTools imports...</span>
  50 <span class="k">try</span><span class="p">:</span>
  51     <span class="kn">from</span> <span class="nn">docopt</span> <span class="kn">import</span> <span class="n">docopt</span>
  52     <span class="kn">import</span> <span class="nn">MiscUtil</span>
  53     <span class="kn">import</span> <span class="nn">RDKitUtil</span>
  54 <span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">ErrMsg</span><span class="p">:</span>
  55     <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Failed to import MayaChemTools module/package: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ErrMsg</span><span class="p">)</span>
  56     <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Check/update your MayaChemTools environment and try again.</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
  57     <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
  58 
  59 <span class="n">ScriptName</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
  60 <span class="n">Options</span> <span class="o">=</span> <span class="p">{}</span>
  61 <span class="n">OptionsInfo</span> <span class="o">=</span> <span class="p">{}</span>
  62 
  63 <span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
  64     <span class="sd">&quot;&quot;&quot;Start execution of the script&quot;&quot;&quot;</span>
  65     
  66     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="s2"> (RDK v</span><span class="si">%s</span><span class="s2">; </span><span class="si">%s</span><span class="s2">): Starting...</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ScriptName</span><span class="p">,</span> <span class="n">rdBase</span><span class="o">.</span><span class="n">rdkitVersion</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">asctime</span><span class="p">()))</span>
  67     
  68     <span class="p">(</span><span class="n">WallClockTime</span><span class="p">,</span> <span class="n">ProcessorTime</span><span class="p">)</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">GetWallClockAndProcessorTime</span><span class="p">()</span>
  69     
  70     <span class="c1"># Retrieve command line arguments and options...</span>
  71     <span class="n">RetrieveOptions</span><span class="p">()</span>
  72     
  73     <span class="c1"># Process and validate command line arguments and options...</span>
  74     <span class="n">ProcessOptions</span><span class="p">()</span>
  75     
  76     <span class="c1"># Perform actions required by the script...</span>
  77     <span class="n">PerformRGroupDecomposition</span><span class="p">()</span>
  78     
  79     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="s2">: Done...</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ScriptName</span><span class="p">)</span>
  80     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Total time: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">GetFormattedElapsedTime</span><span class="p">(</span><span class="n">WallClockTime</span><span class="p">,</span> <span class="n">ProcessorTime</span><span class="p">))</span>
  81 
  82 <span class="k">def</span> <span class="nf">PerformRGroupDecomposition</span><span class="p">():</span>
  83     <span class="sd">&quot;&quot;&quot;Perform R group decomposition.&quot;&quot;&quot;</span>
  84 
  85     <span class="c1"># Retrieve molecules...</span>
  86     <span class="n">Mols</span> <span class="o">=</span> <span class="n">RetrieveMolecules</span><span class="p">()</span>
  87 
  88     <span class="c1"># Identify R groups and write them out...</span>
  89     <span class="n">RGroups</span><span class="p">,</span> <span class="n">UnmatchedMolIndices</span> <span class="o">=</span> <span class="n">RetrieveRGroups</span><span class="p">(</span><span class="n">Mols</span><span class="p">)</span>
  90     <span class="n">WriteRGroups</span><span class="p">(</span><span class="n">Mols</span><span class="p">,</span> <span class="n">RGroups</span><span class="p">,</span> <span class="n">UnmatchedMolIndices</span><span class="p">)</span>
  91     
  92 <span class="k">def</span> <span class="nf">RetrieveRGroups</span><span class="p">(</span><span class="n">Mols</span><span class="p">):</span>
  93     <span class="sd">&quot;&quot;&quot;Retrieve R groups&quot;&quot;&quot;</span>
  94     
  95     <span class="n">CoreMols</span> <span class="o">=</span> <span class="n">SetupCoreScaffolds</span><span class="p">(</span><span class="n">Mols</span><span class="p">)</span>
  96     <span class="n">DecompositionParams</span> <span class="o">=</span> <span class="n">SetupRGroupDecompositionParams</span><span class="p">()</span>
  97     <span class="n">RGroupDecompositionObject</span> <span class="o">=</span> <span class="n">rgd</span><span class="o">.</span><span class="n">RGroupDecomposition</span><span class="p">(</span><span class="n">CoreMols</span><span class="p">,</span> <span class="n">DecompositionParams</span><span class="p">)</span>
  98     
  99     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Performing R group decomposition...&quot;</span><span class="p">)</span>
 100     
 101     <span class="n">UnmatchedMolIndices</span> <span class="o">=</span> <span class="p">[]</span>
 102     <span class="k">for</span> <span class="n">MolIndex</span><span class="p">,</span> <span class="n">Mol</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">Mols</span><span class="p">):</span>
 103         <span class="n">Status</span> <span class="o">=</span> <span class="n">RGroupDecompositionObject</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">Mol</span><span class="p">)</span>
 104         <span class="k">if</span> <span class="n">Status</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
 105             <span class="n">UnmatchedMolIndices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">MolIndex</span><span class="p">)</span>
 106     
 107     <span class="k">if</span> <span class="ow">not</span> <span class="n">RGroupDecompositionObject</span><span class="o">.</span><span class="n">Process</span><span class="p">():</span>
 108         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;R group decomposition failed to match any molecule to core scaffold(s)...&quot;</span><span class="p">)</span>
 109     
 110     <span class="n">RGroups</span> <span class="o">=</span> <span class="n">RGroupDecompositionObject</span><span class="o">.</span><span class="n">GetRGroupsAsColumns</span><span class="p">(</span><span class="n">asSmiles</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
 111 
 112     <span class="k">return</span> <span class="p">(</span><span class="n">RGroups</span><span class="p">,</span> <span class="n">UnmatchedMolIndices</span><span class="p">)</span>
 113     
 114 <span class="k">def</span> <span class="nf">SetupCoreScaffolds</span><span class="p">(</span><span class="n">Mols</span><span class="p">):</span>
 115     <span class="sd">&quot;&quot;&quot;Setup core scaffold molecules(s)&quot;&quot;&quot;</span>
 116 
 117     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(BySMARTS|BySMILES)$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;CoreScaffold&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 118         <span class="k">return</span> <span class="n">SetupCoreScaffoldsBySMARTSOrSMILES</span><span class="p">()</span>
 119     <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^ByMCS$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;CoreScaffold&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 120         <span class="k">return</span> <span class="n">SetupCoreScaffoldsByMCS</span><span class="p">(</span><span class="n">Mols</span><span class="p">)</span>
 121     <span class="k">else</span><span class="p">:</span>
 122         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The  value, </span><span class="si">%s</span><span class="s2">, specified for  </span><span class="se">\&quot;</span><span class="s2">-c, --coreScaffold</span><span class="se">\&quot;</span><span class="s2"> option is not supported.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;CoreScaffold&quot;</span><span class="p">]))</span>
 123         
 124 <span class="k">def</span> <span class="nf">SetupCoreScaffoldsBySMARTSOrSMILES</span><span class="p">():</span>
 125     <span class="sd">&quot;&quot;&quot;Setup core scaffold molecules(s) using specified SMARTS or SMILES.&quot;&quot;&quot;</span>
 126 
 127     <span class="n">BySMARTS</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^BySMARTS$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;CoreScaffold&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 128     <span class="n">CoreScaffoldList</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SMARTSOrSMILESCoreScaffoldList&quot;</span><span class="p">]</span>
 129 
 130     <span class="k">if</span> <span class="n">BySMARTS</span><span class="p">:</span>
 131         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Setting up core scaffold(s) using SMARTS...</span><span class="se">\n</span><span class="s2">SMARTS core scaffold(s): </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">CoreScaffoldList</span><span class="p">))</span>
 132     <span class="k">else</span><span class="p">:</span>
 133         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Setting up core scaffold(s) using SMILES...</span><span class="se">\n</span><span class="s2">SMILES core scaffold(s): </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">CoreScaffoldList</span><span class="p">))</span>
 134     
 135     <span class="n">CoreMols</span> <span class="o">=</span> <span class="p">[]</span>
 136     <span class="k">for</span> <span class="n">Core</span> <span class="ow">in</span> <span class="n">CoreScaffoldList</span><span class="p">:</span>
 137         <span class="k">if</span> <span class="n">BySMARTS</span><span class="p">:</span>
 138             <span class="n">CoreMol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmarts</span><span class="p">(</span><span class="n">Core</span><span class="p">)</span>
 139         <span class="k">else</span><span class="p">:</span>
 140             <span class="n">CoreMol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmiles</span><span class="p">(</span><span class="n">Core</span><span class="p">)</span>
 141         <span class="k">if</span> <span class="n">CoreMol</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
 142             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;Failed to generate mol for core scaffold: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Core</span><span class="p">))</span>
 143         <span class="n">CoreMols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CoreMol</span><span class="p">)</span>
 144 
 145     <span class="k">return</span> <span class="n">CoreMols</span>
 146 
 147 <span class="k">def</span> <span class="nf">SetupCoreScaffoldsByMCS</span><span class="p">(</span><span class="n">Mols</span><span class="p">):</span>
 148     <span class="sd">&quot;&quot;&quot;Setup core scaffold molecule using MCS.&quot;&quot;&quot;</span>
 149 
 150     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Setting up core scaffold using MCS...&quot;</span><span class="p">)</span>
 151 
 152     <span class="n">MCSParams</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MCSParams&quot;</span><span class="p">]</span>
 153     
 154     <span class="n">CoreMols</span> <span class="o">=</span> <span class="p">[]</span>
 155 
 156     <span class="n">MCSResultObject</span> <span class="o">=</span> <span class="n">rdFMCS</span><span class="o">.</span><span class="n">FindMCS</span><span class="p">(</span><span class="n">Mols</span><span class="p">,</span> <span class="n">maximizeBonds</span> <span class="o">=</span> <span class="n">MCSParams</span><span class="p">[</span><span class="s2">&quot;MaximizeBonds&quot;</span><span class="p">],</span> <span class="n">threshold</span> <span class="o">=</span> <span class="n">MCSParams</span><span class="p">[</span><span class="s2">&quot;Threshold&quot;</span><span class="p">],</span> <span class="n">timeout</span> <span class="o">=</span> <span class="n">MCSParams</span><span class="p">[</span><span class="s2">&quot;TimeOut&quot;</span><span class="p">],</span> <span class="n">verbose</span> <span class="o">=</span> <span class="n">MCSParams</span><span class="p">[</span><span class="s2">&quot;Verbose&quot;</span><span class="p">],</span> <span class="n">matchValences</span> <span class="o">=</span> <span class="n">MCSParams</span><span class="p">[</span><span class="s2">&quot;MatchValences&quot;</span><span class="p">],</span> <span class="n">ringMatchesRingOnly</span> <span class="o">=</span> <span class="n">MCSParams</span><span class="p">[</span><span class="s2">&quot;RingMatchesRingOnly&quot;</span><span class="p">],</span> <span class="n">completeRingsOnly</span> <span class="o">=</span> <span class="n">MCSParams</span><span class="p">[</span><span class="s2">&quot;CompleteRingsOnly&quot;</span><span class="p">],</span> <span class="n">matchChiralTag</span> <span class="o">=</span> <span class="n">MCSParams</span><span class="p">[</span><span class="s2">&quot;MatchChiralTag&quot;</span><span class="p">],</span> <span class="n">atomCompare</span> <span class="o">=</span> <span class="n">MCSParams</span><span class="p">[</span><span class="s2">&quot;AtomCompare&quot;</span><span class="p">],</span> <span class="n">bondCompare</span> <span class="o">=</span> <span class="n">MCSParams</span><span class="p">[</span><span class="s2">&quot;BondCompare&quot;</span><span class="p">],</span> <span class="n">seedSmarts</span> <span class="o">=</span> <span class="n">MCSParams</span><span class="p">[</span><span class="s2">&quot;SeedSMARTS&quot;</span><span class="p">])</span> 
 157 
 158     <span class="k">if</span> <span class="n">MCSResultObject</span><span class="o">.</span><span class="n">canceled</span><span class="p">:</span>
 159         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;MCS failed to identify a core scaffold. Specify a different set of parameters using </span><span class="se">\&quot;</span><span class="s2">-m, --mcsParams</span><span class="se">\&quot;</span><span class="s2"> option and try again.&quot;</span><span class="p">)</span>
 160     
 161     <span class="n">CoreNumAtoms</span> <span class="o">=</span> <span class="n">MCSResultObject</span><span class="o">.</span><span class="n">numAtoms</span>
 162     <span class="n">CoreNumBonds</span> <span class="o">=</span> <span class="n">MCSResultObject</span><span class="o">.</span><span class="n">numBonds</span>
 163     <span class="n">SMARTSCore</span> <span class="o">=</span> <span class="n">MCSResultObject</span><span class="o">.</span><span class="n">smartsString</span>
 164     
 165     <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">SMARTSCore</span><span class="p">):</span>
 166         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;MCS failed to identify a core scaffold. Specify a different set of parameters using </span><span class="se">\&quot;</span><span class="s2">-m, --mcsParams</span><span class="se">\&quot;</span><span class="s2"> option and try again.&quot;</span><span class="p">)</span>
 167         
 168     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;SMARTS core scaffold: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">Number of atoms in core scaffold: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">Number of bonds in core scaffold: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SMARTSCore</span><span class="p">,</span> <span class="n">CoreNumAtoms</span><span class="p">,</span> <span class="n">CoreNumBonds</span><span class="p">))</span>
 169 
 170     <span class="k">if</span> <span class="n">CoreNumAtoms</span> <span class="o">&lt;</span> <span class="n">MCSParams</span><span class="p">[</span><span class="s2">&quot;MinNumAtoms&quot;</span><span class="p">]:</span>
 171         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;Number of atoms, </span><span class="si">%d</span><span class="s2">, in core scaffold identified by MCS is less than, </span><span class="si">%d</span><span class="s2">, as specified by </span><span class="se">\&quot;</span><span class="s2">minNumAtoms</span><span class="se">\&quot;</span><span class="s2"> parameter in  </span><span class="se">\&quot;</span><span class="s2">-m, --mcsParams</span><span class="se">\&quot;</span><span class="s2"> option.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">CoreNumAtoms</span><span class="p">,</span> <span class="n">MCSParams</span><span class="p">[</span><span class="s2">&quot;MinNumAtoms&quot;</span><span class="p">]))</span>
 172     
 173     <span class="k">if</span> <span class="n">CoreNumBonds</span> <span class="o">&lt;</span> <span class="n">MCSParams</span><span class="p">[</span><span class="s2">&quot;MinNumBonds&quot;</span><span class="p">]:</span>
 174         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;Number of bonds, </span><span class="si">%d</span><span class="s2">, in core scaffold identified by MCS is less than, </span><span class="si">%d</span><span class="s2">, as specified by </span><span class="se">\&quot;</span><span class="s2">minNumBonds</span><span class="se">\&quot;</span><span class="s2"> parameter in  </span><span class="se">\&quot;</span><span class="s2">-m, --mcsParams</span><span class="se">\&quot;</span><span class="s2"> option.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">CoreNumBonds</span><span class="p">,</span> <span class="n">MCSParams</span><span class="p">[</span><span class="s2">&quot;MinNumBonds&quot;</span><span class="p">]))</span>
 175     
 176     <span class="n">CoreMol</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolFromSmarts</span><span class="p">(</span><span class="n">SMARTSCore</span><span class="p">)</span>
 177     <span class="n">CoreMols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CoreMol</span><span class="p">)</span>
 178 
 179     <span class="k">return</span> <span class="n">CoreMols</span>
 180 
 181 <span class="k">def</span> <span class="nf">SetupRGroupDecompositionParams</span><span class="p">():</span>
 182     <span class="sd">&quot;&quot;&quot;Setup R group decomposition parameters&quot;&quot;&quot;</span>
 183 
 184     <span class="n">DecompositionParams</span> <span class="o">=</span> <span class="n">rgd</span><span class="o">.</span><span class="n">RGroupDecompositionParameters</span><span class="p">()</span>
 185 
 186     <span class="n">DecompositionParams</span><span class="o">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;DecompositionParams&quot;</span><span class="p">][</span><span class="s2">&quot;RGroupCoreAlignment&quot;</span><span class="p">]</span>
 187     <span class="n">DecompositionParams</span><span class="o">.</span><span class="n">chunkSize</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;DecompositionParams&quot;</span><span class="p">][</span><span class="s2">&quot;chunkSize&quot;</span><span class="p">]</span>
 188     <span class="n">DecompositionParams</span><span class="o">.</span><span class="n">matchingStrategy</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;DecompositionParams&quot;</span><span class="p">][</span><span class="s2">&quot;RGroupMatching&quot;</span><span class="p">]</span>
 189     <span class="n">DecompositionParams</span><span class="o">.</span><span class="n">onlyMatchAtRGroups</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;DecompositionParams&quot;</span><span class="p">][</span><span class="s2">&quot;matchOnlyAtRGroups&quot;</span><span class="p">]</span>
 190     <span class="n">DecompositionParams</span><span class="o">.</span><span class="n">removeAllHydrogenRGroups</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;DecompositionParams&quot;</span><span class="p">][</span><span class="s2">&quot;removeHydrogenOnlyGroups&quot;</span><span class="p">]</span>
 191     <span class="n">DecompositionParams</span><span class="o">.</span><span class="n">removeHydrogensPostMatch</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;DecompositionParams&quot;</span><span class="p">][</span><span class="s2">&quot;removeHydrogensPostMatch&quot;</span><span class="p">]</span>
 192 
 193     <span class="k">return</span> <span class="n">DecompositionParams</span>
 194     
 195 <span class="k">def</span> <span class="nf">WriteRGroups</span><span class="p">(</span><span class="n">Mols</span><span class="p">,</span> <span class="n">RGroups</span><span class="p">,</span> <span class="n">UnmatchedMolIndices</span><span class="p">):</span>
 196     <span class="sd">&quot;&quot;&quot;Write out R groups&quot;&quot;&quot;</span>
 197 
 198     <span class="n">Outfile</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Outfile&quot;</span><span class="p">]</span>
 199     <span class="n">UnmatchedOutfile</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;UnmatchedOutfile&quot;</span><span class="p">]</span>
 200     <span class="n">RemoveUnmatchedMode</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;RemoveUnmatchedMode&quot;</span><span class="p">]</span>
 201     
 202     <span class="n">Compute2DCoords</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;OutfileParams&quot;</span><span class="p">][</span><span class="s2">&quot;Compute2DCoords&quot;</span><span class="p">]</span>
 203     
 204     <span class="n">TextOutFileMode</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;TextOutFileMode&quot;</span><span class="p">]</span>
 205     <span class="n">TextOutFileDelim</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;TextOutFileDelim&quot;</span><span class="p">]</span>
 206     <span class="n">Quote</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;TextOutQuote&quot;</span><span class="p">]</span>
 207 
 208     <span class="n">SMILESIsomeric</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;OutfileParams&quot;</span><span class="p">][</span><span class="s2">&quot;SMILESIsomeric&quot;</span><span class="p">]</span>
 209     <span class="n">SMILESKekulize</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;OutfileParams&quot;</span><span class="p">][</span><span class="s2">&quot;Kekulize&quot;</span><span class="p">]</span>
 210     
 211     <span class="c1"># Setup writers...</span>
 212     <span class="n">Writer</span> <span class="o">=</span> <span class="bp">None</span>
 213     <span class="n">UnmatchedWriter</span> <span class="o">=</span> <span class="bp">None</span>
 214     <span class="k">if</span> <span class="n">TextOutFileMode</span><span class="p">:</span>
 215         <span class="n">Writer</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">Outfile</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
 216         <span class="k">if</span> <span class="n">RemoveUnmatchedMode</span><span class="p">:</span>
 217             <span class="n">UnmatchedWriter</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">UnmatchedOutfile</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
 218     <span class="k">else</span><span class="p">:</span>
 219         <span class="n">Writer</span> <span class="o">=</span> <span class="n">RDKitUtil</span><span class="o">.</span><span class="n">MoleculesWriter</span><span class="p">(</span><span class="n">Outfile</span><span class="p">,</span> <span class="o">**</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;OutfileParams&quot;</span><span class="p">])</span>
 220         <span class="k">if</span> <span class="n">RemoveUnmatchedMode</span><span class="p">:</span>
 221             <span class="n">UnmatchedWriter</span> <span class="o">=</span> <span class="n">RDKitUtil</span><span class="o">.</span><span class="n">MoleculesWriter</span><span class="p">(</span><span class="n">UnmatchedOutfile</span><span class="p">,</span> <span class="o">**</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;OutfileParams&quot;</span><span class="p">])</span>
 222         
 223     <span class="k">if</span> <span class="n">Writer</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
 224         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;Failed to setup a writer for output fie </span><span class="si">%s</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">Outfile</span><span class="p">)</span>
 225     <span class="k">if</span> <span class="n">RemoveUnmatchedMode</span><span class="p">:</span>
 226         <span class="k">if</span> <span class="n">UnmatchedWriter</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
 227             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;Failed to setup a writer for output fie </span><span class="si">%s</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">UnmatchedOutfile</span><span class="p">)</span>
 228     
 229     <span class="k">if</span> <span class="n">RemoveUnmatchedMode</span><span class="p">:</span>
 230         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Generating files: </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Outfile</span><span class="p">,</span> <span class="n">UnmatchedOutfile</span><span class="p">))</span>
 231     <span class="k">else</span><span class="p">:</span>
 232         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Generating file </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">Outfile</span><span class="p">)</span>
 233         
 234     <span class="c1"># Set up data keys and labels for  core and R groups...</span>
 235     <span class="n">RGroupsDataKeys</span> <span class="o">=</span> <span class="p">[]</span>
 236     <span class="n">RGroupsDataLabels</span> <span class="o">=</span> <span class="p">[]</span>
 237     <span class="n">CoreDataLabelPresent</span> <span class="o">=</span> <span class="bp">False</span>
 238     <span class="k">for</span> <span class="n">DataLabel</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">RGroups</span><span class="p">):</span>
 239         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Core&quot;</span><span class="p">,</span> <span class="n">DataLabel</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 240             <span class="n">CoreDataLabelPresent</span> <span class="o">=</span> <span class="bp">True</span>
 241             <span class="n">RGroupsDataKeys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DataLabel</span><span class="p">)</span>
 242             <span class="n">RGroupsDataLabels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;SMILES</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">DataLabel</span><span class="p">)</span>
 243         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^R&quot;</span><span class="p">,</span> <span class="n">DataLabel</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 244             <span class="n">RGroupsDataKeys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DataLabel</span><span class="p">)</span>
 245             <span class="n">RGroupsDataLabels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;SMILES</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">DataLabel</span><span class="p">)</span>
 246         <span class="k">else</span><span class="p">:</span>
 247             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;Ignoring unknown R group data label, </span><span class="si">%s</span><span class="s2">, found during R group decomposition...&quot;</span> <span class="o">%</span> <span class="n">DataLabel</span><span class="p">)</span>
 248 
 249     <span class="k">if</span> <span class="n">CoreDataLabelPresent</span><span class="p">:</span>
 250         <span class="n">RGroupsCategoriesCount</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">RGroupsDataLabels</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
 251     <span class="k">else</span><span class="p">:</span>
 252         <span class="n">RGroupsCategoriesCount</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">RGroupsDataLabels</span><span class="p">)</span>
 253     <span class="n">RGroupsMolUnmatchedCount</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">UnmatchedMolIndices</span><span class="p">)</span>
 254     <span class="n">RGroupsMolMatchedCount</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">Mols</span><span class="p">)</span> <span class="o">-</span> <span class="n">RGroupsMolUnmatchedCount</span>
 255     
 256     <span class="c1"># Wite out headers for a text file...</span>
 257     <span class="k">if</span> <span class="n">TextOutFileMode</span><span class="p">:</span>
 258         <span class="n">LineWords</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;SMILES&quot;</span><span class="p">,</span><span class="s2">&quot;Name&quot;</span><span class="p">]</span>
 259         
 260         <span class="k">if</span> <span class="n">RemoveUnmatchedMode</span><span class="p">:</span>
 261             <span class="n">Line</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">JoinWords</span><span class="p">(</span><span class="n">LineWords</span><span class="p">,</span> <span class="n">TextOutFileDelim</span><span class="p">,</span> <span class="n">Quote</span><span class="p">)</span>
 262             <span class="n">UnmatchedWriter</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">Line</span><span class="p">)</span>
 263         
 264         <span class="n">LineWords</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">RGroupsDataLabels</span><span class="p">)</span>
 265         <span class="n">Line</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">JoinWords</span><span class="p">(</span><span class="n">LineWords</span><span class="p">,</span> <span class="n">TextOutFileDelim</span><span class="p">,</span> <span class="n">Quote</span><span class="p">)</span>
 266         <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">Line</span><span class="p">)</span>
 267 
 268     <span class="n">MolCount</span> <span class="o">=</span> <span class="mi">0</span>
 269     <span class="n">RGroupsResultIndex</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
 270     
 271     <span class="k">for</span> <span class="n">MolIndex</span><span class="p">,</span> <span class="n">Mol</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">Mols</span><span class="p">):</span>
 272         <span class="n">MolCount</span> <span class="o">+=</span> <span class="mi">1</span>
 273 
 274         <span class="n">UnmatchedMol</span> <span class="o">=</span> <span class="bp">False</span>
 275         <span class="k">if</span> <span class="n">MolIndex</span> <span class="ow">in</span> <span class="n">UnmatchedMolIndices</span><span class="p">:</span>
 276             <span class="n">UnmatchedMol</span> <span class="o">=</span> <span class="bp">True</span>
 277         
 278         <span class="k">if</span> <span class="n">UnmatchedMol</span><span class="p">:</span>
 279             <span class="n">RGroupsDataSMILES</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">RGroupsDataKeys</span><span class="p">)</span>
 280         <span class="k">else</span><span class="p">:</span>
 281             <span class="n">RGroupsResultIndex</span> <span class="o">+=</span> <span class="mi">1</span>
 282             <span class="n">RGroupsDataSMILES</span> <span class="o">=</span> <span class="p">[</span><span class="n">RGroups</span><span class="p">[</span><span class="n">RGroupsDataKey</span><span class="p">][</span><span class="n">RGroupsResultIndex</span><span class="p">]</span> <span class="k">for</span> <span class="n">RGroupsDataKey</span> <span class="ow">in</span> <span class="n">RGroupsDataKeys</span><span class="p">]</span>
 283 
 284         <span class="k">if</span> <span class="n">TextOutFileMode</span><span class="p">:</span>
 285             <span class="c1"># Write out text file including SMILES file...</span>
 286             <span class="n">MolSMILES</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">MolToSmiles</span><span class="p">(</span><span class="n">Mol</span><span class="p">,</span> <span class="n">isomericSmiles</span> <span class="o">=</span> <span class="n">SMILESIsomeric</span><span class="p">,</span> <span class="n">kekuleSmiles</span> <span class="o">=</span> <span class="n">SMILESKekulize</span><span class="p">)</span>
 287             <span class="n">MolName</span> <span class="o">=</span> <span class="n">RDKitUtil</span><span class="o">.</span><span class="n">GetMolName</span><span class="p">(</span><span class="n">Mol</span><span class="p">,</span> <span class="n">MolCount</span><span class="p">)</span>
 288             <span class="n">LineWords</span> <span class="o">=</span> <span class="p">[</span><span class="n">MolSMILES</span><span class="p">,</span> <span class="n">MolName</span><span class="p">]</span>
 289 
 290             <span class="k">if</span> <span class="n">UnmatchedMol</span> <span class="ow">and</span> <span class="n">RemoveUnmatchedMode</span><span class="p">:</span>
 291                 <span class="n">Line</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">JoinWords</span><span class="p">(</span><span class="n">LineWords</span><span class="p">,</span> <span class="n">TextOutFileDelim</span><span class="p">,</span> <span class="n">Quote</span><span class="p">)</span>
 292                 <span class="n">UnmatchedWriter</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">Line</span><span class="p">)</span>
 293             <span class="k">else</span><span class="p">:</span>
 294                 <span class="n">LineWords</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">RGroupsDataSMILES</span><span class="p">)</span>
 295                 <span class="n">Line</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">JoinWords</span><span class="p">(</span><span class="n">LineWords</span><span class="p">,</span> <span class="n">TextOutFileDelim</span><span class="p">,</span> <span class="n">Quote</span><span class="p">)</span>
 296                 <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">Line</span><span class="p">)</span>
 297         <span class="k">else</span><span class="p">:</span>
 298             <span class="c1"># Write out SD file...</span>
 299             <span class="k">if</span> <span class="n">Compute2DCoords</span><span class="p">:</span>
 300                 <span class="n">AllChem</span><span class="o">.</span><span class="n">Compute2DCoords</span><span class="p">(</span><span class="n">Mol</span><span class="p">)</span>
 301             
 302             <span class="k">if</span> <span class="n">UnmatchedMol</span> <span class="ow">and</span> <span class="n">RemoveUnmatchedMode</span><span class="p">:</span>
 303                 <span class="n">UnmatchedWriter</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">Mol</span><span class="p">)</span>
 304             <span class="k">else</span><span class="p">:</span>
 305                 <span class="k">for</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Value</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">RGroupsDataLabels</span><span class="p">,</span> <span class="n">RGroupsDataSMILES</span><span class="p">):</span>
 306                     <span class="n">Mol</span><span class="o">.</span><span class="n">SetProp</span><span class="p">(</span><span class="n">Name</span><span class="p">,</span> <span class="n">Value</span><span class="p">)</span>
 307                 <span class="n">Writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">Mol</span><span class="p">)</span>
 308     
 309     <span class="k">if</span> <span class="n">Writer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
 310         <span class="n">Writer</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
 311     <span class="k">if</span> <span class="n">UnmatchedWriter</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
 312         <span class="n">UnmatchedWriter</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
 313 
 314     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Total number of molecules: </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">MolCount</span><span class="p">)</span>
 315     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Number of  R group categories: </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">RGroupsCategoriesCount</span><span class="p">)</span>
 316     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Number of  matched molecules containing core scaffold(s): </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">RGroupsMolMatchedCount</span><span class="p">)</span>
 317     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Number of  unmatched molecules containing no core scaffold(s): </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">RGroupsMolUnmatchedCount</span><span class="p">)</span>
 318     
 319 <span class="k">def</span> <span class="nf">RetrieveMolecules</span><span class="p">():</span>
 320     <span class="sd">&quot;&quot;&quot;Retrieve molecules.&quot;&quot;&quot;</span>
 321 
 322     <span class="n">Infile</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Infile&quot;</span><span class="p">]</span>
 323     
 324     <span class="c1"># Read molecules...</span>
 325     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Reading file </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">Infile</span><span class="p">)</span>
 326     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfileParams&quot;</span><span class="p">][</span><span class="s2">&quot;AllowEmptyMols&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
 327     <span class="n">ValidMols</span><span class="p">,</span> <span class="n">MolCount</span><span class="p">,</span> <span class="n">ValidMolCount</span>  <span class="o">=</span> <span class="n">RDKitUtil</span><span class="o">.</span><span class="n">ReadAndValidateMolecules</span><span class="p">(</span><span class="n">Infile</span><span class="p">,</span> <span class="o">**</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfileParams&quot;</span><span class="p">])</span>
 328     
 329     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Total number of molecules: </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">MolCount</span><span class="p">)</span>
 330     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Number of valid molecules: </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ValidMolCount</span><span class="p">)</span>
 331     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Number of ignored molecules: </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MolCount</span> <span class="o">-</span> <span class="n">ValidMolCount</span><span class="p">))</span>
 332 
 333     <span class="k">return</span> <span class="n">ValidMols</span>
 334 
 335 <span class="k">def</span> <span class="nf">ProcessDecompositionParameters</span><span class="p">():</span>
 336     <span class="sd">&quot;&quot;&quot;Set up and process decomposition parameters.&quot;&quot;&quot;</span>
 337 
 338     <span class="n">SetupDecompositionParameters</span><span class="p">()</span>
 339     <span class="n">ProcessSpecifiedDecompositionParameters</span><span class="p">()</span>
 340 
 341 <span class="k">def</span> <span class="nf">SetupDecompositionParameters</span><span class="p">():</span>
 342     <span class="sd">&quot;&quot;&quot;Set up default decomposition parameters.&quot;&quot;&quot;</span>
 343     
 344     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;DecompositionParams&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;RGroupCoreAlignment&quot;</span><span class="p">:</span> <span class="n">rgd</span><span class="o">.</span><span class="n">RGroupCoreAlignment</span><span class="o">.</span><span class="n">MCS</span><span class="p">,</span> <span class="s2">&quot;RGroupMatching&quot;</span><span class="p">:</span> <span class="n">rgd</span><span class="o">.</span><span class="n">RGroupMatching</span><span class="o">.</span><span class="n">GreedyChunks</span><span class="p">,</span> <span class="s2">&quot;chunkSize&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;matchOnlyAtRGroups&quot;</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;removeHydrogenOnlyGroups&quot;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;removeHydrogensPostMatch&quot;</span><span class="p">:</span> <span class="bp">False</span><span class="p">}</span>
 345     
 346 <span class="k">def</span> <span class="nf">ProcessSpecifiedDecompositionParameters</span><span class="p">():</span>
 347     <span class="sd">&quot;&quot;&quot;Process specified decomposition parameters.&quot;&quot;&quot;</span>
 348 
 349     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SpecifiedDecompositionParams&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 350         <span class="c1"># Nothing to process...</span>
 351         <span class="k">return</span>
 352 
 353     <span class="c1"># Parse specified parameters...</span>
 354     <span class="n">DecompositionParams</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SpecifiedDecompositionParams&quot;</span><span class="p">])</span>
 355     <span class="k">if</span> <span class="ow">not</span> <span class="n">DecompositionParams</span><span class="p">:</span>
 356         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;No valid parameter name and value pairs specified using </span><span class="se">\&quot;</span><span class="s2">-d, --decompositionParams</span><span class="se">\&quot;</span><span class="s2"> option.&quot;</span><span class="p">)</span>
 357 
 358     <span class="n">DecompositionParamsWords</span> <span class="o">=</span> <span class="n">DecompositionParams</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
 359     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">DecompositionParamsWords</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span><span class="p">:</span>
 360         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The number of comma delimited paramater names and values, </span><span class="si">%d</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="s2">-d, --decompositionParams</span><span class="se">\&quot;</span><span class="s2"> option must be an even number.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">DecompositionParamsWords</span><span class="p">)))</span>
 361     
 362     <span class="c1"># Setup  canonical parameter names...</span>
 363     <span class="n">ValidParamNames</span> <span class="o">=</span> <span class="p">[]</span>
 364     <span class="n">CanonicalParamNamesMap</span> <span class="o">=</span> <span class="p">{}</span>
 365     <span class="k">for</span> <span class="n">ParamName</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;DecompositionParams&quot;</span><span class="p">]):</span>
 366         <span class="n">ValidParamNames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ParamName</span><span class="p">)</span>
 367         <span class="n">CanonicalParamNamesMap</span><span class="p">[</span><span class="n">ParamName</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="o">=</span> <span class="n">ParamName</span>
 368 
 369     <span class="c1"># Validate and set paramater names and value...</span>
 370     <span class="k">for</span> <span class="n">Index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">DecompositionParamsWords</span><span class="p">),</span> <span class="mi">2</span><span class="p">):</span>
 371         <span class="n">Name</span> <span class="o">=</span> <span class="n">DecompositionParamsWords</span><span class="p">[</span><span class="n">Index</span><span class="p">]</span>
 372         <span class="n">Value</span> <span class="o">=</span> <span class="n">DecompositionParamsWords</span><span class="p">[</span><span class="n">Index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
 373 
 374         <span class="n">CanonicalName</span> <span class="o">=</span> <span class="n">Name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
 375         <span class="k">if</span>  <span class="ow">not</span> <span class="n">CanonicalName</span> <span class="ow">in</span> <span class="n">CanonicalParamNamesMap</span><span class="p">:</span>
 376             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter name, </span><span class="si">%s</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="s2">-d, --decompositionParams</span><span class="se">\&quot;</span><span class="s2"> option is not a valid name. Supported parameter names: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span>  <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ValidParamNames</span><span class="p">)))</span>
 377 
 378         <span class="n">ParamName</span> <span class="o">=</span> <span class="n">CanonicalParamNamesMap</span><span class="p">[</span><span class="n">CanonicalName</span><span class="p">]</span>
 379         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^RGroupCoreAlignment$&quot;</span><span class="p">,</span> <span class="n">ParamName</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 380             <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^MCS$&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 381                 <span class="n">ParamValue</span> <span class="o">=</span> <span class="n">rgd</span><span class="o">.</span><span class="n">RGroupCoreAlignment</span><span class="o">.</span><span class="n">MCS</span>
 382             <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^None$&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 383                 <span class="n">ParamValue</span> <span class="o">=</span> <span class="n">rgd</span><span class="o">.</span><span class="n">RGroupCoreAlignment</span><span class="o">.</span><span class="n">names</span><span class="p">[</span><span class="s1">&#39;None&#39;</span><span class="p">]</span>
 384             <span class="k">else</span><span class="p">:</span>
 385                 <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="s2">-d, --decompositionParams</span><span class="se">\&quot;</span><span class="s2"> option  for parameter, </span><span class="si">%s</span><span class="s2">, is not a valid value. Supported values: MCS None&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">))</span>
 386         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^RGroupMatching$&quot;</span><span class="p">,</span> <span class="n">ParamName</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 387             <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Greedy$&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 388                 <span class="n">ParamValue</span> <span class="o">=</span> <span class="n">rgd</span><span class="o">.</span><span class="n">RGroupMatching</span><span class="o">.</span><span class="n">Greedy</span>
 389             <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^GreedyChunks$&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 390                 <span class="n">ParamValue</span> <span class="o">=</span> <span class="n">rgd</span><span class="o">.</span><span class="n">RGroupMatching</span><span class="o">.</span><span class="n">GreedyChunks</span>
 391             <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Exhaustive$&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 392                 <span class="n">ParamValue</span> <span class="o">=</span> <span class="n">rgd</span><span class="o">.</span><span class="n">RGroupMatching</span><span class="o">.</span><span class="n">Exhaustive</span>
 393             <span class="k">else</span><span class="p">:</span>
 394                 <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="s2">-d, --decompositionParams</span><span class="se">\&quot;</span><span class="s2"> option  for parameter, </span><span class="si">%s</span><span class="s2">, is not a valid value. Supported values: Greedy GreedyChunks Exhaustive&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">))</span>
 395         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^chunkSize$&quot;</span><span class="p">,</span> <span class="n">ParamName</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 396             <span class="n">Value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Value</span><span class="p">)</span>
 397             <span class="k">if</span> <span class="n">Value</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="p">:</span>
 398                 <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="s2">-d, --decompositionParams</span><span class="se">\&quot;</span><span class="s2"> option  for parameter, </span><span class="si">%s</span><span class="s2">, is not a valid value. Supported values: &gt; 0&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">))</span>
 399             <span class="n">ParamValue</span> <span class="o">=</span> <span class="n">Value</span>
 400         <span class="k">else</span><span class="p">:</span>
 401             <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(Yes|No|True|False)$&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 402                 <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="s2">-d, --decompositionParams</span><span class="se">\&quot;</span><span class="s2"> option  for parameter, </span><span class="si">%s</span><span class="s2">, is not a valid value. Supported values: Yes No True False&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">))</span>
 403             <span class="n">ParamValue</span> <span class="o">=</span> <span class="bp">False</span>
 404             <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(Yes|True)$&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 405                 <span class="n">ParamValue</span> <span class="o">=</span> <span class="bp">True</span>
 406         
 407         <span class="c1"># Set value...</span>
 408         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;DecompositionParams&quot;</span><span class="p">][</span><span class="n">ParamName</span><span class="p">]</span> <span class="o">=</span> <span class="n">ParamValue</span>
 409 
 410 <span class="k">def</span> <span class="nf">ProcessMCSParameters</span><span class="p">():</span>
 411     <span class="sd">&quot;&quot;&quot;Set up and process MCS parameters.&quot;&quot;&quot;</span>
 412 
 413     <span class="n">SetupMCSParameters</span><span class="p">()</span>
 414     <span class="n">ProcessSpecifiedMCSParameters</span><span class="p">()</span>
 415 
 416 <span class="k">def</span> <span class="nf">SetupMCSParameters</span><span class="p">():</span>
 417     <span class="sd">&quot;&quot;&quot;Set up default MCS parameters.&quot;&quot;&quot;</span>
 418     
 419     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MCSParams&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;MaximizeBonds&quot;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;Threshold&quot;</span><span class="p">:</span> <span class="mf">0.9</span><span class="p">,</span> <span class="s2">&quot;TimeOut&quot;</span><span class="p">:</span> <span class="mi">3600</span><span class="p">,</span> <span class="s2">&quot;Verbose&quot;</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;MatchValences&quot;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;MatchChiralTag&quot;</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;RingMatchesRingOnly&quot;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;CompleteRingsOnly&quot;</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;AtomCompare&quot;</span><span class="p">:</span> <span class="n">rdFMCS</span><span class="o">.</span><span class="n">AtomCompare</span><span class="o">.</span><span class="n">CompareElements</span><span class="p">,</span> <span class="s2">&quot;BondCompare&quot;</span><span class="p">:</span> <span class="n">rdFMCS</span><span class="o">.</span><span class="n">BondCompare</span><span class="o">.</span><span class="n">CompareOrder</span><span class="p">,</span> <span class="s2">&quot;SeedSMARTS&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;MinNumAtoms&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;MinNumBonds&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
 420     
 421 <span class="k">def</span> <span class="nf">ProcessSpecifiedMCSParameters</span><span class="p">():</span>
 422     <span class="sd">&quot;&quot;&quot;Process specified MCS parameters.&quot;&quot;&quot;</span>
 423 
 424     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SpecifiedMCSParams&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 425         <span class="c1"># Nothing to process...</span>
 426         <span class="k">return</span>
 427     
 428     <span class="c1"># Parse specified parameters...</span>
 429     <span class="n">MCSParams</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SpecifiedMCSParams&quot;</span><span class="p">])</span>
 430     <span class="k">if</span> <span class="ow">not</span> <span class="n">MCSParams</span><span class="p">:</span>
 431         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;No valid parameter name and value pairs specified using </span><span class="se">\&quot;</span><span class="s2">-m, --mcsParams</span><span class="se">\&quot;</span><span class="s2"> option.&quot;</span><span class="p">)</span>
 432 
 433     <span class="n">MCSParamsWords</span> <span class="o">=</span> <span class="n">MCSParams</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
 434     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">MCSParamsWords</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span><span class="p">:</span>
 435         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The number of comma delimited paramater names and values, </span><span class="si">%d</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="s2">-m, --mcsParams</span><span class="se">\&quot;</span><span class="s2"> option must be an even number.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">MCSParamsWords</span><span class="p">)))</span>
 436     
 437     <span class="c1"># Setup  canonical parameter names...</span>
 438     <span class="n">ValidParamNames</span> <span class="o">=</span> <span class="p">[]</span>
 439     <span class="n">CanonicalParamNamesMap</span> <span class="o">=</span> <span class="p">{}</span>
 440     <span class="k">for</span> <span class="n">ParamName</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MCSParams&quot;</span><span class="p">]):</span>
 441         <span class="n">ValidParamNames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ParamName</span><span class="p">)</span>
 442         <span class="n">CanonicalParamNamesMap</span><span class="p">[</span><span class="n">ParamName</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="o">=</span> <span class="n">ParamName</span>
 443 
 444     <span class="c1"># Validate and set paramater names and value...</span>
 445     <span class="k">for</span> <span class="n">Index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">MCSParamsWords</span><span class="p">),</span> <span class="mi">2</span><span class="p">):</span>
 446         <span class="n">Name</span> <span class="o">=</span> <span class="n">MCSParamsWords</span><span class="p">[</span><span class="n">Index</span><span class="p">]</span>
 447         <span class="n">Value</span> <span class="o">=</span> <span class="n">MCSParamsWords</span><span class="p">[</span><span class="n">Index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
 448 
 449         <span class="n">CanonicalName</span> <span class="o">=</span> <span class="n">Name</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
 450         <span class="k">if</span>  <span class="ow">not</span> <span class="n">CanonicalName</span> <span class="ow">in</span> <span class="n">CanonicalParamNamesMap</span><span class="p">:</span>
 451             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter name, </span><span class="si">%s</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="s2">-m, --mcsParams</span><span class="se">\&quot;</span><span class="s2"> option is not a valid name. Supported parameter names: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">,</span>  <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ValidParamNames</span><span class="p">)))</span>
 452 
 453         <span class="n">ParamName</span> <span class="o">=</span> <span class="n">CanonicalParamNamesMap</span><span class="p">[</span><span class="n">CanonicalName</span><span class="p">]</span>
 454         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Threshold$&quot;</span><span class="p">,</span> <span class="n">ParamName</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 455             <span class="n">Value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Value</span><span class="p">)</span>
 456             <span class="k">if</span> <span class="n">Value</span> <span class="o">&lt;=</span> <span class="mf">0.0</span> <span class="ow">or</span> <span class="n">Value</span> <span class="o">&gt;</span> <span class="mf">1.0</span> <span class="p">:</span>
 457                 <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="s2">-m, --mcsParams</span><span class="se">\&quot;</span><span class="s2"> option  for parameter, </span><span class="si">%s</span><span class="s2">, is not a valid value. Supported values: &gt; 0 and &lt;= 1.0&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">))</span>
 458             <span class="n">ParamValue</span> <span class="o">=</span> <span class="n">Value</span>
 459         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Timeout$&quot;</span><span class="p">,</span> <span class="n">ParamName</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 460             <span class="n">Value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Value</span><span class="p">)</span>
 461             <span class="k">if</span> <span class="n">Value</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
 462                 <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="s2">-m, --mcsParams</span><span class="se">\&quot;</span><span class="s2"> option  for parameter, </span><span class="si">%s</span><span class="s2">, is not a valid value. Supported values: &gt; 0&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">))</span>
 463             <span class="n">ParamValue</span> <span class="o">=</span> <span class="n">Value</span>
 464         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^MinNumAtoms$&quot;</span><span class="p">,</span> <span class="n">ParamName</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 465             <span class="n">Value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Value</span><span class="p">)</span>
 466             <span class="k">if</span> <span class="n">Value</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
 467                 <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="s2">-m, --mcsParams</span><span class="se">\&quot;</span><span class="s2"> option  for parameter, </span><span class="si">%s</span><span class="s2">, is not a valid value. Supported values: &gt;= 1&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">))</span>
 468             <span class="n">ParamValue</span> <span class="o">=</span> <span class="n">Value</span>
 469         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^MinNumBonds$&quot;</span><span class="p">,</span> <span class="n">ParamName</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 470             <span class="n">Value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Value</span><span class="p">)</span>
 471             <span class="k">if</span> <span class="n">Value</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
 472                 <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="s2">-m, --mcsParams</span><span class="se">\&quot;</span><span class="s2"> option  for parameter, </span><span class="si">%s</span><span class="s2">, is not a valid value. Supported values: &gt;=0 &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">))</span>
 473             <span class="n">ParamValue</span> <span class="o">=</span> <span class="n">Value</span>
 474         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^AtomCompare$&quot;</span><span class="p">,</span> <span class="n">ParamName</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 475             <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^CompareAny$&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 476                 <span class="n">ParamValue</span> <span class="o">=</span> <span class="n">rdFMCS</span><span class="o">.</span><span class="n">AtomCompare</span><span class="o">.</span><span class="n">CompareAny</span>
 477             <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^CompareElements$&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 478                 <span class="n">ParamValue</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdFMCS</span><span class="o">.</span><span class="n">AtomCompare</span><span class="o">.</span><span class="n">CompareElements</span>
 479             <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^CompareIsotopes$&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 480                 <span class="n">ParamValue</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdFMCS</span><span class="o">.</span><span class="n">AtomCompare</span><span class="o">.</span><span class="n">CompareIsotopes</span>
 481             <span class="k">else</span><span class="p">:</span>
 482                 <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="s2">-m, --mcsParams</span><span class="se">\&quot;</span><span class="s2"> option  for parameter, </span><span class="si">%s</span><span class="s2">, is not a valid value. Supported values: CompareAny CompareElements CompareIsotopes&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">))</span>
 483         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^BondCompare$&quot;</span><span class="p">,</span> <span class="n">ParamName</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 484             <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^CompareAny$&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 485                 <span class="n">ParamValue</span> <span class="o">=</span> <span class="n">Chem</span><span class="o">.</span><span class="n">rdFMCS</span><span class="o">.</span><span class="n">BondCompare</span><span class="o">.</span><span class="n">CompareAny</span>
 486             <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^CompareOrder$&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 487                 <span class="n">ParamValue</span> <span class="o">=</span> <span class="n">rdFMCS</span><span class="o">.</span><span class="n">BondCompare</span><span class="o">.</span><span class="n">CompareOrder</span>
 488             <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^CompareOrderExact$&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 489                 <span class="n">ParamValue</span> <span class="o">=</span> <span class="n">rdFMCS</span><span class="o">.</span><span class="n">BondCompare</span><span class="o">.</span><span class="n">CompareOrderExact</span>
 490             <span class="k">else</span><span class="p">:</span>
 491                 <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="s2">-m, --mcsParams</span><span class="se">\&quot;</span><span class="s2"> option  for parameter, </span><span class="si">%s</span><span class="s2">, is not a valid value. Supported values: CompareAny CompareOrder CompareOrderExact&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">))</span>
 492         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^SeedSMARTS$&quot;</span><span class="p">,</span> <span class="n">ParamName</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 493             <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">Value</span><span class="p">):</span>
 494                 <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value specified using </span><span class="se">\&quot;</span><span class="s2">-m, --mcsParams</span><span class="se">\&quot;</span><span class="s2"> option  for parameter, </span><span class="si">%s</span><span class="s2">, is empty. &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Name</span><span class="p">))</span>
 495             <span class="n">ParamValue</span> <span class="o">=</span> <span class="n">Value</span>
 496         <span class="k">else</span><span class="p">:</span>
 497             <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(Yes|No|True|False)$&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 498                 <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The parameter value, </span><span class="si">%s</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="s2">-m, --mcsParams</span><span class="se">\&quot;</span><span class="s2"> option  for parameter, </span><span class="si">%s</span><span class="s2">, is not a valid value. Supported values: Yes No True False&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Value</span><span class="p">,</span> <span class="n">Name</span><span class="p">))</span>
 499             <span class="n">ParamValue</span> <span class="o">=</span> <span class="bp">False</span>
 500             <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(Yes|True)$&quot;</span><span class="p">,</span> <span class="n">Value</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 501                 <span class="n">ParamValue</span> <span class="o">=</span> <span class="bp">True</span>
 502         
 503         <span class="c1"># Set value...</span>
 504         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MCSParams&quot;</span><span class="p">][</span><span class="n">ParamName</span><span class="p">]</span> <span class="o">=</span> <span class="n">ParamValue</span>
 505 
 506 <span class="k">def</span> <span class="nf">ProcessOptions</span><span class="p">():</span>
 507     <span class="sd">&quot;&quot;&quot;Process and validate command line arguments and options&quot;&quot;&quot;</span>
 508     
 509     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Processing options...&quot;</span><span class="p">)</span>
 510     
 511     <span class="c1"># Validate options...</span>
 512     <span class="n">ValidateOptions</span><span class="p">()</span>
 513     
 514     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;CoreScaffold&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--coreScaffold&quot;</span><span class="p">]</span>
 515     
 516     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Infile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--infile&quot;</span><span class="p">]</span>
 517     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfileParams&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ProcessOptionInfileParameters</span><span class="p">(</span><span class="s2">&quot;--infileParams&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--infileParams&quot;</span><span class="p">],</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--infile&quot;</span><span class="p">])</span>
 518     
 519     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Outfile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--outfile&quot;</span><span class="p">]</span>
 520     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;OutfileParams&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ProcessOptionOutfileParameters</span><span class="p">(</span><span class="s2">&quot;--outfileParams&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--outfileParams&quot;</span><span class="p">],</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--infile&quot;</span><span class="p">],</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--outfile&quot;</span><span class="p">])</span>
 521     
 522     <span class="n">TextOutFileMode</span> <span class="o">=</span> <span class="bp">False</span>
 523     <span class="n">TextOutFileDelim</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
 524     
 525     <span class="k">if</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">CheckFileExt</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--outfile&quot;</span><span class="p">],</span> <span class="s2">&quot;csv&quot;</span><span class="p">):</span>
 526         <span class="n">TextOutFileMode</span> <span class="o">=</span> <span class="bp">True</span>
 527         <span class="n">TextOutFileDelim</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span>
 528     <span class="k">elif</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">CheckFileExt</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--outfile&quot;</span><span class="p">],</span> <span class="s2">&quot;tsv txt&quot;</span><span class="p">):</span>
 529         <span class="n">TextOutFileMode</span> <span class="o">=</span> <span class="bp">True</span>
 530         <span class="n">TextOutFileDelim</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
 531     
 532     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;TextOutFileMode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">TextOutFileMode</span>
 533     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;TextOutFileDelim&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">TextOutFileDelim</span>
 534 
 535     <span class="n">TextOutQuote</span> <span class="o">=</span> <span class="bp">False</span>
 536     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--quote&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 537         <span class="k">if</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">CheckFileExt</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--outfile&quot;</span><span class="p">],</span> <span class="s2">&quot;csv&quot;</span><span class="p">):</span>
 538             <span class="n">TextOutQuote</span> <span class="o">=</span> <span class="bp">True</span>
 539     <span class="k">else</span><span class="p">:</span>
 540         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^yes$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--quote&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 541             <span class="n">TextOutQuote</span> <span class="o">=</span> <span class="bp">True</span>
 542     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;TextOutQuote&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">TextOutQuote</span>
 543     
 544     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Overwrite&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--overwrite&quot;</span><span class="p">]</span>
 545 
 546     <span class="n">RemoveUnmatchedMode</span> <span class="o">=</span> <span class="bp">False</span>
 547     <span class="n">UnmatchedOutfile</span> <span class="o">=</span> <span class="bp">None</span>
 548     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^yes$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--removeUnmatched&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 549         <span class="n">RemoveUnmatchedMode</span> <span class="o">=</span> <span class="bp">True</span>
 550         <span class="n">FileDir</span><span class="p">,</span> <span class="n">FileName</span><span class="p">,</span> <span class="n">FileExt</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ParseFileName</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Outfile&quot;</span><span class="p">])</span>
 551         <span class="n">UnmatchedOutfile</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Unmatched.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">FileName</span><span class="p">,</span> <span class="n">FileExt</span><span class="p">)</span>
 552     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;RemoveUnmatchedMode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">RemoveUnmatchedMode</span>
 553     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;UnmatchedOutfile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">UnmatchedOutfile</span>
 554 
 555     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SpecifiedDecompositionParams&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--decompositionParams&quot;</span><span class="p">]</span>
 556     <span class="n">ProcessDecompositionParameters</span><span class="p">()</span>
 557     
 558     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SpecifiedMCSParams&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--mcsParams&quot;</span><span class="p">]</span>
 559     <span class="n">ProcessMCSParameters</span><span class="p">()</span>
 560     
 561     <span class="n">SMARTSOrSMILESCoreScaffold</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
 562     <span class="n">SMARTSOrSMILESCoreScaffoldList</span> <span class="o">=</span> <span class="p">[]</span>
 563     <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^none$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--smartsOrSmilesCoreScaffold&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--smartsOrSmilesCoreScaffold&quot;</span><span class="p">]):</span>
 564         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(BySMARTS|BySMILES)$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--coreScaffold&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 565             <span class="n">SMARTSOrSMILESCoreScaffold</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--smartsOrSmilesCoreScaffold&quot;</span><span class="p">])</span>
 566             <span class="k">if</span> <span class="ow">not</span> <span class="n">SMARTSOrSMILESCoreScaffold</span><span class="p">:</span>
 567                 <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;A non empty value must be specified for </span><span class="se">\&quot;</span><span class="s2">-s, --smartsOrSmilesCoreScaffold</span><span class="se">\&quot;</span><span class="s2"> during </span><span class="si">%s</span><span class="s2"> value of </span><span class="se">\&quot;</span><span class="s2">-c, --coreScaffold</span><span class="se">\&quot;</span><span class="s2"> option &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--coreScaffold&quot;</span><span class="p">]))</span>
 568             <span class="n">SMARTSOrSMILESCoreScaffoldList</span> <span class="o">=</span> <span class="n">SMARTSOrSMILESCoreScaffold</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
 569     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SMARTSOrSMILESCoreScaffold&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SMARTSOrSMILESCoreScaffold</span>
 570     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SMARTSOrSMILESCoreScaffoldList&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">SMARTSOrSMILESCoreScaffoldList</span>
 571     
 572 <span class="k">def</span> <span class="nf">RetrieveOptions</span><span class="p">():</span>
 573     <span class="sd">&quot;&quot;&quot;Retrieve command line arguments and options&quot;&quot;&quot;</span>
 574     
 575     <span class="c1"># Get options...</span>
 576     <span class="k">global</span> <span class="n">Options</span>
 577     <span class="n">Options</span> <span class="o">=</span> <span class="n">docopt</span><span class="p">(</span><span class="n">_docoptUsage_</span><span class="p">)</span>
 578     
 579     <span class="c1"># Set current working directory to the specified directory...</span>
 580     <span class="n">WorkingDir</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--workingdir&quot;</span><span class="p">]</span>
 581     <span class="k">if</span> <span class="n">WorkingDir</span><span class="p">:</span>
 582         <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">WorkingDir</span><span class="p">)</span>
 583     
 584     <span class="c1"># Handle examples option...</span>
 585     <span class="k">if</span> <span class="s2">&quot;--examples&quot;</span> <span class="ow">in</span> <span class="n">Options</span> <span class="ow">and</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--examples&quot;</span><span class="p">]:</span>
 586         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="n">MiscUtil</span><span class="o">.</span><span class="n">GetExamplesTextFromDocOptText</span><span class="p">(</span><span class="n">_docoptUsage_</span><span class="p">))</span>
 587         <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
 588 
 589 <span class="k">def</span> <span class="nf">ValidateOptions</span><span class="p">():</span>
 590     <span class="sd">&quot;&quot;&quot;Validate option values&quot;&quot;&quot;</span>
 591     
 592     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;-c, --coreScaffold&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--coreScaffold&quot;</span><span class="p">],</span> <span class="s2">&quot;ByMCS BySMARTS BySMILES&quot;</span><span class="p">)</span>
 593     
 594     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFilePath</span><span class="p">(</span><span class="s2">&quot;-i, --infile&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--infile&quot;</span><span class="p">])</span>
 595     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFileExt</span><span class="p">(</span><span class="s2">&quot;-i, --infile&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--infile&quot;</span><span class="p">],</span> <span class="s2">&quot;sdf sd mol smi csv tsv txt&quot;</span><span class="p">)</span>
 596     
 597     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFileExt</span><span class="p">(</span><span class="s2">&quot;-o, --outfile&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--outfile&quot;</span><span class="p">],</span> <span class="s2">&quot;sdf sd csv tsv txt&quot;</span><span class="p">)</span>
 598     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionsOutputFileOverwrite</span><span class="p">(</span><span class="s2">&quot;-o, --outfile&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--outfile&quot;</span><span class="p">],</span> <span class="s2">&quot;--overwrite&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--overwrite&quot;</span><span class="p">])</span>
 599     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionsDistinctFileNames</span><span class="p">(</span><span class="s2">&quot;-i, --infile&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--infile&quot;</span><span class="p">],</span> <span class="s2">&quot;-o, --outfile&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--outfile&quot;</span><span class="p">])</span>
 600     
 601     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^none$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--smartsOrSmilesCoreScaffold&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--smartsOrSmilesCoreScaffold&quot;</span><span class="p">]):</span>
 602         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(BySMARTS|BySMILES)$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--coreScaffold&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 603             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;A non empty value must be specified for </span><span class="se">\&quot;</span><span class="s2">-s, --smartsOrSmilesCoreScaffold</span><span class="se">\&quot;</span><span class="s2"> during </span><span class="si">%s</span><span class="s2"> value of </span><span class="se">\&quot;</span><span class="s2">-c, --coreScaffold</span><span class="se">\&quot;</span><span class="s2"> option &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--coreScaffold&quot;</span><span class="p">]))</span>
 604     <span class="k">else</span><span class="p">:</span>
 605         <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(BySMARTS|BySMILES)$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--coreScaffold&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 606             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> value of </span><span class="se">\&quot;</span><span class="s2">-s, --smartsOrSmilesCoreScaffold</span><span class="se">\&quot;</span><span class="s2"> is not allowed during </span><span class="si">%s</span><span class="s2"> value of </span><span class="se">\&quot;</span><span class="s2">-c, --coreScaffold</span><span class="se">\&quot;</span><span class="s2"> option &quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--smartsOrSmilesCoreScaffold&quot;</span><span class="p">],</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--coreScaffold&quot;</span><span class="p">]))</span>
 607     
 608     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;-q, --quote&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--quote&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no auto&quot;</span><span class="p">)</span>
 609     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;-r, --removeUnmatched&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--removeUnmatched&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
 610     
 611 <span class="c1"># Setup a usage string for docopt...</span>
 612 <span class="n">_docoptUsage_</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
 613 <span class="s2">RDKitPerformRGroupDecomposition.py - Perform R group decomposition analysis</span>
 614 
 615 <span class="s2">Usage:</span>
 616 <span class="s2">    RDKitPerformRGroupDecomposition.py [--coreScaffold &lt;ByMCS, BySMARTS or BySMILES&gt;]</span>
 617 <span class="s2">                                       [--decompositionParams &lt;Name,Value,...&gt;]</span>
 618 <span class="s2">                                       [--infileParams &lt;Name,Value,...&gt;] [--mcsParams &lt;Name,Value,...&gt;]</span>
 619 <span class="s2">                                       [--outfileParams &lt;Name,Value,...&gt;] [--overwrite] [--quote &lt;yes or no&gt;]</span>
 620 <span class="s2">                                       [--removeUnmatched &lt;yes or no&gt;] [--smartsOrSmilesCoreScaffold &lt;text&gt;]</span>
 621 <span class="s2">                                       [-w &lt;dir&gt;] -i &lt;infile&gt; -o &lt;outfile&gt; </span>
 622 <span class="s2">    RDKitPerformRGroupDecomposition.py -h | --help | -e | --examples</span>
 623 
 624 <span class="s2">Description:</span>
 625 <span class="s2">    Perform R group decomposition for a set of molecules in a series containing</span>
 626 <span class="s2">    a common core scaffold. The core scaffold is identified by a SMARTS string,</span>
 627 <span class="s2">    SMILES string, or using maximum common substructure (MCS) search.</span>
 628 <span class="s2">    Multiple core scaffolds may be specified using SMARTS or SMILES strings for</span>
 629 <span class="s2">    set of molecules corresponding to multiple series.</span>
 630 
 631 <span class="s2">    The core scaffolds along with appropriate R groups are written out as SMILES</span>
 632 <span class="s2">    strings to a SD or text file. The unmatched molecules without any specified</span>
 633 <span class="s2">    core scaffold are written to a different output file.</span>
 634 
 635 <span class="s2">    The supported input file formats are: Mol (.mol), SD (.sdf, .sd), SMILES (.smi,</span>
 636 <span class="s2">    .txt, .csv, .tsv)</span>
 637 
 638 <span class="s2">    The supported output file formats are: SD (.sdf, .sd), CSV/TSV (.csv, .tsv, .txt)</span>
 639 
 640 <span class="s2">Options:</span>
 641 <span class="s2">    -c, --coreScaffold &lt;ByMCS, BySMARTS or BySMILES&gt;  [default: ByMCS]</span>
 642 <span class="s2">        Specify a core scaffold for a set of molecules in a series. The core scaffold</span>
 643 <span class="s2">        is identified by an explicit SMARTS string, SMILES string, or using maximum</span>
 644 <span class="s2">        common substructure (MCS) search. Multiple core scaffolds may be specified</span>
 645 <span class="s2">        using SMARTS or SMILES strings for set of molecules corresponding to multiple</span>
 646 <span class="s2">        series.</span>
 647 <span class="s2">    -d, --decompositionParams &lt;Name,Value,...&gt;  [default: auto]</span>
 648 <span class="s2">        Parameter values to use during R group decomposition for a series of molecules.</span>
 649 <span class="s2">        In general, it is a comma delimited list of parameter name and value pairs. The</span>
 650 <span class="s2">        supported parameter names along with their default values are shown below:</span>
 651 <span class="s2">            </span>
 652 <span class="s2">            RGroupCoreAlignment,MCS, RGroupMatching,GreedyChunks,chunkSize,5,</span>
 653 <span class="s2">            matchOnlyAtRGroups,no,removeHydrogenOnlyGroups,yes,</span>
 654 <span class="s2">            removeHydrogensPostMatch,no</span>
 655 <span class="s2">            </span>
 656 <span class="s2">        A brief description of each supported parameter taken from  RDKit documentation,</span>
 657 <span class="s2">        along with their possible values, is as follows.</span>
 658 <span class="s2">        </span>
 659 <span class="s2">        RGroupCoreAlignment - Mapping of core labels:</span>
 660 <span class="s2">        </span>
 661 <span class="s2">            MCS - Map core labels to each other using MCS</span>
 662 <span class="s2">            None - No mapping</span>
 663 <span class="s2">        </span>
 664 <span class="s2">        RGroupMatching: Greedy, GreedyChunks, Exhaustive</span>
 665 <span class="s2">        </span>
 666 <span class="s2">        matchOnlyAtRGroups - Allow R group decomposition only at specified R groups.</span>
 667 <span class="s2">        Possible values: yes, no.</span>
 668 <span class="s2">        </span>
 669 <span class="s2">        removeHydrogenOnlyGroups - Remove all R groups that only have hydrogens.</span>
 670 <span class="s2">        Possible values: yes, no.</span>
 671 <span class="s2">        </span>
 672 <span class="s2">        removeHydrogensPostMatch - Remove all hydrogens from the output molecules.</span>
 673 <span class="s2">        Possible values: yes, no.</span>
 674 <span class="s2">    -e, --examples</span>
 675 <span class="s2">        Print examples.</span>
 676 <span class="s2">    -h, --help</span>
 677 <span class="s2">        Print this help message.</span>
 678 <span class="s2">    -i, --infile &lt;infile&gt;</span>
 679 <span class="s2">        Input file name.</span>
 680 <span class="s2">    --infileParams &lt;Name,Value,...&gt;  [default: auto]</span>
 681 <span class="s2">        A comma delimited list of parameter name and value pairs for reading </span>
 682 <span class="s2">        molecules from files. The supported parameter names for different file</span>
 683 <span class="s2">        formats, along with their default values, are shown below:</span>
 684 <span class="s2">            </span>
 685 <span class="s2">            SD, MOL: removeHydrogens,yes,sanitize,yes,strictParsing,yes</span>
 686 <span class="s2">            SMILES: smilesColumn,1,smilesNameColumn,2,smilesDelimiter,space,</span>
 687 <span class="s2">                smilesTitleLine,auto,sanitize,yes</span>
 688 <span class="s2">            </span>
 689 <span class="s2">        Possible values for smilesDelimiter: space, comma or tab.</span>
 690 <span class="s2">    -m, --mcsParams &lt;Name,Value,...&gt;  [default: auto]</span>
 691 <span class="s2">        Parameter values to use for identifying a maximum common substructure</span>
 692 <span class="s2">        (MCS) in a series of molecules. In general, it is a comma delimited list of</span>
 693 <span class="s2">        parameter name and value pairs. The supported parameter names along with</span>
 694 <span class="s2">        their default values are shown below:</span>
 695 <span class="s2">            </span>
 696 <span class="s2">            atomCompare,CompareElements,bondCompare,CompareOrder,</span>
 697 <span class="s2">            maximizeBonds,yes,matchValences,yes,matchChiralTag,no,</span>
 698 <span class="s2">            minNumAtoms,1,minNumBonds,0,ringMatchesRingOnly,yes,</span>
 699 <span class="s2">            completeRingsOnly,yes,threshold,1.0,timeOut,3600,seedSMARTS,none</span>
 700 <span class="s2">            </span>
 701 <span class="s2">        Possible values for atomCompare: CompareAny, CompareElements,</span>
 702 <span class="s2">        CompareIsotopes. Possible values for bondCompare: CompareAny,</span>
 703 <span class="s2">        CompareOrder, CompareOrderExact.</span>
 704 <span class="s2">        </span>
 705 <span class="s2">        A brief description of MCS parameters taken from RDKit documentation is</span>
 706 <span class="s2">        as follows:</span>
 707 <span class="s2">            </span>
 708 <span class="s2">            atomCompare - Controls match between two atoms</span>
 709 <span class="s2">            bondCompare - Controls match between two bonds</span>
 710 <span class="s2">            maximizeBonds - Maximize number of bonds instead of atoms</span>
 711 <span class="s2">            matchValences - Include atom valences in the MCS match</span>
 712 <span class="s2">            matchChiralTag - Include atom chirality in the MCS match</span>
 713 <span class="s2">            minNumAtoms - Minimum number of atoms in the MCS match</span>
 714 <span class="s2">            minNumBonds - Minimum number of bonds in the MCS match</span>
 715 <span class="s2">            ringMatchesRingOnly - Ring bonds only match other ring bonds</span>
 716 <span class="s2">            completeRingsOnly - Partial rings not allowed during the match</span>
 717 <span class="s2">            threshold - Fraction of the dataset that must contain the MCS</span>
 718 <span class="s2">            seedSMARTS - SMARTS string as the seed of the MCS</span>
 719 <span class="s2">            timeout - Timeout for the MCS calculation in seconds</span>
 720 <span class="s2">            </span>
 721 <span class="s2">    -o, --outfile &lt;outfile&gt;</span>
 722 <span class="s2">        Output file name.</span>
 723 <span class="s2">    --outfileParams &lt;Name,Value,...&gt;  [default: auto]</span>
 724 <span class="s2">        A comma delimited list of parameter name and value pairs for writing</span>
 725 <span class="s2">        molecules to files. The supported parameter names for different file</span>
 726 <span class="s2">        formats, along with their default values, are shown below:</span>
 727 <span class="s2">            </span>
 728 <span class="s2">            SD: compute2DCoords,auto,kekulize,no</span>
 729 <span class="s2">            SMILES: kekulize,no,smilesIsomeric,yes</span>
 730 <span class="s2">            </span>
 731 <span class="s2">        Default value for compute2DCoords: yes for SMILES input file; no for all other</span>
 732 <span class="s2">        file types. The kekulize and smilesIsomeric parameters are also used during</span>
 733 <span class="s2">        generation of SMILES strings for CSV/TSV files.</span>
 734 <span class="s2">    --overwrite</span>
 735 <span class="s2">        Overwrite existing files.</span>
 736 <span class="s2">    -q, --quote &lt;yes or no&gt;  [default: auto]</span>
 737 <span class="s2">        Quote SMILES strings and molecule names before writing them out to text</span>
 738 <span class="s2">        files. Possible values: yes or no. Default: yes for CSV (.csv) text files; no for</span>
 739 <span class="s2">        TSV (.tsv) and TXT (.txt) text files.</span>
 740 <span class="s2">    -r, --removeUnmatched &lt;yes or no&gt;  [default: no]</span>
 741 <span class="s2">        Remove unmatched molecules containing no specified core scaffold from the</span>
 742 <span class="s2">        output file and write them to a different output file.</span>
 743 <span class="s2">    -s, --smartsOrSmilesCoreScaffold &lt;text&gt;  [default: none]</span>
 744 <span class="s2">        SMARTS or SMILES string to use for core scaffold during &#39;SMARTS&#39; or &#39;SMILES&#39;</span>
 745 <span class="s2">        value of &#39;-c, --coreScaffold&#39; option. Multiple core scaffolds may be specified using a</span>
 746 <span class="s2">        comma delimited set of SMARTS or SMILES strings.</span>
 747 <span class="s2">    -w, --workingdir &lt;dir&gt;</span>
 748 <span class="s2">        Location of working directory which defaults to the current directory.</span>
 749 
 750 <span class="s2">Examples:</span>
 751 <span class="s2">    To perform R group decomposition for a set of molecules in a series using MCS</span>
 752 <span class="s2">    to identify a core scaffold and write out a CSV file containing R groups, type:</span>
 753 
 754 <span class="s2">        % RDKitPerformRGroupDecomposition.py -i SampleSeriesD3R.smi</span>
 755 <span class="s2">          -o SampleSeriesD3ROut.csv</span>
 756 
 757 <span class="s2">    To perform R group decomposition for a set of molecules in a series using a</span>
 758 <span class="s2">    specified core scaffold and write out a SD file containing R groups, type:</span>
 759 
 760 <span class="s2">        % RDKitPerformRGroupDecomposition.py  -c BySMARTS</span>
 761 <span class="s2">          -s &quot;Nc1nccc(-c2cnc(CNCc3ccccc3)c2)n1&quot; -i SampleSeriesD3R.smi</span>
 762 <span class="s2">          -o SampleSeriesD3ROut.sdf</span>
 763 
 764 <span class="s2">    To perform R group decomposition for a set of molecules in a series using MCS</span>
 765 <span class="s2">    to identify a core scaffold and write out CSV files containing matched and</span>
 766 <span class="s2">    unmatched molecules without quoting values, type:</span>
 767 
 768 <span class="s2">        % RDKitPerformRGroupDecomposition.py -c ByMCS -r yes -q no</span>
 769 <span class="s2">          -i SampleSeriesD3R.sdf -o SampleSeriesD3ROut.csv</span>
 770 
 771 <span class="s2">    To perform R group decomposition for a set of molecules in multiple series using</span>
 772 <span class="s2">    specified core scaffolds and write out a TSV file containing R groups, type:</span>
 773 
 774 <span class="s2">        % RDKitPerformRGroupDecomposition.py  -c BySMARTS</span>
 775 <span class="s2">          -s &quot;Nc1nccc(-c2cnc(CNCc3ccccc3)c2)n1,[#6]-[#6]1:[#6]:[#6]:[#6]:[#6]:</span>
 776 <span class="s2">          [#6]:1&quot; -i SampleMultipleSeriesD3R.smi -o</span>
 777 <span class="s2">          SampleMultipleSeriesD3ROut.tsv</span>
 778 
 779 <span class="s2">    To perform R group decomposition for a set of molecules in a CSV SMILES file,</span>
 780 <span class="s2">    SMILES strings in  olumn 1, name in column 2, and write out a CSV file containing</span>
 781 <span class="s2">    R groups, type:</span>
 782 <span class="s2">     </span>
 783 <span class="s2">        % RDKitPerformRGroupDecomposition.py --infileParams </span>
 784 <span class="s2">          &quot;smilesDelimiter,comma,smilesTitleLine,yes,smilesColumn,1,</span>
 785 <span class="s2">          smilesNameColumn,2&quot; --outfileParams &quot;compute2DCoords,yes&quot;</span>
 786 <span class="s2">          -i SampleSeriesD3R.smi -o SampleSeriesD3ROut.csv</span>
 787 
 788 <span class="s2">Author:</span>
 789 <span class="s2">    Manish Sud(msud@san.rr.com)</span>
 790 
 791 <span class="s2">See also:</span>
 792 <span class="s2">    RDKitConvertFileFormat.py, RDKitSearchFunctionalGroups.py, RDKitSearchSMARTS.py</span>
 793 
 794 <span class="s2">Copyright:</span>
 795 <span class="s2">    Copyright (C) 2020 Manish Sud. All rights reserved.</span>
 796 
 797 <span class="s2">    The functionality available in this script is implemented using RDKit, an</span>
 798 <span class="s2">    open source toolkit for cheminformatics developed by Greg Landrum.</span>
 799 
 800 <span class="s2">    This file is part of MayaChemTools.</span>
 801 
 802 <span class="s2">    MayaChemTools is free software; you can redistribute it and/or modify it under</span>
 803 <span class="s2">    the terms of the GNU Lesser General Public License as published by the Free</span>
 804 <span class="s2">    Software Foundation; either version 3 of the License, or (at your option) any</span>
 805 <span class="s2">    later version.</span>
 806 
 807 <span class="s2">&quot;&quot;&quot;</span>
 808 
 809 <span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
 810     <span class="n">main</span><span class="p">()</span>
</pre>
<br />
<center>
<img src="../../../images/h2o2.png">
</center>
</body>
</html>
