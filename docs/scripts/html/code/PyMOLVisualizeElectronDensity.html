<html>
<head>
<title>MayaChemTools:Code:PyMOLVisualizeElectronDensity.py</title>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<link rel="stylesheet" type="text/css" href="../../../css/MayaChemToolsPythonCode.css">
</head>
<body leftmargin="20" rightmargin="20" topmargin="10" bottommargin="10">
<br/>
<center>
<a href="http://www.mayachemtools.org" title="MayaChemTools Home"><img src="../../../images/MayaChemToolsLogo.gif" border="0" alt="MayaChemTools"></a>
</center>
<br/>
<pre>
    1 <span class="ch">#!/bin/env python</span>
    2 <span class="c1">#</span>
    3 <span class="c1"># File: PyMOLVisualizeElectronDensity.py</span>
    4 <span class="c1"># Author: Manish Sud &lt;msud@san.rr.com&gt;</span>
    5 <span class="c1">#</span>
    6 <span class="c1"># Copyright (C) 2020 Manish Sud. All rights reserved.</span>
    7 <span class="c1">#</span>
    8 <span class="c1"># The functionality available in this script is implemented using PyMOL, a</span>
    9 <span class="c1"># molecular visualization system on an open source foundation originally</span>
   10 <span class="c1"># developed by Warren DeLano.</span>
   11 <span class="c1">#</span>
   12 <span class="c1"># This file is part of MayaChemTools.</span>
   13 <span class="c1">#</span>
   14 <span class="c1"># MayaChemTools is free software; you can redistribute it and/or modify it under</span>
   15 <span class="c1"># the terms of the GNU Lesser General Public License as published by the Free</span>
   16 <span class="c1"># Software Foundation; either version 3 of the License, or (at your option) any</span>
   17 <span class="c1"># later version.</span>
   18 <span class="c1">#</span>
   19 <span class="c1"># MayaChemTools is distributed in the hope that it will be useful, but without</span>
   20 <span class="c1"># any warranty; without even the implied warranty of merchantability of fitness</span>
   21 <span class="c1"># for a particular purpose.  See the GNU Lesser General Public License for more</span>
   22 <span class="c1"># details.</span>
   23 <span class="c1">#</span>
   24 <span class="c1"># You should have received a copy of the GNU Lesser General Public License</span>
   25 <span class="c1"># along with MayaChemTools; if not, see &lt;http://www.gnu.org/licenses/&gt; or</span>
   26 <span class="c1"># write to the Free Software Foundation Inc., 59 Temple Place, Suite 330,</span>
   27 <span class="c1"># Boston, MA, 02111-1307, USA.</span>
   28 <span class="c1">#</span>
   29 
   30 <span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
   31 
   32 <span class="c1"># Add local python path to the global path and import standard library modules...</span>
   33 <span class="kn">import</span> <span class="nn">os</span>
   34 <span class="kn">import</span> <span class="nn">sys</span><span class="p">;</span>  <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="s2">&quot;..&quot;</span><span class="p">,</span> <span class="s2">&quot;lib&quot;</span><span class="p">,</span> <span class="s2">&quot;Python&quot;</span><span class="p">))</span>
   35 <span class="kn">import</span> <span class="nn">time</span>
   36 <span class="kn">import</span> <span class="nn">re</span>
   37 
   38 <span class="c1"># PyMOL imports...</span>
   39 <span class="k">try</span><span class="p">:</span>
   40     <span class="kn">import</span> <span class="nn">pymol</span>
   41     <span class="c1"># Finish launching PyMOL in  a command line mode for batch processing (-c)</span>
   42     <span class="c1"># along with the following options:  disable loading of pymolrc and plugins (-k);</span>
   43     <span class="c1"># suppress start up messages (-q)</span>
   44     <span class="n">pymol</span><span class="o">.</span><span class="n">finish_launching</span><span class="p">([</span><span class="s1">&#39;pymol&#39;</span><span class="p">,</span> <span class="s1">&#39;-ckq&#39;</span><span class="p">])</span>
   45 <span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">ErrMsg</span><span class="p">:</span>
   46     <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Failed to import PyMOL module/package: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ErrMsg</span><span class="p">)</span>
   47     <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Check/update your PyMOL environment and try again.</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
   48     <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
   49 
   50 <span class="c1"># MayaChemTools imports...</span>
   51 <span class="k">try</span><span class="p">:</span>
   52     <span class="kn">from</span> <span class="nn">docopt</span> <span class="kn">import</span> <span class="n">docopt</span>
   53     <span class="kn">import</span> <span class="nn">MiscUtil</span>
   54     <span class="kn">import</span> <span class="nn">PyMOLUtil</span>
   55 <span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">ErrMsg</span><span class="p">:</span>
   56     <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Failed to import MayaChemTools module/package: </span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ErrMsg</span><span class="p">)</span>
   57     <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;Check/update your MayaChemTools environment and try again.</span><span class="se">\n\n</span><span class="s2">&quot;</span><span class="p">)</span>
   58     <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
   59 
   60 <span class="n">ScriptName</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
   61 <span class="n">Options</span> <span class="o">=</span> <span class="p">{}</span>
   62 <span class="n">OptionsInfo</span> <span class="o">=</span> <span class="p">{}</span>
   63 
   64 <span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
   65     <span class="sd">&quot;&quot;&quot;Start execution of the script&quot;&quot;&quot;</span>
   66     
   67     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="s2"> (PyMOL v</span><span class="si">%s</span><span class="s2">; </span><span class="si">%s</span><span class="s2">) Starting...</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ScriptName</span><span class="p">,</span> <span class="n">pymol</span><span class="o">.</span><span class="n">cmd</span><span class="o">.</span><span class="n">get_version</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="n">time</span><span class="o">.</span><span class="n">asctime</span><span class="p">()))</span>
   68     
   69     <span class="p">(</span><span class="n">WallClockTime</span><span class="p">,</span> <span class="n">ProcessorTime</span><span class="p">)</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">GetWallClockAndProcessorTime</span><span class="p">()</span>
   70     
   71     <span class="c1"># Retrieve command line arguments and options...</span>
   72     <span class="n">RetrieveOptions</span><span class="p">()</span>
   73     
   74     <span class="c1"># Process and validate command line arguments and options...</span>
   75     <span class="n">ProcessOptions</span><span class="p">()</span>
   76 
   77     <span class="c1"># Perform actions required by the script...</span>
   78     <span class="n">GenerateElectronDensityVisualization</span><span class="p">()</span>
   79     
   80     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="s2">: Done...</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ScriptName</span><span class="p">)</span>
   81     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Total time: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">GetFormattedElapsedTime</span><span class="p">(</span><span class="n">WallClockTime</span><span class="p">,</span> <span class="n">ProcessorTime</span><span class="p">))</span>
   82 
   83 <span class="k">def</span> <span class="nf">GenerateElectronDensityVisualization</span><span class="p">():</span>
   84     <span class="sd">&quot;&quot;&quot;Generate electron density visualization.&quot;&quot;&quot;</span>
   85 
   86     <span class="n">Outfile</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMLOutfile&quot;</span><span class="p">]</span>
   87     <span class="n">OutFH</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">Outfile</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
   88     <span class="k">if</span> <span class="n">OutFH</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
   89         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;Failed to open output fie </span><span class="si">%s</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">Outfile</span><span class="p">)</span>
   90     
   91     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Generating file </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">Outfile</span><span class="p">)</span>
   92 
   93     <span class="c1"># Setup header...</span>
   94     <span class="n">WritePMLHeader</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">ScriptName</span><span class="p">)</span>
   95     <span class="n">WritePyMOLParameters</span><span class="p">(</span><span class="n">OutFH</span><span class="p">)</span>
   96 
   97     <span class="c1"># Load reffile for alignment..</span>
   98     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Align&quot;</span><span class="p">]:</span>
   99         <span class="n">WriteAlignReference</span><span class="p">(</span><span class="n">OutFH</span><span class="p">)</span>
  100 
  101     <span class="c1"># Setup view for each input file...</span>
  102     <span class="n">FirstComplex</span> <span class="o">=</span> <span class="bp">True</span>
  103     <span class="n">FirstComplexFirstChainName</span> <span class="o">=</span> <span class="bp">None</span>
  104     <span class="k">for</span> <span class="n">FileIndex</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">])):</span>
  105         <span class="c1"># Setup PyMOL object names...</span>
  106         <span class="n">PyMOLObjectNames</span> <span class="o">=</span> <span class="n">SetupPyMOLObjectNames</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">)</span>
  107 
  108         <span class="c1"># Setup complex view...</span>
  109         <span class="n">WriteComplexView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">FirstComplex</span><span class="p">)</span>
  110         
  111         <span class="n">SpecifiedChainsAndLigandsInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
  112         <span class="n">FirstChain</span> <span class="o">=</span> <span class="bp">True</span>
  113         <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]:</span>
  114             <span class="k">if</span> <span class="n">FirstComplex</span> <span class="ow">and</span> <span class="n">FirstChain</span><span class="p">:</span>
  115                 <span class="n">FirstComplexFirstChainName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAlone&quot;</span><span class="p">]</span>
  116                 
  117             <span class="n">WriteChainView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
  118             
  119             <span class="c1"># Setup ligand views...</span>
  120             <span class="n">FirstLigand</span> <span class="o">=</span> <span class="bp">True</span>
  121             <span class="k">for</span> <span class="n">LigandID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]:</span>
  122                 <span class="n">WriteChainLigandView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">)</span>
  123                 
  124                 <span class="c1"># Set up ligand level group...</span>
  125                 <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span> <span class="o">=</span> <span class="p">[</span><span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">]</span>
  126                 <span class="k">if</span> <span class="n">FirstLigand</span><span class="p">:</span>
  127                     <span class="n">FirstLigand</span> <span class="o">=</span> <span class="bp">False</span>
  128                     <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span> <span class="o">=</span> <span class="p">[</span><span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;open&quot;</span><span class="p">]</span>
  129                 <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="s2">&quot;ChainLigandGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="s2">&quot;ChainLigandGroupMembers&quot;</span><span class="p">],</span> <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span><span class="p">)</span>
  130             
  131             <span class="c1"># Setup Chain level group...</span>
  132             <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span> <span class="o">=</span> <span class="p">[</span><span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">]</span>
  133             <span class="k">if</span> <span class="n">FirstChain</span><span class="p">:</span>
  134                 <span class="n">FirstChain</span> <span class="o">=</span> <span class="bp">False</span>
  135                 <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span> <span class="o">=</span> <span class="p">[</span><span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;open&quot;</span><span class="p">]</span>
  136             <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroupMembers&quot;</span><span class="p">],</span> <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span><span class="p">)</span>
  137     
  138         <span class="c1"># Set up complex level group...</span>
  139         <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span> <span class="o">=</span> <span class="p">[</span><span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">]</span>
  140         <span class="k">if</span> <span class="n">FirstComplex</span><span class="p">:</span>
  141             <span class="n">FirstComplex</span> <span class="o">=</span> <span class="bp">False</span>
  142             <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span> <span class="o">=</span> <span class="p">[</span><span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;open&quot;</span><span class="p">]</span>
  143         <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;PDBGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;PDBGroupMembers&quot;</span><span class="p">],</span> <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span><span class="p">)</span>
  144         
  145         <span class="c1"># Delete empty PyMOL objects...</span>
  146         <span class="n">DeleteEmptyPyMOLObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">)</span>
  147         
  148     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Align&quot;</span><span class="p">]:</span>
  149         <span class="n">DeleteAlignReference</span><span class="p">(</span><span class="n">OutFH</span><span class="p">)</span>
  150 
  151     <span class="k">if</span> <span class="n">FirstComplexFirstChainName</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
  152         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">cmd.orient(&quot;</span><span class="si">%s</span><span class="s2">&quot;, animate = -1)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">FirstComplexFirstChainName</span><span class="p">)</span>
  153     <span class="k">else</span><span class="p">:</span>
  154         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">cmd.orient(&quot;visible&quot;, animate = -1)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  155     
  156     <span class="n">OutFH</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
  157 
  158     <span class="c1"># Generate PSE file as needed...</span>
  159     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PSEOut&quot;</span><span class="p">]:</span>
  160         <span class="n">GeneratePyMOLSessionFile</span><span class="p">()</span>
  161 
  162 <span class="k">def</span> <span class="nf">WritePMLHeader</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">ScriptName</span><span class="p">):</span>
  163     <span class="sd">&quot;&quot;&quot;Write out PML setting up complex view&quot;&quot;&quot;</span>
  164 
  165     <span class="n">HeaderInfo</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLHeaderInfo</span><span class="p">(</span><span class="n">ScriptName</span><span class="p">)</span>
  166     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">HeaderInfo</span><span class="p">)</span>
  167 
  168 <span class="k">def</span> <span class="nf">WritePyMOLParameters</span><span class="p">(</span><span class="n">OutFH</span><span class="p">):</span>
  169     <span class="sd">&quot;&quot;&quot;Write out PyMOL global parameters. &quot;&quot;&quot;</span>
  170 
  171     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
  172     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;mesh_width&quot;, </span><span class="si">%.2f</span><span class="s2">)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshWidth&quot;</span><span class="p">]))</span>
  173     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;transparency&quot;, </span><span class="si">%.2f</span><span class="s2">, &quot;&quot;, 0)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceTransparency&quot;</span><span class="p">]))</span>
  174     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;label_font_id&quot;, </span><span class="si">%s</span><span class="s2">)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;LabelFontID&quot;</span><span class="p">]))</span>
  175     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
  176     
  177     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Setting up PyMOL gobal parameters...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
  178     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  179 
  180 <span class="k">def</span> <span class="nf">WriteAlignReference</span><span class="p">(</span><span class="n">OutFH</span><span class="p">):</span>
  181     <span class="sd">&quot;&quot;&quot;Setup object for alignment reference &quot;&quot;&quot;</span>
  182 
  183     <span class="n">RefFileInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;RefFileInfo&quot;</span><span class="p">]</span>
  184     <span class="n">RefFile</span> <span class="o">=</span> <span class="n">RefFileInfo</span><span class="p">[</span><span class="s2">&quot;RefFileName&quot;</span><span class="p">]</span>
  185     <span class="n">RefName</span> <span class="o">=</span> <span class="n">RefFileInfo</span><span class="p">[</span><span class="s2">&quot;PyMOLObjectName&quot;</span><span class="p">]</span>
  186     
  187     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
  188     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.load(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">RefFile</span><span class="p">,</span> <span class="n">RefName</span><span class="p">))</span>
  189     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.hide(&quot;everything&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">RefName</span><span class="p">))</span>
  190     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.disable(&quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">RefName</span><span class="p">))</span>
  191     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
  192     
  193     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Loading </span><span class="si">%s</span><span class="s2"> and setting up view for align reference...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">RefFile</span><span class="p">)</span>
  194     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  195     
  196 <span class="k">def</span> <span class="nf">WriteAlignComplex</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">):</span>
  197     <span class="sd">&quot;&quot;&quot;Setup alignment of complex to reference&quot;&quot;&quot;</span>
  198 
  199     <span class="n">RefFileInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;RefFileInfo&quot;</span><span class="p">]</span>
  200     <span class="n">RefName</span> <span class="o">=</span> <span class="n">RefFileInfo</span><span class="p">[</span><span class="s2">&quot;PyMOLObjectName&quot;</span><span class="p">]</span>
  201     
  202     <span class="n">ComplexName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Complex&quot;</span><span class="p">]</span>
  203     
  204     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^FirstChain$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AlignMode&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  205         <span class="n">RefFirstChainID</span> <span class="o">=</span> <span class="n">RefFileInfo</span><span class="p">[</span><span class="s2">&quot;ChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
  206         <span class="n">RefAlignSelection</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">RefName</span><span class="p">,</span> <span class="n">RefFirstChainID</span><span class="p">)</span>
  207         
  208         <span class="n">ComplexFirstChainID</span> <span class="o">=</span> <span class="n">RetrieveFirstChainID</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">)</span>
  209         <span class="n">ComplexAlignSelection</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> and chain </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ComplexName</span><span class="p">,</span> <span class="n">ComplexFirstChainID</span><span class="p">)</span>
  210     <span class="k">else</span><span class="p">:</span>
  211         <span class="n">RefAlignSelection</span> <span class="o">=</span> <span class="n">RefName</span>
  212         <span class="n">ComplexAlignSelection</span> <span class="o">=</span> <span class="n">ComplexName</span>
  213 
  214     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForAlignment</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AlignMethod&quot;</span><span class="p">],</span> <span class="n">RefAlignSelection</span><span class="p">,</span> <span class="n">ComplexAlignSelection</span><span class="p">)</span>
  215     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Aligning </span><span class="si">%s</span><span class="s2"> against reference </span><span class="si">%s</span><span class="s2"> ...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ComplexAlignSelection</span><span class="p">,</span> <span class="n">RefAlignSelection</span><span class="p">))</span>
  216     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  217     
  218 <span class="k">def</span> <span class="nf">DeleteAlignReference</span><span class="p">(</span><span class="n">OutFH</span><span class="p">):</span>
  219     <span class="sd">&quot;&quot;&quot;Delete alignment reference object.&quot;&quot;&quot;</span>
  220     
  221     <span class="n">RefName</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;RefFileInfo&quot;</span><span class="p">][</span><span class="s2">&quot;PyMOLObjectName&quot;</span><span class="p">]</span>
  222     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Deleting alignment reference object </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">RefName</span><span class="p">)</span>
  223     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.delete(&quot;</span><span class="si">%s</span><span class="s2">&quot;)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">RefName</span><span class="p">)</span>
  224 
  225 <span class="k">def</span> <span class="nf">WriteComplexView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">FirstComplex</span><span class="p">):</span>
  226     <span class="sd">&quot;&quot;&quot;Write out PML for viewing polymer complex along with electron density.&quot;&quot;&quot;</span>
  227 
  228     <span class="c1"># Setup complex...</span>
  229     <span class="n">Infile</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
  230     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForPolymerComplexView</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Complex&quot;</span><span class="p">],</span> <span class="n">Infile</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
  231     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Loading </span><span class="si">%s</span><span class="s2"> and setting up view for complex...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">Infile</span><span class="p">)</span>
  232     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  233     
  234     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Align&quot;</span><span class="p">]:</span>
  235         <span class="c1"># No need to align complex on to itself...</span>
  236         <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^FirstInputFile$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AlignRefFile&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="ow">and</span> <span class="n">FirstComplex</span><span class="p">):</span>
  237             <span class="n">WriteAlignComplex</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">)</span>
  238 
  239     <span class="c1"># Setup electron density maps and meshes...</span>
  240     <span class="n">CompositeEDMapFile</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;CompositeEDMapFiles&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
  241     <span class="n">WriteComplexCompositeElectronDensityMapView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">CompositeEDMapFile</span><span class="p">)</span>
  242     
  243     <span class="k">if</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;SetupDiffEDMapObjects&quot;</span><span class="p">]:</span>
  244         <span class="n">DifferenceEDMapFile</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;DiffEDMapFiles&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
  245         <span class="n">WriteComplexDifferenceElectronDensityMapView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">DifferenceEDMapFile</span><span class="p">)</span>
  246 
  247     <span class="c1"># Setup complex group...</span>
  248     <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexGroupMembers&quot;</span><span class="p">],</span> <span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  249 
  250 <span class="k">def</span> <span class="nf">WriteComplexCompositeElectronDensityMapView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">MapFileName</span><span class="p">):</span>
  251     <span class="sd">&quot;&quot;&quot;Write out PML for viewing composite maps.&quot;&quot;&quot;</span>
  252 
  253     <span class="c1"># Load composite map (2Fo - Fc) and setup mesh views...</span>
  254     <span class="n">Info</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
  255 <span class="s2">&quot;&quot;</span>
  256 <span class="s2">&quot;Loading composite map (2Fo - Fc) </span><span class="si">%s</span><span class="s2"> and setting up mesh view for complex...&quot;</span>
  257 <span class="s2">&quot;&quot; &quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">MapFileName</span>
  258     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">Info</span><span class="p">)</span>
  259 
  260     <span class="n">MapName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexCompositeEDMap&quot;</span><span class="p">]</span>
  261     <span class="n">ComplexName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Complex&quot;</span><span class="p">]</span>
  262     
  263     <span class="n">ContourLevel</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshLevelCompositeMap&quot;</span><span class="p">]</span>
  264     <span class="n">Color</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshColorCompositeMap&quot;</span><span class="p">]</span>
  265     
  266     <span class="n">VolumeColorRamp</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;VolumeColorRampCompositeMap&quot;</span><span class="p">]</span>
  267     
  268     <span class="n">VolumeName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexCompositeEDVolume&quot;</span><span class="p">]</span>
  269     <span class="n">MeshName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexCompositeEDMesh&quot;</span><span class="p">]</span>
  270     <span class="n">SurfaceName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexCompositeEDSurface&quot;</span><span class="p">]</span>
  271     
  272     <span class="n">AlignMapToObjectName</span> <span class="o">=</span> <span class="n">ComplexName</span> <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Align&quot;</span><span class="p">]</span> <span class="k">else</span> <span class="bp">None</span>
  273     <span class="n">EnableMap</span> <span class="o">=</span> <span class="bp">True</span>
  274     <span class="n">PML</span> <span class="o">=</span> <span class="n">SetupPMLForElectronDensityMap</span><span class="p">(</span><span class="n">MapFileName</span><span class="p">,</span> <span class="n">MapName</span><span class="p">,</span> <span class="n">AlignMapToObjectName</span><span class="p">,</span> <span class="n">EnableMap</span><span class="p">)</span>
  275     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  276 
  277     <span class="n">EnableMesh</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshComplex&quot;</span><span class="p">]</span>
  278     
  279     <span class="n">EnableVolume</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;VolumeComplex&quot;</span><span class="p">]</span>
  280     <span class="k">if</span> <span class="n">EnableVolume</span> <span class="ow">and</span> <span class="n">EnableMesh</span><span class="p">:</span>
  281         <span class="n">EnableVolume</span> <span class="o">=</span> <span class="bp">False</span>
  282         
  283     <span class="n">EnableSurface</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceComplex&quot;</span><span class="p">]</span>
  284     <span class="k">if</span> <span class="n">EnableSurface</span> <span class="ow">and</span> <span class="p">(</span><span class="n">EnableVolume</span> <span class="ow">or</span> <span class="n">EnableMesh</span><span class="p">):</span>
  285         <span class="n">EnableSurface</span> <span class="o">=</span> <span class="bp">False</span>
  286     
  287     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;VolumeComplex&quot;</span><span class="p">]:</span>
  288         <span class="n">PML</span> <span class="o">=</span> <span class="n">SetupPMLForElectronDensityVolume</span><span class="p">(</span><span class="n">MapName</span><span class="p">,</span> <span class="n">VolumeName</span><span class="p">,</span> <span class="n">VolumeColorRamp</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="n">EnableVolume</span><span class="p">,</span> <span class="n">Selection</span> <span class="o">=</span> <span class="n">ComplexName</span><span class="p">)</span>
  289         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  290         
  291     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshComplex&quot;</span><span class="p">]:</span>
  292         <span class="n">PML</span> <span class="o">=</span> <span class="n">SetupPMLForElectronDensityMesh</span><span class="p">(</span><span class="n">MapName</span><span class="p">,</span> <span class="n">MeshName</span><span class="p">,</span> <span class="n">ContourLevel</span><span class="p">,</span> <span class="n">Color</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="n">EnableMesh</span><span class="p">,</span> <span class="n">Selection</span> <span class="o">=</span> <span class="n">ComplexName</span><span class="p">)</span>
  293         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  294 
  295     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceComplex&quot;</span><span class="p">]:</span>
  296         <span class="n">PML</span> <span class="o">=</span> <span class="n">SetupPMLForElectronDensitySurface</span><span class="p">(</span><span class="n">MapName</span><span class="p">,</span> <span class="n">SurfaceName</span><span class="p">,</span> <span class="n">ContourLevel</span><span class="p">,</span> <span class="n">Color</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="n">EnableSurface</span><span class="p">,</span> <span class="n">Selection</span> <span class="o">=</span> <span class="n">ComplexName</span><span class="p">)</span>
  297         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  298 
  299     <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexCompositeEDGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexCompositeEDGroupMembers&quot;</span><span class="p">],</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  300     
  301 <span class="k">def</span> <span class="nf">WriteComplexDifferenceElectronDensityMapView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">MapFileName</span><span class="p">):</span>
  302     <span class="sd">&quot;&quot;&quot;Write out PML for viewing difference maps.&quot;&quot;&quot;</span>
  303 
  304     <span class="c1"># Load difference map (Fo - Fc ) and setup mesh views...</span>
  305     <span class="n">Info</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
  306 <span class="s2">&quot;&quot;</span>
  307 <span class="s2">&quot;Loading difference map (Fo - Fc ) map </span><span class="si">%s</span><span class="s2"> and setting up mesh views...&quot;</span>
  308 <span class="s2">&quot;&quot; &quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">MapFileName</span>
  309     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">Info</span><span class="p">)</span>
  310 
  311     <span class="n">MapName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexDiffEDMap&quot;</span><span class="p">]</span>
  312     <span class="n">ComplexName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Complex&quot;</span><span class="p">]</span>
  313 
  314     <span class="n">ContourLevel1</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Mesh1LevelDiffMap&quot;</span><span class="p">]</span>
  315     <span class="n">ContourLevel2</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Mesh2LevelDiffMap&quot;</span><span class="p">]</span>
  316     <span class="n">Color1</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Mesh1ColorDiffMap&quot;</span><span class="p">]</span>
  317     <span class="n">Color2</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Mesh2ColorDiffMap&quot;</span><span class="p">]</span>
  318     
  319     <span class="n">VolumeColorRamp</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;VolumeColorRampDiffMap&quot;</span><span class="p">]</span>
  320     
  321     <span class="n">VolumeName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexDiffEDVolume&quot;</span><span class="p">]</span>
  322     <span class="n">Mesh1Name</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexDiffEDMesh1&quot;</span><span class="p">]</span>
  323     <span class="n">Surface1Name</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexDiffEDSurface1&quot;</span><span class="p">]</span>
  324     <span class="n">Mesh2Name</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexDiffEDMesh2&quot;</span><span class="p">]</span>
  325     <span class="n">Surface2Name</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexDiffEDSurface2&quot;</span><span class="p">]</span>
  326     
  327     <span class="n">EnableMesh</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshComplex&quot;</span><span class="p">]</span>
  328     
  329     <span class="n">EnableVolume</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;VolumeComplex&quot;</span><span class="p">]</span>
  330     <span class="k">if</span> <span class="n">EnableVolume</span> <span class="ow">and</span> <span class="n">EnableMesh</span><span class="p">:</span>
  331         <span class="n">EnableVolume</span> <span class="o">=</span> <span class="bp">False</span>
  332         
  333     <span class="n">EnableSurface</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceComplex&quot;</span><span class="p">]</span>
  334     <span class="k">if</span> <span class="n">EnableSurface</span> <span class="ow">and</span> <span class="p">(</span><span class="n">EnableVolume</span> <span class="ow">or</span> <span class="n">EnableMesh</span><span class="p">):</span>
  335         <span class="n">EnableSurface</span> <span class="o">=</span> <span class="bp">False</span>
  336     
  337     <span class="n">AlignMapToObjectName</span> <span class="o">=</span> <span class="n">ComplexName</span> <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Align&quot;</span><span class="p">]</span> <span class="k">else</span> <span class="bp">None</span>
  338     <span class="n">EnableMap</span> <span class="o">=</span> <span class="bp">True</span>
  339     <span class="n">PML</span> <span class="o">=</span> <span class="n">SetupPMLForElectronDensityMap</span><span class="p">(</span><span class="n">MapFileName</span><span class="p">,</span> <span class="n">MapName</span><span class="p">,</span> <span class="n">AlignMapToObjectName</span><span class="p">,</span> <span class="n">EnableMap</span><span class="p">)</span>
  340     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  341     
  342     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;VolumeComplex&quot;</span><span class="p">]:</span>
  343         <span class="n">PML</span> <span class="o">=</span> <span class="n">SetupPMLForElectronDensityVolume</span><span class="p">(</span><span class="n">MapName</span><span class="p">,</span> <span class="n">VolumeName</span><span class="p">,</span> <span class="n">VolumeColorRamp</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="n">EnableVolume</span><span class="p">,</span> <span class="n">Selection</span> <span class="o">=</span> <span class="n">ComplexName</span><span class="p">)</span>
  344         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  345         
  346     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshComplex&quot;</span><span class="p">]:</span>
  347         <span class="n">PML</span> <span class="o">=</span> <span class="n">SetupPMLForElectronDensityMesh</span><span class="p">(</span><span class="n">MapName</span><span class="p">,</span> <span class="n">Mesh1Name</span><span class="p">,</span> <span class="n">ContourLevel1</span><span class="p">,</span> <span class="n">Color1</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="n">EnableMesh</span><span class="p">,</span> <span class="n">Selection</span> <span class="o">=</span> <span class="n">ComplexName</span><span class="p">)</span>
  348         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  349         
  350     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceComplex&quot;</span><span class="p">]:</span>
  351         <span class="n">PML</span> <span class="o">=</span> <span class="n">SetupPMLForElectronDensitySurface</span><span class="p">(</span><span class="n">MapName</span><span class="p">,</span> <span class="n">Surface1Name</span><span class="p">,</span> <span class="n">ContourLevel1</span><span class="p">,</span> <span class="n">Color1</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="n">EnableSurface</span><span class="p">,</span> <span class="n">Selection</span> <span class="o">=</span> <span class="n">ComplexName</span><span class="p">)</span>
  352         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  353     
  354     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshComplex&quot;</span><span class="p">]:</span>
  355         <span class="n">PML</span> <span class="o">=</span> <span class="n">SetupPMLForElectronDensityMesh</span><span class="p">(</span><span class="n">MapName</span><span class="p">,</span> <span class="n">Mesh2Name</span><span class="p">,</span> <span class="n">ContourLevel2</span><span class="p">,</span> <span class="n">Color2</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="n">EnableMesh</span><span class="p">,</span> <span class="n">Selection</span> <span class="o">=</span> <span class="n">ComplexName</span><span class="p">)</span>
  356         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  357     
  358     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceComplex&quot;</span><span class="p">]:</span>
  359         <span class="n">PML</span> <span class="o">=</span> <span class="n">SetupPMLForElectronDensitySurface</span><span class="p">(</span><span class="n">MapName</span><span class="p">,</span> <span class="n">Surface2Name</span><span class="p">,</span> <span class="n">ContourLevel2</span><span class="p">,</span> <span class="n">Color2</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="n">EnableSurface</span><span class="p">,</span> <span class="n">Selection</span> <span class="o">=</span> <span class="n">ComplexName</span><span class="p">)</span>
  360         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  361     
  362     <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexDiffEDGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexDiffEDGroupMembers&quot;</span><span class="p">],</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  363 
  364 <span class="k">def</span> <span class="nf">WriteChainView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  365     <span class="sd">&quot;&quot;&quot;Write out PML for viewing chain.&quot;&quot;&quot;</span>
  366     
  367     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Setting up views for chain </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">ChainID</span><span class="p">)</span>
  368     
  369     <span class="n">ChainComplexName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplex&quot;</span><span class="p">]</span>
  370     
  371     <span class="c1"># Setup chain complex group view...</span>
  372     <span class="n">WriteChainComplexAndMeshViews</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
  373 
  374     <span class="c1"># Setup chain view...</span>
  375     <span class="n">WriteChainAloneViews</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
  376     
  377     <span class="c1"># Setup chain solvent view...</span>
  378     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForSolventView</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;Solvent&quot;</span><span class="p">],</span> <span class="n">ChainComplexName</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
  379     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  380 
  381     <span class="c1"># Setup chain inorganic view...</span>
  382     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForInorganicView</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;Inorganic&quot;</span><span class="p">],</span> <span class="n">ChainComplexName</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>
  383     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  384 
  385 <span class="k">def</span> <span class="nf">WriteChainComplexAndMeshViews</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  386     <span class="sd">&quot;&quot;&quot;Write chain complex and mesh views. &quot;&quot;&quot;</span>
  387     
  388     <span class="c1"># Setup chain complex...</span>
  389     <span class="n">ChainComplexName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplex&quot;</span><span class="p">]</span>
  390     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForPolymerChainComplexView</span><span class="p">(</span><span class="n">ChainComplexName</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Complex&quot;</span><span class="p">],</span> <span class="n">ChainID</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
  391     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  392 
  393     <span class="n">SpecifiedChainsAndLigandsInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
  394     
  395     <span class="n">MeshChainComplex</span> <span class="o">=</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;MeshChainComplex&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
  396     <span class="n">VolumeChainComplex</span> <span class="o">=</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;VolumeChainComplex&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
  397     <span class="n">SurfaceChainComplex</span> <span class="o">=</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChainComplex&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
  398     
  399     <span class="n">EnableVolumeChainComplex</span> <span class="o">=</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;EnableVolumeChainComplex&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
  400     <span class="n">EnableMeshChainComplex</span> <span class="o">=</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;EnableMeshChainComplex&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
  401     <span class="n">EnableSurfaceChainComplex</span> <span class="o">=</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;EnableSurfaceChainComplex&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
  402     
  403     <span class="k">if</span> <span class="n">MeshChainComplex</span> <span class="ow">or</span> <span class="n">VolumeChainComplex</span> <span class="ow">or</span> <span class="n">SurfaceChainComplex</span><span class="p">:</span>
  404         <span class="c1"># Set up composite mesh and group...</span>
  405         <span class="n">MapName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexCompositeEDMap&quot;</span><span class="p">]</span>
  406         <span class="n">ContourLevel</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshLevelCompositeMap&quot;</span><span class="p">]</span>
  407         <span class="n">Color</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshColorCompositeMap&quot;</span><span class="p">]</span>
  408         <span class="n">VolumeColorRamp</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;VolumeColorRampCompositeMap&quot;</span><span class="p">]</span>
  409         
  410         <span class="n">MeshName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexCompositeEDMesh&quot;</span><span class="p">]</span>
  411         <span class="n">VolumeName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexCompositeEDVolume&quot;</span><span class="p">]</span>
  412         <span class="n">SurfaceName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexCompositeEDSurface&quot;</span><span class="p">]</span>
  413         
  414         <span class="k">if</span> <span class="n">VolumeChainComplex</span><span class="p">:</span>
  415             <span class="n">PML</span> <span class="o">=</span> <span class="n">SetupPMLForElectronDensityVolume</span><span class="p">(</span><span class="n">MapName</span><span class="p">,</span> <span class="n">VolumeName</span><span class="p">,</span> <span class="n">VolumeColorRamp</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="n">EnableVolumeChainComplex</span><span class="p">,</span> <span class="n">Selection</span> <span class="o">=</span> <span class="n">ChainComplexName</span><span class="p">)</span>
  416             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  417         
  418         <span class="k">if</span> <span class="n">MeshChainComplex</span><span class="p">:</span>
  419             <span class="n">PML</span> <span class="o">=</span> <span class="n">SetupPMLForElectronDensityMesh</span><span class="p">(</span><span class="n">MapName</span><span class="p">,</span> <span class="n">MeshName</span><span class="p">,</span> <span class="n">ContourLevel</span><span class="p">,</span> <span class="n">Color</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="n">EnableMeshChainComplex</span><span class="p">,</span> <span class="n">Selection</span> <span class="o">=</span> <span class="n">ChainComplexName</span><span class="p">)</span>
  420             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  421         
  422         <span class="k">if</span> <span class="n">SurfaceChainComplex</span><span class="p">:</span>
  423             <span class="n">PML</span> <span class="o">=</span> <span class="n">SetupPMLForElectronDensitySurface</span><span class="p">(</span><span class="n">MapName</span><span class="p">,</span> <span class="n">SurfaceName</span><span class="p">,</span> <span class="n">ContourLevel</span><span class="p">,</span> <span class="n">Color</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="n">EnableSurfaceChainComplex</span><span class="p">,</span> <span class="n">Selection</span> <span class="o">=</span> <span class="n">ChainComplexName</span><span class="p">)</span>
  424             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  425         
  426         <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexCompositeEDGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexCompositeEDGroupMembers&quot;</span><span class="p">],</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  427         <span class="k">if</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;SetupDiffEDMapObjects&quot;</span><span class="p">]:</span>
  428             <span class="c1"># Set up difference meshes and group...</span>
  429             <span class="n">MapName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexDiffEDMap&quot;</span><span class="p">]</span>
  430             
  431             <span class="n">ContourLevel1</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Mesh1LevelDiffMap&quot;</span><span class="p">]</span>
  432             <span class="n">ContourLevel2</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Mesh2LevelDiffMap&quot;</span><span class="p">]</span>
  433             <span class="n">Color1</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Mesh1ColorDiffMap&quot;</span><span class="p">]</span>
  434             <span class="n">Color2</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Mesh2ColorDiffMap&quot;</span><span class="p">]</span>
  435             
  436             <span class="n">VolumeColorRamp</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;VolumeColorRampDiffMap&quot;</span><span class="p">]</span>
  437             <span class="n">VolumeName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexDiffEDVolume&quot;</span><span class="p">]</span>
  438             
  439             <span class="n">Mesh1Name</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexDiffEDMesh1&quot;</span><span class="p">]</span>
  440             <span class="n">Surface1Name</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexDiffEDSurface1&quot;</span><span class="p">]</span>
  441             <span class="n">Mesh2Name</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexDiffEDMesh2&quot;</span><span class="p">]</span>
  442             <span class="n">Surface2Name</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexDiffEDSurface2&quot;</span><span class="p">]</span>
  443         
  444             <span class="k">if</span> <span class="n">VolumeChainComplex</span><span class="p">:</span>
  445                 <span class="n">PML</span> <span class="o">=</span> <span class="n">SetupPMLForElectronDensityVolume</span><span class="p">(</span><span class="n">MapName</span><span class="p">,</span> <span class="n">VolumeName</span><span class="p">,</span> <span class="n">VolumeColorRamp</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="n">EnableVolumeChainComplex</span><span class="p">,</span> <span class="n">Selection</span> <span class="o">=</span> <span class="n">ChainComplexName</span><span class="p">)</span>
  446                 <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  447             
  448             <span class="k">if</span> <span class="n">MeshChainComplex</span><span class="p">:</span>
  449                 <span class="n">PML</span> <span class="o">=</span> <span class="n">SetupPMLForElectronDensityMesh</span><span class="p">(</span><span class="n">MapName</span><span class="p">,</span> <span class="n">Mesh1Name</span><span class="p">,</span> <span class="n">ContourLevel1</span><span class="p">,</span> <span class="n">Color1</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="n">EnableMeshChainComplex</span><span class="p">,</span> <span class="n">Selection</span> <span class="o">=</span> <span class="n">ChainComplexName</span><span class="p">)</span>
  450                 <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  451             
  452             <span class="k">if</span> <span class="n">SurfaceChainComplex</span><span class="p">:</span>
  453                 <span class="n">PML</span> <span class="o">=</span> <span class="n">SetupPMLForElectronDensitySurface</span><span class="p">(</span><span class="n">MapName</span><span class="p">,</span> <span class="n">Surface1Name</span><span class="p">,</span> <span class="n">ContourLevel1</span><span class="p">,</span> <span class="n">Color1</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="n">EnableSurfaceChainComplex</span><span class="p">,</span> <span class="n">Selection</span> <span class="o">=</span> <span class="n">ChainComplexName</span><span class="p">)</span>
  454                 <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  455             
  456             <span class="k">if</span> <span class="n">MeshChainComplex</span><span class="p">:</span>
  457                 <span class="n">PML</span> <span class="o">=</span> <span class="n">SetupPMLForElectronDensityMesh</span><span class="p">(</span><span class="n">MapName</span><span class="p">,</span> <span class="n">Mesh2Name</span><span class="p">,</span> <span class="n">ContourLevel2</span><span class="p">,</span> <span class="n">Color2</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="n">EnableMeshChainComplex</span><span class="p">,</span> <span class="n">Selection</span> <span class="o">=</span> <span class="n">ChainComplexName</span><span class="p">)</span>
  458                 <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  459             
  460             <span class="k">if</span> <span class="n">SurfaceChainComplex</span><span class="p">:</span>
  461                 <span class="n">PML</span> <span class="o">=</span> <span class="n">SetupPMLForElectronDensitySurface</span><span class="p">(</span><span class="n">MapName</span><span class="p">,</span> <span class="n">Surface2Name</span><span class="p">,</span> <span class="n">ContourLevel2</span><span class="p">,</span> <span class="n">Color2</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="n">EnableSurfaceChainComplex</span><span class="p">,</span> <span class="n">Selection</span> <span class="o">=</span> <span class="n">ChainComplexName</span><span class="p">)</span>
  462                 <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  463         
  464             <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexDiffEDGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexDiffEDGroupMembers&quot;</span><span class="p">],</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  465     
  466     <span class="c1"># Setup chain complex group...</span>
  467     <span class="n">EnableChainComplexGroup</span> <span class="o">=</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;EnableChainComplexGroup&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
  468     <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexGroupMembers&quot;</span><span class="p">],</span> <span class="n">EnableChainComplexGroup</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  469     
  470 <span class="k">def</span> <span class="nf">WriteChainAloneViews</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  471     <span class="sd">&quot;&quot;&quot;Write individual chain views. &quot;&quot;&quot;</span>
  472 
  473     <span class="n">ChainComplexName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplex&quot;</span><span class="p">]</span>
  474     
  475     <span class="c1"># Setup chain view...</span>
  476     <span class="n">ChainName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAlone&quot;</span><span class="p">]</span>
  477     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForPolymerChainView</span><span class="p">(</span><span class="n">ChainName</span><span class="p">,</span> <span class="n">ChainComplexName</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
  478     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  479 
  480     <span class="c1"># Setup chain putty by B-factor view...</span>
  481     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;BFactorChainCartoonPutty&quot;</span><span class="p">]:</span>
  482         <span class="n">BFactorPuttyName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneBFactorPutty&quot;</span><span class="p">]</span>
  483         <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForBFactorPuttyView</span><span class="p">(</span><span class="n">BFactorPuttyName</span><span class="p">,</span> <span class="n">ChainName</span><span class="p">,</span> <span class="n">ColorPalette</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;BFactorColorPalette&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
  484         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  485     
  486     <span class="c1"># Setup chain selections view...</span>
  487     <span class="n">SetupChainSelectionsView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
  488     
  489     <span class="c1"># Setup chain group...</span>
  490     <span class="n">SpecifiedChainsAndLigandsInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
  491     <span class="n">EnableChainAloneGroup</span> <span class="o">=</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;EnableChainAloneGroup&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
  492     <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneGroup&quot;</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneGroupMembers&quot;</span><span class="p">],</span> <span class="n">EnableChainAloneGroup</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  493 
  494 <span class="k">def</span> <span class="nf">SetupChainSelectionsView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  495     <span class="sd">&quot;&quot;&quot;Setup chain selectons view. &quot;&quot;&quot;</span>
  496 
  497     <span class="k">if</span> <span class="ow">not</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ChainSelections&quot;</span><span class="p">]:</span>
  498         <span class="k">return</span>
  499     
  500     <span class="n">ChainName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAlone&quot;</span><span class="p">]</span>
  501     <span class="n">SelectionsGroupIDPrefix</span> <span class="o">=</span> <span class="s2">&quot;ChainAloneSelections&quot;</span>
  502     
  503     <span class="k">for</span> <span class="n">Index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ChainSelectionsInfo&quot;</span><span class="p">][</span><span class="s2">&quot;Names&quot;</span><span class="p">])):</span>
  504         <span class="n">SelectionName</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ChainSelectionsInfo&quot;</span><span class="p">][</span><span class="s2">&quot;Names&quot;</span><span class="p">][</span><span class="n">Index</span><span class="p">]</span>
  505         <span class="n">SpecifiedSelection</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ChainSelectionsInfo&quot;</span><span class="p">][</span><span class="s2">&quot;Selections&quot;</span><span class="p">][</span><span class="n">Index</span><span class="p">]</span>
  506         
  507         <span class="n">SelectionNameGroupID</span> <span class="o">=</span> <span class="n">SelectionName</span>
  508         
  509         <span class="c1"># Setup selection object...</span>
  510         <span class="n">SelectionObjectID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Selection&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
  511         <span class="n">SelectionObjectName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SelectionObjectID</span><span class="p">]</span>
  512         <span class="n">SelectionCmd</span> <span class="o">=</span> <span class="s2">&quot;(</span><span class="si">%s</span><span class="s2"> and (</span><span class="si">%s</span><span class="s2">))&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainName</span><span class="p">,</span> <span class="n">SpecifiedSelection</span><span class="p">)</span>
  513         <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForSelectionDisplayView</span><span class="p">(</span><span class="n">SelectionObjectName</span><span class="p">,</span> <span class="n">SelectionCmd</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SelectionsChainStyle&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
  514         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  515         
  516         <span class="c1"># Set up composite mesh and group...</span>
  517         <span class="n">CompositeMeshID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">CompositeEDMesh&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
  518         <span class="n">CompositeVolumeID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">CompositeEDVolume&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
  519         <span class="n">CompositeSurfaceID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">CompositeEDSurface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
  520         <span class="n">CompositeMeshGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">CompositeEDGroup&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
  521         <span class="n">CompositeMeshGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">CompositeEDGroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
  522         
  523         <span class="n">CompositeMapName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexCompositeEDMap&quot;</span><span class="p">]</span>
  524         <span class="n">CompositeMeshName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">CompositeMeshID</span><span class="p">]</span>
  525         <span class="n">CompositeVolumeName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">CompositeVolumeID</span><span class="p">]</span>
  526         <span class="n">CompositeSurfaceName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">CompositeSurfaceID</span><span class="p">]</span>
  527         <span class="n">CompositeMeshGroupName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">CompositeMeshGroupID</span><span class="p">]</span>
  528         <span class="n">CompositeMeshGroupMembers</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">CompositeMeshGroupMembersID</span><span class="p">]</span>
  529         
  530         <span class="n">PML</span> <span class="o">=</span> <span class="n">SetupPMLForElectronDensityVolume</span><span class="p">(</span><span class="n">CompositeMapName</span><span class="p">,</span> <span class="n">CompositeVolumeName</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;VolumeColorRampCompositeMap&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">Selection</span> <span class="o">=</span> <span class="n">SelectionObjectName</span><span class="p">)</span>
  531         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  532         
  533         <span class="n">PML</span> <span class="o">=</span> <span class="n">SetupPMLForElectronDensityMesh</span><span class="p">(</span><span class="n">CompositeMapName</span><span class="p">,</span> <span class="n">CompositeMeshName</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshLevelCompositeMap&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshColorCompositeMap&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">Selection</span> <span class="o">=</span> <span class="n">SelectionObjectName</span><span class="p">)</span>
  534         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  535         
  536         <span class="n">PML</span> <span class="o">=</span> <span class="n">SetupPMLForElectronDensitySurface</span><span class="p">(</span><span class="n">CompositeMapName</span><span class="p">,</span> <span class="n">CompositeSurfaceName</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshLevelCompositeMap&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshColorCompositeMap&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">Selection</span> <span class="o">=</span> <span class="n">SelectionObjectName</span><span class="p">)</span>
  537         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  538         
  539         <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">CompositeMeshGroupName</span><span class="p">,</span> <span class="n">CompositeMeshGroupMembers</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  540         
  541         <span class="k">if</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;SetupDiffEDMapObjects&quot;</span><span class="p">]:</span>
  542             <span class="c1"># Set up difference meshes and group...</span>
  543             <span class="n">DiffVolumeID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">DiffEDVolume&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
  544             <span class="n">DiffMesh1ID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">DiffEDMesh1&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
  545             <span class="n">DiffSurface1ID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">DiffEDSurface1&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
  546             <span class="n">DiffMesh2ID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">DiffEDMesh2&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
  547             <span class="n">DiffSurface2ID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">DiffEDSurface1&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
  548             <span class="n">DiffMeshGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">DiffEDGroup&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
  549             <span class="n">DiffMeshGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">DiffEDGroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
  550             
  551             <span class="n">DiffMapName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexDiffEDMap&quot;</span><span class="p">]</span>
  552             <span class="n">DiffVolumeName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">DiffVolumeID</span><span class="p">]</span>
  553             <span class="n">DiffMesh1Name</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">DiffMesh1ID</span><span class="p">]</span>
  554             <span class="n">DiffSurface1Name</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">DiffSurface1ID</span><span class="p">]</span>
  555             <span class="n">DiffMesh2Name</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">DiffMesh2ID</span><span class="p">]</span>
  556             <span class="n">DiffSurface2Name</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">DiffSurface2ID</span><span class="p">]</span>
  557             <span class="n">DiffMeshGroupName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">DiffMeshGroupID</span><span class="p">]</span>
  558             <span class="n">DiffMeshGroupMembers</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">DiffMeshGroupMembersID</span><span class="p">]</span>
  559             
  560             <span class="n">PML</span> <span class="o">=</span> <span class="n">SetupPMLForElectronDensityVolume</span><span class="p">(</span><span class="n">DiffMapName</span><span class="p">,</span> <span class="n">DiffVolumeName</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;VolumeColorRampDiffMap&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">Selection</span> <span class="o">=</span> <span class="n">SelectionObjectName</span><span class="p">)</span>
  561             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  562             
  563             <span class="n">PML</span> <span class="o">=</span> <span class="n">SetupPMLForElectronDensityMesh</span><span class="p">(</span><span class="n">DiffMapName</span><span class="p">,</span> <span class="n">DiffMesh1Name</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Mesh1LevelDiffMap&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Mesh1ColorDiffMap&quot;</span><span class="p">],</span>  <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">Selection</span> <span class="o">=</span> <span class="n">SelectionObjectName</span><span class="p">)</span>
  564             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  565             
  566             <span class="n">PML</span> <span class="o">=</span> <span class="n">SetupPMLForElectronDensitySurface</span><span class="p">(</span><span class="n">DiffMapName</span><span class="p">,</span> <span class="n">DiffSurface1Name</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Mesh1LevelDiffMap&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Mesh1ColorDiffMap&quot;</span><span class="p">],</span>  <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">Selection</span> <span class="o">=</span> <span class="n">SelectionObjectName</span><span class="p">)</span>
  567             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  568             
  569             <span class="n">PML</span> <span class="o">=</span> <span class="n">SetupPMLForElectronDensityMesh</span><span class="p">(</span><span class="n">DiffMapName</span><span class="p">,</span> <span class="n">DiffMesh2Name</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Mesh2LevelDiffMap&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Mesh2ColorDiffMap&quot;</span><span class="p">],</span>  <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">Selection</span> <span class="o">=</span> <span class="n">SelectionObjectName</span><span class="p">)</span>
  570             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  571             
  572             <span class="n">PML</span> <span class="o">=</span> <span class="n">SetupPMLForElectronDensitySurface</span><span class="p">(</span><span class="n">DiffMapName</span><span class="p">,</span> <span class="n">DiffSurface2Name</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Mesh2LevelDiffMap&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Mesh2ColorDiffMap&quot;</span><span class="p">],</span>  <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">Selection</span> <span class="o">=</span> <span class="n">SelectionObjectName</span><span class="p">)</span>
  573             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  574         
  575             <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">DiffMeshGroupName</span><span class="p">,</span> <span class="n">DiffMeshGroupMembers</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  576         
  577         <span class="c1"># Setup groups for named selections...</span>
  578         <span class="n">SelectionsNameGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
  579         <span class="n">SelectionsNameGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">GroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
  580         <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SelectionsNameGroupID</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SelectionsNameGroupMembersID</span><span class="p">],</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;open&quot;</span><span class="p">)</span>
  581 
  582     <span class="c1"># Setup a group for selections...</span>
  583     <span class="n">SelectionsGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">)</span>
  584     <span class="n">SelectionsGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">GroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">)</span>
  585     <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SelectionsGroupID</span><span class="p">],</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SelectionsGroupMembersID</span><span class="p">],</span> <span class="bp">False</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  586 
  587 <span class="k">def</span> <span class="nf">WriteChainLigandView</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">):</span>
  588     <span class="sd">&quot;&quot;&quot;Write out PML for viewing ligand in a chain.&quot;&quot;&quot;</span>
  589     
  590     <span class="k">for</span> <span class="n">GroupID</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Ligand&quot;</span><span class="p">,</span> <span class="s2">&quot;Pocket&quot;</span><span class="p">,</span> <span class="s2">&quot;PocketSolvent&quot;</span><span class="p">,</span> <span class="s2">&quot;PocketInorganic&quot;</span><span class="p">]:</span>
  591         <span class="n">ComplexName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplex&quot;</span><span class="p">]</span>
  592         <span class="n">LigandName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="s2">&quot;Ligand&quot;</span><span class="p">]</span>
  593         
  594         <span class="c1"># Setup main object...</span>
  595         <span class="n">GroupTypeObjectID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  596         <span class="n">GroupTypeObjectName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupTypeObjectID</span><span class="p">]</span>
  597         
  598         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Ligand$&quot;</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  599             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Setting up views for ligand </span><span class="si">%s</span><span class="s2"> in chain </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">LigandID</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">))</span>
  600             <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForLigandView</span><span class="p">(</span><span class="n">GroupTypeObjectName</span><span class="p">,</span> <span class="n">ComplexName</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
  601             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  602         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Pocket$&quot;</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  603             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Setting up views for pocket around ligand </span><span class="si">%s</span><span class="s2"> in chain </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">LigandID</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">))</span>
  604             <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForLigandPocketView</span><span class="p">(</span><span class="n">GroupTypeObjectName</span><span class="p">,</span> <span class="n">ComplexName</span><span class="p">,</span> <span class="n">LigandName</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketDistanceCutoff&quot;</span><span class="p">],</span> <span class="bp">True</span><span class="p">)</span>
  605             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  606             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;label_color&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketLabelColor&quot;</span><span class="p">],</span> <span class="n">GroupTypeObjectName</span><span class="p">))</span>
  607         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^PocketSolvent$&quot;</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  608             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Setting up views for solvent in pockect around ligand </span><span class="si">%s</span><span class="s2"> in chain </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">LigandID</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">))</span>
  609             <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForLigandPocketSolventView</span><span class="p">(</span><span class="n">GroupTypeObjectName</span><span class="p">,</span> <span class="n">ComplexName</span><span class="p">,</span> <span class="n">LigandName</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketDistanceCutoff&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
  610             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  611         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^PocketInorganic$&quot;</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  612             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Setting up views for inorganic in pockect around ligand </span><span class="si">%s</span><span class="s2"> in chain </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">LigandID</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">))</span>
  613             <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForLigandPocketInorganicView</span><span class="p">(</span><span class="n">GroupTypeObjectName</span><span class="p">,</span> <span class="n">ComplexName</span><span class="p">,</span> <span class="n">LigandName</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketDistanceCutoff&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
  614             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  615         
  616         <span class="c1"># Set up composite mesh and group...</span>
  617         <span class="n">CompositeMeshGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">CompositeEDMeshGroup&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  618         <span class="n">CompositeMeshGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">CompositeEDMeshGroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  619         <span class="n">CompositeMeshID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">CompositeEDMesh&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  620         <span class="n">CompositeVolumeID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">CompositeEDVolume&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  621         <span class="n">CompositeSurfaceID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">CompositeEDSurface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  622 
  623         <span class="n">CompositeMapName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexCompositeEDMap&quot;</span><span class="p">]</span>
  624         <span class="n">CompositeMeshName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">CompositeMeshID</span><span class="p">]</span>
  625         <span class="n">CompositeVolumeName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">CompositeVolumeID</span><span class="p">]</span>
  626         <span class="n">CompositeSurfaceName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">CompositeSurfaceID</span><span class="p">]</span>
  627         <span class="n">CompositeMeshGroupName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">CompositeMeshGroupID</span><span class="p">]</span>
  628         <span class="n">CompositeMeshGroupMembers</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">CompositeMeshGroupMembersID</span><span class="p">]</span>
  629         
  630         <span class="n">PML</span> <span class="o">=</span> <span class="n">SetupPMLForElectronDensityVolume</span><span class="p">(</span><span class="n">CompositeMapName</span><span class="p">,</span> <span class="n">CompositeVolumeName</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;VolumeColorRampCompositeMap&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">Selection</span> <span class="o">=</span> <span class="n">GroupTypeObjectName</span><span class="p">)</span>
  631         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  632         
  633         <span class="n">PML</span> <span class="o">=</span> <span class="n">SetupPMLForElectronDensityMesh</span><span class="p">(</span><span class="n">CompositeMapName</span><span class="p">,</span> <span class="n">CompositeMeshName</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshLevelCompositeMap&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshColorCompositeMap&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">Selection</span> <span class="o">=</span> <span class="n">GroupTypeObjectName</span><span class="p">)</span>
  634         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  635         
  636         <span class="n">PML</span> <span class="o">=</span> <span class="n">SetupPMLForElectronDensitySurface</span><span class="p">(</span><span class="n">CompositeMapName</span><span class="p">,</span> <span class="n">CompositeSurfaceName</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshLevelCompositeMap&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshColorCompositeMap&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">Selection</span> <span class="o">=</span> <span class="n">GroupTypeObjectName</span><span class="p">)</span>
  637         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  638         
  639         <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">CompositeMeshGroupName</span><span class="p">,</span> <span class="n">CompositeMeshGroupMembers</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  640         
  641         <span class="k">if</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;SetupDiffEDMapObjects&quot;</span><span class="p">]:</span>
  642             <span class="c1"># Set up difference meshes and group...</span>
  643             <span class="n">DiffMeshGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">DiffEDMeshGroup&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  644             <span class="n">DiffMeshGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">DiffEDMeshGroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  645             <span class="n">DiffVolumeID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">DiffEDVolume&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  646             <span class="n">DiffMesh1ID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">DiffEDMesh1&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  647             <span class="n">DiffSurface1ID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">DiffEDSurface1&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  648             <span class="n">DiffMesh2ID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">DiffEDMesh2&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  649             <span class="n">DiffSurface2ID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">DiffEDSurface2&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  650         
  651             <span class="n">DiffMapName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexDiffEDMap&quot;</span><span class="p">]</span>
  652             <span class="n">DiffVolumeName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">DiffVolumeID</span><span class="p">]</span>
  653             <span class="n">DiffMesh1Name</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">DiffMesh1ID</span><span class="p">]</span>
  654             <span class="n">DiffSurface1Name</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">DiffSurface1ID</span><span class="p">]</span>
  655             <span class="n">DiffMesh2Name</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">DiffMesh2ID</span><span class="p">]</span>
  656             <span class="n">DiffSurface2Name</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">DiffSurface2ID</span><span class="p">]</span>
  657             <span class="n">DiffMeshGroupName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">DiffMeshGroupID</span><span class="p">]</span>
  658             <span class="n">DiffMeshGroupMembers</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">DiffMeshGroupMembersID</span><span class="p">]</span>
  659             
  660             <span class="n">PML</span> <span class="o">=</span> <span class="n">SetupPMLForElectronDensityVolume</span><span class="p">(</span><span class="n">DiffMapName</span><span class="p">,</span> <span class="n">DiffVolumeName</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;VolumeColorRampDiffMap&quot;</span><span class="p">],</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">Selection</span> <span class="o">=</span> <span class="n">GroupTypeObjectName</span><span class="p">)</span>
  661             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  662             
  663             <span class="n">PML</span> <span class="o">=</span> <span class="n">SetupPMLForElectronDensityMesh</span><span class="p">(</span><span class="n">DiffMapName</span><span class="p">,</span> <span class="n">DiffMesh1Name</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Mesh1LevelDiffMap&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Mesh1ColorDiffMap&quot;</span><span class="p">],</span>  <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">Selection</span> <span class="o">=</span> <span class="n">GroupTypeObjectName</span><span class="p">)</span>
  664             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  665             
  666             <span class="n">PML</span> <span class="o">=</span> <span class="n">SetupPMLForElectronDensitySurface</span><span class="p">(</span><span class="n">DiffMapName</span><span class="p">,</span> <span class="n">DiffSurface1Name</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Mesh1LevelDiffMap&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Mesh1ColorDiffMap&quot;</span><span class="p">],</span>  <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">Selection</span> <span class="o">=</span> <span class="n">GroupTypeObjectName</span><span class="p">)</span>
  667             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  668             
  669             <span class="n">PML</span> <span class="o">=</span> <span class="n">SetupPMLForElectronDensityMesh</span><span class="p">(</span><span class="n">DiffMapName</span><span class="p">,</span> <span class="n">DiffMesh2Name</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Mesh2LevelDiffMap&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Mesh2ColorDiffMap&quot;</span><span class="p">],</span>  <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">Selection</span> <span class="o">=</span> <span class="n">GroupTypeObjectName</span><span class="p">)</span>
  670             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  671             
  672             <span class="n">PML</span> <span class="o">=</span> <span class="n">SetupPMLForElectronDensitySurface</span><span class="p">(</span><span class="n">DiffMapName</span><span class="p">,</span> <span class="n">DiffSurface2Name</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Mesh2LevelDiffMap&quot;</span><span class="p">],</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Mesh2ColorDiffMap&quot;</span><span class="p">],</span>  <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">Selection</span> <span class="o">=</span> <span class="n">GroupTypeObjectName</span><span class="p">)</span>
  673             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  674         
  675             <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">DiffMeshGroupName</span><span class="p">,</span> <span class="n">DiffMeshGroupMembers</span><span class="p">,</span> <span class="bp">True</span><span class="p">,</span> <span class="s2">&quot;close&quot;</span><span class="p">)</span>
  676         
  677         <span class="c1"># Set up polar contacts...</span>
  678         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(Pocket|PocketSolvent|PocketInorganic)$&quot;</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  679             <span class="n">PolarContactsID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">PolarContacts&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  680             <span class="n">PolarContactsName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">PolarContactsID</span><span class="p">]</span>
  681             
  682             <span class="n">PolarContactsColor</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketContactsLigandColor&quot;</span><span class="p">]</span>
  683             <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^PocketSolvent$&quot;</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  684                 <span class="n">PolarContactsColor</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketContactsSolventColor&quot;</span><span class="p">]</span>
  685             <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^PocketInorganic$&quot;</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  686                 <span class="n">PolarContactsColor</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketContactsInorganicColor&quot;</span><span class="p">]</span>
  687             
  688             <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForPolarContactsView</span><span class="p">(</span><span class="n">PolarContactsName</span><span class="p">,</span> <span class="n">LigandName</span><span class="p">,</span> <span class="n">GroupTypeObjectName</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">Color</span> <span class="o">=</span> <span class="n">PolarContactsColor</span><span class="p">,</span> <span class="n">Cutoff</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketContactsCutoff&quot;</span><span class="p">])</span>
  689             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  690             
  691             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;label_color&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">PolarContactsColor</span><span class="p">,</span> <span class="n">PolarContactsName</span><span class="p">))</span>
  692             
  693         <span class="c1"># Set up hydrophobic contacts...</span>
  694         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Pocket$&quot;</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  695             <span class="n">HydrophobicContactsID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">HydrophobicContacts&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  696             <span class="n">HydrophobicContactsName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">HydrophobicContactsID</span><span class="p">]</span>
  697             <span class="n">HydrophobicContactsColor</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketContactsLigandHydrophobicColor&quot;</span><span class="p">]</span>
  698             
  699             <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForHydrophobicContactsView</span><span class="p">(</span><span class="n">HydrophobicContactsName</span><span class="p">,</span> <span class="n">LigandName</span><span class="p">,</span> <span class="n">GroupTypeObjectName</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">Color</span> <span class="o">=</span> <span class="n">HydrophobicContactsColor</span><span class="p">,</span> <span class="n">Cutoff</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketContactsCutoff&quot;</span><span class="p">])</span>
  700             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  701             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;label_color&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">HydrophobicContactsColor</span><span class="p">,</span> <span class="n">HydrophobicContactsName</span><span class="p">))</span>
  702         
  703         <span class="c1"># Set up hydrophobic surface...</span>
  704         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Pocket$&quot;</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="ow">and</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketSurface&quot;</span><span class="p">]:</span>
  705             <span class="n">HydrophobicSurfaceID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">HydrophobicSurface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  706             <span class="n">HydrophobicSurfaceName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">HydrophobicSurfaceID</span><span class="p">]</span>
  707             <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForHydrophobicSurfaceView</span><span class="p">(</span><span class="n">HydrophobicSurfaceName</span><span class="p">,</span> <span class="n">GroupTypeObjectName</span><span class="p">,</span> <span class="n">ColorPalette</span> <span class="o">=</span> <span class="s2">&quot;RedToWhite&quot;</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">)</span>
  708             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  709             
  710             <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.set(&quot;label_color&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketLabelColor&quot;</span><span class="p">],</span> <span class="n">HydrophobicSurfaceName</span><span class="p">))</span>
  711         
  712         <span class="c1"># Setup group....</span>
  713         <span class="n">GroupNameID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  714         <span class="n">GroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">GroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  715         <span class="n">GroupName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupNameID</span><span class="p">]</span>
  716         <span class="n">GroupMembers</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupMembersID</span><span class="p">]</span>
  717 
  718         <span class="n">Action</span> <span class="o">=</span> <span class="s2">&quot;close&quot;</span>
  719         <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span>
  720         <span class="k">if</span>  <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^(Ligand|Pocket)$&quot;</span><span class="p">,</span> <span class="n">GroupID</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
  721             <span class="n">Action</span> <span class="o">=</span> <span class="s2">&quot;open&quot;</span>
  722             <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span>
  723         <span class="n">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">GroupName</span><span class="p">,</span> <span class="n">GroupMembers</span><span class="p">,</span> <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span><span class="p">)</span>
  724 
  725 <span class="k">def</span> <span class="nf">GenerateAndWritePMLForGroup</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">GroupName</span><span class="p">,</span> <span class="n">GroupMembers</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">Action</span> <span class="o">=</span> <span class="s2">&quot;close&quot;</span><span class="p">):</span>
  726     <span class="sd">&quot;&quot;&quot;Generate and write PML for group. &quot;&quot;&quot;</span>
  727     
  728     <span class="n">PML</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForGroup</span><span class="p">(</span><span class="n">GroupName</span><span class="p">,</span> <span class="n">GroupMembers</span><span class="p">,</span> <span class="n">Enable</span><span class="p">,</span> <span class="n">Action</span><span class="p">)</span>
  729     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Setting up group </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="n">GroupName</span><span class="p">)</span>
  730     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  731 
  732 <span class="k">def</span> <span class="nf">SetupPMLForElectronDensityMap</span><span class="p">(</span><span class="n">MapFileName</span><span class="p">,</span> <span class="n">MapName</span><span class="p">,</span> <span class="n">AlignMapToObjectName</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">):</span>
  733     <span class="sd">&quot;&quot;&quot;Setup PML for loading and viewing electron density map. &quot;&quot;&quot;</span>
  734 
  735     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
  736     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.load(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MapFileName</span><span class="p">,</span> <span class="n">MapName</span><span class="p">))</span>
  737     <span class="k">if</span> <span class="n">AlignMapToObjectName</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
  738         <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.matrix_copy(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">AlignMapToObjectName</span><span class="p">,</span> <span class="n">MapName</span><span class="p">))</span>
  739         
  740     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">MapName</span><span class="p">,</span> <span class="n">Enable</span><span class="p">))</span>
  741     
  742     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
  743     
  744     <span class="k">return</span> <span class="n">PML</span>
  745     
  746 <span class="k">def</span> <span class="nf">SetupPMLForElectronDensityMesh</span><span class="p">(</span><span class="n">MapName</span><span class="p">,</span> <span class="n">MeshName</span><span class="p">,</span> <span class="n">SigmaLevel</span><span class="p">,</span> <span class="n">Color</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">Selection</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
  747     <span class="sd">&quot;&quot;&quot;Setup PML for electron density mesh. &quot;&quot;&quot;</span>
  748 
  749     <span class="n">Carve</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshCarveRadius&quot;</span><span class="p">]</span>
  750     
  751     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
  752     <span class="k">if</span> <span class="n">Selection</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
  753         <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.isomesh(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, </span><span class="si">%.1f</span><span class="s2">)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MeshName</span><span class="p">,</span> <span class="n">MapName</span><span class="p">,</span> <span class="n">SigmaLevel</span><span class="p">))</span>
  754     <span class="k">else</span><span class="p">:</span>
  755         <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.isomesh(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, </span><span class="si">%.1f</span><span class="s2">, &quot;(</span><span class="si">%s</span><span class="s2">)&quot;, carve = </span><span class="si">%.1f</span><span class="s2">)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">MeshName</span><span class="p">,</span> <span class="n">MapName</span><span class="p">,</span> <span class="n">SigmaLevel</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="n">Carve</span><span class="p">))</span>
  756     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;util.color_deep(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Color</span><span class="p">,</span> <span class="n">MeshName</span><span class="p">))</span>
  757     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">MeshName</span><span class="p">,</span> <span class="n">Enable</span><span class="p">))</span>
  758     
  759     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
  760     
  761     <span class="k">return</span> <span class="n">PML</span>
  762 
  763 <span class="k">def</span> <span class="nf">SetupPMLForElectronDensityVolume</span><span class="p">(</span><span class="n">MapName</span><span class="p">,</span> <span class="n">VolumeName</span><span class="p">,</span> <span class="n">VolumeColorRamp</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">Selection</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
  764     <span class="sd">&quot;&quot;&quot;Setup PML for electron density volume. &quot;&quot;&quot;</span>
  765 
  766     <span class="n">Carve</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;VolumeCarveRadius&quot;</span><span class="p">]</span>
  767     
  768     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
  769     <span class="k">if</span> <span class="n">Selection</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
  770         <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.volume(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">VolumeName</span><span class="p">,</span> <span class="n">MapName</span><span class="p">,</span> <span class="n">VolumeColorRamp</span><span class="p">))</span>
  771     <span class="k">else</span><span class="p">:</span>
  772         <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.volume(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;(</span><span class="si">%s</span><span class="s2">)&quot;, carve = </span><span class="si">%.1f</span><span class="s2">)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">VolumeName</span><span class="p">,</span> <span class="n">MapName</span><span class="p">,</span> <span class="n">VolumeColorRamp</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="n">Carve</span><span class="p">))</span>
  773     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">VolumeName</span><span class="p">,</span> <span class="n">Enable</span><span class="p">))</span>
  774     
  775     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
  776     
  777     <span class="k">return</span> <span class="n">PML</span>
  778 
  779 <span class="k">def</span> <span class="nf">SetupPMLForElectronDensitySurface</span><span class="p">(</span><span class="n">MapName</span><span class="p">,</span> <span class="n">SurfaceName</span><span class="p">,</span> <span class="n">SigmaLevel</span><span class="p">,</span> <span class="n">Color</span><span class="p">,</span> <span class="n">Enable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">Selection</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
  780     <span class="sd">&quot;&quot;&quot;Setup PML for electron density surface. &quot;&quot;&quot;</span>
  781 
  782     <span class="n">Carve</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshCarveRadius&quot;</span><span class="p">]</span>
  783     
  784     <span class="n">PMLCmds</span> <span class="o">=</span> <span class="p">[]</span>
  785     <span class="k">if</span> <span class="n">Selection</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
  786         <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.isosurface(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, </span><span class="si">%.1f</span><span class="s2">)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfaceName</span><span class="p">,</span> <span class="n">MapName</span><span class="p">,</span> <span class="n">SigmaLevel</span><span class="p">))</span>
  787     <span class="k">else</span><span class="p">:</span>
  788         <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;cmd.isosurface(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;, </span><span class="si">%.1f</span><span class="s2">, &quot;(</span><span class="si">%s</span><span class="s2">)&quot;, carve = </span><span class="si">%.1f</span><span class="s2">)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SurfaceName</span><span class="p">,</span> <span class="n">MapName</span><span class="p">,</span> <span class="n">SigmaLevel</span><span class="p">,</span> <span class="n">Selection</span><span class="p">,</span> <span class="n">Carve</span><span class="p">))</span>
  789     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;util.color_deep(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Color</span><span class="p">,</span> <span class="n">SurfaceName</span><span class="p">))</span>
  790     <span class="n">PMLCmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">SetupPMLForEnableDisable</span><span class="p">(</span><span class="n">SurfaceName</span><span class="p">,</span> <span class="n">Enable</span><span class="p">))</span>
  791     
  792     <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PMLCmds</span><span class="p">)</span>
  793     
  794     <span class="k">return</span> <span class="n">PML</span>
  795 
  796 <span class="k">def</span> <span class="nf">GeneratePyMOLSessionFile</span><span class="p">():</span>
  797     <span class="sd">&quot;&quot;&quot;Generate PME file from PML file. &quot;&quot;&quot;</span>
  798 
  799     <span class="n">PSEOutfile</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PSEOutfile&quot;</span><span class="p">]</span>
  800     <span class="n">PMLOutfile</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMLOutfile&quot;</span><span class="p">]</span>
  801     
  802     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Generating file </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">PSEOutfile</span><span class="p">)</span>
  803     
  804     <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">ConvertPMLFileToPSEFile</span><span class="p">(</span><span class="n">PMLOutfile</span><span class="p">,</span> <span class="n">PSEOutfile</span><span class="p">)</span>
  805     
  806     <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">PSEOutfile</span><span class="p">):</span>
  807         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;Failed to generate PSE file, </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">PSEOutfile</span><span class="p">))</span>
  808     
  809     <span class="k">if</span> <span class="ow">not</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMLOut&quot;</span><span class="p">]:</span>
  810         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Deleting file </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">PMLOutfile</span><span class="p">)</span>
  811         <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">PMLOutfile</span><span class="p">)</span>
  812 
  813 <span class="k">def</span> <span class="nf">DeleteEmptyPyMOLObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">):</span>
  814     <span class="sd">&quot;&quot;&quot;Delete empty PyMOL objects. &quot;&quot;&quot;</span>
  815     
  816     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AllowEmptyObjects&quot;</span><span class="p">]:</span>
  817         <span class="k">return</span>
  818     
  819     <span class="n">SpecifiedChainsAndLigandsInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
  820     <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]:</span>
  821         <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;Checking and deleting empty objects for chain </span><span class="si">%s</span><span class="s2">...&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;</span><span class="se">\n</span><span class="s2">&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainID</span><span class="p">))</span>
  822         
  823         <span class="c1"># Delete any chain level objects...</span>
  824         <span class="n">WritePMLToCheckAndDeleteEmptyObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;Solvent&quot;</span><span class="p">])</span>
  825         <span class="n">WritePMLToCheckAndDeleteEmptyObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;Inorganic&quot;</span><span class="p">])</span>
  826         
  827         <span class="k">for</span> <span class="n">LigandID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]:</span>
  828             <span class="c1"># Delete ligand level objects...</span>
  829             <span class="k">for</span> <span class="n">GroupID</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Pocket&quot;</span><span class="p">,</span> <span class="s2">&quot;PocketSolvent&quot;</span><span class="p">,</span> <span class="s2">&quot;PocketInorganic&quot;</span><span class="p">]:</span>
  830                 <span class="n">GroupNameID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  831                 <span class="n">GroupName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupNameID</span><span class="p">]</span>
  832 
  833                 <span class="n">GroupTypeObjectID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
  834                 <span class="n">GroupTypeObjectName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupTypeObjectID</span><span class="p">]</span>
  835                 
  836                 <span class="n">WritePMLToCheckAndDeleteEmptyObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">GroupTypeObjectName</span><span class="p">,</span> <span class="n">GroupName</span><span class="p">)</span>
  837 
  838 <span class="k">def</span> <span class="nf">WritePMLToCheckAndDeleteEmptyObjects</span><span class="p">(</span><span class="n">OutFH</span><span class="p">,</span> <span class="n">ObjectName</span><span class="p">,</span> <span class="n">ParentObjectName</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
  839     <span class="sd">&quot;&quot;&quot;Write PML to check and delete empty PyMOL objects. &quot;&quot;&quot;</span>
  840     
  841     <span class="k">if</span> <span class="n">ParentObjectName</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
  842         <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;CheckAndDeleteEmptyObjects(&quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ObjectName</span><span class="p">)</span>
  843     <span class="k">else</span><span class="p">:</span>
  844         <span class="n">PML</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;CheckAndDeleteEmptyObjects(&quot;</span><span class="si">%s</span><span class="s2">&quot;, &quot;</span><span class="si">%s</span><span class="s2">&quot;)&quot;&quot;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ObjectName</span><span class="p">,</span> <span class="n">ParentObjectName</span><span class="p">)</span>
  845     
  846     <span class="n">OutFH</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PML</span><span class="p">)</span>
  847 
  848 <span class="k">def</span> <span class="nf">SetupPyMOLObjectNames</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">):</span>
  849     <span class="sd">&quot;&quot;&quot;Setup hierarchy of PyMOL groups and objects for ligand centric views of</span>
  850 <span class="sd">    electron density for chains and ligands present in input file.</span>
  851 <span class="sd">    &quot;&quot;&quot;</span>
  852 
  853     <span class="n">PyMOLObjectNames</span> <span class="o">=</span> <span class="p">{}</span>
  854     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  855     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  856 
  857     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;SetupDiffEDMapObjects&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span> <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;DiffEDMapFiles&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span> <span class="ow">is</span> <span class="bp">None</span> <span class="k">else</span> <span class="bp">True</span>
  858 
  859     <span class="c1"># Setup groups and objects for complex...</span>
  860     <span class="n">SetupPyMOLObjectNamesForComplex</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">)</span>
  861     
  862     <span class="c1"># Setup groups and objects for chain...</span>
  863     <span class="n">SpecifiedChainsAndLigandsInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
  864     <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]:</span>
  865         <span class="n">SetupPyMOLObjectNamesForChain</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
  866         
  867         <span class="c1"># Setup groups and objects for ligand...</span>
  868         <span class="k">for</span> <span class="n">LigandID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]:</span>
  869             <span class="n">SetupPyMOLObjectNamesForLigand</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">)</span>
  870 
  871     <span class="k">return</span> <span class="n">PyMOLObjectNames</span>
  872 
  873 <span class="k">def</span> <span class="nf">SetupPyMOLObjectNamesForComplex</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">):</span>
  874     <span class="sd">&quot;&quot;&quot;Stetup groups and objects for complex. &quot;&quot;&quot;</span>
  875     
  876     <span class="n">PDBFileRoot</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InfilesRoots&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
  877     
  878     <span class="n">PDBGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">PDBFileRoot</span>
  879     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;PDBGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">PDBGroupName</span>
  880     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;PDBGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  881 
  882     <span class="n">ComplexGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Complex&quot;</span> <span class="o">%</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;PDBGroup&quot;</span><span class="p">]</span>
  883     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ComplexGroupName</span>
  884     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;PDBGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ComplexGroupName</span><span class="p">)</span>
  885     
  886     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Complex&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Complex&quot;</span> <span class="o">%</span> <span class="n">ComplexGroupName</span>
  887 
  888     <span class="n">CompositeMeshGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.2Fo-Fc&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ComplexGroupName</span><span class="p">)</span>
  889     <span class="n">CompositeMapName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Map&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">CompositeMeshGroupName</span><span class="p">)</span>
  890     <span class="n">CompositeMeshName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Mesh&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">CompositeMeshGroupName</span><span class="p">)</span>
  891     <span class="n">CompositeVolumeName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Volume&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">CompositeMeshGroupName</span><span class="p">)</span>
  892     <span class="n">CompositeSurfaceName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Surface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">CompositeMeshGroupName</span><span class="p">)</span>
  893     
  894     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexCompositeEDGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">CompositeMeshGroupName</span>
  895     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexCompositeEDMap&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">CompositeMapName</span>
  896     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexCompositeEDMesh&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">CompositeMeshName</span>
  897     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexCompositeEDVolume&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">CompositeVolumeName</span>
  898     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexCompositeEDSurface&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">CompositeSurfaceName</span>
  899 
  900     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexCompositeEDGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  901     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexCompositeEDGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CompositeMapName</span><span class="p">)</span>
  902     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;VolumeComplex&quot;</span><span class="p">]:</span>
  903         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexCompositeEDGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CompositeVolumeName</span><span class="p">)</span>
  904     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshComplex&quot;</span><span class="p">]:</span>
  905         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexCompositeEDGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CompositeMeshName</span><span class="p">)</span>
  906     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceComplex&quot;</span><span class="p">]:</span>
  907         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexCompositeEDGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CompositeSurfaceName</span><span class="p">)</span>
  908     <span class="k">if</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;SetupDiffEDMapObjects&quot;</span><span class="p">]:</span>
  909         <span class="n">DiffMeshGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Fo-Fc&quot;</span> <span class="o">%</span> <span class="n">ComplexGroupName</span>
  910         <span class="n">DiffMapName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Map&quot;</span> <span class="o">%</span> <span class="n">DiffMeshGroupName</span>
  911         <span class="n">DiffVolumeName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Volume&quot;</span> <span class="o">%</span> <span class="n">DiffMeshGroupName</span>
  912         <span class="n">DiffMesh1Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Mesh1&quot;</span> <span class="o">%</span> <span class="n">DiffMeshGroupName</span>
  913         <span class="n">DiffSurface1Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Surface1&quot;</span> <span class="o">%</span> <span class="n">DiffMeshGroupName</span>
  914         <span class="n">DiffMesh2Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Mesh2&quot;</span> <span class="o">%</span> <span class="n">DiffMeshGroupName</span>
  915         <span class="n">DiffSurface2Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Surface2&quot;</span> <span class="o">%</span> <span class="n">DiffMeshGroupName</span>
  916         
  917         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexDiffEDGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DiffMeshGroupName</span>
  918         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexDiffEDMap&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DiffMapName</span>
  919         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexDiffEDVolume&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DiffVolumeName</span>
  920         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexDiffEDMesh1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DiffMesh1Name</span>
  921         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexDiffEDSurface1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DiffSurface1Name</span>
  922         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexDiffEDMesh2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DiffMesh2Name</span>
  923         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexDiffEDSurface2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DiffSurface2Name</span>
  924         
  925         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexDiffEDGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  926         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexDiffEDGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DiffMapName</span><span class="p">)</span>
  927         <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;VolumeComplex&quot;</span><span class="p">]:</span>
  928             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexDiffEDGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DiffVolumeName</span><span class="p">)</span>
  929         <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshComplex&quot;</span><span class="p">]:</span>
  930             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexDiffEDGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DiffMesh1Name</span><span class="p">)</span>
  931         <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceComplex&quot;</span><span class="p">]:</span>
  932             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexDiffEDGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DiffSurface1Name</span><span class="p">)</span>
  933         <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshComplex&quot;</span><span class="p">]:</span>
  934             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexDiffEDGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DiffMesh2Name</span><span class="p">)</span>
  935         <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceComplex&quot;</span><span class="p">]:</span>
  936             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexDiffEDGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DiffSurface2Name</span><span class="p">)</span>
  937     
  938     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  939     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Complex&quot;</span><span class="p">])</span>
  940     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexCompositeEDGroup&quot;</span><span class="p">])</span>
  941     <span class="k">if</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;SetupDiffEDMapObjects&quot;</span><span class="p">]:</span>
  942         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;ComplexDiffEDGroup&quot;</span><span class="p">])</span>
  943     
  944 <span class="k">def</span> <span class="nf">SetupPyMOLObjectNamesForChain</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">):</span>
  945     <span class="sd">&quot;&quot;&quot;Setup groups and objects for chain.&quot;&quot;&quot;</span>
  946     
  947     <span class="n">PDBGroupName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;PDBGroup&quot;</span><span class="p">]</span>
  948     
  949     <span class="n">SpecifiedChainsAndLigandsInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
  950     <span class="n">MeshChainComplex</span> <span class="o">=</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;MeshChainComplex&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
  951     <span class="n">VolumeChainComplex</span> <span class="o">=</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;VolumeChainComplex&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
  952     <span class="n">SurfaceChainComplex</span> <span class="o">=</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChainComplex&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span>
  953     
  954     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  955     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
  956     
  957     <span class="c1"># Set up chain group and chain objects...</span>
  958     <span class="n">ChainGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Chain</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">PDBGroupName</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">)</span>
  959     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ChainGroupName</span>
  960     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;PDBGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ChainGroupName</span><span class="p">)</span>
  961     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  962     
  963     <span class="c1"># Setup chain complex group and objects...</span>
  964     <span class="n">ChainComplexGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Complex&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainGroupName</span><span class="p">)</span>
  965     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ChainComplexGroupName</span>
  966     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ChainComplexGroupName</span><span class="p">)</span>
  967     
  968     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplex&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Complex&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainComplexGroupName</span><span class="p">)</span>
  969     
  970     <span class="n">CompositeMeshGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.2Fo-Fc&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainComplexGroupName</span><span class="p">)</span>
  971     <span class="n">CompositeMeshName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Mesh&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">CompositeMeshGroupName</span><span class="p">)</span>
  972     <span class="n">CompositeVolumeName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Volume&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">CompositeMeshGroupName</span><span class="p">)</span>
  973     <span class="n">CompositeSurfaceName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Surface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">CompositeMeshGroupName</span><span class="p">)</span>
  974     
  975     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexCompositeEDGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">CompositeMeshGroupName</span>
  976     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexCompositeEDMesh&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">CompositeMeshName</span>
  977     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexCompositeEDVolume&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">CompositeVolumeName</span>
  978     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexCompositeEDSurface&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">CompositeSurfaceName</span>
  979     
  980     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexCompositeEDGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  981     <span class="k">if</span> <span class="n">VolumeChainComplex</span><span class="p">:</span>
  982         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexCompositeEDGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CompositeVolumeName</span><span class="p">)</span>
  983     <span class="k">if</span> <span class="n">MeshChainComplex</span><span class="p">:</span>
  984         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexCompositeEDGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CompositeMeshName</span><span class="p">)</span>
  985     <span class="k">if</span> <span class="n">SurfaceChainComplex</span><span class="p">:</span>
  986         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexCompositeEDGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CompositeSurfaceName</span><span class="p">)</span>
  987     
  988     <span class="k">if</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;SetupDiffEDMapObjects&quot;</span><span class="p">]:</span>
  989         <span class="n">DiffMeshGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Fo-Fc&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainComplexGroupName</span><span class="p">)</span>
  990         <span class="n">DiffVolumeName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Volume&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">DiffMeshGroupName</span><span class="p">)</span>
  991         <span class="n">DiffMesh1Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Mesh1&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">DiffMeshGroupName</span><span class="p">)</span>
  992         <span class="n">DiffSurface1Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Surface1&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">DiffMeshGroupName</span><span class="p">)</span>
  993         <span class="n">DiffMesh2Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Mesh2&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">DiffMeshGroupName</span><span class="p">)</span>
  994         <span class="n">DiffSurface2Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Surface2&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">DiffMeshGroupName</span><span class="p">)</span>
  995         
  996         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexDiffEDGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DiffMeshGroupName</span>
  997         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexDiffEDVolume&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DiffVolumeName</span>
  998         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexDiffEDMesh1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DiffMesh1Name</span>
  999         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexDiffEDSurface1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DiffSurface1Name</span>
 1000         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexDiffEDMesh2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DiffMesh2Name</span>
 1001         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexDiffEDSurface2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DiffSurface2Name</span>
 1002         
 1003         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexDiffEDGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1004         <span class="k">if</span> <span class="n">VolumeChainComplex</span><span class="p">:</span>
 1005             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexDiffEDGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DiffVolumeName</span><span class="p">)</span>
 1006         <span class="k">if</span> <span class="n">MeshChainComplex</span><span class="p">:</span>
 1007             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexDiffEDGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DiffMesh1Name</span><span class="p">)</span>
 1008         <span class="k">if</span> <span class="n">SurfaceChainComplex</span><span class="p">:</span>
 1009             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexDiffEDGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DiffSurface1Name</span><span class="p">)</span>
 1010         <span class="k">if</span> <span class="n">MeshChainComplex</span><span class="p">:</span>
 1011             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexDiffEDGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DiffMesh2Name</span><span class="p">)</span>
 1012         <span class="k">if</span> <span class="n">SurfaceChainComplex</span><span class="p">:</span>
 1013             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexDiffEDGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DiffSurface2Name</span><span class="p">)</span>
 1014         
 1015     <span class="n">NameIDs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ChainComplex&quot;</span><span class="p">]</span>
 1016     <span class="k">if</span> <span class="n">MeshChainComplex</span> <span class="ow">or</span> <span class="n">VolumeChainComplex</span> <span class="ow">or</span> <span class="n">SurfaceChainComplex</span> <span class="p">:</span>
 1017         <span class="n">NameIDs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;ChainComplexCompositeEDGroup&quot;</span><span class="p">)</span>
 1018         <span class="k">if</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;SetupDiffEDMapObjects&quot;</span><span class="p">]:</span>
 1019             <span class="n">NameIDs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;ChainComplexDiffEDGroup&quot;</span><span class="p">)</span>
 1020         
 1021     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1022     <span class="k">for</span> <span class="n">NameID</span> <span class="ow">in</span> <span class="n">NameIDs</span><span class="p">:</span>
 1023         <span class="n">Name</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">NameID</span><span class="p">]</span>
 1024         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainComplexGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
 1025 
 1026     <span class="c1"># Setup up a group for individual chains...</span>
 1027     <span class="n">ChainAloneGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Chain&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainGroupName</span><span class="p">)</span>
 1028     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ChainAloneGroupName</span>
 1029     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ChainAloneGroupName</span><span class="p">)</span>
 1030         
 1031     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1032         
 1033     <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Chain&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainAloneGroupName</span><span class="p">)</span>
 1034     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAlone&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
 1035     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
 1036         
 1037     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;BFactorChainCartoonPutty&quot;</span><span class="p">]:</span>
 1038         <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.BFactor&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainAloneGroupName</span><span class="p">)</span>
 1039         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneBFactorPutty&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
 1040         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
 1041 
 1042     <span class="k">if</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ChainSelections&quot;</span><span class="p">]:</span>
 1043         <span class="c1"># Setup selections group and its subgroups..</span>
 1044         <span class="n">SelectionsGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Selections&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainAloneGroupName</span><span class="p">)</span>
 1045         
 1046         <span class="n">SelectionsGroupIDPrefix</span> <span class="o">=</span> <span class="s2">&quot;ChainAloneSelections&quot;</span>
 1047         <span class="n">SelectionsGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="n">SelectionsGroupIDPrefix</span>
 1048         
 1049         <span class="c1"># Add selections group to chain alone group...</span>
 1050         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SelectionsGroupID</span><span class="p">]</span> <span class="o">=</span> <span class="n">SelectionsGroupName</span>
 1051         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainAloneGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SelectionsGroupName</span><span class="p">)</span>
 1052         
 1053         <span class="c1"># Initialize selections group members...</span>
 1054         <span class="n">SelectionsGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">GroupMembers&quot;</span> <span class="o">%</span> <span class="n">SelectionsGroupIDPrefix</span>
 1055         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SelectionsGroupMembersID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1056         
 1057         <span class="c1"># Setup selections name sub group and its members...</span>
 1058         <span class="k">for</span> <span class="n">SelectionName</span> <span class="ow">in</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ChainSelectionsInfo&quot;</span><span class="p">][</span><span class="s2">&quot;Names&quot;</span><span class="p">]:</span>
 1059             <span class="n">SelectionNameGroupID</span> <span class="o">=</span> <span class="n">SelectionName</span>
 1060             
 1061             <span class="n">SelectionsNameGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupName</span><span class="p">,</span> <span class="n">SelectionName</span><span class="p">)</span>
 1062             <span class="n">SelectionsNameGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
 1063 
 1064             <span class="c1"># Add selections name sub group to selections group...</span>
 1065             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SelectionsNameGroupID</span><span class="p">]</span> <span class="o">=</span> <span class="n">SelectionsNameGroupName</span>
 1066             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SelectionsGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SelectionsNameGroupName</span><span class="p">)</span>
 1067             
 1068             <span class="c1"># Initialize selections names sub group members...</span>
 1069             <span class="n">SelectionsNameGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">GroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
 1070             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SelectionsNameGroupMembersID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1071 
 1072             <span class="c1"># Add selection object to selections name group...</span>
 1073             <span class="n">SelectionObjectName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Selection&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsNameGroupName</span><span class="p">)</span>
 1074             <span class="n">SelectionObjectID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">Selection&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
 1075             
 1076             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SelectionObjectID</span><span class="p">]</span> <span class="o">=</span> <span class="n">SelectionObjectName</span>
 1077             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SelectionsNameGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SelectionObjectName</span><span class="p">)</span>
 1078 
 1079             <span class="c1"># Setup composite mesh group and add it to selections name group...</span>
 1080             <span class="n">CompositeMeshGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.2Fo-Fc&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsNameGroupName</span><span class="p">)</span>
 1081             <span class="n">CompositeMeshGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">CompositeEDGroup&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
 1082             
 1083             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">CompositeMeshGroupID</span><span class="p">]</span> <span class="o">=</span> <span class="n">CompositeMeshGroupName</span>
 1084             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SelectionsNameGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CompositeMeshGroupName</span><span class="p">)</span>
 1085             
 1086             <span class="c1"># Initialize composite mesh group members...</span>
 1087             <span class="n">CompositeMeshGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">CompositeEDGroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
 1088             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">CompositeMeshGroupMembersID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1089 
 1090             <span class="c1"># Setup members of composite mesh group...</span>
 1091             <span class="n">CompositeMeshName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Mesh&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">CompositeMeshGroupName</span><span class="p">)</span>
 1092             <span class="n">CompositeMeshID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">CompositeEDMesh&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
 1093             <span class="n">CompositeVolumeName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Volume&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">CompositeMeshGroupName</span><span class="p">)</span>
 1094             <span class="n">CompositeVolumeID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">CompositeEDVolume&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
 1095             <span class="n">CompositeSurfaceName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Surface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">CompositeMeshGroupName</span><span class="p">)</span>
 1096             <span class="n">CompositeSurfaceID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">CompositeEDSurface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
 1097     
 1098             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">CompositeMeshID</span><span class="p">]</span> <span class="o">=</span> <span class="n">CompositeMeshName</span>
 1099             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">CompositeVolumeID</span><span class="p">]</span> <span class="o">=</span> <span class="n">CompositeVolumeName</span>
 1100             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">CompositeSurfaceID</span><span class="p">]</span> <span class="o">=</span> <span class="n">CompositeSurfaceName</span>
 1101 
 1102             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">CompositeMeshGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CompositeMeshName</span><span class="p">)</span>
 1103             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">CompositeMeshGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CompositeVolumeName</span><span class="p">)</span>
 1104             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">CompositeMeshGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CompositeSurfaceName</span><span class="p">)</span>
 1105             
 1106             <span class="k">if</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;SetupDiffEDMapObjects&quot;</span><span class="p">]:</span>
 1107                 <span class="c1"># Setup diff mesh group and add it to selections name group...</span>
 1108                 <span class="n">DiffMeshGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Fo-Fc&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsNameGroupName</span><span class="p">)</span>
 1109                 <span class="n">DiffMeshGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">DiffEDGroup&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
 1110                 
 1111                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">DiffMeshGroupID</span><span class="p">]</span> <span class="o">=</span> <span class="n">DiffMeshGroupName</span>
 1112                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">SelectionsNameGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DiffMeshGroupName</span><span class="p">)</span>
 1113                 
 1114                 <span class="c1"># Initialize diff mesh group members...</span>
 1115                 <span class="n">DiffMeshGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">DiffEDGroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
 1116                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">DiffMeshGroupMembersID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1117                 
 1118                 <span class="c1"># Setup members of diff mesh group...</span>
 1119                 <span class="n">DiffVolumeName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Volume&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">DiffMeshGroupName</span><span class="p">)</span>
 1120                 <span class="n">DiffVolumeID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">DiffEDVolume&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
 1121                 
 1122                 <span class="n">DiffMesh1Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Mesh1&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">DiffMeshGroupName</span><span class="p">)</span>
 1123                 <span class="n">DiffMesh1ID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">DiffEDMesh1&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
 1124                 <span class="n">DiffSurface1Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Surface1&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">DiffMeshGroupName</span><span class="p">)</span>
 1125                 <span class="n">DiffSurface1ID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">DiffEDSurface1&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
 1126                 
 1127                 <span class="n">DiffMesh2Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Mesh2&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">DiffMeshGroupName</span><span class="p">)</span>
 1128                 <span class="n">DiffMesh2ID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">DiffEDMesh2&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
 1129                 <span class="n">DiffSurface2Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Surface2&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">DiffMeshGroupName</span><span class="p">)</span>
 1130                 <span class="n">DiffSurface2ID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">DiffEDSurface1&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">SelectionsGroupIDPrefix</span><span class="p">,</span> <span class="n">SelectionNameGroupID</span><span class="p">)</span>
 1131                 
 1132                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">DiffVolumeID</span><span class="p">]</span> <span class="o">=</span> <span class="n">DiffVolumeName</span>
 1133                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">DiffMesh1ID</span><span class="p">]</span> <span class="o">=</span> <span class="n">DiffMesh1Name</span>
 1134                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">DiffSurface1ID</span><span class="p">]</span> <span class="o">=</span> <span class="n">DiffSurface1Name</span>
 1135                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">DiffMesh2ID</span><span class="p">]</span> <span class="o">=</span> <span class="n">DiffMesh2Name</span>
 1136                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">DiffSurface2ID</span><span class="p">]</span> <span class="o">=</span> <span class="n">DiffSurface2Name</span>
 1137 
 1138                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">DiffMeshGroupMembersID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1139                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">DiffMeshGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DiffVolumeName</span><span class="p">)</span>
 1140                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">DiffMeshGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DiffMesh1Name</span><span class="p">)</span>
 1141                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">DiffMeshGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DiffSurface1Name</span><span class="p">)</span>
 1142                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">DiffMeshGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DiffMesh2Name</span><span class="p">)</span>
 1143                 <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">DiffMeshGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DiffSurface2Name</span><span class="p">)</span>
 1144     
 1145     <span class="c1"># Setup solvent and inorganic objects for chain...</span>
 1146     <span class="k">for</span> <span class="n">NameID</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Solvent&quot;</span><span class="p">,</span> <span class="s2">&quot;Inorganic&quot;</span><span class="p">]:</span>
 1147         <span class="n">Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainGroupName</span><span class="p">,</span> <span class="n">NameID</span><span class="p">)</span>
 1148         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">NameID</span><span class="p">]</span> <span class="o">=</span> <span class="n">Name</span>
 1149         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
 1150 
 1151 <span class="k">def</span> <span class="nf">SetupPyMOLObjectNamesForLigand</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">,</span> <span class="n">PyMOLObjectNames</span><span class="p">,</span> <span class="n">ChainID</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">):</span>
 1152     <span class="sd">&quot;&quot;&quot;Stetup groups and objects for ligand.&quot;&quot;&quot;</span>
 1153 
 1154     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1155     
 1156     <span class="n">ChainGroupName</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroup&quot;</span><span class="p">]</span>
 1157     
 1158     <span class="c1"># Setup a chain level ligand group...</span>
 1159     <span class="n">ChainLigandGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Ligand</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainGroupName</span><span class="p">,</span> <span class="n">LigandID</span><span class="p">)</span>
 1160     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="s2">&quot;ChainLigandGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ChainLigandGroupName</span>
 1161     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Chains&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="s2">&quot;ChainGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ChainLigandGroupName</span><span class="p">)</span>
 1162     
 1163     <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="s2">&quot;ChainLigandGroupMembers&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1164 
 1165     <span class="c1"># Set up groups and objects for a specific ligand group...</span>
 1166     <span class="k">for</span> <span class="n">GroupType</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;Ligand&quot;</span><span class="p">,</span> <span class="s2">&quot;Pocket&quot;</span><span class="p">,</span> <span class="s2">&quot;Pocket_Solvent&quot;</span><span class="p">,</span> <span class="s2">&quot;Pocket_Inorganic&quot;</span><span class="p">]:</span>
 1167         <span class="n">GroupID</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">GroupType</span><span class="p">)</span>
 1168         <span class="n">GroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainLigandGroupName</span><span class="p">,</span> <span class="n">GroupType</span><span class="p">)</span>
 1169                 
 1170         <span class="n">GroupNameID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">Group&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
 1171         <span class="n">GroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">GroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
 1172         
 1173         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupNameID</span><span class="p">]</span> <span class="o">=</span> <span class="n">GroupName</span>
 1174         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="s2">&quot;ChainLigandGroupMembers&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">GroupName</span><span class="p">)</span>
 1175         
 1176         <span class="n">GroupTypeObjectName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupName</span><span class="p">,</span> <span class="n">GroupType</span><span class="p">)</span>
 1177         <span class="n">GroupTypeObjectID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
 1178         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupTypeObjectID</span><span class="p">]</span> <span class="o">=</span> <span class="n">GroupTypeObjectName</span>
 1179         
 1180         <span class="n">CompositeMeshGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.2Fo-Fc&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupName</span><span class="p">)</span>
 1181         <span class="n">CompositeMeshName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Mesh&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">CompositeMeshGroupName</span><span class="p">)</span>
 1182         <span class="n">CompositeVolumeName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Volume&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">CompositeMeshGroupName</span><span class="p">)</span>
 1183         <span class="n">CompositeSurfaceName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Surface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">CompositeMeshGroupName</span><span class="p">)</span>
 1184                 
 1185         <span class="n">CompositeMeshGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">CompositeEDMeshGroup&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
 1186         <span class="n">CompositeMeshGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">CompositeEDMeshGroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
 1187         <span class="n">CompositeMeshID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">CompositeEDMesh&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
 1188         <span class="n">CompositeVolumeID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">CompositeEDVolume&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
 1189         <span class="n">CompositeSurfaceID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">CompositeEDSurface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
 1190         
 1191         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">CompositeMeshGroupID</span><span class="p">]</span> <span class="o">=</span> <span class="n">CompositeMeshGroupName</span>
 1192         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">CompositeMeshID</span><span class="p">]</span> <span class="o">=</span> <span class="n">CompositeMeshName</span>
 1193         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">CompositeVolumeID</span><span class="p">]</span> <span class="o">=</span> <span class="n">CompositeVolumeName</span>
 1194         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">CompositeSurfaceID</span><span class="p">]</span> <span class="o">=</span> <span class="n">CompositeSurfaceName</span>
 1195         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">CompositeMeshGroupMembersID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1196         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">CompositeMeshGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CompositeVolumeName</span><span class="p">)</span>
 1197         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">CompositeMeshGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CompositeMeshName</span><span class="p">)</span>
 1198         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">CompositeMeshGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CompositeSurfaceName</span><span class="p">)</span>
 1199                 
 1200         <span class="k">if</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;SetupDiffEDMapObjects&quot;</span><span class="p">]:</span>
 1201             <span class="n">DiffMeshGroupName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Fo-Fc&quot;</span> <span class="o">%</span> <span class="n">GroupName</span>
 1202             <span class="n">DiffVolumeName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Volume&quot;</span> <span class="o">%</span> <span class="n">DiffMeshGroupName</span>
 1203             <span class="n">DiffMesh1Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Mesh1&quot;</span> <span class="o">%</span> <span class="n">DiffMeshGroupName</span>
 1204             <span class="n">DiffSurface1Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Surface1&quot;</span> <span class="o">%</span> <span class="n">DiffMeshGroupName</span>
 1205             <span class="n">DiffMesh2Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Mesh2&quot;</span> <span class="o">%</span> <span class="n">DiffMeshGroupName</span>
 1206             <span class="n">DiffSurface2Name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Surface2&quot;</span> <span class="o">%</span> <span class="n">DiffMeshGroupName</span>
 1207                     
 1208             <span class="n">DiffMeshGroupID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">DiffEDMeshGroup&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
 1209             <span class="n">DiffMeshGroupMembersID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">DiffEDMeshGroupMembers&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
 1210             <span class="n">DiffVolumeID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">DiffEDVolume&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
 1211             <span class="n">DiffMesh1ID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">DiffEDMesh1&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
 1212             <span class="n">DiffSurface1ID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">DiffEDSurface1&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
 1213             <span class="n">DiffMesh2ID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">DiffEDMesh2&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
 1214             <span class="n">DiffSurface2ID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">DiffEDSurface2&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
 1215                     
 1216             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">DiffMeshGroupID</span><span class="p">]</span> <span class="o">=</span> <span class="n">DiffMeshGroupName</span>
 1217             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">DiffVolumeID</span><span class="p">]</span> <span class="o">=</span> <span class="n">DiffVolumeName</span>
 1218             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">DiffMesh1ID</span><span class="p">]</span> <span class="o">=</span> <span class="n">DiffMesh1Name</span>
 1219             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">DiffSurface1ID</span><span class="p">]</span> <span class="o">=</span> <span class="n">DiffSurface1Name</span>
 1220             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">DiffMesh2ID</span><span class="p">]</span> <span class="o">=</span> <span class="n">DiffMesh2Name</span>
 1221             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">DiffSurface2ID</span><span class="p">]</span> <span class="o">=</span> <span class="n">DiffSurface2Name</span>
 1222             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">DiffMeshGroupMembersID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1223             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">DiffMeshGroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">DiffVolumeName</span><span class="p">,</span> <span class="n">DiffMesh1Name</span><span class="p">,</span> <span class="n">DiffSurface1Name</span><span class="p">,</span> <span class="n">DiffMesh2Name</span><span class="p">,</span>  <span class="n">DiffSurface2Name</span><span class="p">])</span>
 1224                 
 1225         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupMembersID</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1226         <span class="n">NameIDs</span> <span class="o">=</span> <span class="p">[</span><span class="n">GroupTypeObjectID</span><span class="p">,</span> <span class="n">CompositeMeshGroupID</span><span class="p">]</span>
 1227         <span class="k">if</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;SetupDiffEDMapObjects&quot;</span><span class="p">]:</span>
 1228             <span class="n">NameIDs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DiffMeshGroupID</span><span class="p">)</span>
 1229         
 1230         <span class="k">for</span> <span class="n">NameID</span> <span class="ow">in</span> <span class="n">NameIDs</span><span class="p">:</span>
 1231             <span class="n">Name</span> <span class="o">=</span> <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">NameID</span><span class="p">]</span>
 1232             <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
 1233         
 1234         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Ligand$&quot;</span><span class="p">,</span> <span class="n">GroupType</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1235             <span class="c1"># No other object needed for Ligand group...</span>
 1236             <span class="k">continue</span>
 1237         
 1238         <span class="n">PolarContactsName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Polar_Contacts&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupName</span><span class="p">)</span>
 1239         <span class="n">PolarContactsID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">PolarContacts&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
 1240         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">PolarContactsID</span><span class="p">]</span> <span class="o">=</span> <span class="n">PolarContactsName</span>
 1241         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PolarContactsName</span><span class="p">)</span>
 1242                 
 1243         <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Pocket$&quot;</span><span class="p">,</span> <span class="n">GroupType</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1244             <span class="c1"># No other object needed for any other group besides Pocket...</span>
 1245             <span class="k">continue</span>
 1246         
 1247         <span class="k">if</span> <span class="ow">not</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketSurface&quot;</span><span class="p">]:</span>
 1248             <span class="k">continue</span>
 1249         
 1250         <span class="n">HydrophobicContactsName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Hydrophobic_Contacts&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupName</span><span class="p">)</span>
 1251         <span class="n">HydrophobicContactsID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">HydrophobicContacts&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
 1252         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">HydrophobicContactsID</span><span class="p">]</span> <span class="o">=</span> <span class="n">HydrophobicContactsName</span>
 1253         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">HydrophobicContactsName</span><span class="p">)</span>
 1254         
 1255         <span class="n">HydrophobicSurfaceName</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.Surface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupName</span><span class="p">)</span>
 1256         <span class="n">HydrophobicSurfaceID</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">HydrophobicSurface&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">GroupID</span><span class="p">)</span>
 1257         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">HydrophobicSurfaceID</span><span class="p">]</span> <span class="o">=</span> <span class="n">HydrophobicSurfaceName</span>
 1258         <span class="n">PyMOLObjectNames</span><span class="p">[</span><span class="s2">&quot;Ligands&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">][</span><span class="n">LigandID</span><span class="p">][</span><span class="n">GroupMembersID</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">HydrophobicSurfaceName</span><span class="p">)</span>
 1259 
 1260 <span class="k">def</span> <span class="nf">ProcessEDMapFilesAndSuffixes</span><span class="p">():</span>
 1261     <span class="sd">&quot;&quot;&quot;Process specified ED map files or suffixes for input files.&quot;&quot;&quot;</span>
 1262     
 1263     <span class="n">EDMapFiles</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;EDMapFiles&quot;</span><span class="p">]</span>
 1264     <span class="n">EDMapSuffixes</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;EDMapSuffixes&quot;</span><span class="p">]</span>
 1265 
 1266     <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">EDMapFiles</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">))</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">EDMapSuffixes</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)):</span>
 1267             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The values, </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> and </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="s2">--EDMapFiles</span><span class="se">\&quot;</span><span class="s2"> and </span><span class="se">\&quot;</span><span class="s2">--EDMapSuffixes</span><span class="se">\&quot;</span><span class="s2"> are not valid. Both of these options can&#39;t be specified simultaneously.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">EDMapFiles</span><span class="p">,</span> <span class="n">EDMapSuffixes</span><span class="p">))</span>
 1268 
 1269     <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">EDMapFiles</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1270         <span class="n">ProcessEDMapFiles</span><span class="p">()</span>
 1271     <span class="k">else</span><span class="p">:</span>
 1272         <span class="n">ProcessEDMapSuffixes</span><span class="p">()</span>
 1273         
 1274 <span class="k">def</span> <span class="nf">ProcessEDMapFiles</span><span class="p">():</span>
 1275     <span class="sd">&quot;&quot;&quot;Process specified ED map files&quot;&quot;&quot;</span>
 1276 
 1277     <span class="n">EDMapFiles</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;EDMapFiles&quot;</span><span class="p">])</span>
 1278     <span class="k">if</span> <span class="ow">not</span> <span class="n">EDMapFiles</span><span class="p">:</span>
 1279         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;No valid parameter name and value pairs specified using </span><span class="se">\&quot;</span><span class="s2">--EDMapFiles</span><span class="se">\&quot;</span><span class="s2"> option.&quot;</span><span class="p">)</span>
 1280     
 1281     <span class="n">EDMapFilesWords</span> <span class="o">=</span> <span class="n">EDMapFiles</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
 1282     <span class="n">EDMapFilesWordsCount</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">EDMapFilesWords</span><span class="p">)</span>
 1283     <span class="k">if</span> <span class="n">EDMapFilesWordsCount</span> <span class="o">%</span> <span class="mi">2</span><span class="p">:</span>
 1284         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The number of comma delimited ED map files, </span><span class="si">%d</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="s2">--EDMapFiles</span><span class="se">\&quot;</span><span class="s2"> option must be an even number.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">EDMapFilesWordsCount</span><span class="p">))</span>
 1285 
 1286     <span class="n">InfilesNamesCount</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">])</span>
 1287     <span class="k">if</span> <span class="n">EDMapFilesWordsCount</span> <span class="o">!=</span> <span class="mi">2</span><span class="o">*</span><span class="n">InfilesNamesCount</span><span class="p">:</span>
 1288         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The number of comma delimited ED map files, </span><span class="si">%d</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="s2">--EDMapFiles</span><span class="se">\&quot;</span><span class="s2"> must be twice the number of input files, </span><span class="si">%s</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="s2">-i, --infiles</span><span class="se">\&quot;</span><span class="s2"> option.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">EDMapFilesWordsCount</span><span class="p">,</span> <span class="n">InfilesNamesCount</span><span class="p">))</span>
 1289     
 1290     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;CompositeEDMapFiles&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1291     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;DiffEDMapFiles&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1292 
 1293     <span class="n">CompositeEDMapFiles</span> <span class="o">=</span> <span class="p">[]</span>
 1294     <span class="n">DiffEDMapFiles</span> <span class="o">=</span> <span class="p">[]</span>
 1295     <span class="k">for</span> <span class="n">Index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">EDMapFilesWordsCount</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
 1296         <span class="n">CompositeEDMapFiles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">EDMapFilesWords</span><span class="p">[</span><span class="n">Index</span><span class="p">])</span>
 1297         <span class="n">DiffEDMapFiles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">EDMapFilesWords</span><span class="p">[</span><span class="n">Index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
 1298         
 1299     <span class="k">for</span> <span class="n">Index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">InfilesNamesCount</span><span class="p">):</span>
 1300         <span class="n">Infile</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">][</span><span class="n">Index</span><span class="p">]</span>
 1301         <span class="n">CompositeEDMapFile</span> <span class="o">=</span> <span class="n">CompositeEDMapFiles</span><span class="p">[</span><span class="n">Index</span><span class="p">]</span>
 1302         <span class="n">DiffEDMapFile</span> <span class="o">=</span> <span class="n">DiffEDMapFiles</span><span class="p">[</span><span class="n">Index</span><span class="p">]</span>
 1303 
 1304         <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">CompositeEDMapFile</span><span class="p">):</span>
 1305             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The composite ED map file, </span><span class="si">%s</span><span class="s2">, specified using option </span><span class="se">\&quot;</span><span class="s2">--EDMapFiles</span><span class="se">\&quot;</span><span class="s2">, corresponding to input file, </span><span class="si">%s</span><span class="s2">,  doesn&#39;t exist.</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">CompositeEDMapFile</span><span class="p">,</span> <span class="n">Infile</span><span class="p">))</span>
 1306 
 1307         <span class="n">DiffEDMapFileExists</span> <span class="o">=</span> <span class="bp">False</span>
 1308         <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^None$&quot;</span><span class="p">,</span> <span class="n">DiffEDMapFile</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1309             <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">DiffEDMapFile</span><span class="p">):</span>
 1310                 <span class="n">DiffEDMapFileExists</span> <span class="o">=</span> <span class="bp">True</span>
 1311             <span class="k">else</span><span class="p">:</span>
 1312                 <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;The difference ED map file, </span><span class="si">%s</span><span class="s2">, specified using option </span><span class="se">\&quot;</span><span class="s2">--EDMapFiles</span><span class="se">\&quot;</span><span class="s2">, corresponding to input file, </span><span class="si">%s</span><span class="s2">,  doesn&#39;t exist. PyMOL groups and objectes related to difference maps won&#39;t be created.</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">DiffEDMapFile</span><span class="p">,</span> <span class="n">Infile</span><span class="p">))</span>
 1313         
 1314         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;CompositeEDMapFiles&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CompositeEDMapFile</span><span class="p">)</span>
 1315         <span class="k">if</span> <span class="n">DiffEDMapFileExists</span><span class="p">:</span>
 1316             <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;DiffEDMapFiles&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DiffEDMapFile</span><span class="p">)</span>
 1317         <span class="k">else</span><span class="p">:</span>
 1318             <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;DiffEDMapFiles&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
 1319             
 1320 <span class="k">def</span> <span class="nf">ProcessEDMapSuffixes</span><span class="p">():</span>
 1321     <span class="sd">&quot;&quot;&quot;Process suffixes for ED map files&quot;&quot;&quot;</span>
 1322     
 1323     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;EDMapSuffixesMap&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;CompositeMap&quot;</span> <span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;DifferenceMap&quot;</span> <span class="p">:</span> <span class="s2">&quot;_diff&quot;</span><span class="p">}</span>
 1324     
 1325     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;EDMapSuffixes&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1326         <span class="n">SetupEDMapFileNamesUsingSuffixes</span><span class="p">()</span>
 1327         <span class="k">return</span>
 1328     
 1329     <span class="n">EDMapSuffixes</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;EDMapSuffixes&quot;</span><span class="p">])</span>
 1330     <span class="k">if</span> <span class="ow">not</span> <span class="n">EDMapSuffixes</span><span class="p">:</span>
 1331         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;No valid parameter name and value pairs specified using </span><span class="se">\&quot;</span><span class="s2">--EDMapSuffixes</span><span class="se">\&quot;</span><span class="s2"> option.&quot;</span><span class="p">)</span>
 1332     
 1333     <span class="n">EDMapSuffixesWords</span> <span class="o">=</span> <span class="n">EDMapSuffixes</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
 1334     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">EDMapSuffixesWords</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span><span class="p">:</span>
 1335         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The number of comma delimited ED map types names and suffixes, </span><span class="si">%d</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="s2">--EDMapSuffixes</span><span class="se">\&quot;</span><span class="s2"> option must be an even number.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">EDMapSuffixesWords</span><span class="p">)))</span>
 1336 
 1337     <span class="k">for</span> <span class="n">Index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">EDMapSuffixesWords</span><span class="p">),</span> <span class="mi">2</span><span class="p">):</span>
 1338         <span class="n">EDMapType</span> <span class="o">=</span> <span class="n">EDMapSuffixesWords</span><span class="p">[</span><span class="n">Index</span><span class="p">]</span>
 1339         <span class="n">EDMapSuffix</span> <span class="o">=</span> <span class="n">EDMapSuffixesWords</span><span class="p">[</span><span class="n">Index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
 1340         
 1341         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^CompositeMap$&quot;</span><span class="p">,</span> <span class="n">EDMapType</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1342             <span class="n">EDMapType</span> <span class="o">=</span> <span class="s2">&quot;CompositeMap&quot;</span>
 1343         <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^DifferenceMap$&quot;</span><span class="p">,</span> <span class="n">EDMapType</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1344             <span class="n">EDMapType</span> <span class="o">=</span> <span class="s2">&quot;DifferenceMap&quot;</span>
 1345         <span class="k">else</span><span class="p">:</span>
 1346             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The ED map type, </span><span class="si">%s</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="s2">--EDMapSuffixes</span><span class="se">\&quot;</span><span class="s2"> option is not a valid ED map type. Supported ED map types: CompositeMap, DifferenceMap&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">EDMapType</span><span class="p">))</span>
 1347             
 1348         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">EDMapSuffix</span><span class="p">,</span> <span class="s2">&quot;None&quot;</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1349             <span class="n">EDMapSuffix</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
 1350         
 1351         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;EDMapSuffixesMap&quot;</span><span class="p">][</span><span class="n">EDMapType</span><span class="p">]</span> <span class="o">=</span> <span class="n">EDMapSuffix</span>
 1352     
 1353     <span class="n">SetupEDMapFileNamesUsingSuffixes</span><span class="p">()</span>
 1354 
 1355 <span class="k">def</span> <span class="nf">SetupEDMapFileNamesUsingSuffixes</span><span class="p">():</span>
 1356     <span class="sd">&quot;&quot;&quot;Set up ED map file names. &quot;&quot;&quot;</span>
 1357     
 1358     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;CompositeEDMapFiles&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1359     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;DiffEDMapFiles&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1360     
 1361     <span class="n">CompositeMapSuffix</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;EDMapSuffixesMap&quot;</span><span class="p">][</span><span class="s2">&quot;CompositeMap&quot;</span><span class="p">]</span>
 1362     <span class="n">DiffMapSuffix</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;EDMapSuffixesMap&quot;</span><span class="p">][</span><span class="s2">&quot;DifferenceMap&quot;</span><span class="p">]</span>
 1363     <span class="n">InfilesNamesCount</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">])</span>
 1364     
 1365     <span class="k">for</span> <span class="n">Index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">InfilesNamesCount</span><span class="p">):</span>
 1366         <span class="n">Infile</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">][</span><span class="n">Index</span><span class="p">]</span>
 1367         <span class="n">FileDir</span><span class="p">,</span> <span class="n">FileName</span><span class="p">,</span> <span class="n">FileExt</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ParseFileName</span><span class="p">(</span><span class="n">Infile</span><span class="p">)</span>
 1368         <span class="n">InfileRoot</span> <span class="o">=</span> <span class="n">FileName</span>
 1369         
 1370         <span class="n">CompositeEDMapFile</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">.ccp4&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">InfileRoot</span><span class="p">,</span> <span class="n">CompositeMapSuffix</span><span class="p">)</span>
 1371         <span class="n">DiffEDMapFile</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">.ccp4&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">InfileRoot</span><span class="p">,</span> <span class="n">DiffMapSuffix</span><span class="p">)</span>
 1372         
 1373         <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">CompositeEDMapFile</span><span class="p">):</span>
 1374             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The composite ED map file, </span><span class="si">%s</span><span class="s2">, for option </span><span class="se">\&quot;</span><span class="s2">--EDMapSuffixes</span><span class="se">\&quot;</span><span class="s2">, corresponding to input file, </span><span class="si">%s</span><span class="s2">, doesn&#39;t exist.</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">CompositeEDMapFile</span><span class="p">,</span> <span class="n">Infile</span><span class="p">))</span>
 1375 
 1376         <span class="n">DiffEDMapFileExists</span> <span class="o">=</span> <span class="bp">False</span>
 1377         <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">DiffEDMapFile</span><span class="p">):</span>
 1378             <span class="n">DiffEDMapFileExists</span> <span class="o">=</span> <span class="bp">True</span>
 1379         <span class="k">else</span><span class="p">:</span>
 1380             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;The difference ED map file, </span><span class="si">%s</span><span class="s2">, for option </span><span class="se">\&quot;</span><span class="s2">--EDMapSuffixes</span><span class="se">\&quot;</span><span class="s2">, corresponding to input file, </span><span class="si">%s</span><span class="s2">,  doesn&#39;t exist. PyMOL groups and objectes related to difference maps won&#39;t be created.</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">DiffEDMapFile</span><span class="p">,</span> <span class="n">Infile</span><span class="p">))</span>
 1381         
 1382         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;CompositeEDMapFiles&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CompositeEDMapFile</span><span class="p">)</span>
 1383         <span class="k">if</span> <span class="n">DiffEDMapFileExists</span><span class="p">:</span>
 1384             <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;DiffEDMapFiles&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DiffEDMapFile</span><span class="p">)</span>
 1385         <span class="k">else</span><span class="p">:</span>
 1386             <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;DiffEDMapFiles&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
 1387 
 1388 <span class="k">def</span> <span class="nf">RetrieveInfilesInfo</span><span class="p">():</span>
 1389     <span class="sd">&quot;&quot;&quot;Retrieve information for input files.&quot;&quot;&quot;</span>
 1390 
 1391     <span class="n">InfilesInfo</span> <span class="o">=</span> <span class="p">{}</span>
 1392     
 1393     <span class="n">InfilesInfo</span><span class="p">[</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1394     <span class="n">InfilesInfo</span><span class="p">[</span><span class="s2">&quot;InfilesRoots&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1395     <span class="n">InfilesInfo</span><span class="p">[</span><span class="s2">&quot;ChainsAndLigandsInfo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1396     
 1397     <span class="k">for</span> <span class="n">Infile</span> <span class="ow">in</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">]:</span>
 1398         <span class="n">FileDir</span><span class="p">,</span> <span class="n">FileName</span><span class="p">,</span> <span class="n">FileExt</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ParseFileName</span><span class="p">(</span><span class="n">Infile</span><span class="p">)</span>
 1399         <span class="n">InfileRoot</span> <span class="o">=</span> <span class="n">FileName</span>
 1400         
 1401         <span class="n">ChainsAndLigandInfo</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">GetChainsAndLigandsInfo</span><span class="p">(</span><span class="n">Infile</span><span class="p">,</span> <span class="n">InfileRoot</span><span class="p">)</span>
 1402         
 1403         <span class="n">InfilesInfo</span><span class="p">[</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Infile</span><span class="p">)</span>
 1404         <span class="n">InfilesInfo</span><span class="p">[</span><span class="s2">&quot;InfilesRoots&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">InfileRoot</span><span class="p">)</span>
 1405         <span class="n">InfilesInfo</span><span class="p">[</span><span class="s2">&quot;ChainsAndLigandsInfo&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ChainsAndLigandInfo</span><span class="p">)</span>
 1406     
 1407     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">InfilesInfo</span>
 1408 
 1409 <span class="k">def</span> <span class="nf">RetrieveRefFileInfo</span><span class="p">():</span>
 1410     <span class="sd">&quot;&quot;&quot;Retrieve information for ref file.&quot;&quot;&quot;</span>
 1411 
 1412     <span class="n">RefFileInfo</span> <span class="o">=</span> <span class="p">{}</span>
 1413     <span class="k">if</span> <span class="ow">not</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Align&quot;</span><span class="p">]:</span>
 1414         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;RefFileInfo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">RefFileInfo</span>
 1415         <span class="k">return</span>
 1416 
 1417     <span class="n">RefFile</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;RefFileName&quot;</span><span class="p">]</span>
 1418     
 1419     <span class="n">FileDir</span><span class="p">,</span> <span class="n">FileName</span><span class="p">,</span> <span class="n">FileExt</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ParseFileName</span><span class="p">(</span><span class="n">RefFile</span><span class="p">)</span>
 1420     <span class="n">RefFileRoot</span> <span class="o">=</span> <span class="n">FileName</span>
 1421     
 1422     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^FirstInputFile$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AlignRefFile&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1423         <span class="n">ChainsAndLigandInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;ChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
 1424     <span class="k">else</span><span class="p">:</span>
 1425         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Retrieving chain and ligand information for alignment reference file </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">RefFile</span><span class="p">)</span>
 1426         <span class="n">ChainsAndLigandInfo</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">GetChainsAndLigandsInfo</span><span class="p">(</span><span class="n">RefFile</span><span class="p">,</span> <span class="n">RefFileRoot</span><span class="p">)</span>
 1427 
 1428     <span class="n">RefFileInfo</span><span class="p">[</span><span class="s2">&quot;RefFileName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">RefFile</span>
 1429     <span class="n">RefFileInfo</span><span class="p">[</span><span class="s2">&quot;RefFileRoot&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">RefFileRoot</span>
 1430     <span class="n">RefFileInfo</span><span class="p">[</span><span class="s2">&quot;PyMOLObjectName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;AlignRef_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">RefFileRoot</span>
 1431     <span class="n">RefFileInfo</span><span class="p">[</span><span class="s2">&quot;ChainsAndLigandsInfo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ChainsAndLigandInfo</span>
 1432     
 1433     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;RefFileInfo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">RefFileInfo</span>
 1434 
 1435 <span class="k">def</span> <span class="nf">ProcessChainAndLigandIDs</span><span class="p">():</span>
 1436     <span class="sd">&quot;&quot;&quot;Process specified chain and ligand IDs for infiles.&quot;&quot;&quot;</span>
 1437     
 1438     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
 1439     
 1440     <span class="k">for</span> <span class="n">FileIndex</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">])):</span>
 1441         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Processing specified chain and ligand IDs for input file </span><span class="si">%s</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">])</span>
 1442         
 1443         <span class="n">ChainsAndLigandsInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;ChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
 1444         <span class="n">SpecifiedChainsAndLigandsInfo</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">ProcessChainsAndLigandsOptionsInfo</span><span class="p">(</span><span class="n">ChainsAndLigandsInfo</span><span class="p">,</span> <span class="s2">&quot;-c, --chainIDs&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">],</span> <span class="s2">&quot;-l, --ligandIDs&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">])</span>
 1445         <span class="n">ProcessChainMeshesVolumesAndSurfacesOptions</span><span class="p">(</span><span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">)</span>
 1446         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;SpecifiedChainsAndLigandsInfo&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">)</span>
 1447         
 1448         <span class="n">CheckPresenceOfValidLigandIDs</span><span class="p">(</span><span class="n">ChainsAndLigandsInfo</span><span class="p">,</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">)</span>
 1449         
 1450 <span class="k">def</span> <span class="nf">CheckPresenceOfValidLigandIDs</span><span class="p">(</span><span class="n">ChainsAndLigandsInfo</span><span class="p">,</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">):</span>
 1451     <span class="sd">&quot;&quot;&quot;Check presence of valid ligand IDs.&quot;&quot;&quot;</span>
 1452 
 1453     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Specified chain IDs: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">])))</span>
 1454     
 1455     <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]:</span>
 1456         <span class="k">if</span> <span class="nb">len</span> <span class="p">(</span><span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]):</span>
 1457             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Chain ID: </span><span class="si">%s</span><span class="s2">; Specified LigandIDs: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainID</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">])))</span>
 1458         <span class="k">else</span><span class="p">:</span>
 1459             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Chain IDs: </span><span class="si">%s</span><span class="s2">; Specified LigandIDs: None&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainID</span><span class="p">))</span>
 1460             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintWarning</span><span class="p">(</span><span class="s2">&quot;No valid ligand IDs found for chain ID, </span><span class="si">%s</span><span class="s2">. PyMOL groups and objects related to ligand and binding pockect won&#39;t be created.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ChainID</span><span class="p">))</span>
 1461 
 1462 <span class="k">def</span> <span class="nf">RetrieveFirstChainID</span><span class="p">(</span><span class="n">FileIndex</span><span class="p">):</span>
 1463     <span class="sd">&quot;&quot;&quot;Get first chain ID.&quot;&quot;&quot;</span>
 1464     
 1465     <span class="n">ChainsAndLigandsInfo</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesInfo&quot;</span><span class="p">][</span><span class="s2">&quot;ChainsAndLigandsInfo&quot;</span><span class="p">][</span><span class="n">FileIndex</span><span class="p">]</span>
 1466     
 1467     <span class="n">FirstChainID</span> <span class="o">=</span> <span class="bp">None</span>
 1468     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]):</span>
 1469         <span class="n">FirstChainID</span> <span class="o">=</span> <span class="n">ChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
 1470     
 1471     <span class="k">return</span> <span class="n">FirstChainID</span>
 1472 
 1473 <span class="k">def</span> <span class="nf">ProcessChainMeshesVolumesAndSurfacesOptions</span><span class="p">(</span><span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">):</span>
 1474     <span class="sd">&quot;&quot;&quot;Process options to create meshes and surfaces for chains.&quot;&quot;&quot;</span>
 1475 
 1476     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;VolumeChainComplex&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1477     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;MeshChainComplex&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1478     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChainComplex&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1479 
 1480     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;EnableVolumeChainComplex&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1481     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;EnableMeshChainComplex&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1482     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;EnableSurfaceChainComplex&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1483     
 1484     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;EnableChainComplexGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1485     <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;EnableChainAloneGroup&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
 1486     
 1487     <span class="k">for</span> <span class="n">ChainID</span> <span class="ow">in</span> <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]:</span>
 1488         <span class="n">LigandsPresent</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">])</span> <span class="k">else</span> <span class="bp">False</span>
 1489 
 1490         <span class="c1"># Create and enable mesh  or volume in auto mode...</span>
 1491         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshChainComplex&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1492             <span class="n">MeshChainComplex</span> <span class="o">=</span> <span class="bp">False</span> <span class="k">if</span> <span class="n">LigandsPresent</span> <span class="k">else</span> <span class="bp">True</span>
 1493             <span class="n">EnableMeshChainComplex</span> <span class="o">=</span> <span class="bp">False</span> <span class="k">if</span> <span class="n">LigandsPresent</span> <span class="k">else</span> <span class="bp">True</span>
 1494         <span class="k">else</span><span class="p">:</span>
 1495             <span class="n">MeshChainComplex</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Yes$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshChainComplex&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1496             <span class="n">EnableMeshChainComplex</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Yes$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshChainComplex&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1497         
 1498         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;VolumeChainComplex&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1499             <span class="n">VolumeChainComplex</span> <span class="o">=</span> <span class="bp">False</span> <span class="k">if</span> <span class="n">LigandsPresent</span> <span class="k">else</span> <span class="bp">True</span>
 1500             <span class="n">EnableVolumeChainComplex</span> <span class="o">=</span> <span class="bp">False</span> <span class="k">if</span> <span class="n">LigandsPresent</span> <span class="k">else</span> <span class="bp">True</span>
 1501         <span class="k">else</span><span class="p">:</span>
 1502             <span class="n">VolumeChainComplex</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Yes$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;VolumeChainComplex&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1503             <span class="n">EnableVolumeChainComplex</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Yes$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;VolumeChainComplex&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1504         
 1505         <span class="k">if</span> <span class="n">MeshChainComplex</span> <span class="ow">and</span> <span class="n">EnableMeshChainComplex</span><span class="p">:</span>
 1506             <span class="n">EnableVolumeChainComplex</span> <span class="o">=</span> <span class="bp">False</span>
 1507         
 1508         <span class="c1"># Create and enable surface in auto mode based on the status of mesh and volume...</span>
 1509         <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^auto$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChainComplex&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1510             <span class="n">SurfaceChainComplex</span> <span class="o">=</span> <span class="bp">False</span> <span class="k">if</span> <span class="n">LigandsPresent</span> <span class="k">else</span> <span class="bp">True</span>
 1511             <span class="n">EnableSurfaceChainComplex</span> <span class="o">=</span> <span class="bp">False</span> <span class="k">if</span> <span class="n">LigandsPresent</span> <span class="k">else</span> <span class="bp">True</span>
 1512             
 1513             <span class="k">if</span> <span class="n">MeshChainComplex</span> <span class="ow">or</span> <span class="n">VolumeChainComplex</span><span class="p">:</span>
 1514                 <span class="n">SurfaceChainComplex</span> <span class="o">=</span> <span class="bp">False</span>
 1515                 <span class="n">EnableSurfaceChainComplex</span> <span class="o">=</span> <span class="bp">False</span>
 1516         <span class="k">else</span><span class="p">:</span>
 1517             <span class="n">SurfaceChainComplex</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Yes$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChainComplex&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1518             <span class="n">EnableSurfaceChainComplex</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Yes$&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChainComplex&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1519         
 1520         <span class="k">if</span> <span class="p">(</span><span class="n">MeshChainComplex</span> <span class="ow">and</span> <span class="n">EnableMeshChainComplex</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">VolumeChainComplex</span> <span class="ow">or</span> <span class="n">EnableVolumeChainComplex</span><span class="p">):</span>
 1521             <span class="n">EnableSurfaceChainComplex</span> <span class="o">=</span> <span class="bp">False</span>
 1522             
 1523         <span class="k">if</span> <span class="n">LigandsPresent</span><span class="p">:</span>
 1524             <span class="n">EnableChainComplexGroup</span> <span class="o">=</span> <span class="bp">False</span>
 1525             <span class="n">EnableChainAloneGroup</span> <span class="o">=</span> <span class="bp">True</span>
 1526         <span class="k">else</span><span class="p">:</span>
 1527             <span class="n">EnableChainComplexGroup</span> <span class="o">=</span> <span class="bp">True</span>
 1528             <span class="n">EnableChainAloneGroup</span> <span class="o">=</span> <span class="bp">False</span>
 1529 
 1530         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;VolumeChainComplex&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">VolumeChainComplex</span>
 1531         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;MeshChainComplex&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">MeshChainComplex</span>
 1532         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChainComplex&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">SurfaceChainComplex</span>
 1533         
 1534         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;EnableVolumeChainComplex&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">EnableVolumeChainComplex</span>
 1535         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;EnableMeshChainComplex&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">EnableMeshChainComplex</span>
 1536         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;EnableSurfaceChainComplex&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">EnableSurfaceChainComplex</span>
 1537         
 1538         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;EnableChainComplexGroup&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">EnableChainComplexGroup</span>
 1539         <span class="n">SpecifiedChainsAndLigandsInfo</span><span class="p">[</span><span class="s2">&quot;EnableChainAloneGroup&quot;</span><span class="p">][</span><span class="n">ChainID</span><span class="p">]</span> <span class="o">=</span> <span class="n">EnableChainAloneGroup</span>
 1540 
 1541 <span class="k">def</span> <span class="nf">ProcessChainSelections</span><span class="p">():</span>
 1542     <span class="sd">&quot;&quot;&quot;Process custom selections for chains. &quot;&quot;&quot;</span>
 1543 
 1544     <span class="n">ChainSelectionsInfo</span> <span class="o">=</span> <span class="n">PyMOLUtil</span><span class="o">.</span><span class="n">ProcessChainSelectionsOptionsInfo</span><span class="p">(</span><span class="s2">&quot;--selectionsChain&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SelectionsChain&quot;</span><span class="p">])</span>
 1545     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ChainSelectionsInfo&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ChainSelectionsInfo</span>
 1546     
 1547     <span class="n">ChainSelections</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ChainSelectionsInfo&quot;</span><span class="p">][</span><span class="s2">&quot;Names&quot;</span><span class="p">])</span> <span class="k">else</span> <span class="bp">False</span>
 1548     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ChainSelections&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ChainSelections</span>
 1549     
 1550 <span class="k">def</span> <span class="nf">ProcessOptions</span><span class="p">():</span>
 1551     <span class="sd">&quot;&quot;&quot;Process and validate command line arguments and options&quot;&quot;&quot;</span>
 1552     
 1553     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="s2">&quot;Processing options...&quot;</span><span class="p">)</span>
 1554     
 1555     <span class="c1"># Validate options...</span>
 1556     <span class="n">ValidateOptions</span><span class="p">()</span>
 1557     
 1558     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Align&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Yes$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--align&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1559     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AlignMethod&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--alignMethod&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
 1560     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AlignMode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--alignMode&quot;</span><span class="p">]</span>
 1561     
 1562     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AllowEmptyObjects&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Yes$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--allowEmptyObjects&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1563     
 1564     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;BFactorChainCartoonPutty&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Yes$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--BFactorChainCartoonPutty&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1565     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;BFactorColorPalette&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--BFactorColorPalette&quot;</span><span class="p">]</span>
 1566     
 1567     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Infiles&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--infiles&quot;</span><span class="p">]</span>
 1568     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--infileNames&quot;</span><span class="p">]</span>
 1569 
 1570     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;AlignRefFile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--alignRefFile&quot;</span><span class="p">]</span>
 1571     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^FirstInputFile$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--alignRefFile&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1572         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;RefFileName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;InfilesNames&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
 1573     <span class="k">else</span><span class="p">:</span>
 1574         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;RefFileName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--alignRefFile&quot;</span><span class="p">]</span>
 1575     
 1576     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;EDMapFiles&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--EDMapFiles&quot;</span><span class="p">]</span>
 1577     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;EDMapSuffixes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--EDMapSuffixes&quot;</span><span class="p">]</span>
 1578     <span class="n">ProcessEDMapFilesAndSuffixes</span><span class="p">()</span>
 1579 
 1580     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Overwrite&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--overwrite&quot;</span><span class="p">]</span>
 1581     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMLOut&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Yes$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--PMLOut&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1582     
 1583     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Outfile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--outfile&quot;</span><span class="p">]</span>
 1584     <span class="n">FileDir</span><span class="p">,</span> <span class="n">FileName</span><span class="p">,</span> <span class="n">FileExt</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ParseFileName</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Outfile&quot;</span><span class="p">])</span>
 1585     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PSEOut&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span> 
 1586     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^pml$&quot;</span><span class="p">,</span> <span class="n">FileExt</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1587         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMLOutfile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Outfile&quot;</span><span class="p">]</span> 
 1588         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMEOutfile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;.pml$&quot;</span><span class="p">,</span> <span class="s2">&quot;.pme&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Outfile&quot;</span><span class="p">])</span> 
 1589     <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^pse$&quot;</span><span class="p">,</span> <span class="n">FileExt</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1590         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PSEOut&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span> 
 1591         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PSEOutfile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Outfile&quot;</span><span class="p">]</span> 
 1592         <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMLOutfile&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;.pse$&quot;</span><span class="p">,</span> <span class="s2">&quot;.pml&quot;</span><span class="p">,</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Outfile&quot;</span><span class="p">])</span> 
 1593         <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMLOutfile&quot;</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Overwrite&quot;</span><span class="p">]):</span>
 1594             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The intermediate output file to be generated, </span><span class="si">%s</span><span class="s2">, already exist. Use option </span><span class="se">\&quot;</span><span class="s2">--ov</span><span class="se">\&quot;</span><span class="s2"> or </span><span class="se">\&quot;</span><span class="s2">--overwrite</span><span class="se">\&quot;</span><span class="s2"> and try again.&quot;</span> <span class="o">%</span> <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PMLOutfile&quot;</span><span class="p">]</span> <span class="p">)</span>
 1595 
 1596     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;LabelFontID&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--labelFontID&quot;</span><span class="p">])</span>
 1597     
 1598     <span class="c1"># Process mesh parameters...</span>
 1599     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshCarveRadius&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--meshCarveRadius&quot;</span><span class="p">])</span>
 1600     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshComplex&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Yes$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--meshComplex&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1601     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshChainComplex&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--meshChainComplex&quot;</span><span class="p">]</span>
 1602     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshWidth&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--meshWidth&quot;</span><span class="p">])</span>
 1603     
 1604     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshColorCompositeMap&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--meshColorCompositeMap&quot;</span><span class="p">]</span>
 1605     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;MeshLevelCompositeMap&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--meshLevelCompositeMap&quot;</span><span class="p">])</span>
 1606     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Mesh1ColorDiffMap&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--mesh1ColorDiffMap&quot;</span><span class="p">]</span>
 1607     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Mesh1LevelDiffMap&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--mesh1LevelDiffMap&quot;</span><span class="p">])</span>
 1608     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Mesh2ColorDiffMap&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--mesh2ColorDiffMap&quot;</span><span class="p">]</span>
 1609     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;Mesh2LevelDiffMap&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--mesh2LevelDiffMap&quot;</span><span class="p">])</span>
 1610     
 1611     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SelectionsChain&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--selectionsChain&quot;</span><span class="p">]</span>
 1612     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SelectionsChainStyle&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--selectionsChainStyle&quot;</span><span class="p">]</span>
 1613     <span class="n">ProcessChainSelections</span><span class="p">()</span>
 1614     
 1615     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceComplex&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Yes$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceComplex&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1616     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceChainComplex&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceChainComplex&quot;</span><span class="p">]</span>
 1617     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;SurfaceTransparency&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceTransparency&quot;</span><span class="p">])</span>
 1618     
 1619     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketContactsLigandColor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketContactsLigandColor&quot;</span><span class="p">]</span>
 1620     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketContactsLigandHydrophobicColor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketContactsLigandHydrophobicColor&quot;</span><span class="p">]</span>
 1621     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketContactsSolventColor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketContactsSolventColor&quot;</span><span class="p">]</span>
 1622     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketContactsInorganicColor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketContactsInorganicColor&quot;</span><span class="p">]</span>
 1623     
 1624     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketContactsCutoff&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketContactsCutoff&quot;</span><span class="p">])</span>
 1625     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketDistanceCutoff&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketDistanceCutoff&quot;</span><span class="p">])</span>
 1626     
 1627     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketLabelColor&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketLabelColor&quot;</span><span class="p">]</span>
 1628     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;PocketSurface&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Yes$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketSurface&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1629     
 1630     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;VolumeCarveRadius&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--volumeCarveRadius&quot;</span><span class="p">])</span>
 1631     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;VolumeComplex&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span> <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^Yes$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--volumeComplex&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">)</span> <span class="k">else</span> <span class="bp">False</span>
 1632     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;VolumeChainComplex&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--volumeChainComplex&quot;</span><span class="p">]</span>
 1633     
 1634     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;VolumeColorRampCompositeMap&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--volumeColorRampCompositeMap&quot;</span><span class="p">]</span>
 1635     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;VolumeColorRampDiffMap&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--volumeColorRampDiffMap&quot;</span><span class="p">]</span>
 1636     
 1637     <span class="n">RetrieveInfilesInfo</span><span class="p">()</span>
 1638     <span class="n">RetrieveRefFileInfo</span><span class="p">()</span>
 1639     
 1640     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;ChainIDs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--chainIDs&quot;</span><span class="p">]</span>
 1641     <span class="n">OptionsInfo</span><span class="p">[</span><span class="s2">&quot;LigandIDs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--ligandIDs&quot;</span><span class="p">]</span>
 1642     
 1643     <span class="n">ProcessChainAndLigandIDs</span><span class="p">()</span>
 1644 
 1645 <span class="k">def</span> <span class="nf">RetrieveOptions</span><span class="p">():</span> 
 1646     <span class="sd">&quot;&quot;&quot;Retrieve command line arguments and options&quot;&quot;&quot;</span>
 1647     
 1648     <span class="c1"># Get options...</span>
 1649     <span class="k">global</span> <span class="n">Options</span>
 1650     <span class="n">Options</span> <span class="o">=</span> <span class="n">docopt</span><span class="p">(</span><span class="n">_docoptUsage_</span><span class="p">)</span>
 1651     
 1652     <span class="c1"># Set current working directory to the specified directory...</span>
 1653     <span class="n">WorkingDir</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--workingdir&quot;</span><span class="p">]</span>
 1654     <span class="k">if</span> <span class="n">WorkingDir</span><span class="p">:</span>
 1655         <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">WorkingDir</span><span class="p">)</span>
 1656     
 1657     <span class="c1"># Handle examples option...</span>
 1658     <span class="k">if</span> <span class="s2">&quot;--examples&quot;</span> <span class="ow">in</span> <span class="n">Options</span> <span class="ow">and</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--examples&quot;</span><span class="p">]:</span>
 1659         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintInfo</span><span class="p">(</span><span class="n">MiscUtil</span><span class="o">.</span><span class="n">GetExamplesTextFromDocOptText</span><span class="p">(</span><span class="n">_docoptUsage_</span><span class="p">))</span>
 1660         <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
 1661 
 1662 <span class="k">def</span> <span class="nf">ValidateOptions</span><span class="p">():</span>
 1663     <span class="sd">&quot;&quot;&quot;Validate option values&quot;&quot;&quot;</span>
 1664     
 1665     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--align&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--align&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
 1666     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--alignMethod&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--alignMethod&quot;</span><span class="p">],</span> <span class="s2">&quot;align cealign super&quot;</span><span class="p">)</span>
 1667     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--alignMode&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--alignMode&quot;</span><span class="p">],</span> <span class="s2">&quot;FirstChain Complex&quot;</span><span class="p">)</span>
 1668     
 1669     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--allowEmptyObjects&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--allowEmptyObjects&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
 1670     
 1671     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--BFactorChainCartoonPutty&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--BFactorChainCartoonPutty&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
 1672     
 1673     <span class="c1"># Expand infiles to handle presence of multiple input files...</span>
 1674     <span class="n">InfileNames</span> <span class="o">=</span> <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ExpandFileNames</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--infiles&quot;</span><span class="p">],</span> <span class="s2">&quot;,&quot;</span><span class="p">)</span>
 1675     <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">InfileNames</span><span class="p">):</span>
 1676         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;No input files specified for </span><span class="se">\&quot;</span><span class="s2">-i, --infiles</span><span class="se">\&quot;</span><span class="s2"> option&quot;</span><span class="p">)</span>
 1677 
 1678     <span class="c1"># Validate file extensions...</span>
 1679     <span class="k">for</span> <span class="n">Infile</span> <span class="ow">in</span> <span class="n">InfileNames</span><span class="p">:</span>
 1680         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFilePath</span><span class="p">(</span><span class="s2">&quot;-i, --infiles&quot;</span><span class="p">,</span> <span class="n">Infile</span><span class="p">)</span>
 1681         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFileExt</span><span class="p">(</span><span class="s2">&quot;-i, --infiles&quot;</span><span class="p">,</span> <span class="n">Infile</span><span class="p">,</span> <span class="s2">&quot;pdb cif&quot;</span><span class="p">)</span>
 1682         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionsDistinctFileNames</span><span class="p">(</span><span class="s2">&quot;-i, --infiles&quot;</span><span class="p">,</span> <span class="n">Infile</span><span class="p">,</span> <span class="s2">&quot;-o, --outfile&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--outfile&quot;</span><span class="p">])</span>
 1683     <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--infileNames&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">InfileNames</span>
 1684     
 1685     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFileExt</span><span class="p">(</span><span class="s2">&quot;-o, --outfile&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--outfile&quot;</span><span class="p">],</span> <span class="s2">&quot;pml pse&quot;</span><span class="p">)</span>
 1686     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionsOutputFileOverwrite</span><span class="p">(</span><span class="s2">&quot;-o, --outfile&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--outfile&quot;</span><span class="p">],</span> <span class="s2">&quot;--overwrite&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--overwrite&quot;</span><span class="p">])</span>
 1687     
 1688     <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^yes$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--align&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1689         <span class="k">if</span> <span class="ow">not</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="s2">&quot;^FirstInputFile$&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--alignRefFile&quot;</span><span class="p">],</span> <span class="n">re</span><span class="o">.</span><span class="n">I</span><span class="p">):</span>
 1690             <span class="n">AlignRefFile</span> <span class="o">=</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--alignRefFile&quot;</span><span class="p">]</span>
 1691             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFilePath</span><span class="p">(</span><span class="s2">&quot;--alignRefFile&quot;</span><span class="p">,</span> <span class="n">AlignRefFile</span><span class="p">)</span>
 1692             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFileExt</span><span class="p">(</span><span class="s2">&quot;--alignRefFile&quot;</span><span class="p">,</span> <span class="n">AlignRefFile</span><span class="p">,</span> <span class="s2">&quot;pdb cif&quot;</span><span class="p">)</span>
 1693             <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionsDistinctFileNames</span><span class="p">(</span><span class="s2">&quot;--AlignRefFile&quot;</span><span class="p">,</span> <span class="n">AlignRefFile</span><span class="p">,</span> <span class="s2">&quot;-o, --outfile&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--outfile&quot;</span><span class="p">])</span>
 1694     
 1695     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--PMLOut&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--PMLOut&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
 1696     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionIntegerValue</span><span class="p">(</span><span class="s2">&quot;--labelFontID&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--labelFontID&quot;</span><span class="p">],</span> <span class="p">{})</span>
 1697 
 1698     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFloatValue</span><span class="p">(</span><span class="s2">&quot;--meshCarveRadius&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--meshCarveRadius&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s2">&quot;&gt;&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">})</span>
 1699     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--meshComplex&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--meshComplex&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
 1700     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--meshChainComplex&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--meshChainComplex&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no auto&quot;</span><span class="p">)</span>
 1701     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFloatValue</span><span class="p">(</span><span class="s2">&quot;--meshWidth&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--meshWidth&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s2">&quot;&gt;&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">})</span>
 1702     
 1703     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFloatValue</span><span class="p">(</span><span class="s2">&quot;--meshLevelCompositeMap&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--meshLevelCompositeMap&quot;</span><span class="p">],</span> <span class="p">{})</span>
 1704     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFloatValue</span><span class="p">(</span><span class="s2">&quot;--mesh1LevelDiffMap&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--mesh1LevelDiffMap&quot;</span><span class="p">],</span> <span class="p">{})</span>
 1705     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFloatValue</span><span class="p">(</span><span class="s2">&quot;--mesh2LevelDiffMap&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--mesh2LevelDiffMap&quot;</span><span class="p">],</span> <span class="p">{})</span>
 1706     
 1707     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--surfaceComplex&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceComplex&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
 1708     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--surfaceChainComplex&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceChainComplex&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no auto&quot;</span><span class="p">)</span>
 1709     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFloatValue</span><span class="p">(</span><span class="s2">&quot;--surfaceTransparency&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--surfaceTransparency&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s2">&quot;&gt;=&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s2">&quot;&lt;=&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">})</span>
 1710     
 1711     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFloatValue</span><span class="p">(</span><span class="s2">&quot;--pocketContactsCutoff&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketContactsCutoff&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s2">&quot;&gt;&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">})</span>
 1712     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFloatValue</span><span class="p">(</span><span class="s2">&quot;--pocketDistanceCutoff&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketDistanceCutoff&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s2">&quot;&gt;&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">})</span>
 1713     <span class="k">if</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketContactsCutoff&quot;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="nb">float</span><span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketDistanceCutoff&quot;</span><span class="p">])):</span>
 1714         <span class="n">MiscUtil</span><span class="o">.</span><span class="n">PrintError</span><span class="p">(</span><span class="s2">&quot;The value, </span><span class="si">%s</span><span class="s2">, specified using option </span><span class="se">\&quot;</span><span class="s2">--pocketContactsCutoff</span><span class="se">\&quot;</span><span class="s2"> must be less than value, </span><span class="si">%s</span><span class="s2">, specified using </span><span class="se">\&quot;</span><span class="s2">-pocketDistanceCutoff</span><span class="se">\&quot;</span><span class="s2"> option.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketContactsCutoff&quot;</span><span class="p">],</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketDistanceCutoff&quot;</span><span class="p">]))</span>
 1715     
 1716     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--pocketSurface&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--pocketSurface&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
 1717     
 1718     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionFloatValue</span><span class="p">(</span><span class="s2">&quot;--volumeCarveRadius&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--volumeCarveRadius&quot;</span><span class="p">],</span> <span class="p">{</span><span class="s2">&quot;&gt;&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">})</span>
 1719     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--volumeComplex&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--volumeComplex&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no&quot;</span><span class="p">)</span>
 1720     <span class="n">MiscUtil</span><span class="o">.</span><span class="n">ValidateOptionTextValue</span><span class="p">(</span><span class="s2">&quot;--volumeChainComplex&quot;</span><span class="p">,</span> <span class="n">Options</span><span class="p">[</span><span class="s2">&quot;--volumeChainComplex&quot;</span><span class="p">],</span> <span class="s2">&quot;yes no auto&quot;</span><span class="p">)</span>
 1721     
 1722 <span class="c1"># Setup a usage string for docopt...</span>
 1723 <span class="n">_docoptUsage_</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
 1724 <span class="s2">PyMOLVisualizeElectronDensity.py - Visualize electron density</span>
 1725 
 1726 <span class="s2">Usage:</span>
 1727 <span class="s2">    PyMOLVisualizeElectronDensity.py  [--align &lt;yes or no&gt;] [--alignMethod &lt;align, cealign, super&gt;]</span>
 1728 <span class="s2">                                     [--alignMode &lt;FirstChain or Complex&gt;] [--alignRefFile &lt;filename&gt;]</span>
 1729 <span class="s2">                                     [--allowEmptyObjects &lt;yes or no&gt;] [--BFactorChainCartoonPutty &lt;yes or no&gt;]</span>
 1730 <span class="s2">                                     [--BFactorColorPalette &lt;text&gt; ] [--chainIDs &lt;First, All or ID1,ID2...&gt;]</span>
 1731 <span class="s2">                                     [--EDMapFiles &lt;file1,file2,...&gt;] [--EDMapSuffixes &lt;CompositeMap,None,...&gt;]</span>
 1732 <span class="s2">                                     [--ligandIDs &lt;Largest, All or ID1,ID2...&gt;] [--labelFontID &lt;number&gt;]</span>
 1733 <span class="s2">                                     [--meshCarveRadius &lt;number&gt;] [--meshComplex &lt;yes or no&gt;]</span>
 1734 <span class="s2">                                     [--meshChainComplex &lt;yes or no&gt;] [--meshColorCompositeMap &lt;text&gt;]</span>
 1735 <span class="s2">                                     [--meshLevelCompositeMap &lt;number&gt;] [--meshWidth &lt;number&gt;]</span>
 1736 <span class="s2">                                     [--mesh1ColorDiffMap &lt;text&gt;] [--mesh1LevelDiffMap &lt;number&gt;]</span>
 1737 <span class="s2">                                     [--mesh2ColorDiffMap &lt;text&gt;] [--mesh2LevelDiffMap &lt;number&gt;]</span>
 1738 <span class="s2">                                     [--PMLOut &lt;yes or no&gt;] [--pocketContactsLigandColor &lt;text&gt;]</span>
 1739 <span class="s2">                                     [--pocketContactsLigandHydrophobicColor &lt;text&gt;] [--pocketContactsSolventColor &lt;text&gt;]</span>
 1740 <span class="s2">                                     [--pocketContactsInorganicColor &lt;text&gt;] [--pocketContactsCutoff &lt;number&gt;]</span>
 1741 <span class="s2">                                     [--pocketDistanceCutoff &lt;number&gt;] [--pocketLabelColor &lt;text&gt;] [--pocketSurface &lt;yes or no&gt;]</span>
 1742 <span class="s2">                                     [--selectionsChain &lt;ObjectName,SelectionSpec,...&gt;] [--selectionsChainStyle &lt;DisplayStyle&gt;]</span>
 1743 <span class="s2">                                     [--surfaceComplex &lt;yes or no&gt; ] [--surfaceChainComplex &lt;yes or no&gt;] [--surfaceTransparency &lt;number&gt;]</span>
 1744 <span class="s2">                                     [--volumeCarveRadius &lt;number&gt;] [--volumeComplex &lt;yes or no&gt;]</span>
 1745 <span class="s2">                                     [--volumeChainComplex &lt;yes, no, or auto&gt;] [--volumeColorRampCompositeMap &lt;text&gt;]</span>
 1746 <span class="s2">                                     [--volumeColorRampDiffMap &lt;text&gt; ] [--overwrite] [-w &lt;dir&gt;] -i &lt;infile1,infile2...&gt; -o &lt;outfile&gt;</span>
 1747 <span class="s2">    PyMOLVisualizeElectronDensity.py -h | --help | -e | --examples</span>
 1748 
 1749 <span class="s2">Description:</span>
 1750 <span class="s2">    Generate PyMOL visualization files for viewing X-ray electron density around</span>
 1751 <span class="s2">    chains, ligands, and ligand binding pockets in macromolecules including proteins</span>
 1752 <span class="s2">    and nucleic acids.</span>
 1753 
 1754 <span class="s2">    The supported input file formats are: Macromolecule - PDB (.pdb) or CIF(.cif),</span>
 1755 <span class="s2">    Electron Density - Collaborative Computational Project Number 4 (CCP4) ( .ccp4)</span>
 1756 
 1757 <span class="s2">    The supported output file formats are: PyMOL script file (.pml), PyMOL session</span>
 1758 <span class="s2">    file (.pse)</span>
 1759 
 1760 <span class="s2">    Two types of CCP4 electron density map files may be used for visualizing electron</span>
 1761 <span class="s2">    density. These file types along with default file names are shown below:</span>
 1762 <span class="s2">    </span>
 1763 <span class="s2">        CompositeMap (2Fobs - Fcalc) - &lt;InfileRoot&gt;.ccp4 (required)</span>
 1764 <span class="s2">        DifferenceMap (Fobs - Fcalc) - &lt;InfileRoot&gt;_diff.ccp4 (optional)</span>
 1765 <span class="s2">    </span>
 1766 <span class="s2">    The compsite map file must be present. The difference map file is optional.</span>
 1767 <span class="s2">    The mesh, volume, and surface PyMOL objects are not generated for missing</span>
 1768 <span class="s2">    difference map file.</span>
 1769 
 1770 <span class="s2">    The electron density present in a composite map file is generated by adding two</span>
 1771 <span class="s2">    difference maps to a calculated map (Fcalc) as shown below:</span>
 1772 <span class="s2">    </span>
 1773 <span class="s2">        Fcalc + 2(Fobs - Fcalc) = 2Fobs - Fcalc</span>
 1774 <span class="s2">    </span>
 1775 <span class="s2">    The following types of meshes and volumes may be created by default for</span>
 1776 <span class="s2">    electron density present in composite and difference map files:</span>
 1777 <span class="s2">    </span>
 1778 <span class="s2">        CompositeVolume - VolumeColorRamp: 2fofc</span>
 1779 <span class="s2">        CompositeMesh - ContourLevel: 1; Color: Blue</span>
 1780 <span class="s2">        DiffVolume - VolumeColorRamp: fofc</span>
 1781 <span class="s2">        DiffMesh1 - ContourLevel: 3; Color: Green</span>
 1782 <span class="s2">        DiffMesh2 - ContourLevel: -3; Color: Red</span>
 1783 
 1784 <span class="s2">    The two meshes created for difference maps correspond to false negative and</span>
 1785 <span class="s2">    false positive in terms of electron density present in the model. The first mesh</span>
 1786 <span class="s2">    shown in  green color corresponds to observed electron density missing in the</span>
 1787 <span class="s2">    model. The second mesh in in red color indicates model electron density not</span>
 1788 <span class="s2">    observed in the experiment.</span>
 1789 <span class="s2">    </span>
 1790 <span class="s2">    A variety of PyMOL groups and objects may be  created for visualization of</span>
 1791 <span class="s2">    electron density present in map files. These groups and objects correspond to</span>
 1792 <span class="s2">    maps, volumes, meshes, surfaces,chains, ligands, inorganics, ligand binding</span>
 1793 <span class="s2">    pockets, polar interactions, and pocket hydrophobic surfaces. A complete</span>
 1794 <span class="s2">    hierarchy of all possible PyMOL groups and objects is shown below:</span>
 1795 <span class="s2">    </span>
 1796 <span class="s2">        &lt;PDBFileRoot&gt;</span>
 1797 <span class="s2">            .Complex</span>
 1798 <span class="s2">                .Complex</span>
 1799 <span class="s2">                .2Fo-Fc</span>
 1800 <span class="s2">                    .Map</span>
 1801 <span class="s2">                    .Volume</span>
 1802 <span class="s2">                    .Mesh</span>
 1803 <span class="s2">                    .Surface</span>
 1804 <span class="s2">                .Fo-Fc</span>
 1805 <span class="s2">                    .Map</span>
 1806 <span class="s2">                    .Volume</span>
 1807 <span class="s2">                    .Mesh1</span>
 1808 <span class="s2">                    .Surface1</span>
 1809 <span class="s2">                    .Mesh2</span>
 1810 <span class="s2">                    .Surface2</span>
 1811 <span class="s2">            .Chain&lt;ID&gt;</span>
 1812 <span class="s2">                .Complex</span>
 1813 <span class="s2">                    .Complex</span>
 1814 <span class="s2">                    .2Fo-Fc</span>
 1815 <span class="s2">                        .Volume</span>
 1816 <span class="s2">                        .Mesh</span>
 1817 <span class="s2">                        .Surface</span>
 1818 <span class="s2">                    .Fo-Fc</span>
 1819 <span class="s2">                        .Volume</span>
 1820 <span class="s2">                        .Mesh1</span>
 1821 <span class="s2">                        .Surface1</span>
 1822 <span class="s2">                        .Mesh2</span>
 1823 <span class="s2">                        .Surface2</span>
 1824 <span class="s2">                .Chain</span>
 1825 <span class="s2">                    .Chain</span>
 1826 <span class="s2">                    .BFactor</span>
 1827 <span class="s2">                    .Selections</span>
 1828 <span class="s2">                        .&lt;Name1&gt;</span>
 1829 <span class="s2">                            .Selection</span>
 1830 <span class="s2">                            .2Fo-Fc</span>
 1831 <span class="s2">                                .Volume</span>
 1832 <span class="s2">                                .Mesh</span>
 1833 <span class="s2">                                .Surface</span>
 1834 <span class="s2">                            .Fo-Fc</span>
 1835 <span class="s2">                                .Volume</span>
 1836 <span class="s2">                                .Mesh1</span>
 1837 <span class="s2">                                .Surface1</span>
 1838 <span class="s2">                                .Mesh2</span>
 1839 <span class="s2">                                .Surface2</span>
 1840 <span class="s2">                        .&lt;Name2&gt;</span>
 1841 <span class="s2">                            ... ... ..</span>
 1842 <span class="s2">                .Solvent</span>
 1843 <span class="s2">                .Inorganic</span>
 1844 <span class="s2">                .Ligand&lt;ID&gt;</span>
 1845 <span class="s2">                    .Ligand</span>
 1846 <span class="s2">                        .Ligand</span>
 1847 <span class="s2">                        .2Fo-Fc</span>
 1848 <span class="s2">                            .Volume</span>
 1849 <span class="s2">                            .Mesh</span>
 1850 <span class="s2">                            .Surface</span>
 1851 <span class="s2">                        .Fo-Fc</span>
 1852 <span class="s2">                            .Volume</span>
 1853 <span class="s2">                            .Mesh1</span>
 1854 <span class="s2">                            .Surface1</span>
 1855 <span class="s2">                            .Mesh2</span>
 1856 <span class="s2">                            .Surface2</span>
 1857 <span class="s2">                    .Pocket</span>
 1858 <span class="s2">                        .Pocket</span>
 1859 <span class="s2">                        .2Fo-Fc</span>
 1860 <span class="s2">                            .Volume</span>
 1861 <span class="s2">                            .Mesh</span>
 1862 <span class="s2">                            .Surface</span>
 1863 <span class="s2">                        .Fo-Fc</span>
 1864 <span class="s2">                            .Volume</span>
 1865 <span class="s2">                            .Mesh1</span>
 1866 <span class="s2">                            .Surface1</span>
 1867 <span class="s2">                            .Mesh2</span>
 1868 <span class="s2">                            .Surface2</span>
 1869 <span class="s2">                        .Polar_Contacts</span>
 1870 <span class="s2">                        .Hydrophobic_Contacts</span>
 1871 <span class="s2">                        .Surface</span>
 1872 <span class="s2">                    .Pocket_Solvent</span>
 1873 <span class="s2">                        .Pocket_Solvent</span>
 1874 <span class="s2">                        .2Fo-Fc</span>
 1875 <span class="s2">                            .Volume</span>
 1876 <span class="s2">                            .Mesh</span>
 1877 <span class="s2">                            .Surface</span>
 1878 <span class="s2">                        .Fo-Fc</span>
 1879 <span class="s2">                            .Volume</span>
 1880 <span class="s2">                            .Mesh1</span>
 1881 <span class="s2">                            .Surface1</span>
 1882 <span class="s2">                            .Mesh2</span>
 1883 <span class="s2">                            .Surface2</span>
 1884 <span class="s2">                        .Polar_Contacts</span>
 1885 <span class="s2">                    .Pocket_Inorganic</span>
 1886 <span class="s2">                        .Pocket_Inorganic</span>
 1887 <span class="s2">                        .2Fo-Fc</span>
 1888 <span class="s2">                            .Volume</span>
 1889 <span class="s2">                            .Mesh</span>
 1890 <span class="s2">                            .Surface</span>
 1891 <span class="s2">                        .Fo-Fc</span>
 1892 <span class="s2">                            .Volume</span>
 1893 <span class="s2">                            .Mesh1</span>
 1894 <span class="s2">                            .Surface1</span>
 1895 <span class="s2">                            .Mesh2</span>
 1896 <span class="s2">                            .Surface2</span>
 1897 <span class="s2">                        .Polar_Contacts</span>
 1898 <span class="s2">                .Ligand&lt;ID&gt;</span>
 1899 <span class="s2">                    .Ligand</span>
 1900 <span class="s2">                        ... ... ...</span>
 1901 <span class="s2">                    .Pocket</span>
 1902 <span class="s2">                        ... ... ...</span>
 1903 <span class="s2">                    .Pocket_Solvent</span>
 1904 <span class="s2">                        ... ... ...</span>
 1905 <span class="s2">                    .Pocket_Inorganic</span>
 1906 <span class="s2">                        ... ... ...</span>
 1907 <span class="s2">            .Chain&lt;ID&gt;</span>
 1908 <span class="s2">                ... ... ...</span>
 1909 <span class="s2">                .Ligand&lt;ID&gt;</span>
 1910 <span class="s2">                    ... ... ...</span>
 1911 <span class="s2">                .Ligand&lt;ID&gt;</span>
 1912 <span class="s2">                    ... ... ...</span>
 1913 <span class="s2">            .Chain&lt;ID&gt;</span>
 1914 <span class="s2">                ... ... ...</span>
 1915 <span class="s2">        &lt;PDBFileRoot&gt;</span>
 1916 <span class="s2">            .Complex</span>
 1917 <span class="s2">                ... ... ...</span>
 1918 <span class="s2">            .Chain&lt;ID&gt;</span>
 1919 <span class="s2">                ... ... ...</span>
 1920 <span class="s2">                .Ligand&lt;ID&gt;</span>
 1921 <span class="s2">                    ... ... ...</span>
 1922 <span class="s2">                .Ligand&lt;ID&gt;</span>
 1923 <span class="s2">                    ... ... ...</span>
 1924 <span class="s2">            .Chain&lt;ID&gt;</span>
 1925 <span class="s2">                ... ... ...</span>
 1926 <span class="s2">    </span>
 1927 <span class="s2">    The meshes, volumes, and surfaces  are not created for complete complex in</span>
 1928 <span class="s2">    each input file by default. A word to the wise: The creation of these surface, volume,</span>
 1929 <span class="s2">    and mesh objects may slow down loading of PML file and generation of PSE file,</span>
 1930 <span class="s2">    based on the size of input complex and map files. The generation of PSE file</span>
 1931 <span class="s2">    may also fail.</span>
 1932 
 1933 <span class="s2">Options:</span>
 1934 <span class="s2">    -a, --align &lt;yes or no&gt;  [default: no]</span>
 1935 <span class="s2">        Align input files to a reference file before visualization along with</span>
 1936 <span class="s2">        available electron density map files.</span>
 1937 <span class="s2">    --alignMethod &lt;align, cealign, super&gt;  [default: super]</span>
 1938 <span class="s2">        Alignment methodology to use for aligning input files to a</span>
 1939 <span class="s2">        reference file.</span>
 1940 <span class="s2">    --alignMode &lt;FirstChain or Complex&gt;  [default: FirstChain]</span>
 1941 <span class="s2">        Portion of input and reference files to use for spatial alignment of</span>
 1942 <span class="s2">        input files against reference file.  Possible values: FirstChain or</span>
 1943 <span class="s2">        Complex.</span>
 1944 <span class="s2">        </span>
 1945 <span class="s2">        The FirstChain mode allows alignment of the first chain in each input</span>
 1946 <span class="s2">        file to the first chain in the reference file along with moving the rest</span>
 1947 <span class="s2">        of the complex to coordinate space of the reference file. The complete</span>
 1948 <span class="s2">        complex in each input file is aligned to the complete complex in reference</span>
 1949 <span class="s2">        file for the Complex mode.</span>
 1950 <span class="s2">    --alignRefFile &lt;filename&gt;  [default: FirstInputFile]</span>
 1951 <span class="s2">        Reference input file name. The default is to use the first input file</span>
 1952 <span class="s2">        name specified using &#39;-i, --infiles&#39; option.</span>
 1953 <span class="s2">    --allowEmptyObjects &lt;yes or no&gt;  [default: no]</span>
 1954 <span class="s2">        Allow creation of empty PyMOL objects corresponding to solvent and</span>
 1955 <span class="s2">        inorganic atom selections across chains, ligands, and ligand binding pockets</span>
 1956 <span class="s2">        in input file(s).</span>
 1957 <span class="s2">    -c, --chainIDs &lt;First, All or ID1,ID2...&gt;  [default: First]</span>
 1958 <span class="s2">        List of chain IDs to use for visualizing electron density. Possible values:</span>
 1959 <span class="s2">        First, All, or a comma delimited list of chain IDs. The default is to use the</span>
 1960 <span class="s2">        chain ID for the first chain in each input file.</span>
 1961 <span class="s2">    -b, --BFactorChainCartoonPutty &lt;yes or no&gt;  [default: yes]</span>
 1962 <span class="s2">        A cartoon putty around individual chains colored by B factors. The minimum</span>
 1963 <span class="s2">        and maximum values for B factors are automatically detected. These values</span>
 1964 <span class="s2">        indicate spread of electron density around atoms. The &#39;blue_white_red&#39; color</span>
 1965 <span class="s2">        palette is deployed for coloring the cartoon putty.</span>
 1966 <span class="s2">    --BFactorColorPalette &lt;text&gt;  [default: blue_white_red]</span>
 1967 <span class="s2">        Color palette for coloring cartoon putty around chains generated using B</span>
 1968 <span class="s2">        factors. Any valid PyMOL color palette name is allowed. No validation is</span>
 1969 <span class="s2">        performed. The complete list of valid color palette names is a available</span>
 1970 <span class="s2">        at: pymolwiki.org/index.php/Spectrum. Examples: blue_white_red,</span>
 1971 <span class="s2">        blue_white_magenta, blue_red, green_white_red, green_red.</span>
 1972 <span class="s2">    -e, --examples</span>
 1973 <span class="s2">        Print examples.</span>
 1974 <span class="s2">    --EDMapFiles &lt;file1,file1,file3...&gt;  [default: auto]</span>
 1975 <span class="s2">        Pairwise comma delimited list of composite and difference electron</span>
 1976 <span class="s2">        density map files corresponding to input files. By default, the names</span>
 1977 <span class="s2">        of electron density files are automatically generated using a combination</span>
 1978 <span class="s2">        of input file names and file suffixes &#39;--EDMapSuffixes&#39;.</span>
 1979 <span class="s2">        </span>
 1980 <span class="s2">        The first file with in each pairs of filenames correspond to composite</span>
 1981 <span class="s2">        electron density map. A composite file must be present for each input</span>
 1982 <span class="s2">        file. The second file corresponds to difference electron density map. The</span>
 1983 <span class="s2">        difference map file is optional. A value of &#39;None&#39; must be used to represent</span>
 1984 <span class="s2">        a missing difference map file. </span>
 1985 <span class="s2">        </span>
 1986 <span class="s2">        The number of specified files must be twice the number of input files.</span>
 1987 <span class="s2">    --EDMapSuffixes &lt;CompositeMap,None,...&gt;  [default: auto]</span>
 1988 <span class="s2">        Electron density map file suffixes for generating names of map files from</span>
 1989 <span class="s2">        the root of input files. It is a pairwise comma delimited list of &#39;EDMapType&#39;</span>
 1990 <span class="s2">        and file suffix.</span>
 1991 <span class="s2">        </span>
 1992 <span class="s2">        This option is ignored during explicit specification of electron density</span>
 1993 <span class="s2">        map files using &#39;--EDMapFiles&#39;.</span>
 1994 <span class="s2">        </span>
 1995 <span class="s2">        Supported values for &#39;EDMapType&#39;: &#39;CompositeMap, DifferenceMap&#39;.</span>
 1996 <span class="s2">        Supported value for file suffix: Any valid string.</span>
 1997 <span class="s2">        </span>
 1998 <span class="s2">        Default value: &#39;CompositeMap,None,DifferenceMap,_diff&#39;</span>
 1999 <span class="s2">        </span>
 2000 <span class="s2">        This option is only used for &#39;Auto&#39; value of &#39;--EDMapFilesMode&#39; option.</span>
 2001 <span class="s2">        </span>
 2002 <span class="s2">        The default names of the map files, generated form a combination of</span>
 2003 <span class="s2">        &#39;InfileRoot&#39; and &#39;EDSMapType&#39; are shown below:</span>
 2004 <span class="s2">            </span>
 2005 <span class="s2">            CompositeMap (2Fobs - Fcalc) - &lt;InfileRoot&gt;.ccp4</span>
 2006 <span class="s2">            DifferenceMap (Fobs - Fcalc) - &lt;InfileRoot&gt;_diff.ccp4</span>
 2007 <span class="s2">            </span>
 2008 <span class="s2">        The composite map files must be present. The difference map files are</span>
 2009 <span class="s2">        optional.</span>
 2010 <span class="s2">    -h, --help</span>
 2011 <span class="s2">        Print this help message.</span>
 2012 <span class="s2">    -i, --infiles &lt;infile1,infile2,infile3...&gt;</span>
 2013 <span class="s2">        Input file names.</span>
 2014 <span class="s2">    -l, --ligandIDs &lt;Largest, All or ID1,ID2...&gt;  [default: Largest]</span>
 2015 <span class="s2">        List of ligand IDs present in chains for visualizing electron density across</span>
 2016 <span class="s2">        ligands and ligand binding pockets. Possible values: Largest, All, or a comma</span>
 2017 <span class="s2">        delimited list of ligand IDs. The default is to use the largest ligand present</span>
 2018 <span class="s2">        in all or specified chains in each input file.</span>
 2019 <span class="s2">        </span>
 2020 <span class="s2">        Ligands are identified using organic selection operator available in PyMOL.</span>
 2021 <span class="s2">        It&#39;ll also  identify buffer molecules as ligands. The largest ligand contains</span>
 2022 <span class="s2">        the highest number of heavy atoms.</span>
 2023 <span class="s2">    --labelFontID &lt;number&gt;  [default: 7]</span>
 2024 <span class="s2">        Font ID for drawing labels. Default: 7 (Sans Bold). Valid values: 5 to 16.</span>
 2025 <span class="s2">        The specified value must be a valid PyMOL font ID. No validation is</span>
 2026 <span class="s2">        performed. The complete lists of valid font IDs is available at:</span>
 2027 <span class="s2">        pymolwiki.org/index.php/Label_font_id. Examples: 5 - Sans;</span>
 2028 <span class="s2">        7 - Sans Bold; 9 - Serif; 10 - Serif Bold.</span>
 2029 <span class="s2">    --meshCarveRadius &lt;number&gt;  [default: 1.6]</span>
 2030 <span class="s2">        Radius in Angstroms around atoms for including electron density.</span>
 2031 <span class="s2">    --meshComplex &lt;yes or no&gt;  [default: no]</span>
 2032 <span class="s2">        Create meshes for complete complex in each input file using corresponding</span>
 2033 <span class="s2">        composite and difference maps. A total of three meshes, one for composite</span>
 2034 <span class="s2">        map and two for difference map, are created for the complete complex.</span>
 2035 <span class="s2">        </span>
 2036 <span class="s2">        The composite and difference maps are always loaded for the complex.</span>
 2037 <span class="s2">    --meshChainComplex &lt;yes, no, or auto&gt;  [default: auto]</span>
 2038 <span class="s2">        Create meshes for individual chain complex in each input file using corresponding</span>
 2039 <span class="s2">        composite and difference maps. A total of three meshes, one for composite map</span>
 2040 <span class="s2">        map and two for difference map, are created for each chain complex. By default,</span>
 2041 <span class="s2">        the meshes are automatically created for chain complexes without any ligands. </span>
 2042 <span class="s2">    --meshColorCompositeMap &lt;text&gt;  [default: blue]</span>
 2043 <span class="s2">        Line color for meshes corresponding to composite maps. The specified value</span>
 2044 <span class="s2">        must be valid color. No validation is performed.</span>
 2045 <span class="s2">    --meshLevelCompositeMap &lt;number&gt;  [default: 1.0]</span>
 2046 <span class="s2">        Contour level in sigma units for generating meshes corresponding to composite</span>
 2047 <span class="s2">        maps.</span>
 2048 <span class="s2">    --meshWidth &lt;number&gt;  [default: 0.5]</span>
 2049 <span class="s2">        Line width for mesh lines corresponding to composite and difference maps.</span>
 2050 <span class="s2">    --mesh1ColorDiffMap &lt;text&gt;  [default: green]</span>
 2051 <span class="s2">        Line color for first mesh corresponding to difference maps at contour level</span>
 2052 <span class="s2">        specified by &#39;--mesh1LevelDiffMap&#39;. The specified value must be valid color.</span>
 2053 <span class="s2">        No validation is performed.</span>
 2054 <span class="s2">    --mesh1LevelDiffMap &lt;number&gt;  [default: 3.0]</span>
 2055 <span class="s2">        Contour level in sigma units for generating first mesh corresponding to </span>
 2056 <span class="s2">        to  difference maps.</span>
 2057 <span class="s2">    --mesh2ColorDiffMap &lt;text&gt;  [default: red]</span>
 2058 <span class="s2">        Line color for second mesh corresponding to difference maps at contour level</span>
 2059 <span class="s2">        specified by &#39;--mesh2LevelDiffMap&#39;. The specified value must be valid color.</span>
 2060 <span class="s2">        No validation is performed.</span>
 2061 <span class="s2">    --mesh2LevelDiffMap &lt;number&gt;  [default: -3.0]</span>
 2062 <span class="s2">        Contour level in sigma units for generating second mesh corresponding to</span>
 2063 <span class="s2">        difference maps.</span>
 2064 <span class="s2">    -o, --outfile &lt;outfile&gt;</span>
 2065 <span class="s2">        Output file name.</span>
 2066 <span class="s2">    -p, --PMLOut &lt;yes or no&gt;  [default: yes]</span>
 2067 <span class="s2">        Save PML file during generation of PSE file.</span>
 2068 <span class="s2">    --pocketContactsLigandColor &lt;text&gt;  [default: orange]</span>
 2069 <span class="s2">        Color for drawing polar contacts between ligand and pocket residues.</span>
 2070 <span class="s2">        The specified value must be valid color. No validation is performed.</span>
 2071 <span class="s2">    --pocketContactsLigandHydrophobicColor &lt;text&gt;  [default: purpleblue]</span>
 2072 <span class="s2">        Color for drawing hydrophobic contacts between ligand and pocket residues.</span>
 2073 <span class="s2">        The specified value must be valid color. No validation is performed. The</span>
 2074 <span class="s2">        hydrophobic contacts are shown between pairs of carbon atoms not</span>
 2075 <span class="s2">        connected to hydrogen bond donor or acceptors atoms as identified</span>
 2076 <span class="s2">        by PyMOL.</span>
 2077 <span class="s2">    --pocketContactsSolventColor &lt;text&gt;  [default: marine]</span>
 2078 <span class="s2">        Color for drawing polar contacts between solvent and pocket residues.</span>
 2079 <span class="s2">        The specified value must be valid color. No validation is performed.</span>
 2080 <span class="s2">    --pocketContactsInorganicColor &lt;text&gt;  [default: deepsalmon]</span>
 2081 <span class="s2">        Color for drawing polar contacts between inorganic and pocket residues.</span>
 2082 <span class="s2">        The specified value must be valid color. No validation is performed.</span>
 2083 <span class="s2">    --pocketContactsCutoff &lt;number&gt;  [default: 4.0]</span>
 2084 <span class="s2">        Distance in Angstroms for identifying polar and hyrdophobic contacts</span>
 2085 <span class="s2">        between atoms in pocket residues and ligands.</span>
 2086 <span class="s2">    --pocketDistanceCutoff &lt;number&gt;  [default: 5.0]</span>
 2087 <span class="s2">        Distance in Angstroms for identifying pocket residues around ligands.</span>
 2088 <span class="s2">    --pocketLabelColor &lt;text&gt;  [default: magenta]</span>
 2089 <span class="s2">        Color for drawing residue or atom level labels for a pocket. The specified</span>
 2090 <span class="s2">        value must be valid color. No validation is performed.</span>
 2091 <span class="s2">    --pocketSurface &lt;yes or no&gt;  [default: yes]</span>
 2092 <span class="s2">        Hydrophobic surface around pocket. The pocket surface is colored by</span>
 2093 <span class="s2">        hydrophobicity. It is only valid for proteins. The color of amino acids is</span>
 2094 <span class="s2">        set using the Eisenberg hydrophobicity scale. The color varies from red</span>
 2095 <span class="s2">        to white, red being the most hydrophobic amino acid.</span>
 2096 <span class="s2">    --selectionsChain &lt;ObjectName,SelectionSpec,...&gt;  [default: None]</span>
 2097 <span class="s2">        Custom selections for chains. It is a pairwise of list comma delimited values</span>
 2098 <span class="s2">        corresponding to PyMOL object names and selection specifications.  The</span>
 2099 <span class="s2">        selection specification must be a valid PyMOL specification. No validation is</span>
 2100 <span class="s2">        performed.</span>
 2101 <span class="s2">        </span>
 2102 <span class="s2">        The PyMOL objects are created for each chain corresponding to the</span>
 2103 <span class="s2">        specified selections. The display style for PyMOL objects is set using</span>
 2104 <span class="s2">        value of &#39;--selectionsChainStyle&#39; option.</span>
 2105 <span class="s2">        </span>
 2106 <span class="s2">        The specified selection specification is automatically appended to appropriate</span>
 2107 <span class="s2">        chain specification before creating PyMOL objects.</span>
 2108 <span class="s2">        </span>
 2109 <span class="s2">        For example, the following specification for &#39;--selectionsChain&#39; option will</span>
 2110 <span class="s2">        generate PyMOL objects for chains containing Cysteines and Serines:</span>
 2111 <span class="s2">            </span>
 2112 <span class="s2">            Cysteines,resn CYS,Serines,resn SER</span>
 2113 <span class="s2">            </span>
 2114 <span class="s2">    --selectionsChainStyle &lt;DisplayStyle&gt;  [default: sticks]</span>
 2115 <span class="s2">        Display style for PyMOL objects created for &#39;--selectionsChain&#39; option. It</span>
 2116 <span class="s2">        must be a valid PyMOL display style. No validation is performed.</span>
 2117 <span class="s2">    --surfaceComplex &lt;yes or no&gt;  [default: no]</span>
 2118 <span class="s2">        Create surfaces for complete complex in each input file using corresponding</span>
 2119 <span class="s2">        composite and difference maps. A total of three surfaces, one for composite</span>
 2120 <span class="s2">        map and two for difference map, are created for the complete complex.</span>
 2121 <span class="s2">        </span>
 2122 <span class="s2">        The composite and difference maps are always loaded for the complex.</span>
 2123 <span class="s2">    --surfaceChainComplex &lt;yes, no or auto&gt;  [default: auto]</span>
 2124 <span class="s2">        Create surfaces for individual chain complexes in each input file using corresponding</span>
 2125 <span class="s2">        composite and difference maps. A total of three surfaces, one for composite</span>
 2126 <span class="s2">        map and two for difference map, are created for each chain complex. By default,</span>
 2127 <span class="s2">        the surfaces are automatically created for chain complexes without any ligands. </span>
 2128 <span class="s2">    --surfaceTransparency &lt;number&gt;  [default: 0.25]</span>
 2129 <span class="s2">        Surface transparency for molecular and electron density surfaces.</span>
 2130 <span class="s2">    --volumeCarveRadius &lt;number&gt;  [default: 1.6]</span>
 2131 <span class="s2">        Radius in Angstroms around atoms for including electron density during</span>
 2132 <span class="s2">        generation of volume objects.</span>
 2133 <span class="s2">    --volumeComplex &lt;yes or no&gt;  [default: no]</span>
 2134 <span class="s2">        Create volumes for complete complex in input file using corresponding</span>
 2135 <span class="s2">        composite and difference maps. A total of two volumes, one each for</span>
 2136 <span class="s2">        composite and difference maps, are created for the complete complex.</span>
 2137 <span class="s2">    --volumeChainComplex &lt;yes, no, or auto&gt;  [default: auto]</span>
 2138 <span class="s2">        Create volumes for individual chain complex in each input file using corresponding</span>
 2139 <span class="s2">        composite and difference maps. A total of two volumes, one each for composite</span>
 2140 <span class="s2">        and difference maps, are created for each chain complex. By default, the</span>
 2141 <span class="s2">        volumes are automatically created for chain complexes without any ligands.</span>
 2142 <span class="s2">    --volumeColorRampCompositeMap &lt;text&gt;  [default: 2fofc]</span>
 2143 <span class="s2">        Name of volume color ramp for composite maps. The specified value must</span>
 2144 <span class="s2">        be a valid name. No validation is performed. The following volume color ramps</span>
 2145 <span class="s2">        are currently available in PyMOL: default, 2fofc, fofc, rainbow, and rainbow2.</span>
 2146 <span class="s2">    --volumeColorRampDiffMap &lt;text&gt;  [default: fofc]</span>
 2147 <span class="s2">        Name of volume color ramp for difference maps. The specified value must</span>
 2148 <span class="s2">        be a valid name. No validation is performed. The following volume color ramps</span>
 2149 <span class="s2">        are currently available in PyMOL: default, 2fofc, fofc, rainbow, and rainbow2.</span>
 2150 <span class="s2">    --overwrite</span>
 2151 <span class="s2">        Overwrite existing files.</span>
 2152 <span class="s2">    -w, --workingdir &lt;dir&gt;</span>
 2153 <span class="s2">        Location of working directory which defaults to the current directory.</span>
 2154 
 2155 <span class="s2">Examples:</span>
 2156 <span class="s2">    To visualize electron density for the largest ligand in the first chain, and</span>
 2157 <span class="s2">    ligand binding pockets to highlight ligand interactions with pockect residues,</span>
 2158 <span class="s2">    solvents and inorganics, in a PDB file by using default map files, and generate a</span>
 2159 <span class="s2">    PML file, type:</span>
 2160 
 2161 <span class="s2">        % PyMOLVisualizeElectronDensity.py -i Sample3.pdb -o Sample3.pml</span>
 2162 
 2163 <span class="s2">    To visualize electron density for the largest ligand in the first chain, cysteine</span>
 2164 <span class="s2">    and serine residues in the chain, and ligand binding pockets to highlight ligand</span>
 2165 <span class="s2">    interactions with pockect residues, solvents and inorganics, in a PDB file by</span>
 2166 <span class="s2">    using default map files, and generate a PML file, type:</span>
 2167 
 2168 <span class="s2">        % PyMOLVisualizeElectronDensity.py -i Sample3.pdb -o Sample3.pml</span>
 2169 <span class="s2">          --selectionsChain &quot;Cysteines,resn cys,Serines,resn ser&quot;</span>
 2170 
 2171 <span class="s2">    To visualize electron density for all ligands in all chains, and ligand binding</span>
 2172 <span class="s2">    pockets to highlight ligand interactions with pockect residues, solvents</span>
 2173 <span class="s2">    and inorganics, in a PDB file by using default map files, and generate a</span>
 2174 <span class="s2">    PML file, type:</span>
 2175 
 2176 <span class="s2">        % PyMOLVisualizeElectronDensity.py -i Sample3.pdb -o Sample3.pml</span>
 2177 <span class="s2">          -c All -l All</span>
 2178 
 2179 <span class="s2">    To visualize electron density for all chains and ligands, along with displaying</span>
 2180 <span class="s2">    meshes, volumes, and surfaces for complete complex and individual chains,</span>
 2181 <span class="s2">    in a PDB file by using  default map files, and generate a PML file, type:</span>
 2182 
 2183 <span class="s2">        % PyMOLVisualizeElectronDensity.py -i Sample3.pdb -o Sample3.pml</span>
 2184 <span class="s2">          --chainIDs All --ligandIDs All --meshComplex yes --surfaceComplex yes</span>
 2185 <span class="s2">          --volumeComplex yes --meshChainComplex yes --surfaceChainComplex yes</span>
 2186 <span class="s2">          --volumeChainComplex yes</span>
 2187 
 2188 <span class="s2">    To visualize electron density for ligand ADP in chain E along with ligand binding</span>
 2189 <span class="s2">    pocket, in a PDB file by using  default map files, and generate a PSE file, type:</span>
 2190 
 2191 <span class="s2">        % PyMOLVisualizeElectronDensity.py -i Sample3.pdb -o Sample3.pse</span>
 2192 <span class="s2">          --chainIDs E --ligandIDs ADP</span>
 2193 
 2194 <span class="s2">    To visualize electron density for all igands in all chains along with their binding</span>
 2195 <span class="s2">    pockets in a PDB file and using explicit file name suffixes for map files, and</span>
 2196 <span class="s2">    generate a PML file, type:</span>
 2197 
 2198 <span class="s2">        % PyMOLVisualizeElectronDensity.py -i Sample3.pdb -o Sample3.pml</span>
 2199 <span class="s2">          --chainIDs All --ligandIDs All --EDMapSuffixes &quot;CompositeMap,None,</span>
 2200 <span class="s2">          DifferenceMap,_diff&quot;</span>
 2201 
 2202 <span class="s2">    To visualize electron density for all ligands in all chains along with their binding</span>
 2203 <span class="s2">    pockets in a PDB file by using explicit file names for map files, and generate</span>
 2204 <span class="s2">    a PML file, type:</span>
 2205 
 2206 <span class="s2">        % PyMOLVisualizeElectronDensity.py -i Sample3.pdb -o Sample3.pml</span>
 2207 <span class="s2">          --chainIDs All --ligandIDs All --EDMapFiles &quot;Sample3.ccp4,</span>
 2208 <span class="s2">          Sample3_diff.ccp4&quot;</span>
 2209 
 2210 <span class="s2">    To align and visualize electron density for all ligands in all chains along with their</span>
 2211 <span class="s2">    binding pockets in PDB files by using explicit file names for map files, and generate</span>
 2212 <span class="s2">    a PML file, type:</span>
 2213 
 2214 <span class="s2">        % PyMOLVisualizeElectronDensity.py -a yes -i &quot;Sample3.pdb,Sample4.pdb&quot;</span>
 2215 <span class="s2">          -o SampleOut.pml --chainIDs All --ligandIDs All --EDMapFiles</span>
 2216 <span class="s2">         &quot;Sample3.ccp4,Sample3_diff.ccp4,Sample4.ccp4,Sample4_diff.ccp4&quot;</span>
 2217 
 2218 <span class="s2">Author:</span>
 2219 <span class="s2">    Manish Sud(msud@san.rr.com)</span>
 2220 
 2221 <span class="s2">See also:</span>
 2222 <span class="s2">    DownloadPDBFiles.pl, PyMOLVisualizeCavities.py,</span>
 2223 <span class="s2">    PyMOLVisualizeCryoEMDensity.py, PyMOLVisualizeInterfaces.py,</span>
 2224 <span class="s2">    PyMOLVisualizeMacromolecules.py, PyMOLVisualizeSurfaceAndBuriedResidues.py</span>
 2225 
 2226 <span class="s2">Copyright:</span>
 2227 <span class="s2">    Copyright (C) 2020 Manish Sud. All rights reserved.</span>
 2228 
 2229 <span class="s2">    The functionality available in this script is implemented using PyMOL, a</span>
 2230 <span class="s2">    molecular visualization system on an open source foundation originally</span>
 2231 <span class="s2">    developed by Warren DeLano.</span>
 2232 
 2233 <span class="s2">    This file is part of MayaChemTools.</span>
 2234 
 2235 <span class="s2">    MayaChemTools is free software; you can redistribute it and/or modify it under</span>
 2236 <span class="s2">    the terms of the GNU Lesser General Public License as published by the Free</span>
 2237 <span class="s2">    Software Foundation; either version 3 of the License, or (at your option) any</span>
 2238 <span class="s2">    later version.</span>
 2239 
 2240 <span class="s2">&quot;&quot;&quot;</span>
 2241 
 2242 <span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
 2243     <span class="n">main</span><span class="p">()</span>
</pre>
<br />
<center>
<img src="../../../images/h2o2.png">
</center>
</body>
</html>
