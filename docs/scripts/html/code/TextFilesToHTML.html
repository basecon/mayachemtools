<html>
<head>
<title>MayaChemTools:Code:TextFilesToHTML.pl</title>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<link rel="stylesheet" type="text/css" href="../../../css/MayaChemToolsCode.css">
</head>
<body leftmargin="20" rightmargin="20" topmargin="10" bottommargin="10">
<br/>
<center>
<a href="http://www.mayachemtools.org" title="MayaChemTools Home"><img src="../../../images/MayaChemToolsLogo.gif" border="0" alt="MayaChemTools"></a>
</center>
<br/>
<pre>
   1 #!/usr/bin/perl -w
   2 <span class="c">#</span>
   3 <span class="c"># File: TextFilesToHTML.pl</span>
   4 <span class="c"># Author: Manish Sud &lt;msud@san.rr.com&gt;</span>
   5 <span class="c">#</span>
   6 <span class="c"># Copyright (C) 2020 Manish Sud. All rights reserved.</span>
   7 <span class="c">#</span>
   8 <span class="c"># This file is part of MayaChemTools.</span>
   9 <span class="c">#</span>
  10 <span class="c"># MayaChemTools is free software; you can redistribute it and/or modify it under</span>
  11 <span class="c"># the terms of the GNU Lesser General Public License as published by the Free</span>
  12 <span class="c"># Software Foundation; either version 3 of the License, or (at your option) any</span>
  13 <span class="c"># later version.</span>
  14 <span class="c">#</span>
  15 <span class="c"># MayaChemTools is distributed in the hope that it will be useful, but without</span>
  16 <span class="c"># any warranty; without even the implied warranty of merchantability of fitness</span>
  17 <span class="c"># for a particular purpose.  See the GNU Lesser General Public License for more</span>
  18 <span class="c"># details.</span>
  19 <span class="c">#</span>
  20 <span class="c"># You should have received a copy of the GNU Lesser General Public License</span>
  21 <span class="c"># along with MayaChemTools; if not, see &lt;http://www.gnu.org/licenses/&gt; or</span>
  22 <span class="c"># write to the Free Software Foundation Inc., 59 Temple Place, Suite 330,</span>
  23 <span class="c"># Boston, MA, 02111-1307, USA.</span>
  24 <span class="c">#</span>
  25 
  26 <span class="k">use</span> <span class="w">strict</span><span class="sc">;</span>
  27 <span class="k">use</span> <span class="w">FindBin</span><span class="sc">;</span> <span class="k">use</span> <span class="w">lib</span> <span class="q">&quot;$FindBin::Bin/../lib&quot;</span><span class="sc">;</span>
  28 <span class="k">use</span> <span class="w">Getopt::Long</span><span class="sc">;</span>
  29 <span class="k">use</span> <span class="w">File::Basename</span><span class="sc">;</span>
  30 <span class="k">use</span> <span class="w">Text::ParseWords</span><span class="sc">;</span>
  31 <span class="k">use</span> <span class="w">Benchmark</span><span class="sc">;</span>
  32 <span class="k">use</span> <span class="w">FileUtil</span><span class="sc">;</span>
  33 <span class="k">use</span> <span class="w">TextUtil</span><span class="sc">;</span>
  34 <span class="k">use</span> <span class="w">HTMLUtil</span><span class="sc">;</span>
  35 
  36 <span class="k">my</span><span class="s">(</span><span class="i">$ScriptName</span><span class="cm">,</span> <span class="i">%Options</span><span class="cm">,</span> <span class="i">$StartTime</span><span class="cm">,</span> <span class="i">$EndTime</span><span class="cm">,</span> <span class="i">$TotalTime</span><span class="s">)</span><span class="sc">;</span>
  37 
  38 <span class="c"># Autoflush STDOUT</span>
  39 <span class="i">$|</span> = <span class="n">1</span><span class="sc">;</span>
  40 
  41 <span class="c"># Starting message...</span>
  42 <span class="i">$ScriptName</span> = <span class="i">basename</span><span class="s">(</span><span class="i">$0</span><span class="s">)</span><span class="sc">;</span>
  43 <span class="k">print</span> <span class="q">&quot;\n$ScriptName: Starting...\n\n&quot;</span><span class="sc">;</span>
  44 <span class="i">$StartTime</span> = <span class="w">new</span> <span class="w">Benchmark</span><span class="sc">;</span>
  45 
  46 <span class="c"># Get the options and setup script...</span>
  47 <span class="i">SetupScriptUsage</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
  48 <span class="k">if</span> <span class="s">(</span><span class="i">$Options</span>{<span class="w">help</span>} || <span class="i">@ARGV</span> &lt; <span class="n">1</span><span class="s">)</span> <span class="s">{</span>
  49   <span class="k">die</span> <span class="i">GetUsageFromPod</span><span class="s">(</span><span class="q">&quot;$FindBin::Bin/$ScriptName&quot;</span><span class="s">)</span><span class="sc">;</span>
  50 <span class="s">}</span>
  51 
  52 <span class="k">my</span><span class="s">(</span><span class="i">@TextFilesList</span><span class="s">)</span><span class="sc">;</span>
  53 <span class="i">@TextFilesList</span> = <span class="i">ExpandFileNames</span><span class="s">(</span>\<span class="i">@ARGV</span><span class="cm">,</span> <span class="q">&quot;csv tsv&quot;</span><span class="s">)</span><span class="sc">;</span>
  54 
  55 <span class="k">print</span> <span class="q">&quot;Processing options...\n&quot;</span><span class="sc">;</span>
  56 <span class="k">my</span><span class="s">(</span><span class="i">%OptionsInfo</span><span class="s">)</span><span class="sc">;</span>
  57 <span class="i">ProcessOptions</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
  58 
  59 <span class="k">print</span> <span class="q">&quot;Checking input text file(s)...\n&quot;</span><span class="sc">;</span>
  60 <span class="k">my</span><span class="s">(</span><span class="i">%TextFilesInfo</span><span class="s">)</span><span class="sc">;</span>
  61 <span class="i">RetrieveTextFilesInfo</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
  62 <span class="i">SetupCoulmnsTablesAndMiscInfo</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
  63 
  64 <span class="c"># Generate output files...</span>
  65 <span class="k">my</span><span class="s">(</span><span class="i">$FileIndex</span><span class="s">)</span><span class="sc">;</span>
  66 <span class="k">if</span> <span class="s">(</span><span class="i">@TextFilesList</span> &gt; <span class="n">1</span><span class="s">)</span> <span class="s">{</span>
  67   <span class="k">print</span> <span class="q">&quot;\nProcessing text files...\n&quot;</span><span class="sc">;</span>
  68 <span class="s">}</span>
  69 <span class="k">for</span> <span class="i">$FileIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="i">$#TextFilesList</span><span class="s">)</span> <span class="s">{</span>
  70   <span class="k">if</span> <span class="s">(</span><span class="i">$TextFilesInfo</span>{<span class="w">FileOkay</span>}[<span class="i">$FileIndex</span>]<span class="s">)</span> <span class="s">{</span>
  71     <span class="k">print</span> <span class="q">&quot;\nProcessing file $TextFilesList[$FileIndex]...\n&quot;</span><span class="sc">;</span>
  72     <span class="i">GenerateHTMLTable</span><span class="s">(</span><span class="i">$FileIndex</span><span class="s">)</span><span class="sc">;</span>
  73   <span class="s">}</span>
  74 <span class="s">}</span>
  75 <span class="k">print</span> <span class="q">&quot;\n$ScriptName:Done...\n\n&quot;</span><span class="sc">;</span>
  76 
  77 <span class="i">$EndTime</span> = <span class="w">new</span> <span class="w">Benchmark</span><span class="sc">;</span>
  78 <span class="i">$TotalTime</span> = <span class="w">timediff</span> <span class="s">(</span><span class="i">$EndTime</span><span class="cm">,</span> <span class="i">$StartTime</span><span class="s">)</span><span class="sc">;</span>
  79 <span class="k">print</span> <span class="q">&quot;Total time: &quot;</span><span class="cm">,</span> <span class="i">timestr</span><span class="s">(</span><span class="i">$TotalTime</span><span class="s">)</span><span class="cm">,</span> <span class="q">&quot;\n&quot;</span><span class="sc">;</span>
  80 
  81 <span class="c">###############################################################################</span>
  82 
  83 <span class="c"># Generate HTML table(s)...</span>
<a name="GenerateHTMLTable-"></a>  84 <span class="k">sub </span><span class="m">GenerateHTMLTable</span> <span class="s">{</span>
  85   <span class="k">my</span><span class="s">(</span><span class="i">$Index</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
  86 
  87   <span class="k">if</span> <span class="s">(</span><span class="i">$TextFilesInfo</span>{<span class="w">MultipleHTMLTables</span>}[<span class="i">$Index</span>]<span class="s">)</span> <span class="s">{</span>
  88     <span class="i">GenerateMultipleHTMLTable</span><span class="s">(</span><span class="i">$Index</span><span class="s">)</span><span class="sc">;</span>
  89   <span class="s">}</span>
  90   <span class="k">else</span> <span class="s">{</span>
  91     <span class="i">GenerateOneHTMLTable</span><span class="s">(</span><span class="i">$Index</span><span class="s">)</span><span class="sc">;</span>
  92   <span class="s">}</span>
  93 <span class="s">}</span>
  94 
  95 <span class="c"># Generate one table...</span>
<a name="GenerateOneHTMLTable-"></a>  96 <span class="k">sub </span><span class="m">GenerateOneHTMLTable</span> <span class="s">{</span>
  97   <span class="k">my</span><span class="s">(</span><span class="i">$Index</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
  98   <span class="k">my</span><span class="s">(</span><span class="i">$TextFile</span><span class="cm">,</span> <span class="i">$TopHTMLDir</span><span class="cm">,</span> <span class="i">$HTMLFile</span><span class="cm">,</span> <span class="i">$Line</span><span class="cm">,</span> <span class="i">$StartRowNum</span><span class="cm">,</span> <span class="i">$EndRowNum</span><span class="cm">,</span> <span class="i">$CSSFile</span><span class="cm">,</span> <span class="i">$CSSFilePath</span><span class="cm">,</span> <span class="i">$CSSRef</span><span class="s">)</span><span class="sc">;</span>
  99 
 100   <span class="i">$HTMLFile</span> = <span class="i">$TextFilesInfo</span>{<span class="w">HTMLRoot</span>}[<span class="i">$Index</span>] . <span class="q">&quot;.html&quot;</span><span class="sc">;</span>
 101   <span class="i">$TextFile</span> = <span class="i">$TextFilesList</span>[<span class="i">$Index</span>]<span class="sc">;</span>
 102 
 103   <span class="c"># Setup data directories...</span>
 104   <span class="s">(</span><span class="i">$TopHTMLDir</span><span class="s">)</span> = <span class="i">SetupDataDirs</span><span class="s">(</span><span class="i">$Index</span><span class="s">)</span><span class="sc">;</span>
 105 
 106   <span class="c"># Setup stylesheet file...</span>
 107   <span class="i">$CSSRef</span> = <span class="q">&quot;&quot;</span><span class="sc">;</span>
 108   <span class="k">if</span> <span class="s">(</span><span class="i">$Options</span>{<span class="w">stylesheet</span>} =~ <span class="q">/^new$/i</span><span class="s">)</span> <span class="s">{</span>
 109     <span class="i">$CSSFile</span> = <span class="i">$TextFilesInfo</span>{<span class="w">HTMLRoot</span>}[<span class="i">$Index</span>] . <span class="q">&quot;.css&quot;</span><span class="sc">;</span> <span class="i">$CSSRef</span> = <span class="q">&quot;.\/&quot;</span> . <span class="q">&quot;$CSSFile&quot;</span><span class="sc">;</span>
 110     <span class="i">$CSSFilePath</span> = <span class="q">&quot;$TopHTMLDir&quot;</span> . <span class="q">&quot;\/&quot;</span> . <span class="i">$CSSFile</span><span class="sc">;</span>
 111     <span class="i">GenerateStyleSheetFile</span><span class="s">(</span><span class="i">$CSSFilePath</span><span class="s">)</span><span class="sc">;</span>
 112   <span class="s">}</span>
 113   <span class="k">elsif</span> <span class="s">(</span><span class="i">$Options</span>{<span class="w">stylesheet</span>} =~ <span class="q">/^old$/i</span><span class="s">)</span> <span class="s">{</span>
 114     <span class="i">$CSSRef</span> = <span class="i">$Options</span>{<span class="w">stylesheetname</span>}<span class="sc">;</span>
 115   <span class="s">}</span>
 116   <span class="c"># Set HTML file location...</span>
 117   <span class="i">$HTMLFile</span> = <span class="q">&quot;$TopHTMLDir&quot;</span> . <span class="q">&quot;\/&quot;</span> . <span class="i">$HTMLFile</span><span class="sc">;</span>
 118 
 119   <span class="k">print</span> <span class="q">&quot;Generating HTML file $HTMLFile...\n&quot;</span><span class="sc">;</span>
 120   <span class="k">open</span> <span class="w">HTMLFILE</span><span class="cm">,</span> <span class="q">&quot;&gt;$HTMLFile&quot;</span> <span class="k">or</span> <span class="k">die</span> <span class="q">&quot;Error: Can&#39;t open $HTMLFile: $! \n&quot;</span><span class="sc">;</span>
 121   <span class="k">open</span> <span class="w">TEXTFILE</span><span class="cm">,</span> <span class="q">&quot;$TextFile&quot;</span> <span class="k">or</span> <span class="k">die</span> <span class="q">&quot;Error: Can&#39;t open $TextFile: $! \n&quot;</span><span class="sc">;</span>
 122 
 123   <span class="c"># Write out HTML page header...</span>
 124   <span class="k">print</span> <span class="i">HTMLFILE</span> <span class="i">SetupHTMLPageHeader</span><span class="s">(</span><span class="i">$TextFilesInfo</span>{<span class="w">HTMLTitle</span>}[<span class="i">$Index</span>]<span class="cm">,</span> <span class="i">$CSSRef</span><span class="s">)</span><span class="sc">;</span>
 125   <span class="k">if</span> <span class="s">(</span><span class="i">$OptionsInfo</span>{<span class="w">TitleDisplay</span>}<span class="s">)</span> <span class="s">{</span>
 126     <span class="k">print</span> <span class="i">HTMLFILE</span> <span class="i">SetupHTMLPageTitle</span><span class="s">(</span><span class="i">$TextFilesInfo</span>{<span class="w">HTMLTitle</span>}[<span class="i">$Index</span>]<span class="s">)</span><span class="sc">;</span>
 127   <span class="s">}</span>
 128   <span class="k">else</span> <span class="s">{</span>
 129     <span class="k">print</span> <span class="i">HTMLFILE</span> <span class="i">SetupHTMLEmptyLines</span><span class="s">(</span><span class="n">1</span><span class="s">)</span><span class="sc">;</span>
 130   <span class="s">}</span>
 131 
 132   <span class="c"># Start the table...</span>
 133   <span class="k">print</span> <span class="i">HTMLFILE</span> <span class="i">SetupHTMLAlignmentBegin</span><span class="s">(</span><span class="q">&quot;center&quot;</span><span class="s">)</span><span class="sc">;</span>
 134   <span class="k">print</span> <span class="i">HTMLFILE</span> <span class="i">SetupHTMLTableHeader</span><span class="s">(</span><span class="i">$OptionsInfo</span>{<span class="w">TableBorder</span>}<span class="cm">,</span> <span class="i">$OptionsInfo</span>{<span class="w">TableCellPadding</span>}<span class="cm">,</span> <span class="i">$OptionsInfo</span>{<span class="w">TableCellSpacing</span>}<span class="s">)</span><span class="sc">;</span>
 135 
 136   <span class="i">WriteColLabels</span><span class="s">(</span><span class="i">$Index</span><span class="cm">,</span> \<span class="i">*TEXTFILE</span><span class="cm">,</span> \<span class="i">*HTMLFILE</span><span class="s">)</span><span class="sc">;</span>
 137 
 138   <span class="c"># Skip the labels and write out all the other rows...</span>
 139   <span class="i">$Line</span> = <span class="q">&lt;TEXTFILE&gt;</span><span class="sc">;</span>
 140   <span class="i">$StartRowNum</span> = <span class="n">1</span><span class="sc">;</span>
 141   <span class="i">$EndRowNum</span> = <span class="i">$TextFilesInfo</span>{<span class="w">LineCount</span>}[<span class="i">$Index</span>]<span class="sc">;</span>
 142   <span class="i">WriteRowValues</span><span class="s">(</span><span class="i">$Index</span><span class="cm">,</span> <span class="i">$StartRowNum</span><span class="cm">,</span> <span class="i">$EndRowNum</span><span class="cm">,</span> \<span class="i">*TEXTFILE</span><span class="cm">,</span> \<span class="i">*HTMLFILE</span><span class="s">)</span><span class="sc">;</span>
 143 
 144   <span class="c"># Finish up the table...</span>
 145   <span class="k">print</span> <span class="i">HTMLFILE</span> <span class="i">SetupHTMLTableEnd</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 146   <span class="k">print</span> <span class="i">HTMLFILE</span> <span class="i">SetupHTMLAlignmentEnd</span><span class="s">(</span><span class="q">&quot;center&quot;</span><span class="s">)</span><span class="sc">;</span>
 147 
 148   <span class="c"># Write out HTML page end...</span>
 149   <span class="k">print</span> <span class="i">HTMLFILE</span> <span class="i">SetupHTMLPageEnd</span><span class="s">(</span><span class="i">$OptionsInfo</span>{<span class="w">Footer</span>}<span class="s">)</span><span class="sc">;</span>
 150 
 151   <span class="k">close</span> <span class="w">HTMLFILE</span><span class="sc">;</span>
 152   <span class="k">close</span> <span class="w">TEXTFILE</span><span class="sc">;</span>
 153 <span class="s">}</span>
 154 
 155 <span class="c"># Generate multiple tables...</span>
<a name="GenerateMultipleHTMLTable-"></a> 156 <span class="k">sub </span><span class="m">GenerateMultipleHTMLTable</span> <span class="s">{</span>
 157   <span class="k">my</span><span class="s">(</span><span class="i">$Index</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 158   <span class="k">my</span><span class="s">(</span><span class="i">$TopHTMLDir</span><span class="cm">,</span> <span class="i">$SubHTMLDir</span><span class="cm">,</span> <span class="i">$TextFile</span><span class="cm">,</span> <span class="i">$HTMLFile</span><span class="cm">,</span> <span class="i">$TableNum</span><span class="cm">,</span> <span class="i">$TableCount</span><span class="cm">,</span> <span class="i">$TableIndex</span><span class="cm">,</span> <span class="i">$TableStartLineNum</span><span class="cm">,</span> <span class="i">$TableEndLineNum</span><span class="cm">,</span> <span class="i">$Line</span><span class="cm">,</span> <span class="i">$InSubHTMLDir</span><span class="cm">,</span> <span class="i">$PrintMsg</span><span class="cm">,</span> <span class="i">$CSSFile</span><span class="cm">,</span> <span class="i">$CSSFilePath</span><span class="cm">,</span> <span class="i">$CSSRef</span><span class="cm">,</span> <span class="i">$NewStyleSheet</span><span class="s">)</span><span class="sc">;</span>
 159 
 160   <span class="c"># Open text file and skip over label line...</span>
 161   <span class="i">$TextFile</span> = <span class="i">$TextFilesList</span>[<span class="i">$Index</span>]<span class="sc">;</span>
 162   <span class="k">open</span> <span class="w">TEXTFILE</span><span class="cm">,</span> <span class="q">&quot;$TextFile&quot;</span> <span class="k">or</span> <span class="k">die</span> <span class="q">&quot;Error: Can&#39;t open $TextFile: $! \n&quot;</span><span class="sc">;</span>
 163   <span class="i">$Line</span> = <span class="q">&lt;TEXTFILE&gt;</span><span class="sc">;</span>
 164 
 165   <span class="c"># Set up data directories to hold various html files...</span>
 166   <span class="s">(</span><span class="i">$TopHTMLDir</span><span class="cm">,</span> <span class="i">$SubHTMLDir</span><span class="s">)</span> = <span class="i">SetupDataDirs</span><span class="s">(</span><span class="i">$Index</span><span class="s">)</span><span class="sc">;</span>
 167 
 168   <span class="c"># Create stylesheet file...</span>
 169   <span class="i">$CSSRef</span> = <span class="q">&quot;&quot;</span><span class="sc">;</span>
 170   <span class="i">$NewStyleSheet</span> = <span class="n">0</span><span class="sc">;</span>
 171   <span class="k">if</span> <span class="s">(</span><span class="i">$Options</span>{<span class="w">stylesheet</span>} =~ <span class="q">/^new$/i</span><span class="s">)</span> <span class="s">{</span>
 172     <span class="i">$NewStyleSheet</span> = <span class="n">1</span><span class="sc">;</span>
 173     <span class="i">$CSSFile</span> = <span class="i">$TextFilesInfo</span>{<span class="w">HTMLRoot</span>}[<span class="i">$Index</span>] . <span class="q">&quot;.css&quot;</span><span class="sc">;</span>
 174     <span class="i">$CSSFilePath</span> = <span class="q">&quot;$TopHTMLDir&quot;</span> . <span class="q">&quot;\/&quot;</span> . <span class="i">$CSSFile</span><span class="sc">;</span>
 175     <span class="i">GenerateStyleSheetFile</span><span class="s">(</span><span class="i">$CSSFilePath</span><span class="s">)</span><span class="sc">;</span>
 176   <span class="s">}</span>
 177   <span class="k">elsif</span> <span class="s">(</span><span class="i">$Options</span>{<span class="w">stylesheet</span>} =~ <span class="q">/^old$/i</span><span class="s">)</span> <span class="s">{</span>
 178     <span class="i">$CSSRef</span> = <span class="i">$Options</span>{<span class="w">stylesheetname</span>}<span class="sc">;</span>
 179   <span class="s">}</span>
 180 
 181   <span class="i">$PrintMsg</span> = <span class="n">1</span><span class="sc">;</span>
 182   <span class="c"># Generate HTML files for all the tables...</span>
 183   <span class="i">$TableCount</span> = <span class="i">$TextFilesInfo</span>{<span class="w">TableCount</span>}[<span class="i">$Index</span>]<span class="sc">;</span>
 184   <span class="k">for</span> <span class="i">$TableNum</span> <span class="s">(</span><span class="n">1</span> .. <span class="i">$TableCount</span><span class="s">)</span> <span class="s">{</span>
 185     <span class="i">$TableIndex</span> = <span class="i">$TableNum</span> - <span class="n">1</span><span class="sc">;</span>
 186     <span class="i">$HTMLFile</span> = <span class="i">$</span>{<span class="i">$TextFilesInfo</span>{<span class="w">TableHTMLFiles</span>}[<span class="i">$Index</span>]}[<span class="i">$TableIndex</span>]<span class="sc">;</span>
 187     <span class="i">$TableStartLineNum</span> = <span class="i">$</span>{<span class="i">$TextFilesInfo</span>{<span class="w">TableStartLineNum</span>}[<span class="i">$Index</span>]}[<span class="i">$TableIndex</span>]<span class="sc">;</span>
 188     <span class="i">$TableEndLineNum</span> = <span class="i">$</span>{<span class="i">$TextFilesInfo</span>{<span class="w">TableEndLineNum</span>}[<span class="i">$Index</span>]}[<span class="i">$TableIndex</span>]<span class="sc">;</span>
 189 
 190     <span class="c"># Setup file name...</span>
 191     <span class="k">if</span> <span class="s">(</span><span class="i">$TableNum</span> == <span class="n">1</span><span class="s">)</span> <span class="s">{</span>
 192       <span class="i">$HTMLFile</span> = <span class="q">&quot;$TopHTMLDir&quot;</span> . <span class="q">&quot;\/&quot;</span> . <span class="i">$HTMLFile</span><span class="sc">;</span>
 193       <span class="k">print</span> <span class="q">&quot;Generating HTML file $HTMLFile...\n&quot;</span><span class="sc">;</span>
 194     <span class="s">}</span>
 195     <span class="k">else</span> <span class="s">{</span>
 196       <span class="i">$HTMLFile</span> = <span class="q">&quot;$SubHTMLDir&quot;</span> . <span class="q">&quot;\/&quot;</span> . <span class="i">$HTMLFile</span><span class="sc">;</span>
 197       <span class="k">if</span> <span class="s">(</span><span class="i">$PrintMsg</span><span class="s">)</span> <span class="s">{</span>
 198         <span class="i">$PrintMsg</span> = <span class="n">0</span><span class="sc">;</span>
 199         <span class="k">if</span> <span class="s">(</span><span class="i">$TableCount</span> == <span class="n">2</span><span class="s">)</span> <span class="s">{</span>
 200           <span class="k">print</span> <span class="q">&quot;Generating HTML file $HTMLFile...\n&quot;</span><span class="sc">;</span>
 201         <span class="s">}</span>
 202         <span class="k">else</span> <span class="s">{</span>
 203           <span class="k">print</span> <span class="q">&quot;Generating &quot;</span><span class="cm">,</span> <span class="s">(</span><span class="i">$TableCount</span> - <span class="n">1</span><span class="s">)</span><span class="cm">,</span> <span class="q">&quot; other HTML files: $SubHTMLDir\/$TextFilesInfo{HTMLRoot}[$Index]\*.html...\n&quot;</span><span class="sc">;</span>
 204         <span class="s">}</span>
 205       <span class="s">}</span>
 206     <span class="s">}</span>
 207     <span class="c"># Setup stylesheet reference...</span>
 208     <span class="k">if</span> <span class="s">(</span><span class="i">$NewStyleSheet</span><span class="s">)</span> <span class="s">{</span>
 209       <span class="i">$CSSRef</span> = <span class="s">(</span><span class="i">$TableNum</span> == <span class="n">1</span><span class="s">)</span> ? <span class="q">&quot;.\/&quot;</span> <span class="co">:</span> <span class="q">&quot;..\/&quot;</span><span class="sc">;</span>
 210       <span class="i">$CSSRef</span> .= <span class="i">$CSSFile</span><span class="sc">;</span>
 211     <span class="s">}</span>
 212 
 213     <span class="k">open</span> <span class="w">HTMLFILE</span><span class="cm">,</span> <span class="q">&quot;&gt;$HTMLFile&quot;</span> <span class="k">or</span> <span class="k">die</span> <span class="q">&quot;Error: Can&#39;t open $HTMLFile: $! \n&quot;</span><span class="sc">;</span>
 214     <span class="c"># Write out HTML page header...</span>
 215     <span class="k">print</span> <span class="i">HTMLFILE</span> <span class="i">SetupHTMLPageHeader</span><span class="s">(</span><span class="i">$TextFilesInfo</span>{<span class="w">HTMLTitle</span>}[<span class="i">$Index</span>]<span class="cm">,</span> <span class="i">$CSSRef</span><span class="s">)</span><span class="sc">;</span>
 216 
 217     <span class="c"># Set up the navigation links for this table...</span>
 218     <span class="k">if</span> <span class="s">(</span><span class="i">$OptionsInfo</span>{<span class="w">NavLinksAtTop</span>}<span class="s">)</span> <span class="s">{</span>
 219       <span class="i">WriteNavigationLinks</span><span class="s">(</span><span class="i">$Index</span><span class="cm">,</span> <span class="i">$TableNum</span><span class="cm">,</span> \<span class="i">*HTMLFILE</span><span class="s">)</span><span class="sc">;</span>
 220     <span class="s">}</span>
 221     <span class="c"># Setup page title...</span>
 222     <span class="k">if</span> <span class="s">(</span><span class="i">$OptionsInfo</span>{<span class="w">TitleDisplay</span>}<span class="s">)</span> <span class="s">{</span>
 223       <span class="k">print</span> <span class="i">HTMLFILE</span> <span class="i">SetupHTMLPageTitle</span><span class="s">(</span><span class="i">$TextFilesInfo</span>{<span class="w">HTMLTitle</span>}[<span class="i">$Index</span>]<span class="s">)</span><span class="sc">;</span>
 224     <span class="s">}</span>
 225     <span class="k">else</span> <span class="s">{</span>
 226       <span class="k">print</span> <span class="i">HTMLFILE</span> <span class="i">SetupHTMLEmptyLines</span><span class="s">(</span><span class="n">1</span><span class="s">)</span><span class="sc">;</span>
 227     <span class="s">}</span>
 228 
 229     <span class="c"># Start the table...</span>
 230     <span class="k">print</span> <span class="i">HTMLFILE</span> <span class="i">SetupHTMLAlignmentBegin</span><span class="s">(</span><span class="q">&quot;center&quot;</span><span class="s">)</span><span class="sc">;</span>
 231     <span class="k">print</span> <span class="i">HTMLFILE</span> <span class="i">SetupHTMLTableHeader</span><span class="s">(</span><span class="i">$OptionsInfo</span>{<span class="w">TableBorder</span>}<span class="cm">,</span> <span class="i">$OptionsInfo</span>{<span class="w">TableCellPadding</span>}<span class="cm">,</span> <span class="i">$OptionsInfo</span>{<span class="w">TableCellSpacing</span>}<span class="s">)</span><span class="sc">;</span>
 232 
 233     <span class="i">WriteColLabels</span><span class="s">(</span><span class="i">$Index</span><span class="cm">,</span> \<span class="i">*TEXTFILE</span><span class="cm">,</span> \<span class="i">*HTMLFILE</span><span class="s">)</span><span class="sc">;</span>
 234 
 235     <span class="c"># Write out appropriate row data for this table...</span>
 236     <span class="i">WriteRowValues</span><span class="s">(</span><span class="i">$Index</span><span class="cm">,</span> <span class="i">$TableStartLineNum</span><span class="cm">,</span> <span class="i">$TableEndLineNum</span><span class="cm">,</span> \<span class="i">*TEXTFILE</span><span class="cm">,</span> \<span class="i">*HTMLFILE</span><span class="s">)</span><span class="sc">;</span>
 237 
 238     <span class="c"># Finish up the table...</span>
 239     <span class="k">print</span> <span class="i">HTMLFILE</span> <span class="i">SetupHTMLTableEnd</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 240     <span class="k">print</span> <span class="i">HTMLFILE</span> <span class="i">SetupHTMLAlignmentEnd</span><span class="s">(</span><span class="q">&quot;center&quot;</span><span class="s">)</span><span class="sc">;</span>
 241 
 242     <span class="c"># Set up the navigation links for this table...</span>
 243     <span class="k">if</span> <span class="s">(</span><span class="i">$OptionsInfo</span>{<span class="w">NavLinksAtBottom</span>}<span class="s">)</span> <span class="s">{</span>
 244       <span class="k">print</span> <span class="i">HTMLFILE</span> <span class="i">SetupHTMLEmptyLines</span><span class="s">(</span><span class="n">1</span><span class="s">)</span><span class="sc">;</span>
 245       <span class="i">WriteNavigationLinks</span><span class="s">(</span><span class="i">$Index</span><span class="cm">,</span> <span class="i">$TableNum</span><span class="cm">,</span> \<span class="i">*HTMLFILE</span><span class="s">)</span><span class="sc">;</span>
 246     <span class="s">}</span>
 247 
 248     <span class="c"># Write out HTML page end...</span>
 249     <span class="k">print</span> <span class="i">HTMLFILE</span> <span class="i">SetupHTMLPageEnd</span><span class="s">(</span><span class="i">$OptionsInfo</span>{<span class="w">Footer</span>}<span class="s">)</span><span class="sc">;</span>
 250     <span class="k">close</span> <span class="w">HTMLFILE</span><span class="sc">;</span>
 251   <span class="s">}</span>
 252   <span class="k">close</span> <span class="w">TEXTFILE</span><span class="sc">;</span>
 253 
 254 <span class="s">}</span>
 255 
 256 <span class="c"># Create stylesheet file...</span>
<a name="GenerateStyleSheetFile-"></a> 257 <span class="k">sub </span><span class="m">GenerateStyleSheetFile</span> <span class="s">{</span>
 258   <span class="k">my</span><span class="s">(</span><span class="i">$CSSFile</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 259     <span class="k">print</span> <span class="q">&quot;Generating stylesheet file $CSSFile...\n&quot;</span><span class="sc">;</span>
 260     <span class="k">open</span> <span class="w">CSSFILE</span><span class="cm">,</span> <span class="q">&quot;&gt;$CSSFile&quot;</span> <span class="k">or</span> <span class="k">die</span> <span class="q">&quot;Error: Can&#39;t open $CSSFile: $! \n&quot;</span><span class="sc">;</span>
 261     <span class="k">print</span> <span class="i">CSSFILE</span> <span class="i">SetupHTMLStyleSheetTags</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 262     <span class="k">close</span> <span class="w">CSSFILE</span><span class="sc">;</span>
 263 <span class="s">}</span>
 264 
 265 <span class="c"># Write out table header using column labels...</span>
<a name="WriteColLabels-"></a> 266 <span class="k">sub </span><span class="m">WriteColLabels</span> <span class="s">{</span>
 267   <span class="k">my</span><span class="s">(</span><span class="i">$Index</span><span class="cm">,</span> <span class="i">$TextFileRef</span><span class="cm">,</span> <span class="i">$HTMLFileRef</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 268   <span class="k">my</span><span class="s">(</span><span class="i">@ColLabels</span><span class="cm">,</span> <span class="i">$Label</span><span class="s">)</span><span class="sc">;</span>
 269 
 270   <span class="k">print</span> <span class="i">$HTMLFileRef</span> <span class="i">$TextFilesInfo</span>{<span class="w">TableRowHeaderTags</span>}<span class="sc">;</span>
 271 
 272   <span class="i">@ColLabels</span> = <span class="i">@</span>{<span class="i">$TextFilesInfo</span>{<span class="w">ColLabels</span>}[<span class="i">$Index</span>]}<span class="sc">;</span>
 273   <span class="k">for</span> <span class="i">$Label</span> <span class="s">(</span><span class="i">@ColLabels</span><span class="s">)</span> <span class="s">{</span>
 274     <span class="k">print</span> <span class="i">$HTMLFileRef</span> <span class="i">SetupHTMLTableRowHeaderValue</span><span class="s">(</span><span class="i">$Label</span><span class="s">)</span><span class="sc">;</span>
 275   <span class="s">}</span>
 276   <span class="k">print</span> <span class="i">$HTMLFileRef</span> <span class="i">$TextFilesInfo</span>{<span class="w">RowEndTags</span>}<span class="sc">;</span>
 277 <span class="s">}</span>
 278 
 279 <span class="c">#Write out the rows value...</span>
<a name="WriteRowValues-"></a> 280 <span class="k">sub </span><span class="m">WriteRowValues</span> <span class="s">{</span>
 281   <span class="k">my</span><span class="s">(</span><span class="i">$Index</span><span class="cm">,</span> <span class="i">$StartRowNum</span><span class="cm">,</span> <span class="i">$EndRowNum</span><span class="cm">,</span> <span class="i">$TextFileRef</span><span class="cm">,</span> <span class="i">$HTMLFileRef</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 282   <span class="k">my</span><span class="s">(</span><span class="i">$ColNum</span><span class="cm">,</span> <span class="i">$BackgroundColor</span><span class="cm">,</span> <span class="i">$FontColor</span><span class="cm">,</span> <span class="i">$LineCount</span><span class="cm">,</span> <span class="i">$Line</span><span class="cm">,</span> <span class="i">@RowValues</span><span class="cm">,</span> <span class="i">$Value</span><span class="cm">,</span> <span class="i">$InDelim</span><span class="cm">,</span> <span class="i">$LastColNum</span><span class="s">)</span><span class="sc">;</span>
 283 
 284   <span class="i">$InDelim</span> = <span class="i">$TextFilesInfo</span>{<span class="w">InDelim</span>}[<span class="i">$Index</span>]<span class="sc">;</span>
 285   <span class="i">$LastColNum</span> = <span class="i">@</span>{<span class="i">$TextFilesInfo</span>{<span class="w">ColLabels</span>}[<span class="i">$Index</span>]} - <span class="n">1</span><span class="sc">;</span>
 286 
 287   <span class="k">for</span> <span class="i">$LineCount</span> <span class="s">(</span><span class="i">$StartRowNum</span> .. <span class="i">$EndRowNum</span><span class="s">)</span> <span class="s">{</span>
 288     <span class="i">$Line</span> = <span class="i">GetTextLine</span><span class="s">(</span><span class="i">$TextFileRef</span><span class="s">)</span><span class="sc">;</span>
 289 
 290     <span class="k">if</span> <span class="s">(</span><span class="i">$OptionsInfo</span>{<span class="w">ShadeRowsStatus</span>}<span class="s">)</span> <span class="s">{</span>
 291       <span class="k">print</span> <span class="i">$HTMLFileRef</span> <span class="s">(</span><span class="i">$LineCount</span> % <span class="n">2</span><span class="s">)</span> ? <span class="i">$TextFilesInfo</span>{<span class="w">BgFilledOddRowHeaderTags</span>} <span class="co">:</span> <span class="i">$TextFilesInfo</span>{<span class="w">BgFilledEvenRowHeaderTags</span>}<span class="sc">;</span>
 292     <span class="s">}</span>
 293     <span class="k">else</span> <span class="s">{</span>
 294       <span class="k">print</span> <span class="i">$HTMLFileRef</span> <span class="i">$TextFilesInfo</span>{<span class="w">RowHeaderTags</span>}<span class="sc">;</span>
 295     <span class="s">}</span>
 296     <span class="i">@RowValues</span> = <span class="i">quotewords</span><span class="s">(</span><span class="i">$InDelim</span><span class="cm">,</span> <span class="n">0</span><span class="cm">,</span> <span class="i">$Line</span><span class="s">)</span><span class="sc">;</span>
 297     <span class="k">for</span> <span class="i">$ColNum</span> <span class="s">(</span><span class="n">0</span> .. <span class="i">$LastColNum</span><span class="s">)</span> <span class="s">{</span>
 298       <span class="i">$Value</span> = <span class="s">(</span><span class="i">$ColNum</span> &lt;= <span class="i">$#RowValues</span><span class="s">)</span> ? <span class="i">$RowValues</span>[<span class="i">$ColNum</span>] <span class="co">:</span> <span class="q">&quot;&quot;</span><span class="sc">;</span>
 299       <span class="i">$BackgroundColor</span> = <span class="q">&quot;&quot;</span><span class="sc">;</span> <span class="i">$FontColor</span> = <span class="q">&quot;&quot;</span><span class="sc">;</span>
 300       <span class="k">if</span> <span class="s">(</span><span class="i">$OptionsInfo</span>{<span class="w">HighlightStatus</span>}<span class="s">)</span> <span class="s">{</span>
 301         <span class="k">if</span> <span class="s">(</span><span class="k">exists</span><span class="s">(</span><span class="i">$TextFilesInfo</span>{<span class="w">HightlightColNumMap</span>}[<span class="i">$Index</span>]{<span class="i">$ColNum</span>}<span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 302           <span class="s">(</span><span class="i">$BackgroundColor</span><span class="cm">,</span> <span class="i">$FontColor</span><span class="s">)</span> = <span class="i">GetValueHighlightColors</span><span class="s">(</span><span class="i">$Index</span><span class="cm">,</span> <span class="i">$ColNum</span><span class="cm">,</span> <span class="i">$Value</span><span class="s">)</span><span class="sc">;</span>
 303         <span class="s">}</span>
 304       <span class="s">}</span>
 305       <span class="k">print</span> <span class="i">$HTMLFileRef</span> <span class="i">SetupHTMLTableRowDataValue</span><span class="s">(</span><span class="i">$Value</span><span class="cm">,</span> <span class="i">$BackgroundColor</span><span class="cm">,</span> <span class="i">$FontColor</span><span class="s">)</span><span class="sc">;</span>
 306     <span class="s">}</span>
 307     <span class="k">print</span> <span class="i">$HTMLFileRef</span> <span class="i">$TextFilesInfo</span>{<span class="w">RowEndTags</span>}<span class="sc">;</span>
 308   <span class="s">}</span>
 309 <span class="s">}</span>
 310 
 311 <span class="c"># Setup navigation link information for each table.</span>
 312 <span class="c">#</span>
 313 <span class="c"># All table sets besides first and last have these links: FirstTable, Previous, Current-1,Current,Current+1,  Next, and LastTable</span>
 314 <span class="c"># First set: Current, Next, and LastTable</span>
 315 <span class="c"># Last set: FirstTable, Previous and Current.</span>
 316 <span class="c">#</span>
<a name="WriteNavigationLinks-"></a> 317 <span class="k">sub </span><span class="m">WriteNavigationLinks</span> <span class="s">{</span>
 318   <span class="k">my</span><span class="s">(</span><span class="i">$Index</span><span class="cm">,</span> <span class="i">$CurTableNum</span><span class="cm">,</span> <span class="i">$HTMLFileRef</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 319   <span class="k">my</span><span class="s">(</span><span class="i">$TableNum</span><span class="cm">,</span> <span class="i">$StartTableNum</span><span class="cm">,</span> <span class="i">$EndTableNum</span><span class="cm">,</span> <span class="i">$TableIndex</span><span class="cm">,</span> <span class="i">$BorderWidth</span><span class="cm">,</span> <span class="i">$CellPadding</span><span class="cm">,</span> <span class="i">$CellSpacing</span><span class="cm">,</span><span class="i">$HTMLFile</span><span class="cm">,</span> <span class="i">$HTMLRefFile</span><span class="cm">,</span> <span class="i">$RelativeFileDir</span><span class="cm">,</span> <span class="i">$HTMLRefValue</span><span class="cm">,</span> <span class="i">$FirstTableNum</span><span class="cm">,</span> <span class="i">$FirstTableIndex</span><span class="cm">,</span> <span class="i">$LastTableNum</span><span class="cm">,</span> <span class="i">$LastTableIndex</span><span class="cm">,</span> <span class="i">$TableStartLineNum</span><span class="cm">,</span> <span class="i">$TableEndLineNum</span><span class="cm">,</span> <span class="i">$LastLineNum</span><span class="cm">,</span> <span class="i">$BGColor</span><span class="cm">,</span> <span class="i">$LinksOffSet</span><span class="s">)</span><span class="sc">;</span>
 320 
 321   <span class="i">$LinksOffSet</span> = <span class="n">10</span><span class="sc">;</span>
 322 
 323   <span class="i">$FirstTableNum</span> = <span class="n">1</span><span class="sc">;</span> <span class="i">$FirstTableIndex</span> = <span class="i">$FirstTableNum</span> - <span class="n">1</span><span class="sc">;</span>
 324   <span class="i">$LastTableNum</span> = <span class="i">$TextFilesInfo</span>{<span class="w">TableCount</span>}[<span class="i">$Index</span>]<span class="sc">;</span> <span class="i">$LastTableIndex</span> = <span class="i">$LastTableNum</span> - <span class="n">1</span><span class="sc">;</span>
 325   <span class="i">$LastLineNum</span> = <span class="i">$</span>{<span class="i">$TextFilesInfo</span>{<span class="w">TableEndLineNum</span>}[<span class="i">$Index</span>]}[<span class="i">$LastTableIndex</span>]<span class="sc">;</span>
 326 
 327   <span class="c"># Figure out which links to display for a particular table...</span>
 328   <span class="i">$StartTableNum</span> = <span class="i">$CurTableNum</span> - <span class="i">$LinksOffSet</span> + <span class="n">1</span><span class="sc">;</span>
 329   <span class="i">$StartTableNum</span> = <span class="s">(</span><span class="i">$StartTableNum</span> &lt; <span class="i">$FirstTableNum</span><span class="s">)</span> ? <span class="i">$FirstTableNum</span> <span class="co">:</span> <span class="i">$StartTableNum</span><span class="sc">;</span>
 330   <span class="k">if</span> <span class="s">(</span><span class="i">$CurTableNum</span> &lt; <span class="i">$LinksOffSet</span><span class="s">)</span> <span class="s">{</span>
 331     <span class="i">$EndTableNum</span> = <span class="i">$LinksOffSet</span><span class="sc">;</span>
 332   <span class="s">}</span>
 333   <span class="k">else</span> <span class="s">{</span>
 334     <span class="i">$EndTableNum</span> = <span class="i">$CurTableNum</span> + <span class="i">$LinksOffSet</span> - <span class="n">1</span><span class="sc">;</span>
 335   <span class="s">}</span>
 336   <span class="i">$EndTableNum</span> = <span class="s">(</span><span class="i">$EndTableNum</span> &gt; <span class="i">$LastTableNum</span><span class="s">)</span> ? <span class="i">$LastTableNum</span> <span class="co">:</span> <span class="i">$EndTableNum</span><span class="sc">;</span>
 337 
 338   <span class="k">my</span><span class="s">(</span><span class="i">$InactiveLinkNumColor</span><span class="cm">,</span> <span class="i">$InactiveLinkFontBold</span><span class="s">)</span> = <span class="s">(</span><span class="q">&quot;#8e2323&quot;</span><span class="cm">,</span> <span class="q">&quot;1&quot;</span><span class="s">)</span><span class="sc">;</span>
 339   <span class="k">my</span><span class="s">(</span><span class="i">$LinkTextColor</span><span class="cm">,</span> <span class="i">$LinkBGColor</span><span class="cm">,</span> <span class="i">$LinkFontBold</span><span class="s">)</span> = <span class="s">(</span><span class="q">&quot;&quot;</span><span class="cm">,</span> <span class="q">&quot;&quot;</span><span class="cm">,</span> <span class="q">&quot;1&quot;</span><span class="s">)</span><span class="sc">;</span>
 340 
 341   <span class="c"># Start link table...</span>
 342   <span class="i">$BorderWidth</span> = <span class="n">0</span><span class="sc">;</span> <span class="i">$CellPadding</span> = <span class="n">2</span><span class="sc">;</span> <span class="i">$CellSpacing</span> = <span class="n">2</span><span class="sc">;</span>
 343   <span class="k">print</span> <span class="i">$HTMLFileRef</span> <span class="i">SetupHTMLAlignmentBegin</span><span class="s">(</span><span class="q">&quot;center&quot;</span><span class="s">)</span><span class="sc">;</span>
 344   <span class="k">print</span> <span class="i">$HTMLFileRef</span> <span class="i">SetupHTMLDivBegin</span><span class="s">(</span><span class="q">&quot;tablenav&quot;</span><span class="s">)</span><span class="sc">;</span>
 345   <span class="k">print</span> <span class="i">$HTMLFileRef</span>  <span class="i">SetupHTMLTableHeader</span><span class="s">(</span><span class="i">$BorderWidth</span><span class="cm">,</span> <span class="i">$CellPadding</span><span class="cm">,</span> <span class="i">$CellSpacing</span><span class="s">)</span><span class="sc">;</span>
 346   <span class="k">print</span> <span class="i">$HTMLFileRef</span> <span class="i">$TextFilesInfo</span>{<span class="w">RowHeaderTags</span>}<span class="sc">;</span>
 347 
 348   <span class="k">if</span> <span class="s">(</span><span class="i">$OptionsInfo</span>{<span class="w">NavLinksTableInfo</span>} &amp;&amp; <span class="i">$OptionsInfo</span>{<span class="w">NavLinksLineInfo</span>}<span class="s">)</span> <span class="s">{</span>
 349     <span class="k">print</span> <span class="i">$HTMLFileRef</span> <span class="i">SetupHTMLTableRowDataValue</span><span class="s">(</span><span class="q">&quot;Showing table $CurTableNum of $LastTableNum&quot;</span><span class="s">)</span><span class="sc">;</span>
 350     <span class="k">print</span> <span class="i">$HTMLFileRef</span> <span class="i">SetupHTMLTableRowDataValue</span><span class="s">(</span><span class="q">&quot;&amp;nbsp&quot;</span><span class="s">)</span><span class="sc">;</span>
 351     <span class="k">print</span> <span class="i">$HTMLFileRef</span> <span class="i">SetupHTMLTableRowDataValue</span><span class="s">(</span><span class="q">&quot;&amp;nbsp&quot;</span><span class="s">)</span><span class="sc">;</span>
 352   <span class="s">}</span>
 353 
 354   <span class="k">print</span> <span class="i">$HTMLFileRef</span> <span class="i">SetupHTMLTableRowDataValue</span><span class="s">(</span><span class="q">&quot;Tables: &quot;</span><span class="s">)</span><span class="sc">;</span>
 355   <span class="c"># Setup a link to first table...</span>
 356   <span class="k">if</span> <span class="s">(</span><span class="i">$StartTableNum</span> != <span class="i">$FirstTableNum</span><span class="s">)</span> <span class="s">{</span>
 357     <span class="i">$HTMLFile</span> = <span class="i">$</span>{<span class="i">$TextFilesInfo</span>{<span class="w">TableHTMLFiles</span>}[<span class="i">$Index</span>]}[<span class="i">$FirstTableIndex</span>]<span class="sc">;</span>
 358     <span class="i">$HTMLRefFile</span> = <span class="i">GetRelativeFileDir</span><span class="s">(</span><span class="i">$CurTableNum</span><span class="cm">,</span> <span class="i">$FirstTableNum</span><span class="cm">,</span> <span class="i">$FirstTableNum</span><span class="s">)</span> . <span class="i">$HTMLFile</span><span class="sc">;</span>
 359     <span class="i">$TableStartLineNum</span> = <span class="i">$</span>{<span class="i">$TextFilesInfo</span>{<span class="w">TableStartLineNum</span>}[<span class="i">$Index</span>]}[<span class="i">$FirstTableIndex</span>]<span class="sc">;</span>
 360     <span class="i">$TableEndLineNum</span> = <span class="i">$</span>{<span class="i">$TextFilesInfo</span>{<span class="w">TableEndLineNum</span>}[<span class="i">$Index</span>]}[<span class="i">$FirstTableIndex</span>]<span class="sc">;</span>
 361     <span class="i">$HTMLRefValue</span> = <span class="i">SetupHTMLHRef</span><span class="s">(</span><span class="q">&quot;First&quot;</span><span class="cm">,</span> <span class="i">$HTMLRefFile</span><span class="cm">,</span> <span class="q">&quot;First Table Containing Lines $TableStartLineNum To $TableEndLineNum&quot;</span><span class="s">)</span><span class="sc">;</span>
 362     <span class="k">print</span> <span class="i">$HTMLFileRef</span> <span class="i">SetupHTMLTableRowDataValue</span><span class="s">(</span><span class="i">$HTMLRefValue</span><span class="cm">,</span> <span class="i">$LinkBGColor</span><span class="cm">,</span> <span class="i">$LinkTextColor</span><span class="cm">,</span> <span class="i">$LinkFontBold</span><span class="s">)</span><span class="sc">;</span>
 363   <span class="s">}</span>
 364 
 365   <span class="c"># Setup link to previous table...</span>
 366   <span class="k">if</span> <span class="s">(</span><span class="i">$CurTableNum</span> != <span class="i">$FirstTableNum</span><span class="s">)</span> <span class="s">{</span>
 367     <span class="k">my</span><span class="s">(</span><span class="i">$PreviousTableNum</span><span class="cm">,</span> <span class="i">$PreviousTableIndex</span><span class="s">)</span><span class="sc">;</span>
 368     <span class="i">$PreviousTableNum</span> = <span class="i">$CurTableNum</span> - <span class="n">1</span><span class="sc">;</span> <span class="i">$PreviousTableIndex</span> = <span class="i">$PreviousTableNum</span> - <span class="n">1</span><span class="sc">;</span>
 369     <span class="i">$HTMLFile</span> = <span class="i">$</span>{<span class="i">$TextFilesInfo</span>{<span class="w">TableHTMLFiles</span>}[<span class="i">$Index</span>]}[<span class="i">$PreviousTableIndex</span>]<span class="sc">;</span>
 370     <span class="i">$HTMLRefFile</span> = <span class="i">GetRelativeFileDir</span><span class="s">(</span><span class="i">$CurTableNum</span><span class="cm">,</span> <span class="i">$PreviousTableNum</span><span class="cm">,</span> <span class="i">$FirstTableNum</span><span class="s">)</span> . <span class="i">$HTMLFile</span><span class="sc">;</span>
 371     <span class="i">$TableStartLineNum</span> = <span class="i">$</span>{<span class="i">$TextFilesInfo</span>{<span class="w">TableStartLineNum</span>}[<span class="i">$Index</span>]}[<span class="i">$PreviousTableIndex</span>]<span class="sc">;</span>
 372     <span class="i">$TableEndLineNum</span> = <span class="i">$</span>{<span class="i">$TextFilesInfo</span>{<span class="w">TableEndLineNum</span>}[<span class="i">$Index</span>]}[<span class="i">$PreviousTableIndex</span>]<span class="sc">;</span>
 373     <span class="i">$HTMLRefValue</span> = <span class="i">SetupHTMLHRef</span><span class="s">(</span><span class="q">&quot;Previous&quot;</span><span class="cm">,</span> <span class="i">$HTMLRefFile</span><span class="cm">,</span> <span class="q">&quot;Previous Table Containing Lines $TableStartLineNum To $TableEndLineNum&quot;</span><span class="s">)</span><span class="sc">;</span>
 374     <span class="k">print</span> <span class="i">$HTMLFileRef</span> <span class="i">SetupHTMLTableRowDataValue</span><span class="s">(</span><span class="i">$HTMLRefValue</span><span class="cm">,</span> <span class="i">$LinkBGColor</span><span class="cm">,</span> <span class="i">$LinkTextColor</span><span class="cm">,</span> <span class="i">$LinkFontBold</span><span class="s">)</span><span class="sc">;</span>
 375   <span class="s">}</span>
 376 
 377   <span class="k">for</span> <span class="i">$TableNum</span> <span class="s">(</span><span class="i">$StartTableNum</span> .. <span class="i">$EndTableNum</span><span class="s">)</span> <span class="s">{</span>
 378     <span class="i">$TableIndex</span> = <span class="i">$TableNum</span> - <span class="n">1</span><span class="sc">;</span>
 379     <span class="i">$HTMLFile</span> = <span class="i">$</span>{<span class="i">$TextFilesInfo</span>{<span class="w">TableHTMLFiles</span>}[<span class="i">$Index</span>]}[<span class="i">$TableIndex</span>]<span class="sc">;</span>
 380     <span class="k">if</span> <span class="s">(</span><span class="i">$TableNum</span> == <span class="i">$CurTableNum</span><span class="s">)</span> <span class="s">{</span>
 381       <span class="k">print</span> <span class="i">$HTMLFileRef</span> <span class="i">SetupHTMLTableRowDataValue</span><span class="s">(</span><span class="i">$TableNum</span><span class="cm">,</span> <span class="i">$LinkBGColor</span><span class="cm">,</span> <span class="i">$InactiveLinkNumColor</span><span class="cm">,</span> <span class="i">$InactiveLinkFontBold</span><span class="s">)</span><span class="sc">;</span>
 382     <span class="s">}</span>
 383     <span class="k">else</span> <span class="s">{</span>
 384       <span class="c"># Setup the link...</span>
 385       <span class="k">my</span><span class="s">(</span><span class="i">$RefTitle</span><span class="s">)</span><span class="sc">;</span>
 386       <span class="i">$TableStartLineNum</span> = <span class="i">$</span>{<span class="i">$TextFilesInfo</span>{<span class="w">TableStartLineNum</span>}[<span class="i">$Index</span>]}[<span class="i">$TableIndex</span>]<span class="sc">;</span>
 387       <span class="i">$TableEndLineNum</span> = <span class="i">$</span>{<span class="i">$TextFilesInfo</span>{<span class="w">TableEndLineNum</span>}[<span class="i">$Index</span>]}[<span class="i">$TableIndex</span>]<span class="sc">;</span>
 388       <span class="i">$RefTitle</span> = <span class="i">AddNumberSuffix</span><span class="s">(</span><span class="i">$TableNum</span><span class="s">)</span> . <span class="q">&quot; Table Containing Lines $TableStartLineNum To $TableEndLineNum&quot;</span><span class="sc">;</span>
 389       <span class="i">$HTMLRefFile</span> = <span class="i">GetRelativeFileDir</span><span class="s">(</span><span class="i">$CurTableNum</span><span class="cm">,</span> <span class="i">$TableNum</span><span class="cm">,</span> <span class="i">$FirstTableNum</span><span class="s">)</span> . <span class="i">$HTMLFile</span><span class="sc">;</span>
 390       <span class="i">$HTMLRefValue</span> = <span class="i">SetupHTMLHRef</span><span class="s">(</span><span class="i">$TableNum</span><span class="cm">,</span> <span class="i">$HTMLRefFile</span><span class="cm">,</span> <span class="i">$RefTitle</span><span class="s">)</span><span class="sc">;</span>
 391       <span class="k">print</span> <span class="i">$HTMLFileRef</span> <span class="i">SetupHTMLTableRowDataValue</span><span class="s">(</span><span class="i">$HTMLRefValue</span><span class="s">)</span><span class="sc">;</span>
 392     <span class="s">}</span>
 393   <span class="s">}</span>
 394 
 395   <span class="c"># Setup link to next table...</span>
 396   <span class="k">if</span> <span class="s">(</span><span class="i">$CurTableNum</span> != <span class="i">$LastTableNum</span><span class="s">)</span> <span class="s">{</span>
 397     <span class="k">my</span><span class="s">(</span><span class="i">$NextTableNum</span><span class="cm">,</span> <span class="i">$NextTableIndex</span><span class="s">)</span><span class="sc">;</span>
 398     <span class="i">$NextTableNum</span> = <span class="i">$CurTableNum</span> + <span class="n">1</span><span class="sc">;</span> <span class="i">$NextTableIndex</span> = <span class="i">$NextTableNum</span> - <span class="n">1</span><span class="sc">;</span>
 399     <span class="i">$HTMLFile</span> = <span class="i">$</span>{<span class="i">$TextFilesInfo</span>{<span class="w">TableHTMLFiles</span>}[<span class="i">$Index</span>]}[<span class="i">$NextTableIndex</span>]<span class="sc">;</span>
 400     <span class="i">$HTMLRefFile</span> = <span class="i">GetRelativeFileDir</span><span class="s">(</span><span class="i">$CurTableNum</span><span class="cm">,</span> <span class="i">$NextTableNum</span><span class="cm">,</span> <span class="i">$FirstTableNum</span><span class="s">)</span> . <span class="i">$HTMLFile</span><span class="sc">;</span>
 401     <span class="i">$TableStartLineNum</span> = <span class="i">$</span>{<span class="i">$TextFilesInfo</span>{<span class="w">TableStartLineNum</span>}[<span class="i">$Index</span>]}[<span class="i">$NextTableIndex</span>]<span class="sc">;</span>
 402     <span class="i">$TableEndLineNum</span> = <span class="i">$</span>{<span class="i">$TextFilesInfo</span>{<span class="w">TableEndLineNum</span>}[<span class="i">$Index</span>]}[<span class="i">$NextTableIndex</span>]<span class="sc">;</span>
 403     <span class="i">$HTMLRefValue</span> = <span class="i">SetupHTMLHRef</span><span class="s">(</span><span class="q">&quot;Next&quot;</span><span class="cm">,</span> <span class="i">$HTMLRefFile</span><span class="cm">,</span> <span class="q">&quot;Next Table Containing Lines $TableStartLineNum To $TableEndLineNum&quot;</span><span class="s">)</span><span class="sc">;</span>
 404     <span class="k">print</span> <span class="i">$HTMLFileRef</span> <span class="i">SetupHTMLTableRowDataValue</span><span class="s">(</span><span class="i">$HTMLRefValue</span><span class="cm">,</span> <span class="i">$LinkBGColor</span><span class="cm">,</span> <span class="i">$LinkTextColor</span><span class="cm">,</span> <span class="i">$LinkFontBold</span><span class="s">)</span><span class="sc">;</span>
 405   <span class="s">}</span>
 406 
 407   <span class="c"># Setup link to last table...</span>
 408   <span class="k">if</span> <span class="s">(</span><span class="i">$EndTableNum</span> != <span class="i">$LastTableNum</span><span class="s">)</span> <span class="s">{</span>
 409     <span class="i">$HTMLFile</span> = <span class="i">$</span>{<span class="i">$TextFilesInfo</span>{<span class="w">TableHTMLFiles</span>}[<span class="i">$Index</span>]}[<span class="i">$LastTableIndex</span>]<span class="sc">;</span>
 410     <span class="i">$HTMLRefFile</span> = <span class="i">GetRelativeFileDir</span><span class="s">(</span><span class="i">$CurTableNum</span><span class="cm">,</span> <span class="i">$LastTableNum</span><span class="cm">,</span> <span class="i">$FirstTableNum</span><span class="s">)</span> . <span class="i">$HTMLFile</span><span class="sc">;</span>
 411     <span class="i">$TableStartLineNum</span> = <span class="i">$</span>{<span class="i">$TextFilesInfo</span>{<span class="w">TableStartLineNum</span>}[<span class="i">$Index</span>]}[<span class="i">$LastTableIndex</span>]<span class="sc">;</span>
 412     <span class="i">$TableEndLineNum</span> = <span class="i">$</span>{<span class="i">$TextFilesInfo</span>{<span class="w">TableEndLineNum</span>}[<span class="i">$Index</span>]}[<span class="i">$LastTableIndex</span>]<span class="sc">;</span>
 413     <span class="i">$HTMLRefValue</span> = <span class="i">SetupHTMLHRef</span><span class="s">(</span><span class="q">&quot;Last&quot;</span><span class="cm">,</span> <span class="i">$HTMLRefFile</span><span class="cm">,</span> <span class="q">&quot;Last Table Containing Lines $TableStartLineNum To $TableEndLineNum&quot;</span><span class="s">)</span><span class="sc">;</span>
 414     <span class="k">print</span> <span class="i">$HTMLFileRef</span> <span class="i">SetupHTMLTableRowDataValue</span><span class="s">(</span><span class="i">$HTMLRefValue</span><span class="cm">,</span> <span class="i">$LinkBGColor</span><span class="cm">,</span> <span class="i">$LinkTextColor</span><span class="cm">,</span> <span class="i">$LinkFontBold</span><span class="s">)</span><span class="sc">;</span>
 415   <span class="s">}</span>
 416   <span class="c"># Setup current table info text....</span>
 417   <span class="k">print</span> <span class="i">$HTMLFileRef</span> <span class="i">SetupHTMLTableRowDataValue</span><span class="s">(</span><span class="q">&quot;&amp;nbsp&quot;</span><span class="s">)</span><span class="sc">;</span>
 418   <span class="k">print</span> <span class="i">$HTMLFileRef</span> <span class="i">SetupHTMLTableRowDataValue</span><span class="s">(</span><span class="q">&quot;&amp;nbsp&quot;</span><span class="s">)</span><span class="sc">;</span>
 419   <span class="i">$TableStartLineNum</span> = <span class="i">$</span>{<span class="i">$TextFilesInfo</span>{<span class="w">TableStartLineNum</span>}[<span class="i">$Index</span>]}[<span class="i">$CurTableNum</span> - <span class="n">1</span>]<span class="sc">;</span>
 420   <span class="i">$TableEndLineNum</span> = <span class="i">$</span>{<span class="i">$TextFilesInfo</span>{<span class="w">TableEndLineNum</span>}[<span class="i">$Index</span>]}[<span class="i">$CurTableNum</span> - <span class="n">1</span>]<span class="sc">;</span>
 421   <span class="k">if</span> <span class="s">(</span><span class="i">$OptionsInfo</span>{<span class="w">NavLinksLineInfo</span>}<span class="s">)</span> <span class="s">{</span>
 422     <span class="k">print</span> <span class="i">$HTMLFileRef</span> <span class="i">SetupHTMLTableRowDataValue</span><span class="s">(</span><span class="q">&quot;Showing lines $TableStartLineNum to $TableEndLineNum of $LastLineNum&quot;</span><span class="s">)</span><span class="sc">;</span>
 423   <span class="s">}</span>
 424   <span class="k">else</span> <span class="s">{</span>
 425     <span class="k">print</span> <span class="i">$HTMLFileRef</span> <span class="i">SetupHTMLTableRowDataValue</span><span class="s">(</span><span class="q">&quot;Showing table $CurTableNum of $LastTableNum&quot;</span><span class="s">)</span><span class="sc">;</span>
 426   <span class="s">}</span>
 427 
 428   <span class="k">print</span> <span class="i">$HTMLFileRef</span> <span class="i">$TextFilesInfo</span>{<span class="w">RowEndTags</span>}<span class="sc">;</span>
 429   <span class="c"># End link table...</span>
 430   <span class="k">print</span> <span class="i">$HTMLFileRef</span> <span class="i">SetupHTMLTableEnd</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 431   <span class="k">print</span> <span class="i">$HTMLFileRef</span> <span class="i">SetupHTMLDivEnd</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 432   <span class="k">print</span> <span class="i">$HTMLFileRef</span> <span class="i">SetupHTMLAlignmentEnd</span><span class="s">(</span><span class="q">&quot;center&quot;</span><span class="s">)</span><span class="sc">;</span>
 433 <span class="s">}</span>
 434 
 435 <span class="c"># Generate relative directory path...</span>
<a name="GetRelativeFileDir-"></a> 436 <span class="k">sub </span><span class="m">GetRelativeFileDir</span> <span class="s">{</span>
 437   <span class="k">my</span><span class="s">(</span><span class="i">$FromTableNum</span><span class="cm">,</span> <span class="i">$ToTableNum</span><span class="cm">,</span> <span class="i">$FirstTableNum</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 438   <span class="k">my</span><span class="s">(</span><span class="i">$RelativeFileDir</span><span class="s">)</span> = <span class="q">&quot;&quot;</span><span class="sc">;</span>
 439 
 440   <span class="k">if</span> <span class="s">(</span><span class="i">$FromTableNum</span> == <span class="i">$FirstTableNum</span><span class="s">)</span> <span class="s">{</span>
 441     <span class="i">$RelativeFileDir</span> = <span class="s">(</span><span class="i">$ToTableNum</span> == <span class="i">$FirstTableNum</span><span class="s">)</span> ? <span class="q">&quot;.\/&quot;</span> <span class="co">:</span> <span class="q">&quot;.\/html\/&quot;</span><span class="sc">;</span>
 442   <span class="s">}</span>
 443   <span class="k">else</span> <span class="s">{</span>
 444     <span class="i">$RelativeFileDir</span> = <span class="s">(</span><span class="i">$ToTableNum</span> == <span class="i">$FirstTableNum</span><span class="s">)</span> ? <span class="q">&quot;..\/&quot;</span> <span class="co">:</span> <span class="q">&quot;.\/&quot;</span><span class="sc">;</span>
 445   <span class="s">}</span>
 446   <span class="k">return</span> <span class="i">$RelativeFileDir</span><span class="sc">;</span>
 447 <span class="s">}</span>
 448 
 449 <span class="c"># Based on hightlight stype, return appropriate colors for background or text...</span>
<a name="GetValueHighlightColors-"></a> 450 <span class="k">sub </span><span class="m">GetValueHighlightColors</span> <span class="s">{</span>
 451   <span class="k">my</span><span class="s">(</span><span class="i">$FileIndex</span><span class="cm">,</span> <span class="i">$ColNum</span><span class="cm">,</span> <span class="i">$Value</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 452   <span class="k">my</span><span class="s">(</span><span class="i">$DataType</span><span class="cm">,</span> <span class="i">$Criterion</span><span class="cm">,</span> <span class="i">$CriterionValue</span><span class="cm">,</span> <span class="i">$BgColor</span><span class="cm">,</span> <span class="i">$FontColor</span><span class="cm">,</span> <span class="i">$ValueOk</span><span class="cm">,</span> <span class="i">$Nothing</span><span class="s">)</span><span class="sc">;</span>
 453 
 454   <span class="i">$BgColor</span> = <span class="q">&quot;&quot;</span><span class="sc">;</span> <span class="i">$FontColor</span> = <span class="q">&quot;&quot;</span><span class="sc">;</span>
 455   <span class="i">$DataType</span> = <span class="i">$</span>{<span class="i">$TextFilesInfo</span>{<span class="w">HightlightDataMap</span>}[<span class="i">$FileIndex</span>]{<span class="i">$ColNum</span>}}[<span class="n">0</span>]<span class="sc">;</span>
 456   <span class="i">$Criterion</span> = <span class="i">$</span>{<span class="i">$TextFilesInfo</span>{<span class="w">HightlightDataMap</span>}[<span class="i">$FileIndex</span>]{<span class="i">$ColNum</span>}}[<span class="n">1</span>]<span class="sc">;</span>
 457   <span class="i">$CriterionValue</span> = <span class="i">$</span>{<span class="i">$TextFilesInfo</span>{<span class="w">HightlightDataMap</span>}[<span class="i">$FileIndex</span>]{<span class="i">$ColNum</span>}}[<span class="n">2</span>]<span class="sc">;</span>
 458 
 459   <span class="i">$ValueOk</span> = <span class="n">0</span><span class="sc">;</span>
 460   <span class="k">if</span> <span class="s">(</span><span class="i">$DataType</span> =~ <span class="q">/^numeric$/i</span><span class="s">)</span> <span class="s">{</span>
 461   <span class="j">NUMSWITCH:</span> <span class="s">{</span>
 462       <span class="k">if</span> <span class="s">(</span><span class="i">$Criterion</span> =~ <span class="q">/^ge$/i</span><span class="s">)</span> <span class="s">{</span> <span class="i">$ValueOk</span> = <span class="s">(</span><span class="i">$Value</span> &gt;= <span class="i">$CriterionValue</span><span class="s">)</span> ? <span class="n">1</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span> <span class="k">last</span> <span class="j">NUMSWITCH</span><span class="sc">;</span> <span class="s">}</span>
 463       <span class="k">if</span> <span class="s">(</span><span class="i">$Criterion</span> =~ <span class="q">/^le$/i</span><span class="s">)</span> <span class="s">{</span> <span class="i">$ValueOk</span> = <span class="s">(</span><span class="i">$Value</span> &lt;= <span class="i">$CriterionValue</span><span class="s">)</span> ? <span class="n">1</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span> <span class="k">last</span> <span class="j">NUMSWITCH</span><span class="sc">;</span> <span class="s">}</span>
 464       <span class="k">if</span> <span class="s">(</span><span class="i">$Criterion</span> =~ <span class="q">/^eq$/i</span><span class="s">)</span> <span class="s">{</span> <span class="i">$ValueOk</span> = <span class="s">(</span><span class="i">$Value</span> == <span class="i">$CriterionValue</span><span class="s">)</span> ? <span class="n">1</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span> <span class="k">last</span> <span class="j">NUMSWITCH</span><span class="sc">;</span> <span class="s">}</span>
 465       <span class="i">$Nothing</span> = <span class="n">1</span><span class="sc">;</span>
 466     <span class="s">}</span>
 467   <span class="s">}</span>
 468   <span class="k">else</span> <span class="s">{</span>
 469   <span class="j">TEXTSWITCH:</span> <span class="s">{</span>
 470       <span class="k">if</span> <span class="s">(</span><span class="i">$Criterion</span> =~ <span class="q">/^ge$/i</span><span class="s">)</span> <span class="s">{</span> <span class="i">$ValueOk</span> = <span class="s">(</span><span class="i">$Value</span> <span class="k">ge</span> <span class="i">$CriterionValue</span><span class="s">)</span> ? <span class="n">1</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span> <span class="k">last</span> <span class="j">TEXTSWITCH</span><span class="sc">;</span> <span class="s">}</span>
 471       <span class="k">if</span> <span class="s">(</span><span class="i">$Criterion</span> =~ <span class="q">/^le$/i</span><span class="s">)</span> <span class="s">{</span> <span class="i">$ValueOk</span> = <span class="s">(</span><span class="i">$Value</span> <span class="k">le</span> <span class="i">$CriterionValue</span><span class="s">)</span> ? <span class="n">1</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span> <span class="k">last</span> <span class="j">TEXTSWITCH</span><span class="sc">;</span> <span class="s">}</span>
 472       <span class="k">if</span> <span class="s">(</span><span class="i">$Criterion</span> =~ <span class="q">/^eq$/i</span><span class="s">)</span> <span class="s">{</span> <span class="i">$ValueOk</span> = <span class="s">(</span><span class="i">$Value</span> <span class="k">eq</span> <span class="i">$CriterionValue</span><span class="s">)</span> ? <span class="n">1</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span> <span class="k">last</span> <span class="j">TEXTSWITCH</span><span class="sc">;</span> <span class="s">}</span>
 473       <span class="i">$Nothing</span> = <span class="n">1</span><span class="sc">;</span>
 474     <span class="s">}</span>
 475   <span class="s">}</span>
 476   <span class="i">$BgColor</span> = <span class="i">$ValueOk</span> ? <span class="i">$OptionsInfo</span>{<span class="w">ValueOkColor</span>} <span class="co">:</span> <span class="i">$OptionsInfo</span>{<span class="w">ValueNotOkColor</span>}<span class="sc">;</span>
 477   <span class="k">if</span> <span class="s">(</span><span class="i">$Options</span>{<span class="w">highlightstyle</span>} =~ <span class="q">/^text$/i</span><span class="s">)</span> <span class="s">{</span>
 478     <span class="i">$BgColor</span> = <span class="q">&quot;&quot;</span><span class="sc">;</span>
 479     <span class="i">$FontColor</span> = <span class="i">$ValueOk</span> ? <span class="i">$OptionsInfo</span>{<span class="w">ValueOkColor</span>} <span class="co">:</span> <span class="i">$OptionsInfo</span>{<span class="w">ValueNotOkColor</span>}<span class="sc">;</span>
 480   <span class="s">}</span>
 481   <span class="k">return</span> <span class="s">(</span><span class="i">$BgColor</span><span class="cm">,</span> <span class="i">$FontColor</span><span class="s">)</span><span class="sc">;</span>
 482 <span class="s">}</span>
 483 
 484 <span class="c"># Setup columns, tables and other information...</span>
<a name="SetupCoulmnsTablesAndMiscInfo-"></a> 485 <span class="k">sub </span><span class="m">SetupCoulmnsTablesAndMiscInfo</span> <span class="s">{</span>
 486   <span class="i">SetupColumnsToHighlightInfo</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 487   <span class="i">SetupMultipleTablesInfo</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 488   <span class="i">SetupHTMLTagsInfo</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 489 <span class="s">}</span>
 490 
 491 <span class="c"># Setup columns to highlight information...</span>
<a name="SetupColumnsToHighlightInfo-"></a> 492 <span class="k">sub </span><span class="m">SetupColumnsToHighlightInfo</span> <span class="s">{</span>
 493   <span class="k">my</span><span class="s">(</span><span class="i">$ColID</span><span class="cm">,</span> <span class="i">$DataType</span><span class="cm">,</span> <span class="i">$Criterion</span><span class="cm">,</span> <span class="i">$Value</span><span class="cm">,</span> <span class="i">$Index</span><span class="cm">,</span> <span class="i">$ColNum</span><span class="cm">,</span> <span class="i">$ColLabel</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="s">)</span><span class="sc">;</span>
 494 
 495   <span class="i">@</span>{<span class="i">$TextFilesInfo</span>{<span class="w">HightlightColNumMap</span>}} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 496   <span class="i">@</span>{<span class="i">$TextFilesInfo</span>{<span class="w">HightlightDataMap</span>}} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 497 
 498   <span class="k">for</span> <span class="i">$Index</span> <span class="s">(</span><span class="n">0</span> .. <span class="i">$#TextFilesList</span><span class="s">)</span> <span class="s">{</span>
 499     <span class="i">%</span>{<span class="i">$TextFilesInfo</span>{<span class="w">HightlightColNumMap</span>}[<span class="i">$Index</span>]} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 500     <span class="i">%</span>{<span class="i">$TextFilesInfo</span>{<span class="w">HightlightDataMap</span>}[<span class="i">$Index</span>]} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 501     <span class="k">if</span> <span class="s">(</span><span class="i">$TextFilesInfo</span>{<span class="w">FileOkay</span>}[<span class="i">$Index</span>]<span class="s">)</span> <span class="s">{</span>
 502       <span class="j">SPECIFIEDCOLS:</span> <span class="k">for</span> <span class="i">$ColIndex</span> <span class="s">(</span><span class="n">0</span> .. <span class="i">$#</span>{<span class="i">$OptionsInfo</span>{<span class="w">SpecifiedColIds</span>}}<span class="s">)</span> <span class="s">{</span>
 503         <span class="i">$ColID</span> = <span class="i">$OptionsInfo</span>{<span class="w">SpecifiedColIds</span>}[<span class="i">$ColIndex</span>]<span class="sc">;</span>
 504         <span class="i">$DataType</span> = <span class="i">$OptionsInfo</span>{<span class="w">SpecifiedColDataTypes</span>}[<span class="i">$ColIndex</span>]<span class="sc">;</span>
 505         <span class="i">$Criterion</span> = <span class="i">$OptionsInfo</span>{<span class="w">SpecifiedColCriteria</span>}[<span class="i">$ColIndex</span>]<span class="sc">;</span>
 506         <span class="i">$Value</span> = <span class="i">$OptionsInfo</span>{<span class="w">SpecifiedColValues</span>}[<span class="i">$ColIndex</span>]<span class="sc">;</span>
 507         <span class="k">if</span> <span class="s">(</span>!<span class="i">$OptionsInfo</span>{<span class="w">HighlightStatus</span>}<span class="s">)</span> <span class="s">{</span>
 508           <span class="k">next</span> <span class="j">SPECIFIEDCOLS</span><span class="sc">;</span>
 509         <span class="s">}</span>
 510         <span class="k">if</span> <span class="s">(</span><span class="i">$Options</span>{<span class="w">highlightby</span>} =~ <span class="q">/^colnum$/i</span><span class="s">)</span> <span class="s">{</span>
 511           <span class="i">$ColNum</span> = <span class="i">$ColID</span><span class="sc">;</span>
 512           <span class="k">if</span> <span class="s">(</span><span class="i">$ColNum</span> &gt; <span class="n">0</span> &amp;&amp; <span class="i">$ColNum</span> &lt;= <span class="i">$TextFilesInfo</span>{<span class="w">ColCount</span>}[<span class="i">$Index</span>]<span class="s">)</span> <span class="s">{</span>
 513             <span class="i">$ColNum</span> -= <span class="n">1</span><span class="sc">;</span>
 514           <span class="s">}</span>
 515           <span class="k">else</span> <span class="s">{</span>
 516             <span class="k">warn</span> <span class="q">&quot;Warning: Ignoring column number, $ColID, specifed in quartet, \&quot;$ColID,$DataType,$Criterion,$Value\&quot;, using \&quot;--highlight\&quot; option for $TextFilesList[$Index]: it doesn&#39;t exists \n&quot;</span><span class="sc">;</span>
 517             <span class="k">next</span> <span class="j">SPECIFIEDCOLS</span><span class="sc">;</span>
 518           <span class="s">}</span>
 519         <span class="s">}</span>
 520         <span class="k">else</span> <span class="s">{</span>
 521           <span class="i">$ColLabel</span> = <span class="i">$ColID</span><span class="sc">;</span>
 522           <span class="k">if</span> <span class="s">(</span><span class="k">exists</span><span class="s">(</span><span class="i">$TextFilesInfo</span>{<span class="w">ColLabelToNumMap</span>}[<span class="i">$Index</span>]{<span class="i">$ColLabel</span>}<span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 523             <span class="i">$ColNum</span> = <span class="i">$TextFilesInfo</span>{<span class="w">ColLabelToNumMap</span>}[<span class="i">$Index</span>]{<span class="i">$ColLabel</span>}<span class="sc">;</span>
 524           <span class="s">}</span> <span class="k">else</span> <span class="s">{</span>
 525             <span class="k">warn</span> <span class="q">&quot;Warning: Ignoring column label, $ColID, specifed in quartet, \&quot;$ColID,$DataType,$Criterion,$Value\&quot;, using \&quot;--highlight\&quot; option for $TextFilesList[$Index]: it doesn&#39;t exists \n&quot;</span><span class="sc">;</span>
 526             <span class="k">next</span> <span class="j">SPECIFIEDCOLS</span><span class="sc">;</span>
 527           <span class="s">}</span>
 528         <span class="s">}</span>
 529         <span class="i">$TextFilesInfo</span>{<span class="w">HightlightColNumMap</span>}[<span class="i">$Index</span>]{<span class="i">$ColNum</span>} = <span class="i">$ColNum</span><span class="sc">;</span>
 530         <span class="i">@</span>{<span class="i">$TextFilesInfo</span>{<span class="w">HightlightDataMap</span>}[<span class="i">$Index</span>]{<span class="i">$ColNum</span>}} =<span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 531         <span class="k">push</span> <span class="i">@</span>{<span class="i">$TextFilesInfo</span>{<span class="w">HightlightDataMap</span>}[<span class="i">$Index</span>]{<span class="i">$ColNum</span>}}<span class="cm">,</span> <span class="s">(</span><span class="i">$DataType</span><span class="cm">,</span> <span class="i">$Criterion</span><span class="cm">,</span> <span class="i">$Value</span><span class="s">)</span><span class="sc">;</span>
 532       <span class="s">}</span>
 533     <span class="s">}</span>
 534   <span class="s">}</span>
 535 <span class="s">}</span>
 536 
 537 <span class="c"># Setup navigation link information for multiple tables...</span>
<a name="SetupMultipleTablesInfo-"></a> 538 <span class="k">sub </span><span class="m">SetupMultipleTablesInfo</span> <span class="s">{</span>
 539   <span class="k">my</span><span class="s">(</span><span class="i">$Index</span><span class="cm">,</span> <span class="i">$LinesPerTable</span><span class="s">)</span><span class="sc">;</span>
 540 
 541   <span class="i">$LinesPerTable</span> = <span class="i">$Options</span>{<span class="w">numrows</span>}<span class="sc">;</span>
 542   <span class="i">@</span>{<span class="i">$TextFilesInfo</span>{<span class="w">TableCount</span>}} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 543   <span class="i">@</span>{<span class="i">$TextFilesInfo</span>{<span class="w">TableHTMLFiles</span>}} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 544   <span class="i">@</span>{<span class="i">$TextFilesInfo</span>{<span class="w">TableStartLineNum</span>}} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 545   <span class="i">@</span>{<span class="i">$TextFilesInfo</span>{<span class="w">TableEndLineNum</span>}} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 546 
 547   <span class="k">for</span> <span class="i">$Index</span> <span class="s">(</span><span class="n">0</span> .. <span class="i">$#TextFilesList</span><span class="s">)</span> <span class="s">{</span>
 548     <span class="i">$TextFilesInfo</span>{<span class="w">TableCount</span>}[<span class="i">$Index</span>] = <span class="n">1</span><span class="sc">;</span>
 549     <span class="i">@</span>{<span class="i">$TextFilesInfo</span>{<span class="w">TableHTMLFiles</span>}[<span class="i">$Index</span>]} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 550     <span class="i">@</span>{<span class="i">$TextFilesInfo</span>{<span class="w">TableStartLineNum</span>}[<span class="i">$Index</span>]} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 551     <span class="i">@</span>{<span class="i">$TextFilesInfo</span>{<span class="w">TableEndLineNum</span>}[<span class="i">$Index</span>]} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 552 
 553     <span class="k">if</span> <span class="s">(</span><span class="i">$TextFilesInfo</span>{<span class="w">FileOkay</span>}[<span class="i">$Index</span>]<span class="s">)</span> <span class="s">{</span>
 554       <span class="k">if</span> <span class="s">(</span><span class="i">$TextFilesInfo</span>{<span class="w">MultipleHTMLTables</span>}[<span class="i">$Index</span>]<span class="s">)</span> <span class="s">{</span>
 555         <span class="k">my</span><span class="s">(</span><span class="i">$TableIndex</span><span class="cm">,</span> <span class="i">$TotalLines</span><span class="cm">,</span> <span class="i">$TableCount</span><span class="cm">,</span> <span class="i">$TableStartLineNum</span><span class="cm">,</span> <span class="i">$TableEndLineNum</span><span class="cm">,</span> <span class="i">$Name</span><span class="s">)</span><span class="sc">;</span>
 556 
 557         <span class="i">$TotalLines</span> = <span class="i">$TextFilesInfo</span>{<span class="w">LineCount</span>}[<span class="i">$Index</span>]<span class="sc">;</span>
 558         <span class="i">$TableCount</span> = <span class="s">(</span><span class="i">$TotalLines</span> % <span class="i">$LinesPerTable</span><span class="s">)</span> ? <span class="s">(</span><span class="k">int</span><span class="s">(</span><span class="i">$TotalLines</span>/<span class="i">$LinesPerTable</span><span class="s">)</span> + <span class="n">1</span><span class="s">)</span> <span class="co">:</span> <span class="s">(</span><span class="i">$TotalLines</span>/<span class="i">$LinesPerTable</span><span class="s">)</span><span class="sc">;</span>
 559         <span class="i">$TextFilesInfo</span>{<span class="w">TableCount</span>}[<span class="i">$Index</span>] = <span class="i">$TableCount</span><span class="sc">;</span>
 560         <span class="k">for</span> <span class="i">$TableIndex</span> <span class="s">(</span><span class="n">1</span> .. <span class="i">$TableCount</span><span class="s">)</span> <span class="s">{</span>
 561           <span class="i">$TableStartLineNum</span> = <span class="s">(</span><span class="i">$TableIndex</span> - <span class="n">1</span><span class="s">)</span> * <span class="i">$LinesPerTable</span> + <span class="n">1</span><span class="sc">;</span>
 562           <span class="i">$TableEndLineNum</span> = <span class="s">(</span><span class="i">$TableIndex</span> == <span class="i">$TableCount</span><span class="s">)</span> ? <span class="i">$TotalLines</span> <span class="co">:</span> <span class="s">(</span><span class="i">$TableIndex</span> * <span class="i">$LinesPerTable</span><span class="s">)</span><span class="sc">;</span>
 563           <span class="k">push</span> <span class="i">@</span>{<span class="i">$TextFilesInfo</span>{<span class="w">TableStartLineNum</span>}[<span class="i">$Index</span>]}<span class="cm">,</span> <span class="i">$TableStartLineNum</span><span class="sc">;</span>
 564           <span class="k">push</span> <span class="i">@</span>{<span class="i">$TextFilesInfo</span>{<span class="w">TableEndLineNum</span>}[<span class="i">$Index</span>]}<span class="cm">,</span> <span class="i">$TableEndLineNum</span><span class="sc">;</span>
 565 
 566           <span class="c"># Setup HTML file names for all the tables...</span>
 567           <span class="i">$Name</span> = <span class="q">&quot;Lines&quot;</span> . <span class="q">&quot;$TableStartLineNum&quot;</span> . <span class="q">&quot;To&quot;</span> . <span class="q">&quot;$TableEndLineNum&quot;</span><span class="sc">;</span>
 568           <span class="k">if</span> <span class="s">(</span><span class="i">$TableIndex</span> == <span class="n">1</span><span class="s">)</span> <span class="s">{</span>
 569             <span class="i">$Name</span> = <span class="q">&quot;&quot;</span><span class="sc">;</span>
 570           <span class="s">}</span>
 571           <span class="i">$Name</span> = <span class="i">$TextFilesInfo</span>{<span class="w">HTMLRoot</span>}[<span class="i">$Index</span>] . <span class="i">$Name</span> . <span class="q">&quot;.html&quot;</span><span class="sc">;</span>
 572           <span class="k">push</span> <span class="i">@</span>{<span class="i">$TextFilesInfo</span>{<span class="w">TableHTMLFiles</span>}[<span class="i">$Index</span>]}<span class="cm">,</span> <span class="i">$Name</span><span class="sc">;</span>
 573         <span class="s">}</span>
 574         <span class="c">#print &quot;$TextFilesList[$Index]: $TableCount -  @{$TextFilesInfo{TableStartLineNum}[$Index]} - @{$TextFilesInfo{TableEndLineNum}[$Index]} -  @{$TextFilesInfo{TableHTMLFiles}[$Index]}\n&quot;;</span>
 575       <span class="s">}</span>
 576     <span class="s">}</span>
 577   <span class="s">}</span>
 578 <span class="s">}</span>
 579 
 580 <span class="c"># Setup HTML tags information...</span>
<a name="SetupHTMLTagsInfo-"></a> 581 <span class="k">sub </span><span class="m">SetupHTMLTagsInfo</span> <span class="s">{</span>
 582   <span class="c"># Setup row tags...</span>
 583   <span class="i">$TextFilesInfo</span>{<span class="w">RowHeaderTags</span>} = <span class="q">&quot;&quot;</span><span class="sc">;</span>
 584   <span class="i">$TextFilesInfo</span>{<span class="w">RowEndTags</span>} = <span class="q">&quot;&quot;</span><span class="sc">;</span>
 585   <span class="i">$TextFilesInfo</span>{<span class="w">BgFilledOddRowHeaderTags</span>} = <span class="q">&quot;&quot;</span><span class="sc">;</span>
 586   <span class="i">$TextFilesInfo</span>{<span class="w">BgFilledEvenRowHeaderTags</span>} = <span class="q">&quot;&quot;</span><span class="sc">;</span>
 587   <span class="i">$TextFilesInfo</span>{<span class="w">TableRowHeaderTags</span>} = <span class="q">&quot;&quot;</span><span class="sc">;</span>
 588 
 589   <span class="i">$TextFilesInfo</span>{<span class="w">RowHeaderTags</span>} = <span class="i">SetupHTMLTableRowHeader</span><span class="s">(</span><span class="i">$OptionsInfo</span>{<span class="w">RowHAlignment</span>}<span class="cm">,</span> <span class="q">&quot;&quot;</span><span class="cm">,</span> <span class="i">$OptionsInfo</span>{<span class="w">RowVAlignment</span>}<span class="s">)</span><span class="sc">;</span>
 590   <span class="i">$TextFilesInfo</span>{<span class="w">RowEndTags</span>} = <span class="i">SetupHTMLTableRowEnd</span><span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 591 
 592   <span class="k">if</span> <span class="s">(</span><span class="i">$OptionsInfo</span>{<span class="w">ShadeRowsStatus</span>}<span class="s">)</span> <span class="s">{</span>
 593     <span class="i">$TextFilesInfo</span>{<span class="w">BgFilledOddRowHeaderTags</span>} = <span class="i">SetupHTMLTableRowHeader</span><span class="s">(</span><span class="i">$OptionsInfo</span>{<span class="w">RowHAlignment</span>}<span class="cm">,</span> <span class="i">$OptionsInfo</span>{<span class="w">OddRowsShadeColor</span>}<span class="cm">,</span> <span class="i">$OptionsInfo</span>{<span class="w">RowVAlignment</span>}<span class="s">)</span><span class="sc">;</span>
 594     <span class="i">$TextFilesInfo</span>{<span class="w">BgFilledEvenRowHeaderTags</span>} = <span class="i">SetupHTMLTableRowHeader</span><span class="s">(</span><span class="i">$OptionsInfo</span>{<span class="w">RowHAlignment</span>}<span class="cm">,</span> <span class="i">$OptionsInfo</span>{<span class="w">EvenRowsShadeColor</span>}<span class="cm">,</span> <span class="i">$OptionsInfo</span>{<span class="w">RowVAlignment</span>}<span class="s">)</span><span class="sc">;</span>
 595   <span class="s">}</span>
 596 
 597   <span class="i">$TextFilesInfo</span>{<span class="w">TableRowHeaderTags</span>} = <span class="i">SetupHTMLTableRowHeader</span><span class="s">(</span><span class="i">$OptionsInfo</span>{<span class="w">TableHeaderRowHAlignment</span>}<span class="cm">,</span> <span class="i">$OptionsInfo</span>{<span class="w">TableHeaderRowColor</span>}<span class="cm">,</span> <span class="i">$OptionsInfo</span>{<span class="w">TableHeaderRowVAlignment</span>}<span class="s">)</span><span class="sc">;</span>
 598 
 599 <span class="s">}</span>
 600 
 601 <span class="c">#Make sure appropriate mode specific option values are specified...</span>
<a name="ProcessOptions-"></a> 602 <span class="k">sub </span><span class="m">ProcessOptions</span> <span class="s">{</span>
 603 
 604   <span class="i">%OptionsInfo</span> = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 605 
 606   <span class="i">$OptionsInfo</span>{<span class="w">RowHAlignment</span>} = <span class="q">&quot;left&quot;</span><span class="sc">;</span> <span class="i">$OptionsInfo</span>{<span class="w">RowVAlignment</span>} = <span class="q">&quot;middle&quot;</span><span class="sc">;</span>
 607   <span class="k">if</span> <span class="s">(</span><span class="k">exists</span><span class="s">(</span><span class="i">$Options</span>{<span class="w">align</span>}<span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 608     <span class="k">my</span> <span class="s">(</span><span class="i">@AlignValues</span><span class="s">)</span> = <span class="k">split</span> <span class="q">&quot;,&quot;</span><span class="cm">,</span> <span class="i">$Options</span>{<span class="w">align</span>}<span class="sc">;</span>
 609     <span class="k">if</span> <span class="s">(</span><span class="i">@AlignValues</span> == <span class="n">2</span><span class="s">)</span> <span class="s">{</span>
 610       <span class="i">$OptionsInfo</span>{<span class="w">RowHAlignment</span>} = <span class="i">$AlignValues</span>[<span class="n">0</span>]<span class="sc">;</span>
 611       <span class="i">$OptionsInfo</span>{<span class="w">RowVAlignment</span>} = <span class="i">$AlignValues</span>[<span class="n">1</span>]<span class="sc">;</span>
 612     <span class="s">}</span>
 613     <span class="k">elsif</span> <span class="s">(</span><span class="i">@AlignValues</span> == <span class="n">1</span><span class="s">)</span> <span class="s">{</span>
 614       <span class="i">$OptionsInfo</span>{<span class="w">RowHAlignment</span>} = <span class="i">$AlignValues</span>[<span class="n">0</span>]<span class="sc">;</span>
 615     <span class="s">}</span>
 616     <span class="k">else</span> <span class="s">{</span>
 617       <span class="k">die</span> <span class="q">&quot;Error: Invalid number of values, &quot;</span><span class="cm">,</span> <span class="k">scalar</span><span class="s">(</span><span class="i">@AlignValues</span><span class="s">)</span> <span class="cm">,</span> <span class="q">&quot;, specified by \&quot;-a --align\&quot; option.\nIt must contain only one or two value.\n&quot;</span><span class="sc">;</span>
 618     <span class="s">}</span>
 619     <span class="k">if</span> <span class="s">(</span><span class="i">$OptionsInfo</span>{<span class="w">RowHAlignment</span>} !~ <span class="q">/^(left|center|right)$/i</span><span class="s">)</span> <span class="s">{</span>
 620       <span class="k">die</span> <span class="q">&quot;Error: The horizontal alignment value specified, $Options{align}, for option \&quot;-a --align\&quot; is not valid. Allowed values: left, center, or right\n&quot;</span><span class="sc">;</span>
 621     <span class="s">}</span>
 622     <span class="k">if</span> <span class="s">(</span><span class="i">$OptionsInfo</span>{<span class="w">RowVAlignment</span>} !~ <span class="q">/^(top|middle|bottom)$/i</span><span class="s">)</span> <span class="s">{</span>
 623       <span class="k">die</span> <span class="q">&quot;Error: The horizontal alignment value specified, $Options{align}, for option \&quot;-a --align\&quot; is not valid. Allowed values: top, middle, or bottom\n&quot;</span><span class="sc">;</span>
 624     <span class="s">}</span>
 625   <span class="s">}</span>
 626 
 627   <span class="i">$OptionsInfo</span>{<span class="w">TableHeaderRowHAlignment</span>} = <span class="q">&quot;center&quot;</span><span class="sc">;</span> <span class="i">$OptionsInfo</span>{<span class="w">TableHeaderRowVAlignment</span>} = <span class="q">&quot;middle&quot;</span><span class="sc">;</span>
 628   <span class="k">if</span> <span class="s">(</span><span class="k">exists</span><span class="s">(</span><span class="i">$Options</span>{<span class="w">headeralign</span>}<span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 629     <span class="k">my</span> <span class="s">(</span><span class="i">@AlignValues</span><span class="s">)</span> = <span class="k">split</span> <span class="q">&quot;,&quot;</span><span class="cm">,</span> <span class="i">$Options</span>{<span class="w">headeralign</span>}<span class="sc">;</span>
 630     <span class="k">if</span> <span class="s">(</span><span class="i">@AlignValues</span> == <span class="n">2</span><span class="s">)</span> <span class="s">{</span>
 631       <span class="i">$OptionsInfo</span>{<span class="w">TableHeaderRowHAlignment</span>} = <span class="i">$AlignValues</span>[<span class="n">0</span>]<span class="sc">;</span>
 632       <span class="i">$OptionsInfo</span>{<span class="w">TableHeaderRowVAlignment</span>} = <span class="i">$AlignValues</span>[<span class="n">1</span>]<span class="sc">;</span>
 633     <span class="s">}</span>
 634     <span class="k">elsif</span> <span class="s">(</span><span class="i">@AlignValues</span> == <span class="n">1</span><span class="s">)</span> <span class="s">{</span>
 635       <span class="i">$OptionsInfo</span>{<span class="w">TableHeaderRowHAlignment</span>} = <span class="i">$AlignValues</span>[<span class="n">0</span>]<span class="sc">;</span>
 636     <span class="s">}</span>
 637     <span class="k">else</span> <span class="s">{</span>
 638       <span class="k">die</span> <span class="q">&quot;Error: Invalid number of values, &quot;</span><span class="cm">,</span> <span class="k">scalar</span><span class="s">(</span><span class="i">@AlignValues</span><span class="s">)</span> <span class="cm">,</span> <span class="q">&quot;, specified by \&quot;--headeralign\&quot; option.\nIt must contain only one or two value.\n&quot;</span><span class="sc">;</span>
 639     <span class="s">}</span>
 640     <span class="k">if</span> <span class="s">(</span><span class="i">$OptionsInfo</span>{<span class="w">TableHeaderRowHAlignment</span>} !~ <span class="q">/^(left|center|right)$/i</span><span class="s">)</span> <span class="s">{</span>
 641       <span class="k">die</span> <span class="q">&quot;Error: The horizontal alignment value specified, $Options{headeralign}, for option \&quot;--headeralign\&quot; is not valid. Allowed values: left, center, or right\n&quot;</span><span class="sc">;</span>
 642     <span class="s">}</span>
 643     <span class="k">if</span> <span class="s">(</span><span class="i">$OptionsInfo</span>{<span class="w">TableHeaderRowVAlignment</span>} !~ <span class="q">/^(top|middle|bottom)$/i</span><span class="s">)</span> <span class="s">{</span>
 644       <span class="k">die</span> <span class="q">&quot;Error: The horizontal alignment value specified, $Options{headeralign}, for option \&quot;-a --headeralign\&quot; is not valid. Allowed values: top, middle, or bottom\n&quot;</span><span class="sc">;</span>
 645     <span class="s">}</span>
 646   <span class="s">}</span>
 647 
 648   <span class="i">$OptionsInfo</span>{<span class="w">TitleDisplay</span>} = <span class="s">(</span><span class="i">$Options</span>{<span class="w">titledisplay</span>} =~ <span class="q">/^yes$/i</span><span class="s">)</span> ? <span class="n">1</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 649 
 650   <span class="k">if</span> <span class="s">(</span><span class="k">exists</span><span class="s">(</span><span class="i">$Options</span>{<span class="w">border</span>}<span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 651     <span class="i">$OptionsInfo</span>{<span class="w">TableBorder</span>} = <span class="i">$Options</span>{<span class="w">border</span>}<span class="sc">;</span>
 652   <span class="s">}</span>
 653   <span class="k">else</span> <span class="s">{</span>
 654     <span class="i">$OptionsInfo</span>{<span class="w">TableBorder</span>} = <span class="s">(</span><span class="i">$Options</span>{<span class="w">mode</span>} =~ <span class="q">/^(plain|highlight)$/i</span><span class="s">)</span> ? <span class="n">1</span> <span class="co">:</span> <span class="n">0</span><span class="sc">;</span>
 655   <span class="s">}</span>
 656   <span class="i">$OptionsInfo</span>{<span class="w">TableCellPadding</span>} = <span class="i">$Options</span>{<span class="w">cellpadding</span>}<span class="sc">;</span>
 657   <span class="i">$OptionsInfo</span>{<span class="w">TableCellSpacing</span>} = <span class="i">$Options</span>{<span class="w">cellspacing</span>}<span class="sc">;</span>
 658   <span class="i">$OptionsInfo</span>{<span class="w">Footer</span>} = <span class="i">$Options</span>{<span class="w">footer</span>} ? <span class="i">$Options</span>{<span class="w">footer</span>} <span class="co">:</span> <span class="q">&quot;&quot;</span><span class="sc">;</span>
 659 
 660   <span class="k">if</span> <span class="s">(</span><span class="i">$Options</span>{<span class="w">headercolor</span>}<span class="s">)</span> <span class="s">{</span>
 661     <span class="i">$OptionsInfo</span>{<span class="w">TableHeaderRowColor</span>} = <span class="i">$Options</span>{<span class="w">headercolor</span>}<span class="sc">;</span>
 662   <span class="s">}</span>
 663   <span class="k">else</span> <span class="s">{</span>
 664     <span class="i">$OptionsInfo</span>{<span class="w">TableHeaderRowColor</span>} = <span class="s">(</span><span class="i">$Options</span>{<span class="w">mode</span>} =~ <span class="q">/^plain$/i</span><span class="s">)</span> ? <span class="q">&quot;&quot;</span> <span class="co">:</span> <span class="q">&quot;#ccccff&quot;</span><span class="sc">;</span>
 665   <span class="s">}</span>
 666 
 667   <span class="i">$OptionsInfo</span>{<span class="w">NavLinksAtBottom</span>} = <span class="n">1</span><span class="sc">;</span> <span class="i">$OptionsInfo</span>{<span class="w">NavLinksAtTop</span>} = <span class="n">0</span><span class="sc">;</span>
 668   <span class="k">if</span> <span class="s">(</span><span class="i">$Options</span>{<span class="w">displaylinks</span>} =~ <span class="q">/^(both|top)$/i</span><span class="s">)</span> <span class="s">{</span>
 669     <span class="i">$OptionsInfo</span>{<span class="w">NavLinksAtTop</span>} = <span class="n">1</span><span class="sc">;</span>
 670   <span class="s">}</span>
 671   <span class="i">$OptionsInfo</span>{<span class="w">NavLinksTableInfo</span>} = <span class="n">1</span><span class="sc">;</span> <span class="i">$OptionsInfo</span>{<span class="w">NavLinksLineInfo</span>} = <span class="n">0</span><span class="sc">;</span>
 672   <span class="k">if</span> <span class="s">(</span><span class="i">$Options</span>{<span class="w">displaylinksinfo</span>} =~ <span class="q">/^both$/i</span><span class="s">)</span> <span class="s">{</span>
 673     <span class="i">$OptionsInfo</span>{<span class="w">NavLinksLineInfo</span>} = <span class="n">1</span><span class="sc">;</span>
 674     <span class="i">$OptionsInfo</span>{<span class="w">NavLinksTableInfo</span>} = <span class="n">1</span><span class="sc">;</span>
 675   <span class="s">}</span>
 676   <span class="k">elsif</span> <span class="s">(</span><span class="i">$Options</span>{<span class="w">displaylinksinfo</span>} =~ <span class="q">/^line$/i</span><span class="s">)</span> <span class="s">{</span>
 677     <span class="i">$OptionsInfo</span>{<span class="w">NavLinksLineInfo</span>} = <span class="n">1</span><span class="sc">;</span>
 678     <span class="i">$OptionsInfo</span>{<span class="w">NavLinksTableInfo</span>} = <span class="n">0</span><span class="sc">;</span>
 679   <span class="s">}</span>
 680 
 681   <span class="k">if</span> <span class="s">(</span><span class="i">$Options</span>{<span class="w">stylesheet</span>} =~ <span class="q">/^old$/i</span> <span class="s">)</span> <span class="s">{</span>
 682     <span class="k">if</span> <span class="s">(</span>!<span class="i">$Options</span>{<span class="w">stylesheetname</span>}<span class="s">)</span> <span class="s">{</span>
 683       <span class="k">die</span> <span class="q">&quot;Error: No stylesheet name specified using \&quot;--stylesheetname\&quot; option: It is required for \&quot;old\&quot; value of \&quot;-s --stylesheet\&quot; option. \n&quot;</span><span class="sc">;</span>
 684     <span class="s">}</span>
 685   <span class="s">}</span>
 686 
 687   <span class="k">my</span><span class="s">(</span><span class="i">@ColorValues</span><span class="s">)</span><span class="sc">;</span>
 688   <span class="i">$OptionsInfo</span>{<span class="w">OddRowsShadeColor</span>} = <span class="q">&quot;&quot;</span><span class="sc">;</span> <span class="i">$OptionsInfo</span>{<span class="w">EvenRowsShadeColor</span>} = <span class="q">&quot;&quot;</span><span class="sc">;</span> <span class="i">$OptionsInfo</span>{<span class="w">ShadeRowsStatus</span>} = <span class="n">0</span><span class="sc">;</span>
 689   <span class="k">if</span> <span class="s">(</span><span class="i">$Options</span>{<span class="w">mode</span>} =~ <span class="q">/^(shade|shadedhighlight)$/i</span><span class="s">)</span> <span class="s">{</span>
 690     <span class="i">$OptionsInfo</span>{<span class="w">OddRowsShadeColor</span>} = <span class="q">&quot;#ffffff&quot;</span><span class="sc">;</span>
 691     <span class="i">$OptionsInfo</span>{<span class="w">EvenRowsShadeColor</span>} = <span class="q">&quot;#e0e0eb&quot;</span><span class="sc">;</span>
 692     <span class="i">$OptionsInfo</span>{<span class="w">ShadeRowsStatus</span>} = <span class="n">1</span><span class="sc">;</span>
 693     <span class="k">if</span> <span class="s">(</span><span class="i">$Options</span>{<span class="w">shadecolor</span>}<span class="s">)</span> <span class="s">{</span>
 694       <span class="c"># Make sure only two value are specified...</span>
 695       <span class="i">@ColorValues</span> = <span class="k">split</span> <span class="q">&quot;,&quot;</span><span class="cm">,</span> <span class="i">$Options</span>{<span class="w">shadecolor</span>}<span class="sc">;</span>
 696       <span class="k">if</span> <span class="s">(</span><span class="i">@ColorValues</span> == <span class="n">2</span><span class="s">)</span> <span class="s">{</span>
 697         <span class="i">$OptionsInfo</span>{<span class="w">OddRowsShadeColor</span>} = <span class="i">$ColorValues</span>[<span class="n">0</span>]<span class="sc">;</span>
 698         <span class="i">$OptionsInfo</span>{<span class="w">EvenRowsShadeColor</span>} = <span class="i">$ColorValues</span>[<span class="n">1</span>]<span class="sc">;</span>
 699       <span class="s">}</span>
 700       <span class="k">else</span> <span class="s">{</span>
 701         <span class="k">die</span> <span class="q">&quot;Error: Invalid number of values, &quot;</span><span class="cm">,</span> <span class="k">scalar</span><span class="s">(</span><span class="i">@ColorValues</span><span class="s">)</span> <span class="cm">,</span> <span class="q">&quot;, specified by \&quot;--shadecolor\&quot; option.\nIt must contain only two values.\n&quot;</span><span class="sc">;</span>
 702       <span class="s">}</span>
 703     <span class="s">}</span>
 704   <span class="s">}</span>
 705   <span class="i">$OptionsInfo</span>{<span class="w">ValueOkColor</span>} = <span class="q">&quot;&quot;</span><span class="sc">;</span> <span class="i">$OptionsInfo</span>{<span class="w">ValueNotOkColor</span>} = <span class="q">&quot;&quot;</span><span class="sc">;</span> <span class="i">$OptionsInfo</span>{<span class="w">HighlightStatus</span>} = <span class="n">0</span><span class="sc">;</span>
 706   <span class="k">if</span> <span class="s">(</span><span class="i">$Options</span>{<span class="w">mode</span>} =~ <span class="q">/^(highlight|shadedhighlight)$/i</span><span class="s">)</span> <span class="s">{</span>
 707     <span class="k">my</span><span class="s">(</span><span class="i">$HighlightMode</span><span class="cm">,</span> <span class="i">$HighlightBy</span><span class="s">)</span><span class="sc">;</span>
 708     <span class="i">$HighlightMode</span> = <span class="i">$Options</span>{<span class="w">mode</span>}<span class="sc">;</span> <span class="i">$HighlightBy</span> = <span class="i">$Options</span>{<span class="w">highlightby</span>}<span class="sc">;</span>
 709 
 710     <span class="i">$OptionsInfo</span>{<span class="w">HighlightStatus</span>} = <span class="n">1</span><span class="sc">;</span>
 711     <span class="i">$OptionsInfo</span>{<span class="w">ValueOkColor</span>} = <span class="q">&quot;#0fff0f&quot;</span><span class="sc">;</span>
 712     <span class="i">$OptionsInfo</span>{<span class="w">ValueNotOkColor</span>} = <span class="q">&quot;#ff0f0f&quot;</span><span class="sc">;</span>
 713     <span class="k">if</span> <span class="s">(</span><span class="i">$Options</span>{<span class="w">highlightstyle</span>} =~ <span class="q">/^text$/i</span><span class="s">)</span> <span class="s">{</span>
 714       <span class="i">$OptionsInfo</span>{<span class="w">ValueOkColor</span>} = <span class="q">&quot;#0fbb0f&quot;</span><span class="sc">;</span>
 715       <span class="i">$OptionsInfo</span>{<span class="w">ValueNotOkColor</span>} = <span class="q">&quot;#ff0f0f&quot;</span><span class="sc">;</span>
 716     <span class="s">}</span>
 717     <span class="k">if</span> <span class="s">(</span><span class="i">$Options</span>{<span class="w">highlightcolor</span>}<span class="s">)</span> <span class="s">{</span>
 718       <span class="c"># Make sure two values are specified...</span>
 719       <span class="i">@ColorValues</span> = <span class="k">split</span> <span class="q">&quot;,&quot;</span><span class="cm">,</span> <span class="i">$Options</span>{<span class="w">highlightcolor</span>}<span class="sc">;</span>
 720       <span class="k">if</span> <span class="s">(</span><span class="i">@ColorValues</span> == <span class="n">2</span><span class="s">)</span> <span class="s">{</span>
 721         <span class="i">$OptionsInfo</span>{<span class="w">ValueOkColor</span>} = <span class="i">$ColorValues</span>[<span class="n">0</span>]<span class="sc">;</span>
 722         <span class="i">$OptionsInfo</span>{<span class="w">ValueNotOkColor</span>} = <span class="i">$ColorValues</span>[<span class="n">1</span>]<span class="sc">;</span>
 723       <span class="s">}</span>
 724       <span class="k">else</span> <span class="s">{</span>
 725         <span class="k">die</span> <span class="q">&quot;Error: Invalid number of values, &quot;</span><span class="cm">,</span> <span class="k">scalar</span><span class="s">(</span><span class="i">@ColorValues</span><span class="s">)</span><span class="cm">,</span> <span class="q">&quot;, specified by \&quot;--highlightcolor\&quot; option.\nIt must contain only two value for $HighlightMode value specified using \&quot;-m --mode\&quot; option.\n&quot;</span><span class="sc">;</span>
 726       <span class="s">}</span>
 727     <span class="s">}</span>
 728     <span class="k">if</span> <span class="s">(</span>!<span class="i">$Options</span>{<span class="w">highlight</span>}<span class="s">)</span> <span class="s">{</span>
 729       <span class="k">die</span> <span class="q">&quot;Error: Specify columns to be highlighted using \&quot;--hightlight\&quot; option\n&quot;</span><span class="sc">;</span>
 730     <span class="s">}</span>
 731     <span class="c"># Retrieve quartet values from &quot;hightlight&quot; option...</span>
 732     <span class="k">my</span><span class="s">(</span><span class="i">@HighlightValueQuartets</span><span class="s">)</span><span class="sc">;</span>
 733 
 734     <span class="i">@HighlightValueQuartets</span> = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 735     <span class="i">@HighlightValueQuartets</span> = <span class="k">split</span> <span class="q">&quot;,&quot;</span><span class="cm">,</span> <span class="i">$Options</span>{<span class="w">highlight</span>}<span class="sc">;</span>
 736     <span class="k">if</span> <span class="s">(</span><span class="s">(</span><span class="i">@HighlightValueQuartets</span> % <span class="n">4</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 737       <span class="k">die</span> <span class="q">&quot;Error: Quartets not found in values specified using \&quot;--highlight\&quot; option for $HighlightMode \&quot;-m --mode\&quot;\n&quot;</span><span class="sc">;</span>
 738     <span class="s">}</span>
 739     <span class="c"># Process quartets...</span>
 740     <span class="k">my</span><span class="s">(</span><span class="i">$Index</span><span class="cm">,</span> <span class="i">$Col</span><span class="cm">,</span> <span class="i">$DataType</span><span class="cm">,</span> <span class="i">$Criterion</span><span class="cm">,</span> <span class="i">$Value</span><span class="s">)</span><span class="sc">;</span>
 741 
 742     <span class="i">@</span>{<span class="i">$OptionsInfo</span>{<span class="w">SpecifiedColIds</span>}} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 743     <span class="i">@</span>{<span class="i">$OptionsInfo</span>{<span class="w">SpecifiedColDataTypes</span>}} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 744     <span class="i">@</span>{<span class="i">$OptionsInfo</span>{<span class="w">SpecifiedColCriteria</span>}} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 745     <span class="i">@</span>{<span class="i">$OptionsInfo</span>{<span class="w">SpecifiedColValues</span>}} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 746     <span class="k">for</span> <span class="s">(</span><span class="i">$Index</span> = <span class="n">0</span><span class="sc">;</span> <span class="i">$Index</span> &lt; <span class="i">@HighlightValueQuartets</span><span class="sc">;</span> <span class="i">$Index</span> = <span class="i">$Index</span> + <span class="n">4</span><span class="s">)</span> <span class="s">{</span>
 747       <span class="i">$Col</span> = <span class="i">$HighlightValueQuartets</span>[<span class="i">$Index</span>]<span class="sc">;</span>
 748       <span class="i">$DataType</span> = <span class="i">$HighlightValueQuartets</span>[<span class="i">$Index</span> + <span class="n">1</span>]<span class="sc">;</span>
 749       <span class="i">$Criterion</span> = <span class="i">$HighlightValueQuartets</span>[<span class="i">$Index</span> + <span class="n">2</span>]<span class="sc">;</span>
 750       <span class="i">$Value</span> = <span class="i">$HighlightValueQuartets</span>[<span class="i">$Index</span> + <span class="n">3</span>]<span class="sc">;</span>
 751       <span class="k">if</span> <span class="s">(</span><span class="i">$Options</span>{<span class="w">highlightby</span>} =~ <span class="q">/^colnum$/i</span> <span class="s">)</span> <span class="s">{</span>
 752         <span class="k">if</span> <span class="s">(</span>!<span class="i">IsPositiveInteger</span><span class="s">(</span><span class="i">$Col</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 753           <span class="k">die</span> <span class="q">&quot;Error: Invalid column id, $Col, specified in quartet, \&quot;$Col,$DataType,$Criterion,$Value\&quot;, using \&quot;--hightlight\&quot; option: It must be an integer value &gt; 0 for $HighlightMode \&quot;-m --mode\&quot; and $HighlightBy \&quot;--highlightby\&quot; option values.\n&quot;</span><span class="sc">;</span>
 754         <span class="s">}</span>
 755       <span class="s">}</span>
 756       <span class="k">if</span> <span class="s">(</span><span class="i">$DataType</span> !~ <span class="q">/^(numeric|text)$/i</span><span class="s">)</span> <span class="s">{</span>
 757         <span class="k">die</span> <span class="q">&quot;Error: Invalid column data type, $DataType, specified in quartet, \&quot;$Col,$DataType,$Criterion,$Value\&quot;, using \&quot;--hightlight\&quot; option: Valid values: numeric or text\n&quot;</span><span class="sc">;</span>
 758       <span class="s">}</span>
 759       <span class="k">if</span> <span class="s">(</span><span class="i">$Criterion</span> !~ <span class="q">/^(eq|le|ge)$/i</span><span class="s">)</span> <span class="s">{</span>
 760         <span class="k">die</span> <span class="q">&quot;Error: Invalid criterion value, $Criterion, specified in quartet, \&quot;$Col,$DataType,$Criterion,$Value\&quot;, using \&quot;--hightlight\&quot; option: Valid values: le, ge, or eq\n&quot;</span><span class="sc">;</span>
 761       <span class="s">}</span>
 762       <span class="k">if</span> <span class="s">(</span><span class="i">$DataType</span> =~ <span class="q">/^numeric$/i</span><span class="s">)</span> <span class="s">{</span>
 763         <span class="k">if</span> <span class="s">(</span>!<span class="i">IsFloat</span><span class="s">(</span><span class="i">$Value</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 764           <span class="k">die</span> <span class="q">&quot;Error: Invalid criterion value, $Value, specified in quartet, \&quot;$Col,$DataType,$Criterion,$Value\&quot;, using \&quot;--hightlight\&quot; option: numeric value required for numeric data type\n&quot;</span><span class="sc">;</span>
 765         <span class="s">}</span>
 766       <span class="s">}</span>
 767       <span class="k">push</span> <span class="i">@</span>{<span class="i">$OptionsInfo</span>{<span class="w">SpecifiedColIds</span>}}<span class="cm">,</span> <span class="i">$Col</span><span class="sc">;</span>
 768       <span class="k">push</span> <span class="i">@</span>{<span class="i">$OptionsInfo</span>{<span class="w">SpecifiedColDataTypes</span>}}<span class="cm">,</span> <span class="i">$DataType</span><span class="sc">;</span>
 769       <span class="k">push</span> <span class="i">@</span>{<span class="i">$OptionsInfo</span>{<span class="w">SpecifiedColCriteria</span>}}<span class="cm">,</span> <span class="i">$Criterion</span><span class="sc">;</span>
 770       <span class="k">push</span> <span class="i">@</span>{<span class="i">$OptionsInfo</span>{<span class="w">SpecifiedColValues</span>}}<span class="cm">,</span> <span class="i">$Value</span><span class="sc">;</span>
 771     <span class="s">}</span>
 772   <span class="s">}</span>
 773 <span class="s">}</span>
 774 
 775 <span class="c"># Retrieve information about input text files...</span>
<a name="RetrieveTextFilesInfo-"></a> 776 <span class="k">sub </span><span class="m">RetrieveTextFilesInfo</span> <span class="s">{</span>
 777   <span class="k">my</span><span class="s">(</span><span class="i">$LineCount</span><span class="cm">,</span> <span class="i">$TextFile</span><span class="cm">,</span> <span class="i">$FileDir</span><span class="cm">,</span> <span class="i">$FileName</span><span class="cm">,</span> <span class="i">$HTMLFile</span><span class="cm">,</span> <span class="i">$CSSFile</span><span class="cm">,</span> <span class="i">$HTMLRoot</span><span class="cm">,</span> <span class="i">$HTMLTitle</span><span class="cm">,</span> <span class="i">$FileExt</span><span class="cm">,</span> <span class="i">$Index</span><span class="cm">,</span> <span class="i">$ColIndex</span><span class="cm">,</span> <span class="i">$ColNum</span><span class="cm">,</span> <span class="i">$ColLabel</span><span class="cm">,</span> <span class="i">$LinesCount</span><span class="cm">,</span> <span class="i">$InDelim</span><span class="cm">,</span> <span class="i">$Line</span><span class="cm">,</span> <span class="i">@LineWords</span><span class="cm">,</span> <span class="i">@ColLabels</span><span class="cm">,</span> <span class="i">$TopHTMLDir</span><span class="s">)</span><span class="sc">;</span>
 778 
 779   <span class="i">%TextFilesInfo</span> = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 780 
 781   <span class="i">@</span>{<span class="i">$TextFilesInfo</span>{<span class="w">FileOkay</span>}} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 782   <span class="i">@</span>{<span class="i">$TextFilesInfo</span>{<span class="w">ColCount</span>}} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 783   <span class="i">@</span>{<span class="i">$TextFilesInfo</span>{<span class="w">ColLabels</span>}} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 784   <span class="i">@</span>{<span class="i">$TextFilesInfo</span>{<span class="w">ColLabelToNumMap</span>}} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 785   <span class="i">@</span>{<span class="i">$TextFilesInfo</span>{<span class="w">LineCount</span>}} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 786   <span class="i">@</span>{<span class="i">$TextFilesInfo</span>{<span class="w">InDelim</span>}} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 787 
 788   <span class="i">@</span>{<span class="i">$TextFilesInfo</span>{<span class="w">HTMLRoot</span>}} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 789   <span class="i">@</span>{<span class="i">$TextFilesInfo</span>{<span class="w">HTMLTitle</span>}} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 790   <span class="i">@</span>{<span class="i">$TextFilesInfo</span>{<span class="w">MultipleHTMLTables</span>}} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 791 
 792   <span class="i">@</span>{<span class="i">$TextFilesInfo</span>{<span class="w">TopHTMLDir</span>}} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 793   <span class="i">@</span>{<span class="i">$TextFilesInfo</span>{<span class="w">SubHTMLDir</span>}} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 794 
 795   <span class="j">FILELIST:</span> <span class="k">for</span> <span class="i">$Index</span> <span class="s">(</span><span class="n">0</span> .. <span class="i">$#TextFilesList</span><span class="s">)</span> <span class="s">{</span>
 796     <span class="i">$TextFile</span> = <span class="i">$TextFilesList</span>[<span class="i">$Index</span>]<span class="sc">;</span>
 797 
 798     <span class="i">$TextFilesInfo</span>{<span class="w">FileOkay</span>}[<span class="i">$Index</span>] = <span class="n">0</span><span class="sc">;</span>
 799     <span class="i">$TextFilesInfo</span>{<span class="w">ColCount</span>}[<span class="i">$Index</span>] = <span class="n">0</span><span class="sc">;</span>
 800     <span class="i">$TextFilesInfo</span>{<span class="w">LineCount</span>}[<span class="i">$Index</span>] = <span class="n">0</span><span class="sc">;</span>
 801     <span class="i">$TextFilesInfo</span>{<span class="w">InDelim</span>}[<span class="i">$Index</span>] = <span class="q">&quot;&quot;</span><span class="sc">;</span>
 802     <span class="i">$TextFilesInfo</span>{<span class="w">HTMLRoot</span>}[<span class="i">$Index</span>] = <span class="q">&quot;&quot;</span><span class="sc">;</span>
 803     <span class="i">$TextFilesInfo</span>{<span class="w">HTMLTitle</span>}[<span class="i">$Index</span>] = <span class="q">&quot;&quot;</span><span class="sc">;</span>
 804     <span class="i">$TextFilesInfo</span>{<span class="w">MultipleHTMLTables</span>}[<span class="i">$Index</span>] = <span class="n">0</span><span class="sc">;</span>
 805 
 806     <span class="i">@</span>{<span class="i">$TextFilesInfo</span>{<span class="w">ColLabels</span>}[<span class="i">$Index</span>]} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 807     <span class="i">%</span>{<span class="i">$TextFilesInfo</span>{<span class="w">ColLabelToNumMap</span>}[<span class="i">$Index</span>]} = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 808 
 809     <span class="k">if</span> <span class="s">(</span>!<span class="s">(</span><span class="k">-e</span> <span class="i">$TextFile</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 810       <span class="k">warn</span> <span class="q">&quot;Warning: Ignoring file $TextFile: It doesn&#39;t exist\n&quot;</span><span class="sc">;</span>
 811       <span class="k">next</span> <span class="j">FILELIST</span><span class="sc">;</span>
 812     <span class="s">}</span>
 813     <span class="k">if</span> <span class="s">(</span>!<span class="i">CheckFileType</span><span class="s">(</span><span class="i">$TextFile</span><span class="cm">,</span> <span class="q">&quot;csv tsv&quot;</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 814       <span class="k">warn</span> <span class="q">&quot;Warning: Ignoring file $TextFile: It&#39;s not a csv or tsv file\n&quot;</span><span class="sc">;</span>
 815       <span class="k">next</span> <span class="j">FILELIST</span><span class="sc">;</span>
 816     <span class="s">}</span>
 817     <span class="s">(</span><span class="i">$FileDir</span><span class="cm">,</span> <span class="i">$FileName</span><span class="cm">,</span> <span class="i">$FileExt</span><span class="s">)</span> = <span class="i">ParseFileName</span><span class="s">(</span><span class="i">$TextFile</span><span class="s">)</span><span class="sc">;</span>
 818     <span class="k">if</span> <span class="s">(</span><span class="i">$FileExt</span> =~ <span class="q">/^tsv$/i</span><span class="s">)</span> <span class="s">{</span>
 819       <span class="i">$InDelim</span> = <span class="q">&quot;\t&quot;</span><span class="sc">;</span>
 820     <span class="s">}</span>
 821     <span class="k">else</span> <span class="s">{</span>
 822       <span class="i">$InDelim</span> = <span class="q">&quot;\,&quot;</span><span class="sc">;</span>
 823       <span class="k">if</span> <span class="s">(</span><span class="i">$Options</span>{<span class="w">indelim</span>} !~ <span class="q">/^(comma|semicolon)$/i</span><span class="s">)</span> <span class="s">{</span>
 824         <span class="k">warn</span> <span class="q">&quot;Warning: Ignoring file $TextFile: The value specified, $Options{indelim}, for option \&quot;--indelim\&quot; is not valid for csv files\n&quot;</span><span class="sc">;</span>
 825         <span class="k">next</span> <span class="j">FILELIST</span><span class="sc">;</span>
 826       <span class="s">}</span>
 827       <span class="k">if</span> <span class="s">(</span><span class="i">$Options</span>{<span class="w">indelim</span>} =~ <span class="q">/^semicolon$/i</span><span class="s">)</span> <span class="s">{</span>
 828         <span class="i">$InDelim</span> = <span class="q">&quot;\;&quot;</span><span class="sc">;</span>
 829       <span class="s">}</span>
 830     <span class="s">}</span>
 831 
 832     <span class="k">if</span> <span class="s">(</span>!<span class="k">open</span> <span class="w">TEXTFILE</span><span class="cm">,</span> <span class="q">&quot;$TextFile&quot;</span><span class="s">)</span> <span class="s">{</span>
 833       <span class="k">warn</span> <span class="q">&quot;Warning: Ignoring file $TextFile: Couldn&#39;t open it: $! \n&quot;</span><span class="sc">;</span>
 834       <span class="k">next</span> <span class="j">FILELIST</span><span class="sc">;</span>
 835     <span class="s">}</span>
 836 
 837     <span class="i">$Line</span> = <span class="i">GetTextLine</span><span class="s">(</span>\<span class="i">*TEXTFILE</span><span class="s">)</span><span class="sc">;</span>
 838     <span class="i">@ColLabels</span> = <span class="i">quotewords</span><span class="s">(</span><span class="i">$InDelim</span><span class="cm">,</span> <span class="n">0</span><span class="cm">,</span> <span class="i">$Line</span><span class="s">)</span><span class="sc">;</span>
 839     <span class="i">$LineCount</span> = <span class="n">0</span><span class="sc">;</span>
 840     <span class="k">while</span> <span class="s">(</span><span class="q">&lt;TEXTFILE&gt;</span><span class="s">)</span> <span class="s">{</span>
 841       <span class="i">$LineCount</span>++<span class="sc">;</span>
 842     <span class="s">}</span>
 843     <span class="k">close</span> <span class="w">TEXTFILE</span><span class="sc">;</span>
 844 
 845     <span class="i">$FileDir</span> = <span class="q">&quot;&quot;</span><span class="sc">;</span> <span class="i">$FileName</span> = <span class="q">&quot;&quot;</span><span class="sc">;</span> <span class="i">$FileExt</span> = <span class="q">&quot;&quot;</span><span class="sc">;</span>
 846     <span class="s">(</span><span class="i">$FileDir</span><span class="cm">,</span> <span class="i">$FileName</span><span class="cm">,</span> <span class="i">$FileExt</span><span class="s">)</span> = <span class="i">ParseFileName</span><span class="s">(</span><span class="i">$TextFile</span><span class="s">)</span><span class="sc">;</span>
 847     <span class="i">$HTMLRoot</span> = <span class="i">$FileName</span><span class="sc">;</span>
 848     <span class="k">if</span> <span class="s">(</span><span class="i">$Options</span>{<span class="w">root</span>} &amp;&amp; <span class="s">(</span><span class="i">@TextFilesList</span> == <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 849       <span class="k">my</span> <span class="s">(</span><span class="i">$RootFileDir</span><span class="cm">,</span> <span class="i">$RootFileName</span><span class="cm">,</span> <span class="i">$RootFileExt</span><span class="s">)</span> = <span class="i">ParseFileName</span><span class="s">(</span><span class="i">$Options</span>{<span class="w">root</span>}<span class="s">)</span><span class="sc">;</span>
 850       <span class="k">if</span> <span class="s">(</span><span class="i">$RootFileName</span> &amp;&amp; <span class="i">$RootFileExt</span><span class="s">)</span> <span class="s">{</span>
 851         <span class="i">$HTMLRoot</span> = <span class="i">$RootFileName</span><span class="sc">;</span>
 852       <span class="s">}</span>
 853       <span class="k">else</span> <span class="s">{</span>
 854         <span class="i">$HTMLRoot</span> = <span class="i">$Options</span>{<span class="w">root</span>}<span class="sc">;</span>
 855       <span class="s">}</span>
 856     <span class="s">}</span>
 857     <span class="i">$HTMLTitle</span> = <span class="i">$HTMLRoot</span><span class="sc">;</span>
 858     <span class="k">if</span> <span class="s">(</span><span class="i">$Options</span>{<span class="w">title</span>} &amp;&amp; <span class="s">(</span><span class="i">@TextFilesList</span> == <span class="n">1</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 859       <span class="i">$HTMLTitle</span> = <span class="i">$Options</span>{<span class="w">title</span>}<span class="sc">;</span>
 860     <span class="s">}</span>
 861     <span class="i">$HTMLFile</span> = <span class="k">lc</span><span class="s">(</span><span class="i">$HTMLRoot</span><span class="s">)</span> . <span class="q">&quot;-html&quot;</span><span class="sc">;</span>
 862     <span class="k">if</span> <span class="s">(</span>!<span class="i">$Options</span>{<span class="w">overwrite</span>}<span class="s">)</span> <span class="s">{</span>
 863       <span class="k">if</span> <span class="s">(</span><span class="k">-d</span> <span class="i">$HTMLFile</span><span class="s">)</span> <span class="s">{</span>
 864         <span class="k">warn</span> <span class="q">&quot;Warning: Ignoring file $TextFile: The directory $HTMLFile already exists\n&quot;</span><span class="sc">;</span>
 865         <span class="k">next</span> <span class="j">FILELIST</span><span class="sc">;</span>
 866       <span class="s">}</span>
 867     <span class="s">}</span>
 868 
 869     <span class="i">$TextFilesInfo</span>{<span class="w">FileOkay</span>}[<span class="i">$Index</span>] = <span class="n">1</span><span class="sc">;</span>
 870     <span class="i">$TextFilesInfo</span>{<span class="w">InDelim</span>}[<span class="i">$Index</span>] = <span class="i">$InDelim</span><span class="sc">;</span>
 871     <span class="i">$TextFilesInfo</span>{<span class="w">HTMLRoot</span>}[<span class="i">$Index</span>] = <span class="q">&quot;$HTMLRoot&quot;</span><span class="sc">;</span>
 872     <span class="i">$TextFilesInfo</span>{<span class="w">HTMLTitle</span>}[<span class="i">$Index</span>] = <span class="q">&quot;$HTMLTitle&quot;</span><span class="sc">;</span>
 873 
 874     <span class="i">$TextFilesInfo</span>{<span class="w">ColCount</span>}[<span class="i">$Index</span>] = <span class="i">@ColLabels</span><span class="sc">;</span>
 875     <span class="k">push</span> <span class="i">@</span>{<span class="i">$TextFilesInfo</span>{<span class="w">ColLabels</span>}[<span class="i">$Index</span>]}<span class="cm">,</span> <span class="i">@ColLabels</span><span class="sc">;</span>
 876     <span class="k">for</span> <span class="i">$ColNum</span> <span class="s">(</span><span class="n">0</span> .. <span class="i">$#ColLabels</span><span class="s">)</span> <span class="s">{</span>
 877       <span class="i">$ColLabel</span> = <span class="i">$ColLabels</span>[<span class="i">$ColNum</span>]<span class="sc">;</span>
 878       <span class="i">$TextFilesInfo</span>{<span class="w">ColLabelToNumMap</span>}[<span class="i">$Index</span>]{<span class="i">$ColLabel</span>} = <span class="i">$ColNum</span><span class="sc">;</span>
 879     <span class="s">}</span>
 880     <span class="i">$TextFilesInfo</span>{<span class="w">LineCount</span>}[<span class="i">$Index</span>] = <span class="i">$LineCount</span><span class="sc">;</span>
 881 
 882     <span class="k">if</span> <span class="s">(</span><span class="i">$Options</span>{<span class="w">numrows</span>} == <span class="n">0</span> || <span class="i">$LineCount</span> &lt;= <span class="i">$Options</span>{<span class="w">numrows</span>}<span class="s">)</span> <span class="s">{</span>
 883       <span class="i">$TextFilesInfo</span>{<span class="w">MultipleHTMLTables</span>}[<span class="i">$Index</span>] = <span class="n">0</span><span class="sc">;</span>
 884     <span class="s">}</span>
 885     <span class="k">else</span> <span class="s">{</span>
 886       <span class="i">$TextFilesInfo</span>{<span class="w">MultipleHTMLTables</span>}[<span class="i">$Index</span>] = <span class="n">1</span><span class="sc">;</span>
 887     <span class="s">}</span>
 888     <span class="c"># Setup HTML data directories paths...</span>
 889     <span class="i">$TopHTMLDir</span> = <span class="k">lc</span><span class="s">(</span><span class="i">$TextFilesInfo</span>{<span class="w">HTMLRoot</span>}[<span class="i">$Index</span>]<span class="s">)</span> . <span class="q">&quot;-html&quot;</span><span class="sc">;</span>
 890     <span class="i">$TextFilesInfo</span>{<span class="w">TopHTMLDir</span>}[<span class="i">$Index</span>] = <span class="q">&quot;$TopHTMLDir&quot;</span><span class="sc">;</span>
 891     <span class="i">$TextFilesInfo</span>{<span class="w">SubHTMLDir</span>}[<span class="i">$Index</span>] = <span class="q">&quot;$TopHTMLDir\/html&quot;</span><span class="sc">;</span>
 892   <span class="s">}</span>
 893 <span class="s">}</span>
 894 
 895 <span class="c"># Setup various data directories to hold HTML and other related files...</span>
<a name="SetupDataDirs-"></a> 896 <span class="k">sub </span><span class="m">SetupDataDirs</span> <span class="s">{</span>
 897   <span class="k">my</span><span class="s">(</span><span class="i">$Index</span><span class="s">)</span> = <span class="i">@_</span><span class="sc">;</span>
 898   <span class="k">my</span><span class="s">(</span><span class="i">$TopHTMLDir</span><span class="cm">,</span> <span class="i">$SubHTMLDir</span><span class="cm">,</span> <span class="i">$CreateTopHTMLDir</span><span class="cm">,</span> <span class="i">$CreateSubHTMLDir</span><span class="s">)</span><span class="sc">;</span>
 899 
 900   <span class="i">$TopHTMLDir</span> = <span class="i">$TextFilesInfo</span>{<span class="w">TopHTMLDir</span>}[<span class="i">$Index</span>]<span class="sc">;</span>
 901   <span class="i">$SubHTMLDir</span> = <span class="i">$TextFilesInfo</span>{<span class="w">SubHTMLDir</span>}[<span class="i">$Index</span>]<span class="sc">;</span>
 902 
 903   <span class="c"># Clean up existing directories...</span>
 904   <span class="k">if</span> <span class="s">(</span><span class="k">-d</span> <span class="i">$TopHTMLDir</span><span class="s">)</span> <span class="s">{</span>
 905     <span class="k">unlink</span> <span class="q">&quot;&lt;$TopHTMLDir/*.html&gt;&quot;</span><span class="sc">;</span>
 906     <span class="k">unlink</span> <span class="q">&quot;&lt;$TopHTMLDir/*.css&gt;&quot;</span><span class="sc">;</span>
 907   <span class="s">}</span>
 908   <span class="k">if</span> <span class="s">(</span><span class="k">-d</span> <span class="i">$SubHTMLDir</span><span class="s">)</span> <span class="s">{</span>
 909     <span class="k">unlink</span> <span class="q">&quot;&lt;$SubHTMLDir/*.html&gt;&quot;</span><span class="sc">;</span>
 910   <span class="s">}</span>
 911   <span class="c"># What directories need to be created...</span>
 912   <span class="i">$CreateTopHTMLDir</span> = <span class="s">(</span><span class="k">-d</span> <span class="i">$TopHTMLDir</span><span class="s">)</span> ? <span class="n">0</span> <span class="co">:</span> <span class="n">1</span><span class="sc">;</span>
 913 
 914   <span class="i">$CreateSubHTMLDir</span> = <span class="n">0</span><span class="sc">;</span>
 915   <span class="k">if</span> <span class="s">(</span><span class="i">$TextFilesInfo</span>{<span class="w">MultipleHTMLTables</span>}[<span class="i">$Index</span>]<span class="s">)</span> <span class="s">{</span>
 916     <span class="i">$CreateSubHTMLDir</span> = <span class="s">(</span><span class="k">-d</span> <span class="i">$SubHTMLDir</span><span class="s">)</span> ? <span class="n">0</span> <span class="co">:</span> <span class="n">1</span><span class="sc">;</span>
 917   <span class="s">}</span>
 918 
 919   <span class="c"># Create appropriate directories...</span>
 920   <span class="k">if</span> <span class="s">(</span><span class="i">$CreateTopHTMLDir</span><span class="s">)</span> <span class="s">{</span>
 921     <span class="k">mkdir</span> <span class="i">$TopHTMLDir</span> <span class="k">or</span> <span class="k">die</span> <span class="q">&quot;Couldn&#39;t mkdir $TopHTMLDir: $! \n&quot;</span><span class="sc">;</span>
 922   <span class="s">}</span>
 923   <span class="k">if</span> <span class="s">(</span><span class="i">$CreateSubHTMLDir</span><span class="s">)</span> <span class="s">{</span>
 924     <span class="k">mkdir</span> <span class="i">$SubHTMLDir</span> <span class="k">or</span> <span class="k">die</span> <span class="q">&quot;Error: Couldn&#39;t mkdir $SubHTMLDir: $! \n&quot;</span><span class="sc">;</span>
 925   <span class="s">}</span>
 926   <span class="k">else</span> <span class="s">{</span>
 927     <span class="k">unlink</span> <span class="q">&lt;$SubHTMLDir/*.html&gt;</span><span class="sc">;</span>
 928   <span class="s">}</span>
 929   <span class="k">return</span> <span class="s">(</span><span class="i">$TopHTMLDir</span><span class="cm">,</span> <span class="i">$SubHTMLDir</span><span class="s">)</span><span class="sc">;</span>
 930 <span class="s">}</span>
 931 
 932 <span class="c"># Setup script usage  and retrieve command line arguments specified using various options...</span>
<a name="SetupScriptUsage-"></a> 933 <span class="k">sub </span><span class="m">SetupScriptUsage</span> <span class="s">{</span>
 934 
 935   <span class="c"># Retrieve all the options...</span>
 936   <span class="i">%Options</span> = <span class="s">(</span><span class="s">)</span><span class="sc">;</span>
 937   <span class="i">$Options</span>{<span class="w">indelim</span>} = <span class="q">&quot;comma&quot;</span><span class="sc">;</span>
 938   <span class="i">$Options</span>{<span class="w">numrows</span>} = <span class="n">50</span><span class="sc">;</span>
 939 
 940   <span class="i">$Options</span>{<span class="w">mode</span>} = <span class="q">&quot;shade&quot;</span><span class="sc">;</span>
 941   <span class="i">$Options</span>{<span class="w">highlightby</span>} = <span class="q">&quot;colnum&quot;</span><span class="sc">;</span>
 942   <span class="i">$Options</span>{<span class="w">highlightstyle</span>} = <span class="q">&quot;background&quot;</span><span class="sc">;</span>
 943 
 944   <span class="i">$Options</span>{<span class="w">cellpadding</span>} = <span class="n">2</span><span class="sc">;</span>
 945   <span class="i">$Options</span>{<span class="w">cellspacing</span>} = <span class="n">1</span><span class="sc">;</span>
 946 
 947   <span class="i">$Options</span>{<span class="w">displaylinks</span>} = <span class="q">&quot;both&quot;</span><span class="sc">;</span>
 948   <span class="i">$Options</span>{<span class="w">displaylinksinfo</span>} = <span class="q">&quot;both&quot;</span><span class="sc">;</span>
 949   <span class="i">$Options</span>{<span class="w">stylesheet</span>} = <span class="q">&quot;new&quot;</span><span class="sc">;</span>
 950 
 951   <span class="i">$Options</span>{<span class="w">titledisplay</span>} = <span class="q">&quot;yes&quot;</span><span class="sc">;</span>
 952 
 953   <span class="k">if</span> <span class="s">(</span>!<span class="i">GetOptions</span><span class="s">(</span>\<span class="i">%Options</span><span class="cm">,</span> <span class="q">&quot;align|a=s&quot;</span><span class="cm">,</span> <span class="q">&quot;border|b=i&quot;</span><span class="cm">,</span> <span class="q">&quot;cellpadding=i&quot;</span><span class="cm">,</span> <span class="q">&quot;cellspacing=i&quot;</span><span class="cm">,</span> <span class="q">&quot;color|c=s&quot;</span><span class="cm">,</span> <span class="q">&quot;footer=s&quot;</span><span class="cm">,</span> <span class="q">&quot;displaylinks|d=s&quot;</span><span class="cm">,</span> <span class="q">&quot;displaylinksinfo=s&quot;</span><span class="cm">,</span> <span class="q">&quot;help|h&quot;</span><span class="cm">,</span> <span class="q">&quot;headeralign=s&quot;</span><span class="cm">,</span> <span class="q">&quot;headercolor=s&quot;</span><span class="cm">,</span> <span class="q">&quot;highlight=s&quot;</span><span class="cm">,</span> <span class="q">&quot;highlightby=s&quot;</span><span class="cm">,</span> <span class="q">&quot;highlightcolor=s&quot;</span><span class="cm">,</span> <span class="q">&quot;highlightstyle=s&quot;</span><span class="cm">,</span> <span class="q">&quot;indelim=s&quot;</span><span class="cm">,</span> <span class="q">&quot;mode|m=s&quot;</span><span class="cm">,</span> <span class="q">&quot;numrows|n=i&quot;</span><span class="cm">,</span> <span class="q">&quot;overwrite|o&quot;</span><span class="cm">,</span> <span class="q">&quot;root|r=s&quot;</span><span class="cm">,</span> <span class="q">&quot;shadecolor=s&quot;</span><span class="cm">,</span> <span class="q">&quot;stylesheet=s&quot;</span><span class="cm">,</span> <span class="q">&quot;stylesheetname=s&quot;</span><span class="cm">,</span> <span class="q">&quot;title|t=s&quot;</span><span class="cm">,</span> <span class="q">&quot;titledisplay=s&quot;</span><span class="cm">,</span> <span class="q">&quot;workingdir|w=s&quot;</span><span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 954     <span class="k">die</span> <span class="q">&quot;\nTo get a list of valid options and their values, use \&quot;$ScriptName -h\&quot; or\n\&quot;perl -S $ScriptName -h\&quot; command and try again...\n&quot;</span><span class="sc">;</span>
 955   <span class="s">}</span>
 956 
 957   <span class="k">if</span> <span class="s">(</span><span class="i">$Options</span>{<span class="w">workingdir</span>}<span class="s">)</span> <span class="s">{</span>
 958     <span class="k">if</span> <span class="s">(</span>! <span class="k">-d</span> <span class="i">$Options</span>{<span class="w">workingdir</span>}<span class="s">)</span> <span class="s">{</span>
 959       <span class="k">die</span> <span class="q">&quot;Error: The value specified, $Options{workingdir}, for option \&quot;-w --workingdir\&quot; is not a directory name.\n&quot;</span><span class="sc">;</span>
 960     <span class="s">}</span>
 961     <span class="k">chdir</span> <span class="i">$Options</span>{<span class="w">workingdir</span>} <span class="k">or</span> <span class="k">die</span> <span class="q">&quot;Error: Couldn&#39;t chdir $Options{workingdir}: $! \n&quot;</span><span class="sc">;</span>
 962   <span class="s">}</span>
 963   <span class="k">if</span> <span class="s">(</span><span class="i">$Options</span>{<span class="w">displaylinks</span>} !~ <span class="q">/^(top|bottom|both)$/i</span><span class="s">)</span> <span class="s">{</span>
 964     <span class="k">die</span> <span class="q">&quot;Error: The value specified, $Options{displaylinks}, for option \&quot;-d --displaylinks\&quot; is not valid. Allowed values: top, bottom, or both\n&quot;</span><span class="sc">;</span>
 965   <span class="s">}</span>
 966   <span class="k">if</span> <span class="s">(</span><span class="i">$Options</span>{<span class="w">displaylinksinfo</span>} !~ <span class="q">/^(line|table|both)$/i</span><span class="s">)</span> <span class="s">{</span>
 967     <span class="k">die</span> <span class="q">&quot;Error: The value specified, $Options{displaylinksinfo}, for option \&quot;--displaylinksinfo\&quot; is not valid. Allowed values: line, table, or both\n&quot;</span><span class="sc">;</span>
 968   <span class="s">}</span>
 969   <span class="k">if</span> <span class="s">(</span><span class="i">$Options</span>{<span class="w">indelim</span>} !~ <span class="q">/^(comma|semicolon)$/i</span><span class="s">)</span> <span class="s">{</span>
 970     <span class="k">die</span> <span class="q">&quot;Error: The value specified, $Options{indelim}, for option \&quot;--indelim\&quot; is not valid. Allowed values: comma or semicolon\n&quot;</span><span class="sc">;</span>
 971   <span class="s">}</span>
 972   <span class="k">if</span> <span class="s">(</span><span class="i">$Options</span>{<span class="w">highlightby</span>} !~ <span class="q">/^(colnum|collabel)$/i</span><span class="s">)</span> <span class="s">{</span>
 973     <span class="k">die</span> <span class="q">&quot;Error: The value specified, $Options{highlightby}, for option \&quot;--highlightby\&quot; is not valid. Allowed values: colnum or collabel\n&quot;</span><span class="sc">;</span>
 974   <span class="s">}</span>
 975   <span class="k">if</span> <span class="s">(</span><span class="i">$Options</span>{<span class="w">highlightstyle</span>} !~ <span class="q">/^(background|text)$/i</span><span class="s">)</span> <span class="s">{</span>
 976     <span class="k">die</span> <span class="q">&quot;Error: The value specified, $Options{highlightstyle}, for option \&quot;--highlightstyle\&quot; is not valid. Allowed values: background or text\n&quot;</span><span class="sc">;</span>
 977   <span class="s">}</span>
 978   <span class="k">if</span> <span class="s">(</span><span class="i">$Options</span>{<span class="w">mode</span>} !~ <span class="q">/^(plain|shade|highlight|shadedhighlight)$/i</span><span class="s">)</span> <span class="s">{</span>
 979     <span class="k">die</span> <span class="q">&quot;Error: The value specified, $Options{mode}, for option \&quot;-m --mode\&quot; is not valid. Allowed values: plain, shade, hightlight, or shadedhighlight\n&quot;</span><span class="sc">;</span>
 980   <span class="s">}</span>
 981   <span class="k">if</span> <span class="s">(</span><span class="i">$Options</span>{<span class="w">stylesheet</span>} !~ <span class="q">/^(old|new|none)$/i</span><span class="s">)</span> <span class="s">{</span>
 982     <span class="k">die</span> <span class="q">&quot;Error: The value specified, $Options{stylesheet}, for option \&quot;-s --stylesheet\&quot; is not valid. Allowed values: old, new, or none\n&quot;</span><span class="sc">;</span>
 983   <span class="s">}</span>
 984   <span class="k">if</span> <span class="s">(</span><span class="i">$Options</span>{<span class="w">numrows</span>} &lt; <span class="n">0</span><span class="s">)</span> <span class="s">{</span>
 985     <span class="k">die</span> <span class="q">&quot;Error: The value specified, $Options{numrows},  for option \&quot;-n --numrows\&quot; is not valid. Allowed values: &gt;= 0 \n&quot;</span><span class="sc">;</span>
 986   <span class="s">}</span>
 987   <span class="k">if</span> <span class="s">(</span><span class="i">$Options</span>{<span class="w">titledisplay</span>} !~ <span class="q">/^(yes|no)$/i</span><span class="s">)</span> <span class="s">{</span>
 988     <span class="k">die</span> <span class="q">&quot;Error: The value specified, $Options{titledisplay}, for option \&quot;--titledisplay\&quot; is not valid. Allowed values: yes or no\n&quot;</span><span class="sc">;</span>
 989   <span class="s">}</span>
 990   <span class="k">if</span> <span class="s">(</span><span class="k">exists</span><span class="s">(</span><span class="i">$Options</span>{<span class="w">border</span>}<span class="s">)</span><span class="s">)</span> <span class="s">{</span>
 991     <span class="k">if</span> <span class="s">(</span><span class="i">$Options</span>{<span class="w">border</span>} &lt; <span class="n">0</span><span class="s">)</span> <span class="s">{</span>
 992       <span class="k">die</span> <span class="q">&quot;Error: The value specified, $Options{border},  for option \&quot;--border\&quot; is not valid. Allowed values: &gt;= 0 \n&quot;</span><span class="sc">;</span>
 993     <span class="s">}</span>
 994   <span class="s">}</span>
 995   <span class="k">if</span> <span class="s">(</span><span class="i">$Options</span>{<span class="w">cellpadding</span>} &lt; <span class="n">0</span><span class="s">)</span> <span class="s">{</span>
 996     <span class="k">die</span> <span class="q">&quot;Error: The value specified, $Options{cellpadding},  for option \&quot;--cellpadding\&quot; is not valid. Allowed values: &gt;= 0 \n&quot;</span><span class="sc">;</span>
 997   <span class="s">}</span>
 998   <span class="k">if</span> <span class="s">(</span><span class="i">$Options</span>{<span class="w">cellspacing</span>} &lt; <span class="n">0</span><span class="s">)</span> <span class="s">{</span>
 999     <span class="k">die</span> <span class="q">&quot;Error: The value specified, $Options{cellspacing},  for option \&quot;--cellspacing\&quot; is not valid. Allowed values: &gt;= 0 \n&quot;</span><span class="sc">;</span>
1000   <span class="s">}</span>
1001 <span class="s">}</span>
1002 
<a name="EOF-"></a></pre>
<p>&nbsp;</p>
<br />
<center>
<img src="../../../images/h2o2.png">
</center>
</body>
</html>
