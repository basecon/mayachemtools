<html>
<head>
<title>MayaChemTools:Documentation:RDKitCalculateRMSD.py</title>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<link rel="stylesheet" type="text/css" href="../../css/MayaChemTools.css">
</head>
<body leftmargin="20" rightmargin="20" topmargin="10" bottommargin="10">
<br/>
<center>
<a href="http://www.mayachemtools.org" title="MayaChemTools Home"><img src="../../images/MayaChemToolsLogo.gif" border="0" alt="MayaChemTools"></a>
</center>
<br/>
<div class="DocNav">
<table width="100%" border=0 cellpadding=0 cellspacing=2>
<tr align="left" valign="top"><td width="33%" align="left"><a href="./RDKitCalculatePartialCharges.html" title="RDKitCalculatePartialCharges.html">Previous</a>&nbsp;&nbsp;<a href="./index.html" title="Table of Contents">TOC</a>&nbsp;&nbsp;<a href="./RDKitClusterMolecules.html" title="RDKitClusterMolecules.html">Next</a></td><td width="34%" align="middle"><strong>RDKitCalculateRMSD.py</strong></td><td width="33%" align="right"><a href="././code/RDKitCalculateRMSD.html" title="View source code">Code</a>&nbsp;|&nbsp;<a href="./../pdf/RDKitCalculateRMSD.pdf" title="PDF US Letter Size">PDF</a>&nbsp;|&nbsp;<a href="./../pdfa4/RDKitCalculateRMSD.pdf" title="PDF A4 Size">PDFA4</a></td></tr>
</table>
</div>
<h1 id="NAME">NAME</h2>
<p>RDKitCalculateRMSD.py - Calculate RMSD between molecules</p>
<h1 id="SYNOPSIS">SYNOPSIS</h2>
<p>RDKitCalculateRMSD.py [<b>--calcRMSD</b> &lt;RMSD, BestRMSD&gt;] [<b>--infileParams</b> &lt;Name,Value,...&gt;] [<b>--maxIters</b> &lt;number&gt;] [<b>--mode</b> &lt;OneToOne, AllToAll, FirstToAll&gt;] [<b>--overwrite</b>] [<b>-w</b> &lt;dir&gt;] <b>-r</b> &lt;reffile&gt; <b>-p</b> &lt;probefile&gt; <b>-o</b> &lt;outfile&gt;</p>
<p>RDKitCalculateRMSD.py <b>-h</b> | <b>--help</b> | <b>-e</b> | <b>--examples</b></p>
<h1 id="DESCRIPTION">DESCRIPTION</h2>
<p>Calculate Root Mean Square Distance (RMSD) between a set of similar molecules in reference and probe input files. The RDKit function fails to calculate RMSD values for dissimilar molecules. Consequently, a text string &#39;None&#39; is written out as a RMSD value for dissimilar molecule pairs.</p>
<p>The supported input file formats are: Mol (.mol), SD (.sdf, .sd)</p>
<p>The supported output file formats are: CSV (.csv), TSV (.tsv, .txt)</p>
<h1 id="OPTIONS">OPTIONS</h2>
<dl>
<dt id="c---calcRMSD-RMSD-BestRMSD-default:-RMSD"><b>-c, --calcRMSD</b> &lt;RMSD, BestRMSD&gt; [default: RMSD]</dt>
<dd>
<p>Methodology for calculating RMSD values. Possible values: RMSD, BestRMSD. During BestRMSMode mode, the RDKit &#39;function AllChem.GetBestRMS&#39; is used to align and calculate RMSD. This function calculates optimal RMSD for aligning two molecules, taking symmetry into account. Otherwise, the RMSD value is calculated using &#39;AllChem.AlignMol function&#39; without changing the atom order. A word to the wise from RDKit documentation: The AllChem.GetBestRMS function will attempt to align all permutations of matching atom orders in both molecules, for some molecules it will lead to &#39;combinatorial explosion&#39;.</p>
</dd>
<dt id="infileParams-Name-Value-...-default:-auto"><b>--infileParams</b> &lt;Name,Value,...&gt; [default: auto]</dt>
<dd>
<p>A comma delimited list of parameter name and value pairs for reading molecules from files. The supported parameter names for different file formats, along with their default values, are shown below:</p>
<div class="OptionsBox">    SD, MOL: removeHydrogens,yes,sanitize,yes,strictParsing,yes
<br/>    </div>
</dd>
<dt id="maxIters-number-default:-50"><b>--maxIters</b> &lt;number&gt; [default: 50]</dt>
<dd>
<p>Maximum number of iterations to perform for each molecule pair during minimization of RMSD values. This option is ignored during BestRMSD mode.</p>
</dd>
<dt id="m---mode-OneToOne-AllToAll-FirstToAll-default:-OneToOne"><b>-m, --mode</b> &lt;OneToOne, AllToAll, FirstToAll&gt; [default: OneToOne]</dt>
<dd>
<p>Specify how molecules are handled in reference and probe input files during calculation of RMSD between reference and probe molecules. Possible values: OneToOne, AllToAll and AllToFirst. For OneToOne mode, the number of molecules in reference file must be equal to the number of molecules in probe file. The RMSD is calculated for each pair of molecules in the reference and probe file and written to the output file. For AllToAll mode, the RMSD is calculated for each reference molecule against all probe molecules. For FirstToAll mode, however, the RMSD is only calculated for the first reference molecule against all probe molecules.</p>
</dd>
<dt id="e---examples"><b>-e, --examples</b></dt>
<dd>
<p>Print examples.</p>
</dd>
<dt id="h---help"><b>-h, --help</b></dt>
<dd>
<p>Print this help message.</p>
</dd>
<dt id="p---probefile-probefile"><b>-p, --probefile</b> &lt;probefile&gt;</dt>
<dd>
<p>Probe input file name.</p>
</dd>
<dt id="r---reffile-reffile"><b>-r, --reffile</b> &lt;reffile&gt;</dt>
<dd>
<p>Reference input file name.</p>
</dd>
<dt id="o---outfile-outfile"><b>-o, --outfile</b> &lt;outfile&gt;</dt>
<dd>
<p>Output file name for writing out RMSD values. Supported text file extensions: csv or tsv.</p>
</dd>
<dt id="overwrite"><b>--overwrite</b></dt>
<dd>
<p>Overwrite existing files.</p>
</dd>
<dt id="w---workingdir-dir"><b>-w, --workingdir</b> &lt;dir&gt;</dt>
<dd>
<p>Location of working directory which defaults to the current directory.</p>
</dd>
</dl>
<h1 id="EXAMPLES">EXAMPLES</h2>
<p>To calculate RMSD between pair of molecules in reference and probe input 3D SD files and write out a CSV file containing calculated RMSD values along with appropriate molecule IDs, type:</p>
<div class="ExampleBox">    % RDKitCalculateRMSD.py  -r Sample3DRef.sdf -p Sample3DProb.sdf
      -o SampleOut.csv</div>
<p>To calculate RMSD between all molecules in reference and probe input 3D SD files and write out a CSV file containing calculated RMSD values along with appropriate molecule IDs, type:</p>
<div class="ExampleBox">    % RDKitCalculateRMSD.py  -m AllToAll -r Sample3DRef.sdf -p
      Sample3DProb.sdf -o SampleOut.csv</div>
<p>To calculate best RMSD between first molecule in reference all probe molecules in 3D SD files and write out a TSV file containing calculated RMSD values along with appropriate molecule IDs, type:</p>
<div class="ExampleBox">    % RDKitCalculateRMSD.py  -m FirstToAll --calcRMSD BestRMSD -r
      Sample3DRef.sdf -p Sample3DProb.sdf -o SampleOut.tsv</div>
<p>To calculate RMSD between all molecules in reference and probe molecules input 3D SD files without removing hydrogens and write out a TSV file containing calculated RMSD values along with appropriate molecule IDs, type:</p>
<div class="ExampleBox">    % RDKitCalculateRMSD.py  -m AllToAll --infileParams
      &quot;removeHydrogens,no&quot; -r Sample3DRef.sdf  -p Sample3DProb.sdf
      -o SampleOut.tsv</div>
<h1 id="AUTHOR">AUTHOR</h2>
<p><a href="mailto:msud@san.rr.com">Manish Sud</a></p>
<h1 id="SEE-ALSO">SEE ALSO</h2>
<p><a href="./RDKitCalculateMolecularDescriptors.html">RDKitCalculateMolecularDescriptors.py</a>, <a href="./RDKitCompareMoleculeShapes.html">RDKitCompareMoleculeShapes.py</a>, <a href="./RDKitConvertFileFormat.html">RDKitConvertFileFormat.py</a>, <a href="./RDKitGenerateConformers.html">RDKitGenerateConformers.py</a>, <a href="./RDKitPerformMinimization.html">RDKitPerformMinimization.py</a></p>
<h1 id="COPYRIGHT">COPYRIGHT</h2>
<p>Copyright (C) 2020 Manish Sud. All rights reserved.</p>
<p>The functionality available in this script is implemented using RDKit, an open source toolkit for cheminformatics developed by Greg Landrum.</p>
<p>This file is part of MayaChemTools.</p>
<p>MayaChemTools is free software; you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation; either version 3 of the License, or (at your option) any later version.</p>
<p>&nbsp</p><p>&nbsp</p><div class="DocNav">
<table width="100%" border=0 cellpadding=0 cellspacing=2>
<tr align="left" valign="top"><td width="33%" align="left"><a href="./RDKitCalculatePartialCharges.html" title="RDKitCalculatePartialCharges.html">Previous</a>&nbsp;&nbsp;<a href="./index.html" title="Table of Contents">TOC</a>&nbsp;&nbsp;<a href="./RDKitClusterMolecules.html" title="RDKitClusterMolecules.html">Next</a></td><td width="34%" align="middle"><strong>August 27, 2020</strong></td><td width="33%" align="right"><strong>RDKitCalculateRMSD.py</strong></td></tr>
</table>
</div>
<br />
<center>
<img src="../../images/h2o2.png">
</center>
</body>
</html>
